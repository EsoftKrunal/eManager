IF NOT EXISTS (SELECT name FROM sys.databases WHERE name = N'eMANAGER')
BEGIN
	CREATE DATABASE eMANAGER COLLATE SQL_Latin1_General_CP1_CI_AS 
END
GO

USE eMANAGER
GO

IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'VW_MP_VSL_ProvisionOtherItems', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_MP_VSL_ProvisionOtherItems'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'VW_MP_VSL_ProvisionOtherItems', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_MP_VSL_ProvisionOtherItems'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'VW_MP_VSL_ProvisionNationalityWise', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_MP_VSL_ProvisionNationalityWise'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'VW_MP_VSL_ProvisionNationalityWise', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_MP_VSL_ProvisionNationalityWise'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'VW_MP_VSL_ProvisionDetails', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_MP_VSL_ProvisionDetails'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'VW_MP_VSL_ProvisionDetails', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_MP_VSL_ProvisionDetails'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobUpdateDataByPeriod', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobUpdateDataByPeriod'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane2' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobUpdateDataByPeriod', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane2' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobUpdateDataByPeriod'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobUpdateDataByPeriod', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobUpdateDataByPeriod'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobPlanningHomerpt', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobPlanningHomerpt'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobPlanningHomerpt', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobPlanningHomerpt'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobPlanningForRPT', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobPlanningForRPT'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane2' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobPlanningForRPT', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane2' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobPlanningForRPT'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobPlanningForRPT', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobPlanningForRPT'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobComplitationReport', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobComplitationReport'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobComplitationReport', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobComplitationReport'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ER_S133_PrintReport', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ER_S133_PrintReport'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ER_S133_PrintReport', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ER_S133_PrintReport'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ER_S115_PrintReport_InjuryToPerson', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ER_S115_PrintReport_InjuryToPerson'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ER_S115_PrintReport_InjuryToPerson', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ER_S115_PrintReport_InjuryToPerson'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ER_S115_PrintReport', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ER_S115_PrintReport'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ER_S115_PrintReport', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ER_S115_PrintReport'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'VW_DefectReport_ShipData', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_DefectReport_ShipData'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'VW_DefectReport_ShipData', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_DefectReport_ShipData'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'VW_DefectReport_OfficeData', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_DefectReport_OfficeData'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'VW_DefectReport_OfficeData', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_DefectReport_OfficeData'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'Vw_ComponentJobs', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Vw_ComponentJobs'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane2' , N'SCHEMA',N'dbo', N'VIEW',N'Vw_ComponentJobs', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane2' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Vw_ComponentJobs'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'Vw_ComponentJobs', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Vw_ComponentJobs'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ComponentDetailsListReport', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ComponentDetailsListReport'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ComponentDetailsListReport', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ComponentDetailsListReport'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ClassComponentJobStatus', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPaneCount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ClassComponentJobStatus'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane2' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ClassComponentJobStatus', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane2' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ClassComponentJobStatus'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ClassComponentJobStatus', NULL,NULL))
EXEC sys.sp_dropextendedproperty @name=N'MS_DiagramPane1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ClassComponentJobStatus'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'SMS_ShipComments', N'COLUMN',N'Stage'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'SMS_ShipComments', @level2type=N'COLUMN',@level2name=N'Stage'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'SMS_ShipComments', N'COLUMN',N'Status'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'SMS_ShipComments', @level2type=N'COLUMN',@level2name=N'Status'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'SMS_OfficeComments', N'COLUMN',N'Stage'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'SMS_OfficeComments', @level2type=N'COLUMN',@level2name=N'Stage'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'SMS_OfficeComments', N'COLUMN',N'Status'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'SMS_OfficeComments', @level2type=N'COLUMN',@level2name=N'Status'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'MailSettings', N'COLUMN',N'PacketMode'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'MailSettings', @level2type=N'COLUMN',@level2name=N'PacketMode'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_VSL_DrillTrainingsHistory', N'COLUMN',N'RecordType'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_VSL_DrillTrainingsHistory', @level2type=N'COLUMN',@level2name=N'RecordType'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_VSL_DrillTrainings', N'COLUMN',N'NextDueDate'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_VSL_DrillTrainings', @level2type=N'COLUMN',@level2name=N'NextDueDate'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_TrainingMaster', N'COLUMN',N'RecordType'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_TrainingMaster', @level2type=N'COLUMN',@level2name=N'RecordType'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_MatrixDetails', N'COLUMN',N'ValidityType'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_MatrixDetails', @level2type=N'COLUMN',@level2name=N'ValidityType'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_MatrixDetails', N'COLUMN',N'RecordType'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_MatrixDetails', @level2type=N'COLUMN',@level2name=N'RecordType'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_MatrixDetails', N'COLUMN',N'DTId'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_MatrixDetails', @level2type=N'COLUMN',@level2name=N'DTId'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_MatrixDetails', N'COLUMN',N'MatrixId'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_MatrixDetails', @level2type=N'COLUMN',@level2name=N'MatrixId'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DD_DocketMaster', N'COLUMN',N'Status'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DD_DocketMaster', @level2type=N'COLUMN',@level2name=N'Status'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DD_Docket_RFQ_Master', N'COLUMN',N'ActiveInactive'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DD_Docket_RFQ_Master', @level2type=N'COLUMN',@level2name=N'ActiveInactive'

GO
IF  EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DD_Docket_RFQ_Master', N'COLUMN',N'Status'))
EXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DD_Docket_RFQ_Master', @level2type=N'COLUMN',@level2name=N'Status'

GO
/****** Object:  Index [IX_StartTime]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[DefaultTrace_History]') AND name = N'IX_StartTime')
DROP INDEX [IX_StartTime] ON [dbo].[DefaultTrace_History] WITH ( ONLINE = OFF )
GO
/****** Object:  View [dbo].[VW_VSL_VPR_ALLREPORTS]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_VSL_VPR_ALLREPORTS]'))
DROP VIEW [dbo].[VW_VSL_VPR_ALLREPORTS]
GO
/****** Object:  View [dbo].[vw_VIQQuestionRanks]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_VIQQuestionRanks]'))
DROP VIEW [dbo].[vw_VIQQuestionRanks]
GO
/****** Object:  View [dbo].[vw_SMS_GetSendManuals]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_SMS_GetSendManuals]'))
DROP VIEW [dbo].[vw_SMS_GetSendManuals]
GO
/****** Object:  View [dbo].[vw_SMS_GetComments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_SMS_GetComments]'))
DROP VIEW [dbo].[vw_SMS_GetComments]
GO
/****** Object:  View [dbo].[vw_SCM_RankDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_SCM_RankDetails]'))
DROP VIEW [dbo].[vw_SCM_RankDetails]
GO
/****** Object:  View [dbo].[vw_PrintRunningHourHistory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_PrintRunningHourHistory]'))
DROP VIEW [dbo].[vw_PrintRunningHourHistory]
GO
/****** Object:  View [dbo].[VW_PRINT_RFQ_SUP]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_PRINT_RFQ_SUP]'))
DROP VIEW [dbo].[VW_PRINT_RFQ_SUP]
GO
/****** Object:  View [dbo].[VW_PRINT_RFQ]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_PRINT_RFQ]'))
DROP VIEW [dbo].[VW_PRINT_RFQ]
GO
/****** Object:  View [dbo].[VW_MP_VSL_ProvisionOtherItems]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_MP_VSL_ProvisionOtherItems]'))
DROP VIEW [dbo].[VW_MP_VSL_ProvisionOtherItems]
GO
/****** Object:  View [dbo].[VW_MP_VSL_ProvisionNationalityWise]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_MP_VSL_ProvisionNationalityWise]'))
DROP VIEW [dbo].[VW_MP_VSL_ProvisionNationalityWise]
GO
/****** Object:  View [dbo].[VW_MP_VSL_ProvisionMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_MP_VSL_ProvisionMaster]'))
DROP VIEW [dbo].[VW_MP_VSL_ProvisionMaster]
GO
/****** Object:  View [dbo].[VW_MP_VSL_ProvisionDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_MP_VSL_ProvisionDetails]'))
DROP VIEW [dbo].[VW_MP_VSL_ProvisionDetails]
GO
/****** Object:  View [dbo].[vw_HullMonitoring]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_HullMonitoring]'))
DROP VIEW [dbo].[vw_HullMonitoring]
GO
/****** Object:  View [dbo].[vw_GetSpareDataRPT]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetSpareDataRPT]'))
DROP VIEW [dbo].[vw_GetSpareDataRPT]
GO
/****** Object:  View [dbo].[vw_GetSJobDescOfficeRPT]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetSJobDescOfficeRPT]'))
DROP VIEW [dbo].[vw_GetSJobDescOfficeRPT]
GO
/****** Object:  View [dbo].[vw_GetShipMasterJobsRPT]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetShipMasterJobsRPT]'))
DROP VIEW [dbo].[vw_GetShipMasterJobsRPT]
GO
/****** Object:  View [dbo].[vw_GetSCM_Master]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetSCM_Master]'))
DROP VIEW [dbo].[vw_GetSCM_Master]
GO
/****** Object:  View [dbo].[vw_GetRFQEditReportData]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetRFQEditReportData]'))
DROP VIEW [dbo].[vw_GetRFQEditReportData]
GO
/****** Object:  View [dbo].[vw_GetRanningHourRPT]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetRanningHourRPT]'))
DROP VIEW [dbo].[vw_GetRanningHourRPT]
GO
/****** Object:  View [dbo].[vw_GetJobUpdateDataByPeriod]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetJobUpdateDataByPeriod]'))
DROP VIEW [dbo].[vw_GetJobUpdateDataByPeriod]
GO
/****** Object:  View [dbo].[vw_GetJobPlanningHomerpt]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetJobPlanningHomerpt]'))
DROP VIEW [dbo].[vw_GetJobPlanningHomerpt]
GO
/****** Object:  View [dbo].[vw_GetJobPlanningForRPT]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetJobPlanningForRPT]'))
DROP VIEW [dbo].[vw_GetJobPlanningForRPT]
GO
/****** Object:  View [dbo].[vw_GetJobComplitationReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetJobComplitationReport]'))
DROP VIEW [dbo].[vw_GetJobComplitationReport]
GO
/****** Object:  View [dbo].[vw_GetCostCategoryReportData]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetCostCategoryReportData]'))
DROP VIEW [dbo].[vw_GetCostCategoryReportData]
GO
/****** Object:  View [dbo].[vw_ER_S133_PrintReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_ER_S133_PrintReport]'))
DROP VIEW [dbo].[vw_ER_S133_PrintReport]
GO
/****** Object:  View [dbo].[vw_ER_S115_PrintReport_InjuryToPerson]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_ER_S115_PrintReport_InjuryToPerson]'))
DROP VIEW [dbo].[vw_ER_S115_PrintReport_InjuryToPerson]
GO
/****** Object:  View [dbo].[vw_ER_S115_PrintReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_ER_S115_PrintReport]'))
DROP VIEW [dbo].[vw_ER_S115_PrintReport]
GO
/****** Object:  View [dbo].[vw_Accident_PrintReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_Accident_PrintReport]'))
DROP VIEW [dbo].[vw_Accident_PrintReport]
GO
/****** Object:  View [dbo].[vw_DrillTrainings]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_DrillTrainings]'))
DROP VIEW [dbo].[vw_DrillTrainings]
GO
/****** Object:  View [dbo].[VW_DefectReport_ShipData]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_DefectReport_ShipData]'))
DROP VIEW [dbo].[VW_DefectReport_ShipData]
GO
/****** Object:  View [dbo].[VW_DefectReport_OfficeData]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_DefectReport_OfficeData]'))
DROP VIEW [dbo].[VW_DefectReport_OfficeData]
GO
/****** Object:  View [dbo].[Vw_DefectReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[Vw_DefectReport]'))
DROP VIEW [dbo].[Vw_DefectReport]
GO
/****** Object:  View [dbo].[vw_DefectJobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_DefectJobs]'))
DROP VIEW [dbo].[vw_DefectJobs]
GO
/****** Object:  View [dbo].[VW_DD_RFQ_SUP_PRINT]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_DD_RFQ_SUP_PRINT]'))
DROP VIEW [dbo].[VW_DD_RFQ_SUP_PRINT]
GO
/****** Object:  View [dbo].[VW_DD_RFQ_PRINT]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_DD_RFQ_PRINT]'))
DROP VIEW [dbo].[VW_DD_RFQ_PRINT]
GO
/****** Object:  View [dbo].[VW_DD_DOCKET_PRINT]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_DD_DOCKET_PRINT]'))
DROP VIEW [dbo].[VW_DD_DOCKET_PRINT]
GO
/****** Object:  View [dbo].[vw_CriticalShutdownRequestData]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_CriticalShutdownRequestData]'))
DROP VIEW [dbo].[vw_CriticalShutdownRequestData]
GO
/****** Object:  View [dbo].[vw_CriticalShutdownExtensionDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_CriticalShutdownExtensionDetails]'))
DROP VIEW [dbo].[vw_CriticalShutdownExtensionDetails]
GO
/****** Object:  View [dbo].[Vw_ComponentJobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[Vw_ComponentJobs]'))
DROP VIEW [dbo].[Vw_ComponentJobs]
GO
/****** Object:  View [dbo].[vw_ComponentDetailsListReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_ComponentDetailsListReport]'))
DROP VIEW [dbo].[vw_ComponentDetailsListReport]
GO
/****** Object:  View [dbo].[vw_Communication_Export]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_Communication_Export]'))
DROP VIEW [dbo].[vw_Communication_Export]
GO
/****** Object:  View [dbo].[vw_ClassComponentJobStatus]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_ClassComponentJobStatus]'))
DROP VIEW [dbo].[vw_ClassComponentJobStatus]
GO
/****** Object:  Table [dbo].[VSL_VPRPortDriftReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPRPortDriftReport]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VPRPortDriftReport]
GO
/****** Object:  Table [dbo].[VSL_VPRPortBerthingReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPRPortBerthingReport]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VPRPortBerthingReport]
GO
/****** Object:  Table [dbo].[VSL_VPRPortAnchorageReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPRPortAnchorageReport]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VPRPortAnchorageReport]
GO
/****** Object:  Table [dbo].[VSL_VPRNoonReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPRNoonReport]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VPRNoonReport]
GO
/****** Object:  Table [dbo].[VSL_VPRDepartureReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPRDepartureReport]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VPRDepartureReport]
GO
/****** Object:  Table [dbo].[VSL_VPRArrivalReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPRArrivalReport]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VPRArrivalReport]
GO
/****** Object:  Table [dbo].[VSL_VesselSpareMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselSpareMaster]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VesselSpareMaster]
GO
/****** Object:  Table [dbo].[VSL_VesselRunningHourMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselRunningHourMaster]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VesselRunningHourMaster]
GO
/****** Object:  Table [dbo].[VSL_VesselJobUpdateHistorySpareDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselJobUpdateHistorySpareDetails]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VesselJobUpdateHistorySpareDetails]
GO
/****** Object:  Table [dbo].[VSL_VesselJobUpdateHistoryAttachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselJobUpdateHistoryAttachments]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VesselJobUpdateHistoryAttachments]
GO
/****** Object:  Table [dbo].[VSL_VesselJobUpdateHistory_OfficeComments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselJobUpdateHistory_OfficeComments]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VesselJobUpdateHistory_OfficeComments]
GO
/****** Object:  Table [dbo].[VSL_VesselJobUpdateHistory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselJobUpdateHistory]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VesselJobUpdateHistory]
GO
/****** Object:  Table [dbo].[VSL_VesselComponentJobMaster_Updates]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselComponentJobMaster_Updates]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VesselComponentJobMaster_Updates]
GO
/****** Object:  Table [dbo].[VSL_VesselComponentJobMaster_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselComponentJobMaster_Attachments]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VesselComponentJobMaster_Attachments]
GO
/****** Object:  Table [dbo].[VSL_VesselComponentJobMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselComponentJobMaster]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_VesselComponentJobMaster]
GO
/****** Object:  Table [dbo].[VSL_UnPlannedJobs_SpareDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_UnPlannedJobs_SpareDetails]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_UnPlannedJobs_SpareDetails]
GO
/****** Object:  Table [dbo].[VSL_UnPlannedJobs_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_UnPlannedJobs_Attachments]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_UnPlannedJobs_Attachments]
GO
/****** Object:  Table [dbo].[VSL_UnPlannedJobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_UnPlannedJobs]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_UnPlannedJobs]
GO
/****** Object:  Table [dbo].[VSL_StockInventory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_StockInventory]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_StockInventory]
GO
/****** Object:  Table [dbo].[VSL_SMS_PacketSent]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_SMS_PacketSent]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_SMS_PacketSent]
GO
/****** Object:  Table [dbo].[VSL_SMS_PacketRecd]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_SMS_PacketRecd]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_SMS_PacketRecd]
GO
/****** Object:  Table [dbo].[VSL_ShipSettings]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_ShipSettings]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_ShipSettings]
GO
/****** Object:  Table [dbo].[VSL_Settings]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_Settings]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_Settings]
GO
/****** Object:  Table [dbo].[VSL_PlanMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_PlanMaster]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_PlanMaster]
GO
/****** Object:  Table [dbo].[VSL_MP_Products]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_MP_Products]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_MP_Products]
GO
/****** Object:  Table [dbo].[VSL_MP_MealConsumptionMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_MP_MealConsumptionMaster]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_MP_MealConsumptionMaster]
GO
/****** Object:  Table [dbo].[VSL_MNP_PacketSent]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_MNP_PacketSent]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_MNP_PacketSent]
GO
/****** Object:  Table [dbo].[VSL_MNP_PacketRecd]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_MNP_PacketRecd]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_MNP_PacketRecd]
GO
/****** Object:  Table [dbo].[VSL_MaintenanceKPI]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_MaintenanceKPI]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_MaintenanceKPI]
GO
/****** Object:  Table [dbo].[VSL_DefectSpareDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_DefectSpareDetails]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_DefectSpareDetails]
GO
/****** Object:  Table [dbo].[VSL_Defects_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_Defects_Attachments]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_Defects_Attachments]
GO
/****** Object:  Table [dbo].[VSL_DefectRemarks]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_DefectRemarks]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_DefectRemarks]
GO
/****** Object:  Table [dbo].[VSL_DefectDetailsMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_DefectDetailsMaster]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_DefectDetailsMaster]
GO
/****** Object:  Table [dbo].[VSL_CriticalShutdownExtensions]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_CriticalShutdownExtensions]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_CriticalShutdownExtensions]
GO
/****** Object:  Table [dbo].[VSL_CriticalShutdownExtensionApproval]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_CriticalShutdownExtensionApproval]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_CriticalShutdownExtensionApproval]
GO
/****** Object:  Table [dbo].[VSL_CriticalShutdownApproval]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_CriticalShutdownApproval]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_CriticalShutdownApproval]
GO
/****** Object:  Table [dbo].[VSL_CriticalEquipShutdownRequest]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_CriticalEquipShutdownRequest]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_CriticalEquipShutdownRequest]
GO
/****** Object:  Table [dbo].[VSL_ComponentMasterForVessel]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_ComponentMasterForVessel]') AND type in (N'U'))
DROP TABLE [dbo].[VSL_ComponentMasterForVessel]
GO
/****** Object:  Table [dbo].[VNA_Master]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VNA_Master]') AND type in (N'U'))
DROP TABLE [dbo].[VNA_Master]
GO
/****** Object:  Table [dbo].[VNA_Details]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VNA_Details]') AND type in (N'U'))
DROP TABLE [dbo].[VNA_Details]
GO
/****** Object:  Table [dbo].[VLI_LFI_FC]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VLI_LFI_FC]') AND type in (N'U'))
DROP TABLE [dbo].[VLI_LFI_FC]
GO
/****** Object:  Table [dbo].[VLI]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VLI]') AND type in (N'U'))
DROP TABLE [dbo].[VLI]
GO
/****** Object:  Table [dbo].[VIQ_VIQMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VIQMaster]') AND type in (N'U'))
DROP TABLE [dbo].[VIQ_VIQMaster]
GO
/****** Object:  Table [dbo].[VIQ_VIQDetailsRanksAttachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VIQDetailsRanksAttachments]') AND type in (N'U'))
DROP TABLE [dbo].[VIQ_VIQDetailsRanksAttachments]
GO
/****** Object:  Table [dbo].[VIQ_VIQDetailsRanks_Inv]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VIQDetailsRanks_Inv]') AND type in (N'U'))
DROP TABLE [dbo].[VIQ_VIQDetailsRanks_Inv]
GO
/****** Object:  Table [dbo].[VIQ_VIQDetailsRanks]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VIQDetailsRanks]') AND type in (N'U'))
DROP TABLE [dbo].[VIQ_VIQDetailsRanks]
GO
/****** Object:  Table [dbo].[VIQ_VIQDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VIQDetails]') AND type in (N'U'))
DROP TABLE [dbo].[VIQ_VIQDetails]
GO
/****** Object:  Table [dbo].[VIMS_Inspections]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIMS_Inspections]') AND type in (N'U'))
DROP TABLE [dbo].[VIMS_Inspections]
GO
/****** Object:  Table [dbo].[VIMS_Ins_Observations]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIMS_Ins_Observations]') AND type in (N'U'))
DROP TABLE [dbo].[VIMS_Ins_Observations]
GO
/****** Object:  Table [dbo].[VesselSpareMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VesselSpareMaster]') AND type in (N'U'))
DROP TABLE [dbo].[VesselSpareMaster]
GO
/****** Object:  Table [dbo].[VesselRunningHourMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VesselRunningHourMaster]') AND type in (N'U'))
DROP TABLE [dbo].[VesselRunningHourMaster]
GO
/****** Object:  Table [dbo].[VesselMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Vessel]') AND type in (N'U'))
DROP TABLE [dbo].[Vessel]
GO
/****** Object:  Table [dbo].[VesselComponentJobMaster_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VesselComponentJobMaster_Attachments]') AND type in (N'U'))
DROP TABLE [dbo].[VesselComponentJobMaster_Attachments]
GO
/****** Object:  Table [dbo].[VesselComponentJobMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VesselComponentJobMaster]') AND type in (N'U'))
DROP TABLE [dbo].[VesselComponentJobMaster]
GO
/****** Object:  Table [dbo].[tbl_Vessel_Communication]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[tbl_Vessel_Communication]') AND type in (N'U'))
DROP TABLE [dbo].[tbl_Vessel_Communication]
GO
/****** Object:  Table [dbo].[SMS_ShipComments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ShipComments]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_ShipComments]
GO
/****** Object:  Table [dbo].[SMS_PacketSent]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_PacketSent]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_PacketSent]
GO
/****** Object:  Table [dbo].[SMS_PacketRecd]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_PacketRecd]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_PacketRecd]
GO
/****** Object:  Table [dbo].[SMS_OfficeComments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_OfficeComments]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_OfficeComments]
GO
/****** Object:  Table [dbo].[SMS_ManualVesselType]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualVesselType]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_ManualVesselType]
GO
/****** Object:  Table [dbo].[SMS_ManualMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualMaster]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_ManualMaster]
GO
/****** Object:  Table [dbo].[SMS_ManualDetailsForms_History]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualDetailsForms_History]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_ManualDetailsForms_History]
GO
/****** Object:  Table [dbo].[SMS_ManualDetailsForms]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualDetailsForms]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_ManualDetailsForms]
GO
/****** Object:  Table [dbo].[SMS_ManualDetails_Images]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualDetails_Images]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_ManualDetails_Images]
GO
/****** Object:  Table [dbo].[SMS_ManualDetails_History]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualDetails_History]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_ManualDetails_History]
GO
/****** Object:  Table [dbo].[SMS_ManualDetails_Comments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualDetails_Comments]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_ManualDetails_Comments]
GO
/****** Object:  Table [dbo].[SMS_ManualDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualDetails]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_ManualDetails]
GO
/****** Object:  Table [dbo].[SMS_ManualCatMappings]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualCatMappings]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_ManualCatMappings]
GO
/****** Object:  Table [dbo].[SMS_ManualCategory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualCategory]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_ManualCategory]
GO
/****** Object:  Table [dbo].[SMS_FORMS_BKP_28_APR]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_FORMS_BKP_28_APR]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_FORMS_BKP_28_APR]
GO
/****** Object:  Table [dbo].[SMS_Forms]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Forms]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_Forms]
GO
/****** Object:  Table [dbo].[SMS_APP_ManualMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_APP_ManualMaster]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_APP_ManualMaster]
GO
/****** Object:  Table [dbo].[SMS_APP_ManualDetailsForms]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_APP_ManualDetailsForms]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_APP_ManualDetailsForms]
GO
/****** Object:  Table [dbo].[SMS_APP_ManualDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_APP_ManualDetails]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_APP_ManualDetails]
GO
/****** Object:  Table [dbo].[SMS_APP_COM_ManualDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_APP_COM_ManualDetails]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_APP_COM_ManualDetails]
GO
/****** Object:  Table [dbo].[SMS_APP_COM_Forms]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_APP_COM_Forms]') AND type in (N'U'))
DROP TABLE [dbo].[SMS_APP_COM_Forms]
GO
/****** Object:  Table [dbo].[ShipUserMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ShipUserMaster]') AND type in (N'U'))
DROP TABLE [dbo].[ShipUserMaster]
GO
/****** Object:  Table [dbo].[Ship_MaintenanceKPI]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ship_MaintenanceKPI]') AND type in (N'U'))
DROP TABLE [dbo].[Ship_MaintenanceKPI]
GO
/****** Object:  Table [dbo].[Settings]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Settings]') AND type in (N'U'))
DROP TABLE [dbo].[Settings]
GO
/****** Object:  Table [dbo].[SCM_RANKDETAILS]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_RANKDETAILS]') AND type in (N'U'))
DROP TABLE [dbo].[SCM_RANKDETAILS]
GO
/****** Object:  Table [dbo].[SCM_NCRDETAILS]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_NCRDETAILS]') AND type in (N'U'))
DROP TABLE [dbo].[SCM_NCRDETAILS]
GO
/****** Object:  Table [dbo].[SCM_MASTER]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_MASTER]') AND type in (N'U'))
DROP TABLE [dbo].[SCM_MASTER]
GO
/****** Object:  Table [dbo].[Reg_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Reg_Vessel_Notifications]') AND type in (N'U'))
DROP TABLE [dbo].[Reg_Vessel_Notifications]
GO
/****** Object:  Table [dbo].[Reg_SubSource]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Reg_SubSource]') AND type in (N'U'))
DROP TABLE [dbo].[Reg_SubSource]
GO
/****** Object:  Table [dbo].[Reg_Regulation]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Reg_Regulation]') AND type in (N'U'))
DROP TABLE [dbo].[Reg_Regulation]
GO
/****** Object:  Table [dbo].[Reg_MainSource]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Reg_MainSource]') AND type in (N'U'))
DROP TABLE [dbo].[Reg_MainSource]
GO
/****** Object:  Table [dbo].[Reg_Category]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Reg_Category]') AND type in (N'U'))
DROP TABLE [dbo].[Reg_Category]
GO
/****** Object:  Table [dbo].[Reg_Categories]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Reg_Categories]') AND type in (N'U'))
DROP TABLE [dbo].[Reg_Categories]
GO
/****** Object:  Table [dbo].[Rank]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Rank]') AND type in (N'U'))
DROP TABLE [dbo].[Rank]
GO
/****** Object:  Table [dbo].[Port]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Port]') AND type in (N'U'))
DROP TABLE [dbo].[Port]
GO
/****** Object:  Table [dbo].[PB_VSL_Publication]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_VSL_Publication]') AND type in (N'U'))
DROP TABLE [dbo].[PB_VSL_Publication]
GO
/****** Object:  Table [dbo].[PB_RequiredBy]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_RequiredBy]') AND type in (N'U'))
DROP TABLE [dbo].[PB_RequiredBy]
GO
/****** Object:  Table [dbo].[PB_Publisher]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publisher]') AND type in (N'U'))
DROP TABLE [dbo].[PB_Publisher]
GO
/****** Object:  Table [dbo].[PB_Publications_RequiredBy]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publications_RequiredBy]') AND type in (N'U'))
DROP TABLE [dbo].[PB_Publications_RequiredBy]
GO
/****** Object:  Table [dbo].[PB_Publications]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publications]') AND type in (N'U'))
DROP TABLE [dbo].[PB_Publications]
GO
/****** Object:  Table [dbo].[PB_PublicationEditions]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_PublicationEditions]') AND type in (N'U'))
DROP TABLE [dbo].[PB_PublicationEditions]
GO
/****** Object:  Table [dbo].[PB_Publication_Type_Vessels]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publication_Type_Vessels]') AND type in (N'U'))
DROP TABLE [dbo].[PB_Publication_Type_Vessels]
GO
/****** Object:  Table [dbo].[PB_Publication_Type]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publication_Type]') AND type in (N'U'))
DROP TABLE [dbo].[PB_Publication_Type]
GO
/****** Object:  Table [dbo].[PB_Publication_Mode]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publication_Mode]') AND type in (N'U'))
DROP TABLE [dbo].[PB_Publication_Mode]
GO
/****** Object:  Table [dbo].[PB_Publication_Location]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publication_Location]') AND type in (N'U'))
DROP TABLE [dbo].[PB_Publication_Location]
GO
/****** Object:  Table [dbo].[PB_Publication_Category]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publication_Category]') AND type in (N'U'))
DROP TABLE [dbo].[PB_Publication_Category]
GO
/****** Object:  Table [dbo].[MWUC_MASTER]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_MASTER]') AND type in (N'U'))
DROP TABLE [dbo].[MWUC_MASTER]
GO
/****** Object:  Table [dbo].[MWUC_DETAILS]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_DETAILS]') AND type in (N'U'))
DROP TABLE [dbo].[MWUC_DETAILS]
GO
/****** Object:  Table [dbo].[MWUC_CATMASTER]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_CATMASTER]') AND type in (N'U'))
DROP TABLE [dbo].[MWUC_CATMASTER]
GO
/****** Object:  Table [dbo].[MP_VSL_TMP_Stores]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_TMP_Stores]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_TMP_Stores]
GO
/****** Object:  Table [dbo].[MP_VSL_TMP_Spares]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_TMP_Spares]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_TMP_Spares]
GO
/****** Object:  Table [dbo].[MP_VSL_TMP_Provision_OtherItems]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_TMP_Provision_OtherItems]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_TMP_Provision_OtherItems]
GO
/****** Object:  Table [dbo].[MP_VSL_TMP_Provision]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_TMP_Provision]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_TMP_Provision]
GO
/****** Object:  Table [dbo].[MP_VSL_SupplyMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_SupplyMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_SupplyMaster]
GO
/****** Object:  Table [dbo].[MP_VSL_SupplyDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_SupplyDetails]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_SupplyDetails]
GO
/****** Object:  Table [dbo].[MP_VSL_StoreReqMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_StoreReqMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_StoreReqMaster]
GO
/****** Object:  Table [dbo].[MP_VSL_StoreReqDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_StoreReqDetails]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_StoreReqDetails]
GO
/****** Object:  Table [dbo].[MP_VSL_StoreItemMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_StoreItemMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_StoreItemMaster]
GO
/****** Object:  Table [dbo].[MP_VSL_SparesReqMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_SparesReqMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_SparesReqMaster]
GO
/****** Object:  Table [dbo].[MP_VSL_SparesReqDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_SparesReqDetails]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_SparesReqDetails]
GO
/****** Object:  Table [dbo].[MP_VSL_ShipStaffMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_ShipStaffMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_ShipStaffMaster]
GO
/****** Object:  Table [dbo].[MP_VSL_ShipStaffDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_ShipStaffDetails]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_ShipStaffDetails]
GO
/****** Object:  Table [dbo].[MP_VSL_ProvisionOtherItems]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_ProvisionOtherItems]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_ProvisionOtherItems]
GO
/****** Object:  Table [dbo].[MP_VSL_ProvisionNationalityWise]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_ProvisionNationalityWise]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_ProvisionNationalityWise]
GO
/****** Object:  Table [dbo].[MP_VSL_ProvisionMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_ProvisionMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_ProvisionMaster]
GO
/****** Object:  Table [dbo].[MP_VSL_ProvisionDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_ProvisionDetails]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_ProvisionDetails]
GO
/****** Object:  Table [dbo].[MP_VSL_MenuCalculator_SHIP]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_MenuCalculator_SHIP]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_MenuCalculator_SHIP]
GO
/****** Object:  Table [dbo].[MP_VSL_MenuCalculator]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_MenuCalculator]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_MenuCalculator]
GO
/****** Object:  Table [dbo].[MP_VSL_InventoryMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_InventoryMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_InventoryMaster]
GO
/****** Object:  Table [dbo].[MP_VSL_InventoryDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_InventoryDetails]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_InventoryDetails]
GO
/****** Object:  Table [dbo].[MP_VSL_AccountMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_AccountMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_AccountMaster]
GO
/****** Object:  Table [dbo].[MP_VSL_AccountDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_AccountDetails]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VSL_AccountDetails]
GO
/****** Object:  Table [dbo].[MP_VictualingMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VictualingMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_VictualingMaster]
GO
/****** Object:  Table [dbo].[MP_UnitMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_UnitMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_UnitMaster]
GO
/****** Object:  Table [dbo].[MP_Products_Packaging]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_Products_Packaging]') AND type in (N'U'))
DROP TABLE [dbo].[MP_Products_Packaging]
GO
/****** Object:  Table [dbo].[MP_Products]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_Products]') AND type in (N'U'))
DROP TABLE [dbo].[MP_Products]
GO
/****** Object:  Table [dbo].[MP_NationalityMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_NationalityMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_NationalityMaster]
GO
/****** Object:  Table [dbo].[MP_MealsTypeMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_MealsTypeMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_MealsTypeMaster]
GO
/****** Object:  Table [dbo].[MP_MealConsumptionMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_MealConsumptionMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_MealConsumptionMaster]
GO
/****** Object:  Table [dbo].[MP_MealConsumptionDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_MealConsumptionDetails]') AND type in (N'U'))
DROP TABLE [dbo].[MP_MealConsumptionDetails]
GO
/****** Object:  Table [dbo].[MP_MainCategory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_MainCategory]') AND type in (N'U'))
DROP TABLE [dbo].[MP_MainCategory]
GO
/****** Object:  Table [dbo].[MP_CrewComplementMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_CrewComplementMaster]') AND type in (N'U'))
DROP TABLE [dbo].[MP_CrewComplementMaster]
GO
/****** Object:  Table [dbo].[MP_CrewComplementDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_CrewComplementDetails]') AND type in (N'U'))
DROP TABLE [dbo].[MP_CrewComplementDetails]
GO
/****** Object:  Table [dbo].[MP_AllRank]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_AllRank]') AND type in (N'U'))
DROP TABLE [dbo].[MP_AllRank]
GO
/****** Object:  Table [dbo].[MailSettings]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MailSettings]') AND type in (N'U'))
DROP TABLE [dbo].[MailSettings]
GO
/****** Object:  Table [dbo].[LFICategory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LFICategory]') AND type in (N'U'))
DROP TABLE [dbo].[LFICategory]
GO
/****** Object:  Table [dbo].[LFI_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LFI_Vessel_Notifications]') AND type in (N'U'))
DROP TABLE [dbo].[LFI_Vessel_Notifications]
GO
/****** Object:  Table [dbo].[LFI_Categories]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LFI_Categories]') AND type in (N'U'))
DROP TABLE [dbo].[LFI_Categories]
GO
/****** Object:  Table [dbo].[LFI]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LFI]') AND type in (N'U'))
DROP TABLE [dbo].[LFI]
GO
/****** Object:  Table [dbo].[JobMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[JobMaster]') AND type in (N'U'))
DROP TABLE [dbo].[JobMaster]
GO
/****** Object:  Table [dbo].[JobIntervalMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[JobIntervalMaster]') AND type in (N'U'))
DROP TABLE [dbo].[JobIntervalMaster]
GO
/****** Object:  Table [dbo].[IE_PacketReceived_MNP]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[IE_PacketReceived_MNP]') AND type in (N'U'))
DROP TABLE [dbo].[IE_PacketReceived_MNP]
GO
/****** Object:  Table [dbo].[IE_PacketReceived]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[IE_PacketReceived]') AND type in (N'U'))
DROP TABLE [dbo].[IE_PacketReceived]
GO
/****** Object:  Table [dbo].[IE_PacketCreatedDetails_MNP]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[IE_PacketCreatedDetails_MNP]') AND type in (N'U'))
DROP TABLE [dbo].[IE_PacketCreatedDetails_MNP]
GO
/****** Object:  Table [dbo].[IE_PacketCreatedDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[IE_PacketCreatedDetails]') AND type in (N'U'))
DROP TABLE [dbo].[IE_PacketCreatedDetails]
GO
/****** Object:  Table [dbo].[IE_PacketCreated_MNP]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[IE_PacketCreated_MNP]') AND type in (N'U'))
DROP TABLE [dbo].[IE_PacketCreated_MNP]
GO
/****** Object:  Table [dbo].[IE_PacketCreated]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[IE_PacketCreated]') AND type in (N'U'))
DROP TABLE [dbo].[IE_PacketCreated]
GO
/****** Object:  Table [dbo].[FocusCampCategory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[FocusCampCategory]') AND type in (N'U'))
DROP TABLE [dbo].[FocusCampCategory]
GO
/****** Object:  Table [dbo].[FocusCamp_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[FocusCamp_Vessel_Notifications]') AND type in (N'U'))
DROP TABLE [dbo].[FocusCamp_Vessel_Notifications]
GO
/****** Object:  Table [dbo].[FocusCamp_Categories]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[FocusCamp_Categories]') AND type in (N'U'))
DROP TABLE [dbo].[FocusCamp_Categories]
GO
/****** Object:  Table [dbo].[FocusCamp]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[FocusCamp]') AND type in (N'U'))
DROP TABLE [dbo].[FocusCamp]
GO
/****** Object:  Table [dbo].[EV_VSL_RISKMGMT_MASTER]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_VSL_RISKMGMT_MASTER]') AND type in (N'U'))
DROP TABLE [dbo].[EV_VSL_RISKMGMT_MASTER]
GO
/****** Object:  Table [dbo].[EV_VSL_RISKMGMT_DETAILS]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_VSL_RISKMGMT_DETAILS]') AND type in (N'U'))
DROP TABLE [dbo].[EV_VSL_RISKMGMT_DETAILS]
GO
/****** Object:  Table [dbo].[EV_Off_RISKMGMT_MASTER]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_Off_RISKMGMT_MASTER]') AND type in (N'U'))
DROP TABLE [dbo].[EV_Off_RISKMGMT_MASTER]
GO
/****** Object:  Table [dbo].[EV_Off_RISKMGMT_DETAILS]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_Off_RISKMGMT_DETAILS]') AND type in (N'U'))
DROP TABLE [dbo].[EV_Off_RISKMGMT_DETAILS]
GO
/****** Object:  Table [dbo].[EV_HazardMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_HazardMaster]') AND type in (N'U'))
DROP TABLE [dbo].[EV_HazardMaster]
GO
/****** Object:  Table [dbo].[EV_EventMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_EventMaster]') AND type in (N'U'))
DROP TABLE [dbo].[EV_EventMaster]
GO
/****** Object:  Table [dbo].[ER_S133_Report_Office]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S133_Report_Office]') AND type in (N'U'))
DROP TABLE [dbo].[ER_S133_Report_Office]
GO
/****** Object:  Table [dbo].[ER_S133_Report]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S133_Report]') AND type in (N'U'))
DROP TABLE [dbo].[ER_S133_Report]
GO
/****** Object:  Table [dbo].[ER_S115_Report_Office]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_Report_Office]') AND type in (N'U'))
DROP TABLE [dbo].[ER_S115_Report_Office]
GO
/****** Object:  Table [dbo].[ER_S115_Report_EmailBlast]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_Report_EmailBlast]') AND type in (N'U'))
DROP TABLE [dbo].[ER_S115_Report_EmailBlast]
GO
/****** Object:  Table [dbo].[ER_S115_Report]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_Report]') AND type in (N'U'))
DROP TABLE [dbo].[ER_S115_Report]
GO
/****** Object:  Table [dbo].[ER_S115_InjuryToPerson]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_InjuryToPerson]') AND type in (N'U'))
DROP TABLE [dbo].[ER_S115_InjuryToPerson]
GO
/****** Object:  Table [dbo].[ER_ReportGroupMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_ReportGroupMaster]') AND type in (N'U'))
DROP TABLE [dbo].[ER_ReportGroupMaster]
GO
/****** Object:  Table [dbo].[ER_Report_UpdationDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_Report_UpdationDetails]') AND type in (N'U'))
DROP TABLE [dbo].[ER_Report_UpdationDetails]
GO
/****** Object:  Table [dbo].[ER_Report_Documents_Ship]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_Report_Documents_Ship]') AND type in (N'U'))
DROP TABLE [dbo].[ER_Report_Documents_Ship]
GO
/****** Object:  Table [dbo].[ER_Report_Documents_Office]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_Report_Documents_Office]') AND type in (N'U'))
DROP TABLE [dbo].[ER_Report_Documents_Office]
GO
/****** Object:  Table [dbo].[ER_Registers]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_Registers]') AND type in (N'U'))
DROP TABLE [dbo].[ER_Registers]
GO
/****** Object:  Table [dbo].[ER_RegisterOptions]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_RegisterOptions]') AND type in (N'U'))
DROP TABLE [dbo].[ER_RegisterOptions]
GO
/****** Object:  Table [dbo].[ER_Master]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_Master]') AND type in (N'U'))
DROP TABLE [dbo].[ER_Master]
GO
/****** Object:  Table [dbo].[Accident_Report_Office]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Accident_Report_Office]') AND type in (N'U'))
DROP TABLE [dbo].[Accident_Report_Office]
GO
/****** Object:  Table [dbo].[Accident_Report]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Accident_Report]') AND type in (N'U'))
DROP TABLE [dbo].[Accident_Report]
GO
/****** Object:  Table [dbo].[DT_VSL_DrillTrainingsHistory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_VSL_DrillTrainingsHistory]') AND type in (N'U'))
DROP TABLE [dbo].[DT_VSL_DrillTrainingsHistory]
GO
/****** Object:  Table [dbo].[DT_VSL_DrillTrainings]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_VSL_DrillTrainings]') AND type in (N'U'))
DROP TABLE [dbo].[DT_VSL_DrillTrainings]
GO
/****** Object:  Table [dbo].[DT_VSL_DrillTrainingHistoryRanks]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_VSL_DrillTrainingHistoryRanks]') AND type in (N'U'))
DROP TABLE [dbo].[DT_VSL_DrillTrainingHistoryRanks]
GO
/****** Object:  Table [dbo].[DT_VSL_DrillTrainingHistoryDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_VSL_DrillTrainingHistoryDetails]') AND type in (N'U'))
DROP TABLE [dbo].[DT_VSL_DrillTrainingHistoryDetails]
GO
/****** Object:  Table [dbo].[DT_VSL_DrillTrainingHistoryAttachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_VSL_DrillTrainingHistoryAttachments]') AND type in (N'U'))
DROP TABLE [dbo].[DT_VSL_DrillTrainingHistoryAttachments]
GO
/****** Object:  Table [dbo].[DT_TrainingMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_TrainingMaster]') AND type in (N'U'))
DROP TABLE [dbo].[DT_TrainingMaster]
GO
/****** Object:  Table [dbo].[DT_MatrixMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_MatrixMaster]') AND type in (N'U'))
DROP TABLE [dbo].[DT_MatrixMaster]
GO
/****** Object:  Table [dbo].[DT_MatrixDetailsAttachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_MatrixDetailsAttachments]') AND type in (N'U'))
DROP TABLE [dbo].[DT_MatrixDetailsAttachments]
GO
/****** Object:  Table [dbo].[DT_MatrixDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_MatrixDetails]') AND type in (N'U'))
DROP TABLE [dbo].[DT_MatrixDetails]
GO
/****** Object:  Table [dbo].[DT_DrillMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_DrillMaster]') AND type in (N'U'))
DROP TABLE [dbo].[DT_DrillMaster]
GO
/****** Object:  Table [dbo].[DeptMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DeptMaster]') AND type in (N'U'))
DROP TABLE [dbo].[DeptMaster]
GO
/****** Object:  Table [dbo].[DefaultTrace_History]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DefaultTrace_History]') AND type in (N'U'))
DROP TABLE [dbo].[DefaultTrace_History]
GO
/****** Object:  Table [dbo].[DD_YardMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_YardMaster]') AND type in (N'U'))
DROP TABLE [dbo].[DD_YardMaster]
GO
/****** Object:  Table [dbo].[DD_SubJobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_SubJobs]') AND type in (N'U'))
DROP TABLE [dbo].[DD_SubJobs]
GO
/****** Object:  Table [dbo].[DD_PRINT_RFQ_COMPARISON]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_PRINT_RFQ_COMPARISON]') AND type in (N'U'))
DROP TABLE [dbo].[DD_PRINT_RFQ_COMPARISON]
GO
/****** Object:  Table [dbo].[DD_Jobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Jobs]') AND type in (N'U'))
DROP TABLE [dbo].[DD_Jobs]
GO
/****** Object:  Table [dbo].[DD_JobCategory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_JobCategory]') AND type in (N'U'))
DROP TABLE [dbo].[DD_JobCategory]
GO
/****** Object:  Table [dbo].[DD_DocketSubJobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_DocketSubJobs]') AND type in (N'U'))
DROP TABLE [dbo].[DD_DocketSubJobs]
GO
/****** Object:  Table [dbo].[DD_DocketReportImages]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_DocketReportImages]') AND type in (N'U'))
DROP TABLE [dbo].[DD_DocketReportImages]
GO
/****** Object:  Table [dbo].[DD_DocketReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_DocketReport]') AND type in (N'U'))
DROP TABLE [dbo].[DD_DocketReport]
GO
/****** Object:  Table [dbo].[DD_DocketMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_DocketMaster]') AND type in (N'U'))
DROP TABLE [dbo].[DD_DocketMaster]
GO
/****** Object:  Table [dbo].[DD_DocketJobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_DocketJobs]') AND type in (N'U'))
DROP TABLE [dbo].[DD_DocketJobs]
GO
/****** Object:  Table [dbo].[DD_DocketDocuments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_DocketDocuments]') AND type in (N'U'))
DROP TABLE [dbo].[DD_DocketDocuments]
GO
/****** Object:  Table [dbo].[DD_Docket_RFQ_SubJobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Docket_RFQ_SubJobs]') AND type in (N'U'))
DROP TABLE [dbo].[DD_Docket_RFQ_SubJobs]
GO
/****** Object:  Table [dbo].[DD_Docket_RFQ_Master]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Docket_RFQ_Master]') AND type in (N'U'))
DROP TABLE [dbo].[DD_Docket_RFQ_Master]
GO
/****** Object:  Table [dbo].[DD_Docket_RFQ_Jobs_Planning_History]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Docket_RFQ_Jobs_Planning_History]') AND type in (N'U'))
DROP TABLE [dbo].[DD_Docket_RFQ_Jobs_Planning_History]
GO
/****** Object:  Table [dbo].[DD_Docket_RFQ_Jobs_Planning]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Docket_RFQ_Jobs_Planning]') AND type in (N'U'))
DROP TABLE [dbo].[DD_Docket_RFQ_Jobs_Planning]
GO
/****** Object:  Table [dbo].[DD_Docket_RFQ_Jobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Docket_RFQ_Jobs]') AND type in (N'U'))
DROP TABLE [dbo].[DD_Docket_RFQ_Jobs]
GO
/****** Object:  Table [dbo].[DD_Docket_Publish_History]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Docket_Publish_History]') AND type in (N'U'))
DROP TABLE [dbo].[DD_Docket_Publish_History]
GO
/****** Object:  Table [dbo].[ComponentsJobMapping_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ComponentsJobMapping_Attachments]') AND type in (N'U'))
DROP TABLE [dbo].[ComponentsJobMapping_Attachments]
GO
/****** Object:  Table [dbo].[ComponentsJobMapping]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ComponentsJobMapping]') AND type in (N'U'))
DROP TABLE [dbo].[ComponentsJobMapping]
GO
/****** Object:  Table [dbo].[ComponentMasterForVessel]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ComponentMasterForVessel]') AND type in (N'U'))
DROP TABLE [dbo].[ComponentMasterForVessel]
GO
/****** Object:  Table [dbo].[ComponentMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ComponentMaster]') AND type in (N'U'))
DROP TABLE [dbo].[ComponentMaster]
GO
/****** Object:  Table [dbo].[ComponentJobMapping_OtherRanks]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ComponentJobMapping_OtherRanks]') AND type in (N'U'))
DROP TABLE [dbo].[ComponentJobMapping_OtherRanks]
GO
/****** Object:  Table [dbo].[Cir_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Cir_Vessel_Notifications]') AND type in (N'U'))
DROP TABLE [dbo].[Cir_Vessel_Notifications]
GO
/****** Object:  Table [dbo].[Cir_Circular]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Cir_Circular]') AND type in (N'U'))
DROP TABLE [dbo].[Cir_Circular]
GO
/****** Object:  Table [dbo].[Cir_Category]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Cir_Category]') AND type in (N'U'))
DROP TABLE [dbo].[Cir_Category]
GO
/****** Object:  Table [dbo].[Cir_Categories]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Cir_Categories]') AND type in (N'U'))
DROP TABLE [dbo].[Cir_Categories]
GO
/****** Object:  Table [dbo].[atest]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[atest]') AND type in (N'U'))
DROP TABLE [dbo].[atest]
GO
/****** Object:  UserDefinedFunction [dbo].[getRunningHrsOnFixedDate]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRunningHrsOnFixedDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getRunningHrsOnFixedDate]
GO
/****** Object:  UserDefinedFunction [dbo].[getRunningHrsOnDateFromHistoryDate]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRunningHrsOnDateFromHistoryDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getRunningHrsOnDateFromHistoryDate]
GO
/****** Object:  UserDefinedFunction [dbo].[getRunningHrsOnDateFromHistory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRunningHrsOnDateFromHistory]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getRunningHrsOnDateFromHistory]
GO
/****** Object:  UserDefinedFunction [dbo].[getRunningHrsOnDate_SingleCompCode]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRunningHrsOnDate_SingleCompCode]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getRunningHrsOnDate_SingleCompCode]
GO
/****** Object:  UserDefinedFunction [dbo].[getRunningHrsOnDate_ExcludeLast]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRunningHrsOnDate_ExcludeLast]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getRunningHrsOnDate_ExcludeLast]
GO
/****** Object:  UserDefinedFunction [dbo].[getRunningHrsOnDate]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRunningHrsOnDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getRunningHrsOnDate]
GO
/****** Object:  UserDefinedFunction [dbo].[getRootPath]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRootPath]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getRootPath]
GO
/****** Object:  UserDefinedFunction [dbo].[getROB]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getROB]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getROB]
GO
/****** Object:  UserDefinedFunction [dbo].[getRHAsOnDate]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRHAsOnDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getRHAsOnDate]
GO
/****** Object:  UserDefinedFunction [dbo].[getREGCategories]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getREGCategories]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getREGCategories]
GO
/****** Object:  UserDefinedFunction [dbo].[getLFICategories]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getLFICategories]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getLFICategories]
GO
/****** Object:  UserDefinedFunction [dbo].[GetJobAttachmentCount]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetJobAttachmentCount]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[GetJobAttachmentCount]
GO
/****** Object:  UserDefinedFunction [dbo].[getInvolvedRanks]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getInvolvedRanks]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getInvolvedRanks]
GO
/****** Object:  UserDefinedFunction [dbo].[getInterval]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getInterval]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getInterval]
GO
/****** Object:  UserDefinedFunction [dbo].[getFocusCampCategories]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getFocusCampCategories]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getFocusCampCategories]
GO
/****** Object:  UserDefinedFunction [dbo].[getDueJobsForMonth]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getDueJobsForMonth]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getDueJobsForMonth]
GO
/****** Object:  UserDefinedFunction [dbo].[getDatePart]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getDatePart]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getDatePart]
GO
/****** Object:  UserDefinedFunction [dbo].[getCirCategories]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getCirCategories]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[getCirCategories]
GO
/****** Object:  UserDefinedFunction [dbo].[Get_CircularNo]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Get_CircularNo]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[Get_CircularNo]
GO
/****** Object:  UserDefinedFunction [dbo].[fn_getInventoryROB]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[fn_getInventoryROB]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[fn_getInventoryROB]
GO
/****** Object:  UserDefinedFunction [dbo].[ER_S115_getOptionTextCSV]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_getOptionTextCSV]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[ER_S115_getOptionTextCSV]
GO
/****** Object:  UserDefinedFunction [dbo].[CSVtoTableString]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CSVtoTableString]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[CSVtoTableString]
GO
/****** Object:  UserDefinedFunction [dbo].[CSVtoTableDate]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CSVtoTableDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[CSVtoTableDate]
GO
/****** Object:  UserDefinedFunction [dbo].[CSVtoTable2]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CSVtoTable2]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[CSVtoTable2]
GO
/****** Object:  UserDefinedFunction [dbo].[CSVtoTable]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CSVtoTable]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[CSVtoTable]
GO
/****** Object:  StoredProcedure [dbo].[VSL_VPR_GET_FUEL_ROB]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPR_GET_FUEL_ROB]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[VSL_VPR_GET_FUEL_ROB]
GO
/****** Object:  StoredProcedure [dbo].[VIQ_VSL_InsertUpdateShipComments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VSL_InsertUpdateShipComments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[VIQ_VSL_InsertUpdateShipComments]
GO
/****** Object:  StoredProcedure [dbo].[VIQ_VSL_IMPORT_VIQMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VSL_IMPORT_VIQMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[VIQ_VSL_IMPORT_VIQMaster]
GO
/****** Object:  StoredProcedure [dbo].[VIQ_VSL_IMPORT_VIQDetailsRanksAttachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VSL_IMPORT_VIQDetailsRanksAttachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[VIQ_VSL_IMPORT_VIQDetailsRanksAttachments]
GO
/****** Object:  StoredProcedure [dbo].[VIQ_VSL_IMPORT_VIQDetailsRanks_Inv]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VSL_IMPORT_VIQDetailsRanks_Inv]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[VIQ_VSL_IMPORT_VIQDetailsRanks_Inv]
GO
/****** Object:  StoredProcedure [dbo].[VIQ_VSL_IMPORT_VIQDetailsRanks]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VSL_IMPORT_VIQDetailsRanks]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[VIQ_VSL_IMPORT_VIQDetailsRanks]
GO
/****** Object:  StoredProcedure [dbo].[VIQ_VSL_IMPORT_VIQDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VSL_IMPORT_VIQDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[VIQ_VSL_IMPORT_VIQDetails]
GO
/****** Object:  StoredProcedure [dbo].[VIQ_OFFICE_InsertUpdateOffficeComments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_OFFICE_InsertUpdateOffficeComments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[VIQ_OFFICE_InsertUpdateOffficeComments]
GO
/****** Object:  StoredProcedure [dbo].[VIQ_OFFICE_IMPORT_VIQMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_OFFICE_IMPORT_VIQMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[VIQ_OFFICE_IMPORT_VIQMaster]
GO
/****** Object:  StoredProcedure [dbo].[VIQ_OFFICE_IMPORT_VIQDetailsRanksAttachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_OFFICE_IMPORT_VIQDetailsRanksAttachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[VIQ_OFFICE_IMPORT_VIQDetailsRanksAttachments]
GO
/****** Object:  StoredProcedure [dbo].[VIQ_OFFICE_IMPORT_VIQDetailsRanks]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_OFFICE_IMPORT_VIQDetailsRanks]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[VIQ_OFFICE_IMPORT_VIQDetailsRanks]
GO
/****** Object:  StoredProcedure [dbo].[VerifyJobHistory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VerifyJobHistory]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[VerifyJobHistory]
GO
/****** Object:  StoredProcedure [dbo].[UpdateRunningHrs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdateRunningHrs]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[UpdateRunningHrs]
GO
/****** Object:  StoredProcedure [dbo].[UPDATE_NEXTDUE_BYCOMPONENTID]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UPDATE_NEXTDUE_BYCOMPONENTID]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[UPDATE_NEXTDUE_BYCOMPONENTID]
GO
/****** Object:  StoredProcedure [dbo].[TRANSFTER_TO_POS_StoreReq]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TRANSFTER_TO_POS_StoreReq]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[TRANSFTER_TO_POS_StoreReq]
GO
/****** Object:  StoredProcedure [dbo].[TRANSFTER_TO_POS_SpareReq]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TRANSFTER_TO_POS_SpareReq]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[TRANSFTER_TO_POS_SpareReq]
GO
/****** Object:  StoredProcedure [dbo].[TRANSFTER_TO_POS]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TRANSFTER_TO_POS]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[TRANSFTER_TO_POS]
GO
/****** Object:  StoredProcedure [dbo].[sp_VesselDataScript]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_VesselDataScript]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_VesselDataScript]
GO
/****** Object:  StoredProcedure [dbo].[sp_UpdateUnPlannedJob]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_UpdateUnPlannedJob]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_UpdateUnPlannedJob]
GO
/****** Object:  StoredProcedure [dbo].[sp_UpdateServiceReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_UpdateServiceReport]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_UpdateServiceReport]
GO
/****** Object:  StoredProcedure [dbo].[sp_UpdatePlannedJob]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_UpdatePlannedJob]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_UpdatePlannedJob]
GO
/****** Object:  StoredProcedure [dbo].[sp_Update_Vessel_Specifications]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Update_Vessel_Specifications]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Update_Vessel_Specifications]
GO
/****** Object:  StoredProcedure [dbo].[sp_Update_Vessel_ComponentJobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Update_Vessel_ComponentJobs]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Update_Vessel_ComponentJobs]
GO
/****** Object:  StoredProcedure [dbo].[sp_Update_Ship_Specifications]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Update_Ship_Specifications]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Update_Ship_Specifications]
GO
/****** Object:  StoredProcedure [dbo].[sp_Update_Ship_SpareStatus]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Update_Ship_SpareStatus]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Update_Ship_SpareStatus]
GO
/****** Object:  StoredProcedure [dbo].[sp_Update_Ship_ComponentJobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Update_Ship_ComponentJobs]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Update_Ship_ComponentJobs]
GO
/****** Object:  StoredProcedure [dbo].[sp_Update_MaintenanceKPI]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Update_MaintenanceKPI]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Update_MaintenanceKPI]
GO
/****** Object:  StoredProcedure [dbo].[sp_Ship_UpdateRunningHour_History]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Ship_UpdateRunningHour_History]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Ship_UpdateRunningHour_History]
GO
/****** Object:  StoredProcedure [dbo].[sp_Ship_InsertUpdateSpares]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Ship_InsertUpdateSpares]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Ship_InsertUpdateSpares]
GO
/****** Object:  StoredProcedure [dbo].[sp_Ship_InsertRunningHourByGroup]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Ship_InsertRunningHourByGroup]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Ship_InsertRunningHourByGroup]
GO
/****** Object:  StoredProcedure [dbo].[sp_Ship_InsertRunningHour]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Ship_InsertRunningHour]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Ship_InsertRunningHour]
GO
/****** Object:  StoredProcedure [dbo].[sp_PostponePlannedJob]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_PostponePlannedJob]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_PostponePlannedJob]
GO
/****** Object:  StoredProcedure [dbo].[sp_MoveComponent]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_MoveComponent]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_MoveComponent]
GO
/****** Object:  StoredProcedure [dbo].[sp_MOTOR_PUBLISH]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_MOTOR_PUBLISH]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_MOTOR_PUBLISH]
GO
/****** Object:  StoredProcedure [dbo].[sp_MOTOR_AUTOCREATE]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_MOTOR_AUTOCREATE]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_MOTOR_AUTOCREATE]
GO
/****** Object:  StoredProcedure [dbo].[sp_MaintenanceKPI]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_MaintenanceKPI]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_MaintenanceKPI]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertVesselComponentsJobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertVesselComponentsJobs]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertVesselComponentsJobs]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUPPlanJobsSpares]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUPPlanJobsSpares]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUPPlanJobsSpares]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateVSL_VesselComponentJobMaster_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateVSL_VesselComponentJobMaster_Attachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdateVSL_VesselComponentJobMaster_Attachments]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateVesselComponentJobMaster_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateVesselComponentJobMaster_Attachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdateVesselComponentJobMaster_Attachments]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateSpares]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateSpares]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdateSpares]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateRunningHour]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateRunningHour]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdateRunningHour]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateMonthwiseMaintenanceKPI]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateMonthwiseMaintenanceKPI]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdateMonthwiseMaintenanceKPI]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateMaintenanceKPI]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateMaintenanceKPI]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdateMaintenanceKPI]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateMailSettings]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateMailSettings]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdateMailSettings]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateJobTypes]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateJobTypes]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdateJobTypes]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateJobPlanning]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateJobPlanning]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdateJobPlanning]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateCriticalShutdownRequest]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateCriticalShutdownRequest]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdateCriticalShutdownRequest]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateCriticalShutdownExtension]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateCriticalShutdownExtension]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdateCriticalShutdownExtension]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateComponentsJobMapping_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateComponentsJobMapping_Attachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdateComponentsJobMapping_Attachments]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateComponents]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateComponents]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdateComponents]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdate_Ship_MaintenanceKPI]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdate_Ship_MaintenanceKPI]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUpdate_Ship_MaintenanceKPI]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUPAttachment]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUPAttachment]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUPAttachment]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUnPlannedJob]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUnPlannedJob]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertUnPlannedJob]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertSparesInventory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertSparesInventory]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertSparesInventory]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertSpares_Execute]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertSpares_Execute]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertSpares_Execute]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertSpares_BreakDown]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertSpares_BreakDown]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertSpares_BreakDown]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertExecuteAttachment]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertExecuteAttachment]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertExecuteAttachment]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertDeleteComponentJobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertDeleteComponentJobs]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertDeleteComponentJobs]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertDefectsAttachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertDefectsAttachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertDefectsAttachments]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertDefects]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertDefects]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertDefects]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertDefectRemarks]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertDefectRemarks]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertDefectRemarks]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertComponentsForVessel_AutoSpecFromParent]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertComponentsForVessel_AutoSpecFromParent]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertComponentsForVessel_AutoSpecFromParent]
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertComponentsForVessel]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertComponentsForVessel]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_InsertComponentsForVessel]
GO
/****** Object:  StoredProcedure [dbo].[sp_Insert_Ship_Components_AutoSpecFromParent]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Insert_Ship_Components_AutoSpecFromParent]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Insert_Ship_Components_AutoSpecFromParent]
GO
/****** Object:  StoredProcedure [dbo].[sp_Insert_Ship_Components]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Insert_Ship_Components]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Insert_Ship_Components]
GO
/****** Object:  StoredProcedure [dbo].[sp_Insert_Ship_Component_Jobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Insert_Ship_Component_Jobs]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Insert_Ship_Component_Jobs]
GO
/****** Object:  StoredProcedure [dbo].[sp_Insert_Communication_Export]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Insert_Communication_Export]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Insert_Communication_Export]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselSpareMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselSpareMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_VesselSpareMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselRunningHourMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselRunningHourMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_VesselRunningHourMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselJobUpdateHistorySpareDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselJobUpdateHistorySpareDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_VesselJobUpdateHistorySpareDetails]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselJobUpdateHistoryAttachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselJobUpdateHistoryAttachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_VesselJobUpdateHistoryAttachments]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselJobUpdateHistory_OfficeComments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselJobUpdateHistory_OfficeComments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_VesselJobUpdateHistory_OfficeComments]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselJobUpdateHistory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselJobUpdateHistory]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_VesselJobUpdateHistory]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselComponentJobMaster_Updates]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselComponentJobMaster_Updates]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_VesselComponentJobMaster_Updates]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselComponentJobMaster_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselComponentJobMaster_Attachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_VesselComponentJobMaster_Attachments]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselComponentJobMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselComponentJobMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_VesselComponentJobMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_UnPlannedJobs_SpareDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_UnPlannedJobs_SpareDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_UnPlannedJobs_SpareDetails]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_UnPlannedJobs_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_UnPlannedJobs_Attachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_UnPlannedJobs_Attachments]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_UnPlannedJobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_UnPlannedJobs]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_UnPlannedJobs]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_StockInventory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_StockInventory]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_StockInventory]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_PlanMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_PlanMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_PlanMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_DefectSpareDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_DefectSpareDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_DefectSpareDetails]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_Defects_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_Defects_Attachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_Defects_Attachments]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_DefectRemarks]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_DefectRemarks]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_DefectRemarks]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSl_DefectDetailsMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSl_DefectDetailsMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSl_DefectDetailsMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_CriticalShutdownExtensions]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_CriticalShutdownExtensions]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_CriticalShutdownExtensions]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_CriticalShutdownExtensionApproval]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_CriticalShutdownExtensionApproval]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_CriticalShutdownExtensionApproval]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_CriticalShutdownApproval]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_CriticalShutdownApproval]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_CriticalShutdownApproval]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_CriticalEquipShutdownRequest]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_CriticalEquipShutdownRequest]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_CriticalEquipShutdownRequest]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_ComponentMasterForVessel]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_ComponentMasterForVessel]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_ComponentMasterForVessel]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_ComponentJobMapping_OtherRanks]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_ComponentJobMapping_OtherRanks]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_VSL_ComponentJobMapping_OtherRanks]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_SupplyMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_SupplyMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_SupplyMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_SupplyDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_SupplyDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_SupplyDetails]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_StoreReqMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_StoreReqMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_StoreReqMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_StoreReqDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_StoreReqDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_StoreReqDetails]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_StoreItemMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_StoreItemMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_StoreItemMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_SparesReqMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_SparesReqMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_SparesReqMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_SparesReqDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_SparesReqDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_SparesReqDetails]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_ShipStaffMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_ShipStaffMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_ShipStaffMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_ShipStaffDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_ShipStaffDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_ShipStaffDetails]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_ProvisionOtherItems]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_ProvisionOtherItems]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_ProvisionOtherItems]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_ProvisionNationalityWise]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_ProvisionNationalityWise]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_ProvisionNationalityWise]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_ProvisionMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_ProvisionMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_ProvisionMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_ProvisionDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_ProvisionDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_ProvisionDetails]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_InventoryMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_InventoryMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_InventoryMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_InventoryDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_InventoryDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_InventoryDetails]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_AccountMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_AccountMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_AccountMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_AccountDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_AccountDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VSL_AccountDetails]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VictualingMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VictualingMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_VictualingMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_UnitMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_UnitMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_UnitMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_Store_Rec_Ack]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_Store_Rec_Ack]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_Store_Rec_Ack]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_Spare_Rec_Ack]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_Spare_Rec_Ack]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_Spare_Rec_Ack]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_Products_Packaging]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_Products_Packaging]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_Products_Packaging]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_Products]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_Products]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_Products]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_Pro_Rec_Ack]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_Pro_Rec_Ack]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_Pro_Rec_Ack]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_NationalityMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_NationalityMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_NationalityMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_MealsTypeMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_MealsTypeMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_MealsTypeMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_MealConsumptionMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_MealConsumptionMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_MealConsumptionMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_MealConsumptionDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_MealConsumptionDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_MealConsumptionDetails]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_MainCategory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_MainCategory]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_MainCategory]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_getDataForExport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_getDataForExport]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_getDataForExport]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_FlushPacketLog]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_FlushPacketLog]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_FlushPacketLog]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_CrewComplementMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_CrewComplementMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_CrewComplementMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_CrewComplementDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_CrewComplementDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_CrewComplementDetails]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_CreatePacket]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_CreatePacket]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_CreatePacket]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_AllRank]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_AllRank]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_V1_MP_AllRank]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_ReceivePacket]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_ReceivePacket]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_ReceivePacket]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_JobMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_JobMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_JobMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_getDataForExport_2]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_getDataForExport_2]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_getDataForExport_2]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_getDataForExport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_getDataForExport]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_getDataForExport]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_FlushPacketLog_2]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_FlushPacketLog_2]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_FlushPacketLog_2]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_FlushPacketLog]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_FlushPacketLog]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_FlushPacketLog]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_CreatePacket]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_CreatePacket]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_CreatePacket]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_ComponentsJobMapping_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_ComponentsJobMapping_Attachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_ComponentsJobMapping_Attachments]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_ComponentsJobMapping]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_ComponentsJobMapping]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_ComponentsJobMapping]
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_ComponentMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_ComponentMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_IE_ComponentMaster]
GO
/****** Object:  StoredProcedure [dbo].[sp_GetShipMaintenanceKPIData]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_GetShipMaintenanceKPIData]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_GetShipMaintenanceKPIData]
GO
/****** Object:  StoredProcedure [dbo].[sp_GETJOBPLANNING]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_GETJOBPLANNING]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_GETJOBPLANNING]
GO
/****** Object:  StoredProcedure [dbo].[sp_getInventorySummary]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_getInventorySummary]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_getInventorySummary]
GO
/****** Object:  StoredProcedure [dbo].[sp_GetDataForClassComponentJobStatus]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_GetDataForClassComponentJobStatus]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_GetDataForClassComponentJobStatus]
GO
/****** Object:  StoredProcedure [dbo].[sp_ExportVessel]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ExportVessel]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_ExportVessel]
GO
/****** Object:  StoredProcedure [dbo].[sp_DeleteVSL_VesselComponentJobMaster_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_DeleteVSL_VesselComponentJobMaster_Attachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_DeleteVSL_VesselComponentJobMaster_Attachments]
GO
/****** Object:  StoredProcedure [dbo].[sp_DeleteUPPlanJobsSpares]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_DeleteUPPlanJobsSpares]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_DeleteUPPlanJobsSpares]
GO
/****** Object:  StoredProcedure [dbo].[sp_DeleteUPAttachment]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_DeleteUPAttachment]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_DeleteUPAttachment]
GO
/****** Object:  StoredProcedure [dbo].[sp_DeleteExecuteAttachment]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_DeleteExecuteAttachment]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_DeleteExecuteAttachment]
GO
/****** Object:  StoredProcedure [dbo].[sp_DeleteDefectsAttachment]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_DeleteDefectsAttachment]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_DeleteDefectsAttachment]
GO
/****** Object:  StoredProcedure [dbo].[sp_DeleteComponentsJobMapping_Attachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_DeleteComponentsJobMapping_Attachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_DeleteComponentsJobMapping_Attachments]
GO
/****** Object:  StoredProcedure [dbo].[sp_Delete_Vessel_Spares]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Delete_Vessel_Spares]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Delete_Vessel_Spares]
GO
/****** Object:  StoredProcedure [dbo].[sp_Delete_Vessel_Jobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Delete_Vessel_Jobs]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Delete_Vessel_Jobs]
GO
/****** Object:  StoredProcedure [dbo].[sp_Delete_Vessel_Components]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Delete_Vessel_Components]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Delete_Vessel_Components]
GO
/****** Object:  StoredProcedure [dbo].[sp_Delete_Office_Jobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Delete_Office_Jobs]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Delete_Office_Jobs]
GO
/****** Object:  StoredProcedure [dbo].[sp_Delete_Office_Components]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Delete_Office_Components]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_Delete_Office_Components]
GO
/****** Object:  StoredProcedure [dbo].[sp_CriticalShutdownClosure]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CriticalShutdownClosure]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_CriticalShutdownClosure]
GO
/****** Object:  StoredProcedure [dbo].[sp_CopyVessel]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CopyVessel]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_CopyVessel]
GO
/****** Object:  StoredProcedure [dbo].[sp_CopyComponentJob]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CopyComponentJob]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_CopyComponentJob]
GO
/****** Object:  StoredProcedure [dbo].[sp_CopyComponent]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CopyComponent]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_CopyComponent]
GO
/****** Object:  StoredProcedure [dbo].[sp_CheckMaintenanceKPIData_ShipData]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CheckMaintenanceKPIData_ShipData]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_CheckMaintenanceKPIData_ShipData]
GO
/****** Object:  StoredProcedure [dbo].[sp_CheckMaintenanceKPIData]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CheckMaintenanceKPIData]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_CheckMaintenanceKPIData]
GO
/****** Object:  StoredProcedure [dbo].[sp_CancelPlannedJob]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CancelPlannedJob]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_CancelPlannedJob]
GO
/****** Object:  StoredProcedure [dbo].[sp_ApproveCriticalShutdownExtensions]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ApproveCriticalShutdownExtensions]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_ApproveCriticalShutdownExtensions]
GO
/****** Object:  StoredProcedure [dbo].[sp_ApproveCriticalShutdown]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ApproveCriticalShutdown]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_ApproveCriticalShutdown]
GO
/****** Object:  StoredProcedure [dbo].[sp_ActiveInactive_Admin_Ship_Jobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ActiveInactive_Admin_Ship_Jobs]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_ActiveInactive_Admin_Ship_Jobs]
GO
/****** Object:  StoredProcedure [dbo].[sp_ActiveInactive_Admin_Ship_Components]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ActiveInactive_Admin_Ship_Components]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_ActiveInactive_Admin_Ship_Components]
GO
/****** Object:  StoredProcedure [dbo].[sp_ActiveInactive_Admin_Office_Jobs]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ActiveInactive_Admin_Office_Jobs]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_ActiveInactive_Admin_Office_Jobs]
GO
/****** Object:  StoredProcedure [dbo].[sp_ActiveInactive_Admin_Office_Components]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ActiveInactive_Admin_Office_Components]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_ActiveInactive_Admin_Office_Components]
GO
/****** Object:  StoredProcedure [dbo].[SMS_Update_SearchTages]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Update_SearchTages]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_Update_SearchTages]
GO
/****** Object:  StoredProcedure [dbo].[SMS_SCHEDULE_WHOLE_MANUAL]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_SCHEDULE_WHOLE_MANUAL]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_SCHEDULE_WHOLE_MANUAL]
GO
/****** Object:  StoredProcedure [dbo].[SMS_Review_ImportOfficeData]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Review_ImportOfficeData]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_Review_ImportOfficeData]
GO
/****** Object:  StoredProcedure [dbo].[SMS_ReceiveAck_ShipComments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ReceiveAck_ShipComments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_ReceiveAck_ShipComments]
GO
/****** Object:  StoredProcedure [dbo].[SMS_ReceiveAck_Forms]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ReceiveAck_Forms]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_ReceiveAck_Forms]
GO
/****** Object:  StoredProcedure [dbo].[SMS_ReceiveAck]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ReceiveAck]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_ReceiveAck]
GO
/****** Object:  StoredProcedure [dbo].[SMS_INSERT_ShipComments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_INSERT_ShipComments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_INSERT_ShipComments]
GO
/****** Object:  StoredProcedure [dbo].[SMS_INSERT_OfficeComments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_INSERT_OfficeComments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_INSERT_OfficeComments]
GO
/****** Object:  StoredProcedure [dbo].[SMS_INSERT_ManualDetailsForms]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_INSERT_ManualDetailsForms]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_INSERT_ManualDetailsForms]
GO
/****** Object:  StoredProcedure [dbo].[SMS_ImportPublication]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ImportPublication]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_ImportPublication]
GO
/****** Object:  StoredProcedure [dbo].[SMS_Get_CommunicationData_VSL_SECTION]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Get_CommunicationData_VSL_SECTION]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_Get_CommunicationData_VSL_SECTION]
GO
/****** Object:  StoredProcedure [dbo].[SMS_Get_CommunicationData]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Get_CommunicationData]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_Get_CommunicationData]
GO
/****** Object:  StoredProcedure [dbo].[SMS_Cancel_Reject_Approval_Request]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Cancel_Reject_Approval_Request]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_Cancel_Reject_Approval_Request]
GO
/****** Object:  StoredProcedure [dbo].[SMS_Approve_Request_Manual]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Approve_Request_Manual]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_Approve_Request_Manual]
GO
/****** Object:  StoredProcedure [dbo].[SMS_Approve_Request_Headings]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Approve_Request_Headings]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_Approve_Request_Headings]
GO
/****** Object:  StoredProcedure [dbo].[SMS_AddUpdateForm]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_AddUpdateForm]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_AddUpdateForm]
GO
/****** Object:  StoredProcedure [dbo].[SMS_AddSectionComments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_AddSectionComments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_AddSectionComments]
GO
/****** Object:  StoredProcedure [dbo].[SMS_AddEditManualSectionImage]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_AddEditManualSectionImage]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_AddEditManualSectionImage]
GO
/****** Object:  StoredProcedure [dbo].[SMS_AddEditManualSection]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_AddEditManualSection]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SMS_AddEditManualSection]
GO
/****** Object:  StoredProcedure [dbo].[SHIP_VPR_InsertUpdate_VPRPortBerthingReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_VPR_InsertUpdate_VPRPortBerthingReport]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SHIP_VPR_InsertUpdate_VPRPortBerthingReport]
GO
/****** Object:  StoredProcedure [dbo].[SHIP_VPR_InsertUpdate_VPRNoonReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_VPR_InsertUpdate_VPRNoonReport]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SHIP_VPR_InsertUpdate_VPRNoonReport]
GO
/****** Object:  StoredProcedure [dbo].[SHIP_VPR_InsertUpdate_VPRDepartureReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_VPR_InsertUpdate_VPRDepartureReport]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SHIP_VPR_InsertUpdate_VPRDepartureReport]
GO
/****** Object:  StoredProcedure [dbo].[SHIP_VPR_InsertUpdate_VPRArrivalReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_VPR_InsertUpdate_VPRArrivalReport]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SHIP_VPR_InsertUpdate_VPRArrivalReport]
GO
/****** Object:  StoredProcedure [dbo].[SHIP_VPR_InsertUpdate_PortDriftReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_VPR_InsertUpdate_PortDriftReport]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SHIP_VPR_InsertUpdate_PortDriftReport]
GO
/****** Object:  StoredProcedure [dbo].[SHIP_VPR_InsertUpdate_PortAnchorageReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_VPR_InsertUpdate_PortAnchorageReport]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SHIP_VPR_InsertUpdate_PortAnchorageReport]
GO
/****** Object:  StoredProcedure [dbo].[SHIP_UP_SMS_APP_ManualDetailsForms]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_UP_SMS_APP_ManualDetailsForms]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SHIP_UP_SMS_APP_ManualDetailsForms]
GO
/****** Object:  StoredProcedure [dbo].[SHIP_SMS_SENTACKNOWLEDGEMENT]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_SMS_SENTACKNOWLEDGEMENT]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SHIP_SMS_SENTACKNOWLEDGEMENT]
GO
/****** Object:  StoredProcedure [dbo].[Ship_SMS_Get_CommunicationData]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ship_SMS_Get_CommunicationData]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[Ship_SMS_Get_CommunicationData]
GO
/****** Object:  StoredProcedure [dbo].[SHIP_IU_SMS_Forms]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_IU_SMS_Forms]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SHIP_IU_SMS_Forms]
GO
/****** Object:  StoredProcedure [dbo].[Ship_IU_SMS_APP_ManualMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ship_IU_SMS_APP_ManualMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[Ship_IU_SMS_APP_ManualMaster]
GO
/****** Object:  StoredProcedure [dbo].[SHIP_IU_SMS_APP_ManualDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_IU_SMS_APP_ManualDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SHIP_IU_SMS_APP_ManualDetails]
GO
/****** Object:  StoredProcedure [dbo].[Ship_IU_SMS_APP_COM_ManualDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ship_IU_SMS_APP_COM_ManualDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[Ship_IU_SMS_APP_COM_ManualDetails]
GO
/****** Object:  StoredProcedure [dbo].[SCM_INSERTUPDATE_SCM_RANKDETAILS]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_INSERTUPDATE_SCM_RANKDETAILS]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SCM_INSERTUPDATE_SCM_RANKDETAILS]
GO
/****** Object:  StoredProcedure [dbo].[SCM_INSERTUPDATE_SCM_MASTER_SUPTD]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_INSERTUPDATE_SCM_MASTER_SUPTD]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SCM_INSERTUPDATE_SCM_MASTER_SUPTD]
GO
/****** Object:  StoredProcedure [dbo].[SCM_INSERTUPDATE_SCM_MASTER]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_INSERTUPDATE_SCM_MASTER]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SCM_INSERTUPDATE_SCM_MASTER]
GO
/****** Object:  StoredProcedure [dbo].[SCM_INSERT_SCM_NCRDETAILS]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_INSERT_SCM_NCRDETAILS]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SCM_INSERT_SCM_NCRDETAILS]
GO
/****** Object:  StoredProcedure [dbo].[SCM_IMPORT_SCM_RANKDETAILS]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_IMPORT_SCM_RANKDETAILS]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SCM_IMPORT_SCM_RANKDETAILS]
GO
/****** Object:  StoredProcedure [dbo].[SCM_IMPORT_SCM_NCRDETAILS]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_IMPORT_SCM_NCRDETAILS]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SCM_IMPORT_SCM_NCRDETAILS]
GO
/****** Object:  StoredProcedure [dbo].[SCM_IMPORT_SCM_MASTER]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_IMPORT_SCM_MASTER]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SCM_IMPORT_SCM_MASTER]
GO
/****** Object:  StoredProcedure [dbo].[rpt_DRYDOCKJOBLIST]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[rpt_DRYDOCKJOBLIST]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[rpt_DRYDOCKJOBLIST]
GO
/****** Object:  StoredProcedure [dbo].[REG_InsertUpdateRegulation_VSL]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[REG_InsertUpdateRegulation_VSL]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[REG_InsertUpdateRegulation_VSL]
GO
/****** Object:  StoredProcedure [dbo].[REG_InsertUpdateRegulation_Vessel_Notifications_VSL]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[REG_InsertUpdateRegulation_Vessel_Notifications_VSL]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[REG_InsertUpdateRegulation_Vessel_Notifications_VSL]
GO
/****** Object:  StoredProcedure [dbo].[REG_INSERTUPDATERegulation]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[REG_INSERTUPDATERegulation]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[REG_INSERTUPDATERegulation]
GO
/****** Object:  StoredProcedure [dbo].[REG_InsertRegulation_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[REG_InsertRegulation_Vessel_Notifications]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[REG_InsertRegulation_Vessel_Notifications]
GO
/****** Object:  StoredProcedure [dbo].[PMS_Status_Report]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PMS_Status_Report]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[PMS_Status_Report]
GO
/****** Object:  StoredProcedure [dbo].[OfficeVerifyJobHistory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[OfficeVerifyJobHistory]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[OfficeVerifyJobHistory]
GO
/****** Object:  StoredProcedure [dbo].[MWUC_InsertUpdateMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_InsertUpdateMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MWUC_InsertUpdateMaster]
GO
/****** Object:  StoredProcedure [dbo].[MWUC_InsertUpdateDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_InsertUpdateDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MWUC_InsertUpdateDetails]
GO
/****** Object:  StoredProcedure [dbo].[MWUC_InsertUpdateCategory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_InsertUpdateCategory]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MWUC_InsertUpdateCategory]
GO
/****** Object:  StoredProcedure [dbo].[MWUC_ImportMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_ImportMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MWUC_ImportMaster]
GO
/****** Object:  StoredProcedure [dbo].[MWUC_ImportDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_ImportDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MWUC_ImportDetails]
GO
/****** Object:  StoredProcedure [dbo].[MWUC_ImportCATMASTER]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_ImportCATMASTER]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MWUC_ImportCATMASTER]
GO
/****** Object:  StoredProcedure [dbo].[MP_VSL_AddModify_StoreItem]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_AddModify_StoreItem]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_VSL_AddModify_StoreItem]
GO
/****** Object:  StoredProcedure [dbo].[MP_TMP_AppUpdateStores]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_TMP_AppUpdateStores]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_TMP_AppUpdateStores]
GO
/****** Object:  StoredProcedure [dbo].[MP_TMP_AppUpdateSpares]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_TMP_AppUpdateSpares]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_TMP_AppUpdateSpares]
GO
/****** Object:  StoredProcedure [dbo].[MP_TMP_AppUpdateProvisions]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_TMP_AppUpdateProvisions]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_TMP_AppUpdateProvisions]
GO
/****** Object:  StoredProcedure [dbo].[MP_TMP_AppBlankProvision_OtherItem]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_TMP_AppBlankProvision_OtherItem]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_TMP_AppBlankProvision_OtherItem]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertVictuals]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertVictuals]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertVictuals]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateUnits]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateUnits]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertUpdateUnits]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateSupplyUnits]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateSupplyUnits]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertUpdateSupplyUnits]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateProvisionNationalityWise]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateProvisionNationalityWise]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertUpdateProvisionNationalityWise]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateProducts]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateProducts]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertUpdateProducts]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateMealsType]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateMealsType]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertUpdateMealsType]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateConsumptionUnits]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateConsumptionUnits]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertUpdateConsumptionUnits]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateCategory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateCategory]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertUpdateCategory]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdate_StoreReqMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdate_StoreReqMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertUpdate_StoreReqMaster]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdate_SparesReqMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdate_SparesReqMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertUpdate_SparesReqMaster]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdate_ProvisionReqMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdate_ProvisionReqMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertUpdate_ProvisionReqMaster]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertSupplyMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertSupplyMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertSupplyMaster]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertSupplyDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertSupplyDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertSupplyDetails]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertShipStaffMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertShipStaffMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertShipStaffMaster]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertShipStaffDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertShipStaffDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertShipStaffDetails]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertProvisionOtherItems]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertProvisionOtherItems]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertProvisionOtherItems]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertProvisionMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertProvisionMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertProvisionMaster]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertProvisionDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertProvisionDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertProvisionDetails]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertOpeningStockMaster_Removed]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertOpeningStockMaster_Removed]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertOpeningStockMaster_Removed]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertOpeningStockDetails_Removed]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertOpeningStockDetails_Removed]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertOpeningStockDetails_Removed]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertNationality]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertNationality]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertNationality]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertMenuCalculator_SHIP]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertMenuCalculator_SHIP]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertMenuCalculator_SHIP]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertMenuCalculator]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertMenuCalculator]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertMenuCalculator]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertMealConsumptionMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertMealConsumptionMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertMealConsumptionMaster]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertMealConsumptionDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertMealConsumptionDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertMealConsumptionDetails]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertInventoryMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertInventoryMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertInventoryMaster]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertInventoryDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertInventoryDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertInventoryDetails]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertDeleteProducts_Packaging]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertDeleteProducts_Packaging]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertDeleteProducts_Packaging]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertAccountMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertAccountMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertAccountMaster]
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertAccountDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertAccountDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_InsertAccountDetails]
GO
/****** Object:  StoredProcedure [dbo].[MP_ImportCrewComplement]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_ImportCrewComplement]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_ImportCrewComplement]
GO
/****** Object:  StoredProcedure [dbo].[MP_GetProductSummary]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_GetProductSummary]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_GetProductSummary]
GO
/****** Object:  StoredProcedure [dbo].[MP_GetMonthlyConsumptionVesselwise]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_GetMonthlyConsumptionVesselwise]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_GetMonthlyConsumptionVesselwise]
GO
/****** Object:  StoredProcedure [dbo].[MP_GetMonthlyConsumptionDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_GetMonthlyConsumptionDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_GetMonthlyConsumptionDetails]
GO
/****** Object:  StoredProcedure [dbo].[MP_DeleteMenuCalculator_Ship]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_DeleteMenuCalculator_Ship]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_DeleteMenuCalculator_Ship]
GO
/****** Object:  StoredProcedure [dbo].[MP_DeleteMenuCalculator]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_DeleteMenuCalculator]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_DeleteMenuCalculator]
GO
/****** Object:  StoredProcedure [dbo].[MP_Copy_Provision]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_Copy_Provision]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[MP_Copy_Provision]
GO
/****** Object:  StoredProcedure [dbo].[InsertUpdateLFI_VSL]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertUpdateLFI_VSL]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[InsertUpdateLFI_VSL]
GO
/****** Object:  StoredProcedure [dbo].[InsertUpdateLFI_Vessel_Notifications_VSL]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertUpdateLFI_Vessel_Notifications_VSL]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[InsertUpdateLFI_Vessel_Notifications_VSL]
GO
/****** Object:  StoredProcedure [dbo].[INSERTUPDATELFI]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[INSERTUPDATELFI]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[INSERTUPDATELFI]
GO
/****** Object:  StoredProcedure [dbo].[InsertUpdateFocusCamp_VSL]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertUpdateFocusCamp_VSL]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[InsertUpdateFocusCamp_VSL]
GO
/****** Object:  StoredProcedure [dbo].[InsertUpdateFocusCamp_Vessel_Notifications_VSL]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertUpdateFocusCamp_Vessel_Notifications_VSL]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[InsertUpdateFocusCamp_Vessel_Notifications_VSL]
GO
/****** Object:  StoredProcedure [dbo].[INSERTUPDATEFocusCamp]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[INSERTUPDATEFocusCamp]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[INSERTUPDATEFocusCamp]
GO
/****** Object:  StoredProcedure [dbo].[InsertUpdate_VLI]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertUpdate_VLI]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[InsertUpdate_VLI]
GO
/****** Object:  StoredProcedure [dbo].[InsertLFI_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertLFI_Vessel_Notifications]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[InsertLFI_Vessel_Notifications]
GO
/****** Object:  StoredProcedure [dbo].[InsertFocusCamp_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertFocusCamp_Vessel_Notifications]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[InsertFocusCamp_Vessel_Notifications]
GO
/****** Object:  StoredProcedure [dbo].[Import_S_VNA_Master]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Import_S_VNA_Master]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[Import_S_VNA_Master]
GO
/****** Object:  StoredProcedure [dbo].[Import_S_VNA_Details]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Import_S_VNA_Details]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[Import_S_VNA_Details]
GO
/****** Object:  StoredProcedure [dbo].[Import_O_VNA_Master]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Import_O_VNA_Master]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[Import_O_VNA_Master]
GO
/****** Object:  StoredProcedure [dbo].[Import_O_VNA_Details]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Import_O_VNA_Details]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[Import_O_VNA_Details]
GO
/****** Object:  StoredProcedure [dbo].[GET_SUPPLYDATA_SHIP]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GET_SUPPLYDATA_SHIP]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[GET_SUPPLYDATA_SHIP]
GO
/****** Object:  StoredProcedure [dbo].[GET_INVETORYDATA_SHIP]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GET_INVETORYDATA_SHIP]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[GET_INVETORYDATA_SHIP]
GO
/****** Object:  StoredProcedure [dbo].[GET_INVETORYDATA]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GET_INVETORYDATA]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[GET_INVETORYDATA]
GO
/****** Object:  StoredProcedure [dbo].[ExecQuery]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ExecQuery]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ExecQuery]
GO
/****** Object:  StoredProcedure [dbo].[EV_Off_InsertUpdateRiskMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_Off_InsertUpdateRiskMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[EV_Off_InsertUpdateRiskMaster]
GO
/****** Object:  StoredProcedure [dbo].[EV_Off_InsertRiskDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_Off_InsertRiskDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[EV_Off_InsertRiskDetails]
GO
/****** Object:  StoredProcedure [dbo].[EV_InsertUpdateRiskMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_InsertUpdateRiskMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[EV_InsertUpdateRiskMaster]
GO
/****** Object:  StoredProcedure [dbo].[EV_InsertUpdateHazardMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_InsertUpdateHazardMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[EV_InsertUpdateHazardMaster]
GO
/****** Object:  StoredProcedure [dbo].[EV_InsertUpdateEventMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_InsertUpdateEventMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[EV_InsertUpdateEventMaster]
GO
/****** Object:  StoredProcedure [dbo].[EV_InsertRiskDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_InsertRiskDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[EV_InsertRiskDetails]
GO
/****** Object:  StoredProcedure [dbo].[EV_ImportHazardMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_ImportHazardMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[EV_ImportHazardMaster]
GO
/****** Object:  StoredProcedure [dbo].[EV_ImportEventMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_ImportEventMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[EV_ImportEventMaster]
GO
/****** Object:  StoredProcedure [dbo].[EV_Import_RISKMGMT_MASTER]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_Import_RISKMGMT_MASTER]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[EV_Import_RISKMGMT_MASTER]
GO
/****** Object:  StoredProcedure [dbo].[EV_Import_RISKMGMT_DETAILS]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_Import_RISKMGMT_DETAILS]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[EV_Import_RISKMGMT_DETAILS]
GO
/****** Object:  StoredProcedure [dbo].[ER_S133_InsertUpdate_ER_S133_Report_Office]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S133_InsertUpdate_ER_S133_Report_Office]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_S133_InsertUpdate_ER_S133_Report_Office]
GO
/****** Object:  StoredProcedure [dbo].[ER_S133_InsertUpdate_ER_S133_Report]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S133_InsertUpdate_ER_S133_Report]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_S133_InsertUpdate_ER_S133_Report]
GO
/****** Object:  StoredProcedure [dbo].[ER_S133_IMPORT_ER_S133_Report_Office]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S133_IMPORT_ER_S133_Report_Office]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_S133_IMPORT_ER_S133_Report_Office]
GO
/****** Object:  StoredProcedure [dbo].[ER_S133_IMPORT_ER_S133_Report]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S133_IMPORT_ER_S133_Report]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_S133_IMPORT_ER_S133_Report]
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_SHIPACKSENT]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_SHIPACKSENT]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_S115_SHIPACKSENT]
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_SHIPACKIMPORT]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_SHIPACKIMPORT]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_S115_SHIPACKIMPORT]
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_InsertUpdate_ER_S115_Report_Office]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_InsertUpdate_ER_S115_Report_Office]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_S115_InsertUpdate_ER_S115_Report_Office]
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_InsertUpdate_ER_S115_Report]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_InsertUpdate_ER_S115_Report]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_S115_InsertUpdate_ER_S115_Report]
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_InsertUpdate_ER_S115_InjuredCrewDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_InsertUpdate_ER_S115_InjuredCrewDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_S115_InsertUpdate_ER_S115_InjuredCrewDetails]
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_Insert_ER_Report_Documents_OfficeShip]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_Insert_ER_Report_Documents_OfficeShip]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_S115_Insert_ER_Report_Documents_OfficeShip]
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_IMPORT_ER_S115_Report_Office]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_IMPORT_ER_S115_Report_Office]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_S115_IMPORT_ER_S115_Report_Office]
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_IMPORT_ER_S115_Report]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_IMPORT_ER_S115_Report]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_S115_IMPORT_ER_S115_Report]
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_IMPORT_ER_S115_InjuredCrewDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_IMPORT_ER_S115_InjuredCrewDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_S115_IMPORT_ER_S115_InjuredCrewDetails]
GO
/****** Object:  StoredProcedure [dbo].[ER_Insert_ER_Report_UpdationDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_Insert_ER_Report_UpdationDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_Insert_ER_Report_UpdationDetails]
GO
/****** Object:  StoredProcedure [dbo].[ER_IMPORT_Report_Documents_OfficeShip]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_IMPORT_Report_Documents_OfficeShip]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_IMPORT_Report_Documents_OfficeShip]
GO
/****** Object:  StoredProcedure [dbo].[ER_IMPORT_ER_Report_UpdationDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_IMPORT_ER_Report_UpdationDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ER_IMPORT_ER_Report_UpdationDetails]
GO
/****** Object:  StoredProcedure [dbo].[Accident_InsertUpdate_Accident_Report_Office]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Accident_InsertUpdate_Accident_Report_Office]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[Accident_InsertUpdate_Accident_Report_Office]
GO
/****** Object:  StoredProcedure [dbo].[Accident_InsertUpdate_Accident_Report]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Accident_InsertUpdate_Accident_Report]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[Accident_InsertUpdate_Accident_Report]
GO
/****** Object:  StoredProcedure [dbo].[Accident_IMPORT_Accident_Report_Office]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Accident_IMPORT_Accident_Report_Office]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[Accident_IMPORT_Accident_Report_Office]
GO
/****** Object:  StoredProcedure [dbo].[Accident_IMPORT_Accident_Report]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Accident_IMPORT_Accident_Report]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[Accident_IMPORT_Accident_Report]
GO
/****** Object:  StoredProcedure [dbo].[DT_RESET_DRILL_TRAIINGS]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_RESET_DRILL_TRAIINGS]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_RESET_DRILL_TRAIINGS]
GO
/****** Object:  StoredProcedure [dbo].[DT_InsertUpdateTrainingMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_InsertUpdateTrainingMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_InsertUpdateTrainingMaster]
GO
/****** Object:  StoredProcedure [dbo].[DT_InsertUpdateImprovementAndCorrection]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_InsertUpdateImprovementAndCorrection]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_InsertUpdateImprovementAndCorrection]
GO
/****** Object:  StoredProcedure [dbo].[DT_InsertUpdateDrillMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_InsertUpdateDrillMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_InsertUpdateDrillMaster]
GO
/****** Object:  StoredProcedure [dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryRanks]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryRanks]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryRanks]
GO
/****** Object:  StoredProcedure [dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryDetails]
GO
/****** Object:  StoredProcedure [dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryAttachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryAttachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryAttachments]
GO
/****** Object:  StoredProcedure [dbo].[DT_Import_TrainingMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Import_TrainingMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_Import_TrainingMaster]
GO
/****** Object:  StoredProcedure [dbo].[DT_Import_OfficeAck]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Import_OfficeAck]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_Import_OfficeAck]
GO
/****** Object:  StoredProcedure [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingsHistory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingsHistory]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingsHistory]
GO
/****** Object:  StoredProcedure [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainings]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainings]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainings]
GO
/****** Object:  StoredProcedure [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryRanks]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryRanks]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryRanks]
GO
/****** Object:  StoredProcedure [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryDetails]
GO
/****** Object:  StoredProcedure [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryAttachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryAttachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryAttachments]
GO
/****** Object:  StoredProcedure [dbo].[DT_Import_MatrixMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Import_MatrixMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_Import_MatrixMaster]
GO
/****** Object:  StoredProcedure [dbo].[DT_Import_MatrixDetailsAttachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Import_MatrixDetailsAttachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_Import_MatrixDetailsAttachments]
GO
/****** Object:  StoredProcedure [dbo].[DT_Import_MatrixDetails]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Import_MatrixDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_Import_MatrixDetails]
GO
/****** Object:  StoredProcedure [dbo].[DT_Import_DrillMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Import_DrillMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_Import_DrillMaster]
GO
/****** Object:  StoredProcedure [dbo].[DT_Execute]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Execute]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_Execute]
GO
/****** Object:  StoredProcedure [dbo].[DT_CreateMatrix]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_CreateMatrix]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_CreateMatrix]
GO
/****** Object:  StoredProcedure [dbo].[DT_AddMatrixTrainingsAttachments]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_AddMatrixTrainingsAttachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_AddMatrixTrainingsAttachments]
GO
/****** Object:  StoredProcedure [dbo].[DT_AddMatrixTrainings]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_AddMatrixTrainings]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_AddMatrixTrainings]
GO
/****** Object:  StoredProcedure [dbo].[DT_ActiveInactive_Training]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_ActiveInactive_Training]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_ActiveInactive_Training]
GO
/****** Object:  StoredProcedure [dbo].[DT_ActiveInactive_Drill]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_ActiveInactive_Drill]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DT_ActiveInactive_Drill]
GO
/****** Object:  StoredProcedure [dbo].[DD_UploadDocument]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UploadDocument]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_UploadDocument]
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdateSUPQuote_GETDATA]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdateSUPQuote_GETDATA]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_UpdateSUPQuote_GETDATA]
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdateSUPQuote]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdateSUPQuote]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_UpdateSUPQuote]
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdateQuote]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdateQuote]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_UpdateQuote]
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdatePO]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdatePO]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_UpdatePO]
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdateJobSpecification]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdateJobSpecification]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_UpdateJobSpecification]
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdateCurrency]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdateCurrency]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_UpdateCurrency]
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdateCostTracking]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdateCostTracking]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_UpdateCostTracking]
GO
/****** Object:  StoredProcedure [dbo].[DD_RFQ_SHOWCOMPARISIONREPORT_SUP]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_RFQ_SHOWCOMPARISIONREPORT_SUP]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_RFQ_SHOWCOMPARISIONREPORT_SUP]
GO
/****** Object:  StoredProcedure [dbo].[DD_RFQ_SHOWCOMPARISIONREPORT]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_RFQ_SHOWCOMPARISIONREPORT]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_RFQ_SHOWCOMPARISIONREPORT]
GO
/****** Object:  StoredProcedure [dbo].[DD_PublishDocket]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_PublishDocket]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_PublishDocket]
GO
/****** Object:  StoredProcedure [dbo].[DD_Modify_PlanningDate]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Modify_PlanningDate]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_Modify_PlanningDate]
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateYardMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateYardMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_InsertUpdateYardMaster]
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateVesselSettings]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateVesselSettings]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_InsertUpdateVesselSettings]
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateSubJob]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateSubJob]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_InsertUpdateSubJob]
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateJobCategory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateJobCategory]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_InsertUpdateJobCategory]
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateJob]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateJob]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_InsertUpdateJob]
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateDocketReport]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateDocketReport]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_InsertUpdateDocketReport]
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateDocketMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateDocketMaster]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_InsertUpdateDocketMaster]
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdate_Progress]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdate_Progress]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_InsertUpdate_Progress]
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdate_PlanningDate]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdate_PlanningDate]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_InsertUpdate_PlanningDate]
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertJobSpecification_Other_RFQ]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertJobSpecification_Other_RFQ]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_InsertJobSpecification_Other_RFQ]
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertJobSpecification_Other]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertJobSpecification_Other]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_InsertJobSpecification_Other]
GO
/****** Object:  StoredProcedure [dbo].[DD_ImportSubJob]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_ImportSubJob]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_ImportSubJob]
GO
/****** Object:  StoredProcedure [dbo].[DD_ImportJobCategory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_ImportJobCategory]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_ImportJobCategory]
GO
/****** Object:  StoredProcedure [dbo].[DD_GETCostTracking_Data]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_GETCostTracking_Data]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_GETCostTracking_Data]
GO
/****** Object:  StoredProcedure [dbo].[DD_CreateRFQ]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_CreateRFQ]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_CreateRFQ]
GO
/****** Object:  StoredProcedure [dbo].[DD_CreatePO]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_CreatePO]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[DD_CreatePO]
GO
/****** Object:  StoredProcedure [dbo].[CREATE_VNA_ALLSHIP]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CREATE_VNA_ALLSHIP]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[CREATE_VNA_ALLSHIP]
GO
/****** Object:  StoredProcedure [dbo].[CREATE_VNA]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CREATE_VNA]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[CREATE_VNA]
GO
/****** Object:  StoredProcedure [dbo].[Create_Procedure]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Create_Procedure]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[Create_Procedure]
GO
/****** Object:  StoredProcedure [dbo].[CIR_PUBLISHCIRCULAR]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CIR_PUBLISHCIRCULAR]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[CIR_PUBLISHCIRCULAR]
GO
/****** Object:  StoredProcedure [dbo].[CIR_InsertUpdateCircular_VSL]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CIR_InsertUpdateCircular_VSL]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[CIR_InsertUpdateCircular_VSL]
GO
/****** Object:  StoredProcedure [dbo].[CIR_InsertUpdateCircular_Vessel_Notifications_VSL]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CIR_InsertUpdateCircular_Vessel_Notifications_VSL]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[CIR_InsertUpdateCircular_Vessel_Notifications_VSL]
GO
/****** Object:  StoredProcedure [dbo].[CIR_INSERTUPDATECIRCULAR]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CIR_INSERTUPDATECIRCULAR]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[CIR_INSERTUPDATECIRCULAR]
GO
/****** Object:  StoredProcedure [dbo].[CIR_InsertCircular_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CIR_InsertCircular_Vessel_Notifications]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[CIR_InsertCircular_Vessel_Notifications]
GO
/****** Object:  StoredProcedure [dbo].[CIR_ImportCircularFromSNQ]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CIR_ImportCircularFromSNQ]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[CIR_ImportCircularFromSNQ]
GO
/****** Object:  UserDefinedTableType [dbo].[TYP_MP_V1_VictualingMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.types st JOIN sys.schemas ss ON st.schema_id = ss.schema_id WHERE st.name = N'TYP_MP_V1_VictualingMaster' AND ss.name = N'dbo')
DROP TYPE [dbo].[TYP_MP_V1_VictualingMaster]
GO
/****** Object:  UserDefinedTableType [dbo].[TYP_MP_V1_UnitMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.types st JOIN sys.schemas ss ON st.schema_id = ss.schema_id WHERE st.name = N'TYP_MP_V1_UnitMaster' AND ss.name = N'dbo')
DROP TYPE [dbo].[TYP_MP_V1_UnitMaster]
GO
/****** Object:  UserDefinedTableType [dbo].[TYP_MP_V1_NationalityMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.types st JOIN sys.schemas ss ON st.schema_id = ss.schema_id WHERE st.name = N'TYP_MP_V1_NationalityMaster' AND ss.name = N'dbo')
DROP TYPE [dbo].[TYP_MP_V1_NationalityMaster]
GO
/****** Object:  UserDefinedTableType [dbo].[TYP_MP_V1_MealsTypeMaster]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.types st JOIN sys.schemas ss ON st.schema_id = ss.schema_id WHERE st.name = N'TYP_MP_V1_MealsTypeMaster' AND ss.name = N'dbo')
DROP TYPE [dbo].[TYP_MP_V1_MealsTypeMaster]
GO
/****** Object:  UserDefinedTableType [dbo].[TYP_MP_V1_MainCategory]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.types st JOIN sys.schemas ss ON st.schema_id = ss.schema_id WHERE st.name = N'TYP_MP_V1_MainCategory' AND ss.name = N'dbo')
DROP TYPE [dbo].[TYP_MP_V1_MainCategory]
GO
/****** Object:  UserDefinedTableType [dbo].[TYP_MP_V1_AllRank]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.types st JOIN sys.schemas ss ON st.schema_id = ss.schema_id WHERE st.name = N'TYP_MP_V1_AllRank' AND ss.name = N'dbo')
DROP TYPE [dbo].[TYP_MP_V1_AllRank]
GO
/****** Object:  User [pankaj.k]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.database_principals WHERE name = N'pankaj.k')
DROP USER [pankaj.k]
GO
/****** Object:  User [pankaj.v]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT * FROM sys.database_principals WHERE name = N'pankaj.v')
DROP USER [pankaj.v]
GO
/****** Object:  Database [eMANAGER]    Script Date: 12-Jun-2015 09:18:37 ******/
IF  EXISTS (SELECT name FROM sys.databases WHERE name = N'eMANAGER')
DROP DATABASE [eMANAGER]
GO
/****** Object:  Database [eMANAGER]    Script Date: 12-Jun-2015 09:18:37 ******/
IF NOT EXISTS (SELECT name FROM sys.databases WHERE name = N'eMANAGER')
BEGIN
CREATE DATABASE [eMANAGER]
 CONTAINMENT = NONE
 ON  PRIMARY 
( NAME = N'eMANAGER', FILENAME = N'E:\db\mdf' , SIZE = 129792KB , MAXSIZE = UNLIMITED, FILEGROWTH = 1024KB )
 LOG ON 
( NAME = N'eMANAGER_log', FILENAME = N'E:\logs\eMANAGER_1.ldf' , SIZE = 4277376KB , MAXSIZE = 2048GB , FILEGROWTH = 10%)
END

GO
ALTER DATABASE [eMANAGER] SET COMPATIBILITY_LEVEL = 90
GO
IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))
begin
EXEC [dbo].[sp_fulltext_database] @action = 'disable'
end
GO
ALTER DATABASE [eMANAGER] SET ANSI_NULL_DEFAULT OFF 
GO
ALTER DATABASE [eMANAGER] SET ANSI_NULLS OFF 
GO
ALTER DATABASE [eMANAGER] SET ANSI_PADDING OFF 
GO
ALTER DATABASE [eMANAGER] SET ANSI_WARNINGS OFF 
GO
ALTER DATABASE [eMANAGER] SET ARITHABORT OFF 
GO
ALTER DATABASE [eMANAGER] SET AUTO_CLOSE OFF 
GO
ALTER DATABASE [eMANAGER] SET AUTO_CREATE_STATISTICS ON 
GO
ALTER DATABASE [eMANAGER] SET AUTO_SHRINK OFF 
GO
ALTER DATABASE [eMANAGER] SET AUTO_UPDATE_STATISTICS ON 
GO
ALTER DATABASE [eMANAGER] SET CURSOR_CLOSE_ON_COMMIT OFF 
GO
ALTER DATABASE [eMANAGER] SET CURSOR_DEFAULT  GLOBAL 
GO
ALTER DATABASE [eMANAGER] SET CONCAT_NULL_YIELDS_NULL OFF 
GO
ALTER DATABASE [eMANAGER] SET NUMERIC_ROUNDABORT OFF 
GO
ALTER DATABASE [eMANAGER] SET QUOTED_IDENTIFIER OFF 
GO
ALTER DATABASE [eMANAGER] SET RECURSIVE_TRIGGERS OFF 
GO
ALTER DATABASE [eMANAGER] SET  DISABLE_BROKER 
GO
ALTER DATABASE [eMANAGER] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
GO
ALTER DATABASE [eMANAGER] SET DATE_CORRELATION_OPTIMIZATION OFF 
GO
ALTER DATABASE [eMANAGER] SET TRUSTWORTHY OFF 
GO
ALTER DATABASE [eMANAGER] SET ALLOW_SNAPSHOT_ISOLATION OFF 
GO
ALTER DATABASE [eMANAGER] SET PARAMETERIZATION SIMPLE 
GO
ALTER DATABASE [eMANAGER] SET READ_COMMITTED_SNAPSHOT OFF 
GO
ALTER DATABASE [eMANAGER] SET HONOR_BROKER_PRIORITY OFF 
GO
ALTER DATABASE [eMANAGER] SET RECOVERY FULL 
GO
ALTER DATABASE [eMANAGER] SET  MULTI_USER 
GO
ALTER DATABASE [eMANAGER] SET PAGE_VERIFY CHECKSUM  
GO
ALTER DATABASE [eMANAGER] SET DB_CHAINING OFF 
GO
ALTER DATABASE [eMANAGER] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) 
GO
ALTER DATABASE [eMANAGER] SET TARGET_RECOVERY_TIME = 0 SECONDS 
GO
EXEC sys.sp_db_vardecimal_storage_format N'eMANAGER', N'ON'
GO
/****** Object:  User [pankaj.v]    Script Date: 12-Jun-2015 09:18:41 ******/
IF NOT EXISTS (SELECT * FROM sys.database_principals WHERE name = N'eMANAGER')
CREATE USER [pankaj.v] FOR LOGIN [pankaj.v] WITH DEFAULT_SCHEMA=[dbo]
GO
/****** Object:  User [pankaj.k]    Script Date: 12-Jun-2015 09:18:41 ******/
IF NOT EXISTS (SELECT * FROM sys.database_principals WHERE name = N'eMANAGER')
CREATE USER [pankaj.k] FOR LOGIN [pankaj.k] WITH DEFAULT_SCHEMA=[dbo]
GO
ALTER ROLE [db_owner] ADD MEMBER [pankaj.v]
GO
ALTER ROLE [db_owner] ADD MEMBER [pankaj.k]
GO
/****** Object:  UserDefinedTableType [dbo].[TYP_MP_V1_AllRank]    Script Date: 12-Jun-2015 09:18:42 ******/
IF NOT EXISTS (SELECT * FROM sys.types st JOIN sys.schemas ss ON st.schema_id = ss.schema_id WHERE st.name = N'TYP_MP_V1_AllRank' AND ss.name = N'dbo')
CREATE TYPE [dbo].[TYP_MP_V1_AllRank] AS TABLE(
	[RANKID] [int] NULL,
	[RANKCODE] [varchar](10) NULL,
	[RANKANME] [varchar](50) NULL
)
GO
/****** Object:  UserDefinedTableType [dbo].[TYP_MP_V1_MainCategory]    Script Date: 12-Jun-2015 09:18:44 ******/
IF NOT EXISTS (SELECT * FROM sys.types st JOIN sys.schemas ss ON st.schema_id = ss.schema_id WHERE st.name = N'TYP_MP_V1_MainCategory' AND ss.name = N'dbo')
CREATE TYPE [dbo].[TYP_MP_V1_MainCategory] AS TABLE(
	[CategoryId] [bigint] NOT NULL,
	[CategoryName] [varchar](50) NULL,
	[CategoryCode] [char](5) NULL,
	[ParentCategoryId] [bigint] NULL,
	[OrderUnitId] [int] NULL,
	[ConsumptionUnitId] [int] NULL,
	[ConversionFactor] [float] NULL,
	[Level] [char](1) NULL,
	[Inactive] [bit] NULL
)
GO
/****** Object:  UserDefinedTableType [dbo].[TYP_MP_V1_MealsTypeMaster]    Script Date: 12-Jun-2015 09:18:48 ******/
IF NOT EXISTS (SELECT * FROM sys.types st JOIN sys.schemas ss ON st.schema_id = ss.schema_id WHERE st.name = N'TYP_MP_V1_MealsTypeMaster' AND ss.name = N'dbo')
CREATE TYPE [dbo].[TYP_MP_V1_MealsTypeMaster] AS TABLE(
	[MealId] [bigint] NULL,
	[MealType] [varchar](100) NULL
)
GO
/****** Object:  UserDefinedTableType [dbo].[TYP_MP_V1_NationalityMaster]    Script Date: 12-Jun-2015 09:18:49 ******/
IF NOT EXISTS (SELECT * FROM sys.types st JOIN sys.schemas ss ON st.schema_id = ss.schema_id WHERE st.name = N'TYP_MP_V1_NationalityMaster' AND ss.name = N'dbo')
CREATE TYPE [dbo].[TYP_MP_V1_NationalityMaster] AS TABLE(
	[NationalityId] [bigint] NOT NULL,
	[NationalityName] [varchar](100) NULL
)
GO
/****** Object:  UserDefinedTableType [dbo].[TYP_MP_V1_UnitMaster]    Script Date: 12-Jun-2015 09:18:50 ******/
IF NOT EXISTS (SELECT * FROM sys.types st JOIN sys.schemas ss ON st.schema_id = ss.schema_id WHERE st.name = N'TYP_MP_V1_UnitMaster' AND ss.name = N'dbo')
CREATE TYPE [dbo].[TYP_MP_V1_UnitMaster] AS TABLE(
	[UnitId] [bigint] NOT NULL,
	[UnitName] [varchar](100) NULL
)
GO
/****** Object:  UserDefinedTableType [dbo].[TYP_MP_V1_VictualingMaster]    Script Date: 12-Jun-2015 09:18:51 ******/
IF NOT EXISTS (SELECT * FROM sys.types st JOIN sys.schemas ss ON st.schema_id = ss.schema_id WHERE st.name = N'TYP_MP_V1_VictualingMaster' AND ss.name = N'dbo')
CREATE TYPE [dbo].[TYP_MP_V1_VictualingMaster] AS TABLE(
	[VID] [bigint] NOT NULL,
	[VesselCode] [char](3) NULL,
	[EffectiveDate] [smalldatetime] NULL,
	[VesselAccount] [float] NULL,
	[OwnerAccount] [float] NULL,
	[CharterAccount] [float] NULL
)
GO
/****** Object:  StoredProcedure [dbo].[CIR_ImportCircularFromSNQ]    Script Date: 12-Jun-2015 09:18:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CIR_ImportCircularFromSNQ]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE Proc [dbo].[CIR_ImportCircularFromSNQ]
(
    @CId bigint,
	@Attachment image 
)
AS
BEGIN

IF NOT EXISTS (SELECT * FROM Cir_Circular WHERE CircularNumber= (SELECT CircularNumber FROM [dbo].[CreateCircular] WHERE CID = @CId))
BEGIN
        Declare @NewCId bigint
		SELECT @NewCId=ISNULL(MAX(CId), 0) + 1 FROM Cir_Circular

		insert into Cir_Circular
		(
		    CId,
			CircularNumber,
			CircularDate,
			Category,
			CType,
			[Source],			
			Topic ,
			Details ,
			NextReviewDate ,
			AttachmentFileName,
			Attachment,
			CreatedBy,
			CreatedOn,			
			[Status] 
			
		)
		SELECT @NewCId, CircularNumber,[CircularDate],[Category],[CType],[Source],[Topic],[Details],[NextReviewDate],
		CASE WHEN LTRIM(RTRIM([CFileName])) = '''' THEN ''CircularFile_'' + Cast(@CId as varchar) + ''.pdf'' ELSE [CFileName] END ,
		@Attachment,
		(select  FirstName + '' '' + LastName  from  dbo.userlogin where Loginid=C.CreatedBy),[CreatedOn],[Status]
		FROM [dbo].[CreateCircular] C WHERE C.CID = @CId
	
END


END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[CIR_InsertCircular_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CIR_InsertCircular_Vessel_Notifications]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE proc [dbo].[CIR_InsertCircular_Vessel_Notifications]
(
@CId bigint,
@VesselCode char(3)
)
as
begin
	if exists(select * from Cir_Vessel_Notifications where CId=@CId AND VESSELCODE=@VesselCode)
	BEGIN
		UPDATE Cir_Vessel_Notifications SET SENTON=GETDATE(),ACKON=NULL,ACKMESSAGE=NULL where CId=@CId AND VESSELCODE=@VesselCode
	END
	ELSE
	BEGIN
		INSERT INTO Cir_Vessel_Notifications(CId,VESSELCODE,SENTON)
		VALUES(@CId,@VesselCode,GETDATE())	
	END
end


' 
END
GO
/****** Object:  StoredProcedure [dbo].[CIR_INSERTUPDATECIRCULAR]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CIR_INSERTUPDATECIRCULAR]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE Proc [dbo].[CIR_INSERTUPDATECIRCULAR]
(
    @CId bigint,
	@CircularDate smalldatetime,
	@Category int,
	@CType char(1),
	@Source varchar(1000),
	@Topic varchar(1000),
	@Details varchar(max),
	@NextReviewDate smalldatetime,
	@AttachmentFileName varchar(1000),
	@Attachment Image,
	@CreatedBy varchar(50)
)
AS
BEGIN

IF (@CId <= 0)
BEGIN
        --Declare @CircularNumber varchar(250)		
		--select @CircularNumber=''CIRCULAR-'' + CONVERT(VARCHAR,YEAR(GETDATE())) + ''-'' + REPLACE(STR(ISNULL(MAX(CAST( right(CircularNumber,3) AS INT)),0)+1,3),'' '',''0'') from Cir_Circular WHERE CAST( LEFT(right(CircularNumber,8),4) AS INT)=YEAR(GETDATE())
						
		SELECT @CId=ISNULL(MAX(CId), 0) + 1 FROM Cir_Circular


		insert into Cir_Circular
		(
		    CId,
			CircularNumber,
			CircularDate,
			Category,
			CType,
			[Source],			
			Topic ,
			Details ,
			NextReviewDate ,
			AttachmentFileName,
			Attachment,
			CreatedBy,
			CreatedOn,			
			[Status] 
			
		)
		Values
		(
			@CId,
			'''',
			@CircularDate,
			@Category,
			@CType,
			@Source,
			@Topic,
			@Details,
			@NextReviewDate,
			@AttachmentFileName,
			@Attachment,
			@CreatedBy,
			getdate(),
			1
		)
	
END
ELSE
BEGIN
      IF(LTRIM(RTRIM(@AttachmentFileName)) <> '''')
	  BEGIN
		   UPDATE Cir_Circular 
				  SET CircularDate = @CircularDate, 
					  [Source] = @Source,			
					  Topic = @Topic ,
					  Details = @Details ,
					  NextReviewDate = @NextReviewDate,
					  AttachmentFileName = @AttachmentFileName,
					  Attachment=@Attachment 
				  WHERE CId=@CId
	   END
	   ELSE
	   BEGIN
		   UPDATE Cir_Circular 
				  SET CircularDate = @CircularDate, 
					  [Source] = @Source,			
					  Topic = @Topic ,
					  Details = @Details ,
					  NextReviewDate = @NextReviewDate
				  WHERE CId=@CId
	   END
END

SELECT @CId As CId

END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[CIR_InsertUpdateCircular_Vessel_Notifications_VSL]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CIR_InsertUpdateCircular_Vessel_Notifications_VSL]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE proc [dbo].[CIR_InsertUpdateCircular_Vessel_Notifications_VSL]
(
	@CId bigint,
	@VesselCode char(3),
	@AckOn smalldatetime,
	@AckMessage varchar(500),
	@Discussed bit,
	@Notice bit

)
as
begin
	if exists(select * from Cir_Vessel_Notifications where CId=@CId AND VESSELCODE=@VesselCode)
	BEGIN
		UPDATE Cir_Vessel_Notifications SET ACKON=@AckOn,ACKMESSAGE=@AckMessage,Discussed=@Discussed,Notice=@Notice where CId=@CId AND VESSELCODE=@VesselCode
	END
	ELSE
	BEGIN
		INSERT INTO Cir_Vessel_Notifications(CId,VESSELCODE,AckOn,AckMessage,Discussed,Notice)
		VALUES(@CId,@VesselCode,@AckOn,@AckMessage,@Discussed,@Notice)	
	END
end

' 
END
GO
/****** Object:  StoredProcedure [dbo].[CIR_InsertUpdateCircular_VSL]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CIR_InsertUpdateCircular_VSL]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'--USE [eMANAGER]
--GO

--/****** Object:  StoredProcedure [dbo].[CIR_InsertUpdateCircular_VSL]    Script Date: 18-11-2014 15:27:39 ******/
--IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N''[dbo].[CIR_InsertUpdateCircular_VSL]'') AND type in (N''P'', N''PC''))
--DROP PROCEDURE [dbo].[CIR_InsertUpdateCircular_VSL]
--GO

--/****** Object:  StoredProcedure [dbo].[CIR_InsertUpdateCircular_VSL]    Script Date: 18-11-2014 15:27:39 ******/
--SET ANSI_NULLS ON
--GO

--SET QUOTED_IDENTIFIER ON
--GO

--IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N''[dbo].[CIR_InsertUpdateCircular_VSL]'') AND type in (N''P'', N''PC''))
--BEGIN
--EXEC dbo.sp_executesql @statement = N''
					   
CREATE PROCEDURE [dbo].[CIR_InsertUpdateCircular_VSL]
(
	@CId bigint,
	@CircularNumber varchar(250),
	@CircularDate smalldatetime,
	@Category int,
	@CType char(1),
	@Source varchar(1000),
	@Topic varchar(1000),
	@Details varchar(Max),
	@NextReviewDate smalldatetime,
	@AttachmentFileName varchar(1000),
	@Attachment Image,	
	@CreatedBy varchar(50),
	@CreatedOn smalldatetime,
	@Status int
)
AS
BEGIN
SET NOCOUNT ON

IF EXISTS(SELECT * FROM Cir_Circular WHERE CId=@CId)
	DELETE FROM Cir_Circular WHERE CId=@CId

INSERT INTO Cir_Circular
(
	CId,
	CircularNumber,
	CircularDate,
	Category,
	CType,
	[Source],
	Topic,
	Details,
	NextReviewDate,
	AttachmentFileName,
	Attachment,	
	CreatedBy,
	CreatedOn,
	[Status]
)
Values
(
	@CId,
	@CircularNumber,
	@CircularDate,
	@Category,
	@CType,
	@Source,
	@Topic,
	@Details,
	@NextReviewDate,
	@AttachmentFileName,
	@Attachment,	
	@CreatedBy,
	@CreatedOn,
	@Status
)

END
--'' 
--END
--GO


' 
END
GO
/****** Object:  StoredProcedure [dbo].[CIR_PUBLISHCIRCULAR]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CIR_PUBLISHCIRCULAR]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



CREATE Proc [dbo].[CIR_PUBLISHCIRCULAR]
(
    @CId bigint,	
	@CircularNumber varchar(250),	
	@Attachment Image
)
AS
BEGIN
    	    
	UPDATE Cir_Circular 
	SET Attachment=@Attachment ,
	CircularNumber=@CircularNumber,
	AttachmentFileName=@CircularNumber + ''.pdf''
	WHERE CId=@CId	  
	   
END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[Create_Procedure]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Create_Procedure]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE Procedure [dbo].[Create_Procedure] 
(
@TableName varchar(100)
)
as 
begin

select Name from
(
SELECT -12 as id,0 as ORDINAL_POSITION,''SET ANSI_NULLS ON'' as Name from (select getdate() as a) b 
union
SELECT -11 as id,0 as ORDINAL_POSITION,''GO'' as Name from (select getdate() as a) b 
union
SELECT -10 as id,0 as ORDINAL_POSITION,''SET QUOTED_IDENTIFIER ON'' as Name from (select getdate() as a) b 
union
SELECT -9 as id,0 as ORDINAL_POSITION,''GO'' as Name from (select getdate() as a) b 
union
SELECT -8 as id,0 as ORDINAL_POSITION,''CREATE PROCEDURE dbo.<--->'' as Name from (select getdate() as a) b 
union
SELECT -7 as id,0,''('' from (select getdate() as a) b 
union
select -6 as  id,ORDINAL_POSITION, ''@''+ upper(Column_Name) + '' '' + Data_Type + (case when CHARACTER_MAXIMUM_LENGTH is NULL then '''' else ''('' + CONVERT(VARCHAR,CHARACTER_MAXIMUM_LENGTH) + '')'' end) + (case when ORDINAL_POSITION<>(select max(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME=@TableName and table_schema = ''dbo'') then '','' else '''' end)
from 
INFORMATION_SCHEMA.COLUMNS where TABLE_NAME=
@TableName and table_schema = ''dbo''
union
SELECT -5 as id,0,'')'' from (select getdate() as a) b 
union
SELECT -4 as id,0,''AS'' from (select getdate() as a) b 
union
SELECT -3 as id,0,''BEGIN'' from (select getdate() as a) b 
union
SELECT -2 as id,0,''SET NOCOUNT ON'' from (select getdate() as a) b 
union
SELECT 0 as id,0,''INSERT INTO '' + @TableName from (select getdate() as a) b 
union
SELECT 1 as id,0,''(''  from (select getdate() as a) b 
union
select 2 as  id,ORDINAL_POSITION,upper(Column_Name) + '' '' + (case when ORDINAL_POSITION<>(select max(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME=@TableName and table_schema = ''dbo'') then '','' else '''' end) 
from 
INFORMATION_SCHEMA.COLUMNS where TABLE_NAME=
@TableName and table_schema = ''dbo''
union
SELECT 3 as id,0,'')'' from (select getdate() as a) b 
union
SELECT 4 as id,0,''Values'' from (select getdate() as a) b
union
SELECT 5 as id,0,''('' from (select getdate() as a) b 
union
select 6 as  id,ORDINAL_POSITION, ''@''+ upper(Column_Name) + (case when ORDINAL_POSITION<>(select max(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME=@TableName and table_schema = ''dbo'') then '','' else '''' end)
from 
INFORMATION_SCHEMA.COLUMNS where TABLE_NAME=
@TableName and table_schema = ''dbo''
union
SELECT 7 as id,0,'')'' from (select getdate() as a) b 
union
SELECT 8 as id,0,''END'' from (select getdate() as a) b 
) d order by id,ordinal_position
end



' 
END
GO
/****** Object:  StoredProcedure [dbo].[CREATE_VNA]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CREATE_VNA]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'






CREATE PROC [dbo].[CREATE_VNA]
(
@VSLCODE CHAR(3),
@VNANo varchar(50),
@CreatedBy INT
)
AS
BEGIN
	IF NOT EXISTS(SELECT VNAID FROM VNA_Master WHERE LTRIM(RTRIM(VNANo))=LTRIM(RTRIM(@VNANo)))
	BEGIN	
		DECLARE @VNAID INT
		SELECT @VNAID=ISNULL(MAX(VNAID),0)+1 FROM VNA_Master WHERE VesselCode=@VSLCODE

		INSERT INTO VNA_Master
		(
		VNAId,
		VesselCode,
		VNANo,
		CreatedBy,
		CreatedOn	
		)
		VALUES
		(
		@VNAID,
		@VSLCODE,
		@VNANo,
		@CreatedBy,
		GETDATE()
		)

		INSERT INTO VNA_DETAILS(VESSELCODE,VNAID,QID,QNO,QTEXT,GUIDANCE)
		SELECT @VSLCODE,@VNAID,mq.Id,mq.QuestionNo,Question,Description
		from DBO.m_questions mq inner join DBO.m_subchapters msc on msc.id = mq.subchapterid inner join dbo.m_chapters mc on mc.id = msc.chapterid 
		INNER JOIN DBO.m_inspectiongroup mig on mig.id=mc.inspectiongroup 
		where mc.id=75 
		order by mq.sortorder
	END
END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[CREATE_VNA_ALLSHIP]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CREATE_VNA_ALLSHIP]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROC [dbo].[CREATE_VNA_ALLSHIP]
(
@Vessels varchar(max),
@Yr int,
@Qtr int
)
AS
BEGIN
	DECLARE @CreatedBy INT
	SET @CreatedBy=1
	DECLARE @QUARTER VARCHAR(7)
	DECLARE	@VSLCODE CHAR(3)
	SELECT @QUARTER=CONVERT(VARCHAR,@Yr) + ''-Q'' + CONVERT(varchar,@Qtr)
	DECLARE @VNANo VARCHAR(50)
	DECLARE CS CURSOR FOR SELECT VESSELCODE FROM DBO.VESSEL WHERE VESSELSTATUSID=1 AND VESSELID NOT IN (41,43,44) AND VESSELCODE IN ( SELECT RESULT FROM [dbo].[CSVtoTableString](@Vessels,'',''))
	OPEN CS
	FETCH NEXT FROM CS INTO @VSLCODE
	WHILE(@@FETCH_STATUS=0)
	BEGIN
		
		SET @VNANo=@VSLCODE+ ''-'' + @QUARTER
		EXEC CREATE_VNA @VSLCODE,@VNANo,1

		FETCH NEXT FROM CS INTO @VSLCODE
	END
	CLOSE CS
	DEALLOCATE CS
	
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_CreatePO]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_CreatePO]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'    
CREATE PROC [dbo].[DD_CreatePO]
(
    @RFQId bigint
)
AS
BEGIN

      UPDATE DD_Docket_RFQ_Master SET STATUS = ''P'' WHERE RFQId=@RFQId
      UPDATE DD_Docket_RFQ_SubJobs SET POQty=QuoteQty,POGrossAmount=GrossAmount,PODiscountPer=DiscountPer,PONetAmount=NetAmount WHERE RFQId=@RFQId
  
	  DECLARE @CURR CHAR(3)
	  DECLARE @EXEC_RATE FLOAT
	  SELECT @CURR=CURRENCY,@EXEC_RATE=ExchRate FROM DD_Docket_RFQ_Master WHERE RFQID=@RFQId
	  
	  IF(@EXEC_RATE=0)
		 SET @EXEC_RATE=1
	 
	UPDATE DD_Docket_RFQ_SubJobs
	SET POUnitPrice_USD=UnitPrice_USD,
		POGrossAmount_USD=ROUND(POGrossAmount/@EXEC_RATE,2),
		PONetAmount_USD=ROUND(PONetAmount/@EXEC_RATE,2)		
	WHERE RFQId = @RFQId 

	--UPDATE DD_Docket_RFQ_SubJobs
	--SET 
	--EstQty=POQty,
	--EstDiscPer=PODiscountPer,
	--EstAmount_USD=PONetAmount_USD,
	--EstUnitPrice=POUnitPrice_USD
	--WHERE RFQId = @RFQId

	UPDATE DD_Docket_RFQ_SubJobs
	SET 
	EstQty=SUPQty,
	EstDiscPer=SUPDiscountPer,
	EstAmount_USD=SUPNetAmount_USD,
	EstUnitPrice=SUPUnitPrice_USD
	WHERE RFQId = @RFQId
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_CreateRFQ]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_CreateRFQ]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
			      
CREATE PROC [dbo].[DD_CreateRFQ]
(
	@DocketId Bigint,
	@YardId Bigint,
	@CreatedBy varchar(50)
)
AS
BEGIN
		-- EXEC [dbo].[DD_CreateRFQ] 1,3,''FA''
		IF NOT Exists (SELECT RFQId FROM DD_Docket_RFQ_Master WHERE DocketId=@DocketId AND YardId=@YardId )
		BEGIN
			DECLARE @NEXTID BIGINT
			SELECT @NEXTID=ISNULL(MAX(RFQId),0)+1 FROM DD_Docket_RFQ_Master

			DECLARE @DOCKETNO VARCHAR(50)
			SELECT @DOCKETNO=DocketNo FROM DD_DocketMaster WHERE DOCKETID=@DocketId

			DECLARE @NEXTRFQNO VARCHAR(50)
			SELECT @NEXTRFQNO=LTRIM(RTRIM(@DOCKETNO)) + ''-Q'' + REPLACE(STR(ISNULL(MAX(RIGHT(RFQNO,2)),0)+1,2),'' '',''0'') FROM DD_Docket_RFQ_Master WHERE DOCKETID=@DocketId

			INSERT INTO DD_Docket_RFQ_Master(RFQId,DocketId,RFQNo,YardId,Status,ActiveInactive,GUID,CreatedBy,CreatedOn) 
			VALUES(@NEXTID,@DocketId,@NEXTRFQNO,@YardId,''C'',''A'',NEWID(),@CreatedBy,getdate())

			INSERT INTO DD_Docket_RFQ_Jobs(RFQId,DocketJobId,DocketId,CatId,CatCode,CatName,JobId,JobCode,JobName,ComponentCode,ComponentName,jobdesc)		
			SELECT @NEXTID,DocketJobId,DocketId,CatId,CatCode,CatName,JobId,JobCode,JobName,ComponentCode,ComponentName,jobdesc FROM [dbo].[DD_DocketJobs] WHERE DOCKETID=@DocketId

			INSERT INTO DD_Docket_RFQ_SubJobs(RFQId,DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,AttachmentName,Attachment,Unit,BidQty,LongDescr,CostCategory,OutsideRepair,DefectNo, ReqForJobTrack)		
			SELECT @NEXTID,DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,AttachmentName,Attachment,Unit,BidQty,LongDescr,CostCategory,OutsideRepair,DefectNo, ReqForJobTrack FROM [dbo].[DD_DocketSubJobs] WHERE DOCKETID=@DocketId
	   END
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_GETCostTracking_Data]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_GETCostTracking_Data]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'			      
CREATE PROC [dbo].[DD_GETCostTracking_Data]
(
    @RFQId bigint,
	@DocketId bigint,
	@DocketJobId bigint,
    @DocketSubJobId bigint,
	@SubJobCode Varchar(50)
)
AS
BEGIN

		Declare @CatCode char(2);
		Set @CatCode= substring(@SubJobCode,1,2);

        -- CatSum 
		SELECT 
		ISNULL(SUM(PONetAmount_USD),0) as PONetAmount_USD,
		ISNULL(SUM(EstAmount_USD),0) as EstAmount_USD, 
		(ISNULL(SUM(EstAmount_USD),0) - ISNULL(SUM(PONetAmount_USD),0)) as VarAmt, 
		(((ISNULL(SUM(EstAmount_USD),0) - ISNULL(SUM(PONetAmount_USD),0))/ (case when ISNULL(SUM(PONetAmount_USD),0)=0 then 1 else ISNULL(SUM(PONetAmount_USD),0) end) )* 100)  As VarPer 
		FROM DD_Docket_RFQ_SubJobs WHERE RFQID=@RFQId AND DOCKETJOBID IN(select docketjobid from DD_Docket_RFQ_Jobs where docketid=@DocketId and rfqid=@RFQId and catid=(SELECT [CatId] FROM DD_JobCategory WHERE [CatCode] = @CatCode))
        -- JobSum
		SELECT 
		ISNULL(SUM(PONetAmount_USD),0) as PONetAmount_USD,
		ISNULL(SUM(EstAmount_USD),0) as EstAmount_USD, 
		(ISNULL(SUM(EstAmount_USD),0) - ISNULL(SUM(PONetAmount_USD),0)) as VarAmt,
		(((ISNULL(SUM(EstAmount_USD),0) - ISNULL(SUM(PONetAmount_USD),0))/ (case when ISNULL(SUM(PONetAmount_USD),0)=0 then 1 else ISNULL(SUM(PONetAmount_USD),0) end )    )* 100) As VarPer 
		FROM DD_Docket_RFQ_SubJobs WHERE RFQID=@RFQId AND DOCKETJOBID=@DocketJobId
		-- SubJobSum		
		SELECT  EstAmount_USD,
		([EstAmount_USD]-ISNULL([PONetAmount_USD],0)) AS VarAmt, 
		((([EstAmount_USD]-ISNULL([PONetAmount_USD],0))/(case when ISNULL([PONetAmount_USD],0)=0 then 1 else [PONetAmount_USD] end)) * 100) AS VarPer 
		FROM DD_Docket_RFQ_SubJobs WHERE RFQID=@RFQId AND DocketId=@DocketId AND DocketJobId=@DocketJobId AND DocketSubJobId=@DocketSubJobId AND SubJobCode=@SubJobCode
		-- TOTAL
		SELECT 
		ISNULL(SUM(PONetAmount_USD),0) as PONetAmount_USD_Total,
		ISNULL(SUM(EstAmount_USD),0) as EstAmount_USD_Total,
		ISNULL(SUM(case when isnull(costcategory,''N'')=''Y'' THEN EstAmount_USD ELSE 0 END),0) as EstAmount_USD_TotalYC, 
		ISNULL(SUM(case when isnull(costcategory,''N'')=''N'' THEN EstAmount_USD ELSE 0 END),0) as EstAmount_USD_TotalNY 
		FROM DD_Docket_RFQ_SubJobs WHERE RFQID=@RFQId

	   -- EstimatedAmt_USD

	   SELECT [EstAmount_USD] FROM DD_Docket_RFQ_SubJobs WHERE RFQID=@RFQId AND DocketId=@DocketId AND DocketJobId=@DocketJobId AND DocketSubJobId=@DocketSubJobId
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_ImportJobCategory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_ImportJobCategory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[DD_ImportJobCategory]
(
	@DocketId Bigint,
    @JobId Bigint
)
AS
BEGIN
	IF NOT EXISTS (SELECT * FROM DD_DocketJobs WHERE DOCKETID=@DocketId AND JobId=@JobId)
	BEGIN
		DECLARE @NEXTID BIGINT
		SELECT @NEXTID=ISNULL(MAX(DocketJobId),0)+1 FROM DD_DocketJobs WHERE DOCKETID=@DocketId

		INSERT INTO DD_DocketJobs(DocketJobId,DocketId,CatId,CatCode,CatName,JobId,JobCode,JobName,ComponentCode,ComponentName,JobDesc)
		SELECT @NEXTID, @DocketId,J.CatId,[CatCode],[CatName],J.JobId,[JobCode],[JobName],[ComponentCode],[ComponentName],J.JobDesc
		FROM DD_Jobs J
		INNER JOIN DD_JobCategory C ON J.[CatId] = C.[CatId]
		LEFT JOIN ComponentMaster CM ON J.[ComponentId] = CM.[ComponentId]
		WHERE J.JobId = @JobId

		DECLARE @RFQId BigInt 

		DECLARE InsertJob_cursor CURSOR FOR
		SELECT Distinct RFQId FROM DD_Docket_RFQ_Jobs WHERE DocketId=@DocketId

		OPEN InsertJob_cursor	
		FETCH NEXT FROM InsertJob_cursor into @RFQId
		WHILE @@FETCH_STATUS = 0
		BEGIN
	 		INSERT INTO DD_Docket_RFQ_Jobs(RFQId,DocketJobId,DocketId,CatId,CatCode,CatName,JobId,JobCode,JobName,ComponentCode,ComponentName,jobdesc)		
		    SELECT @RFQId,DocketJobId,DocketId,CatId,CatCode,CatName,JobId,JobCode,JobName,ComponentCode,ComponentName,jobdesc FROM [dbo].[DD_DocketJobs] WHERE DOCKETID=@DocketId AND JobId=@JobId       
	  
		FETCH NEXT FROM InsertJob_cursor into @RFQId	
		END
		CLOSE InsertJob_cursor
		DEALLOCATE InsertJob_cursor

	END			
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_ImportSubJob]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_ImportSubJob]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
			      
CREATE PROC [dbo].[DD_ImportSubJob]
(
	@DocketId Bigint,
	@DocketJobId Bigint,
    @SubJobId Bigint
)
AS
BEGIN
	IF NOT EXISTS (SELECT DOCKETID FROM DD_DocketSubJobs WHERE DOCKETID=@DocketId AND DocketJobId=@DocketJobId AND SubJobId=@SubJobId)
	BEGIN
		DECLARE @NEXTID BIGINT
		SELECT @NEXTID=ISNULL(MAX(DocketSubJobId),0)+1 FROM DD_DocketSubJobs WHERE DOCKETID=@DocketId

		INSERT INTO DD_DocketSubJobs(DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,Unit,BidQty,LongDescr, CostCategory, OutsideRepair, ReqForJobTrack) 
		SELECT @NEXTID,@DocketJobId,@DocketId,SubJobId,SubJobCode,SubJobName,Unit,NULL,LongDescr, CostCategory, OutsideRepair, ReqForJobTrack FROM DD_SubJobs where SubJobId=@SubJobId

		DECLARE @RFQId BigInt 

		DECLARE InsertSubJob_cursor CURSOR FOR
		SELECT Distinct RFQId FROM DD_Docket_RFQ_SubJobs WHERE DocketId=@DocketId

		OPEN InsertSubJob_cursor	
		FETCH NEXT FROM InsertSubJob_cursor into @RFQId
		WHILE @@FETCH_STATUS = 0
		BEGIN
	 		INSERT INTO DD_Docket_RFQ_SubJobs(RFQId,DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,AttachmentName,Attachment,Unit,BidQty,LongDescr,CostCategory,OutsideRepair,ReqForJobTrack)		
			SELECT @RFQId,DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,AttachmentName,Attachment,Unit,BidQty,LongDescr,CostCategory,OutsideRepair,ReqForJobTrack FROM [dbo].[DD_DocketSubJobs] WHERE DocketSubJobId=@NEXTID AND DocketJobId=@DocketJobId AND DocketId=@DocketId        
	  
		FETCH NEXT FROM InsertSubJob_cursor into @RFQId	
		END
		CLOSE InsertSubJob_cursor
		DEALLOCATE InsertSubJob_cursor

	END			
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertJobSpecification_Other]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertJobSpecification_Other]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'     
CREATE PROC [dbo].[DD_InsertJobSpecification_Other]
(
    @DocketId bigint,
	@DocketJobId bigint,
	@SubJobName varchar(5000),
	@AttachmentName varchar(100),
	@Attachment Image,
	@Unit varchar(50),
	@BidQty numeric(18,2),
	@LongDescr varchar(MAX), 
	@CostCategory char(1), 
	@OutsideRepair char(1),
	@DefectNo varchar(15),
	@ReqForJobTrack char(1)

)
AS
BEGIN
  DECLARE @NEXTID BIGINT
  SELECT @NEXTID=ISNULL(MAX(DocketSubJobId),0)+1 FROM DD_DocketSubJobs WHERE DOCKETID=@DocketId
  
  --DECLARE @VESSELID INT
  --SELECT @VESSELID=VESSELID FROM [dbo].[DD_DocketMaster] WHERE DOCKETID=@DocketId 

  --DECLARE @VESSELCODE CHAR(3)
  --SELECT @VESSELCODE=VESSELCODE FROM SHIPSOFT.[dbo].[VESSEL] WHERE VESSELID=@VESSELID 

  DECLARE @JOBCODE VARCHAR(50)
  SELECT @JOBCODE=JOBCODE FROM [dbo].[DD_DocketJobs] WHERE DOCKETID=@DocketId AND DOCKETJOBID=@DocketJobId
  SET @JOBCODE =RTRIM(LTRIM(@JOBCODE)) + ''-EXTRA-''

  DECLARE @NEXTJOBCODE VARCHAR(50)
  SELECT @NEXTJOBCODE=@JOBCODE + REPLACE(STR(ISNULL(MAX(RIGHT(SUBJOBCODE,2)),0)+1,2),'' '',''0'') FROM DD_DocketSubJobs WHERE DOCKETID=@DocketId AND SubJobId=0 AND LEFT(SUBJOBCODE,13)=@JOBCODE

  IF(ltrim(rtrim(@AttachmentName))='''')
  BEGIN
		INSERT INTO DD_DocketSubJobs(DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,Unit,BidQty,LongDescr, CostCategory, OutsideRepair, DefectNo, ReqForJobTrack)
		VALUES (@NEXTID,@DocketJobId,@DocketId,0,@NEXTJOBCODE,@SubJobName,@Unit,@BidQty,@LongDescr, @CostCategory, @OutsideRepair, @DefectNo, @ReqForJobTrack)
		
   END
   ELSE
   BEGIN
		INSERT INTO DD_DocketSubJobs(DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,AttachmentName,Attachment,Unit,BidQty,LongDescr, CostCategory, OutsideRepair, DefectNo, ReqForJobTrack)
		VALUES (@NEXTID,@DocketJobId,@DocketId,0,@NEXTJOBCODE,@SubJobName,@AttachmentName,@Attachment,@Unit,@BidQty,@LongDescr, @CostCategory, @OutsideRepair, @DefectNo, @ReqForJobTrack)
   END


    DECLARE @RFQId BigInt 

	DECLARE InsertSubJob_cursor CURSOR FOR
	SELECT Distinct RFQId FROM DD_Docket_RFQ_SubJobs WHERE DocketId=@DocketId

	OPEN InsertSubJob_cursor	
	FETCH NEXT FROM InsertSubJob_cursor into @RFQId
	WHILE @@FETCH_STATUS = 0
	BEGIN
	 	INSERT INTO DD_Docket_RFQ_SubJobs(RFQId,DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,AttachmentName,Attachment,Unit,BidQty,LongDescr,CostCategory,OutsideRepair,ReqForJobTrack)		
		SELECT @RFQId,DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,AttachmentName,Attachment,Unit,BidQty,LongDescr,CostCategory,OutsideRepair,ReqForJobTrack FROM [dbo].[DD_DocketSubJobs] WHERE DocketSubJobId=@NEXTID AND DocketJobId=@DocketJobId AND DocketId=@DocketId        
	  
	FETCH NEXT FROM InsertSubJob_cursor into @RFQId	
	END
	CLOSE InsertSubJob_cursor
	DEALLOCATE InsertSubJob_cursor

END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertJobSpecification_Other_RFQ]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertJobSpecification_Other_RFQ]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROC [dbo].[DD_InsertJobSpecification_Other_RFQ]
(
	@CURRRFQId BIGINT,
    @DocketId bigint,
	@DocketJobId bigint,
	@SubJobName varchar(5000),
	@AttachmentName varchar(100),
	@Attachment Image,
	@Unit varchar(50),
	@BidQty numeric(18,2),
	@LongDescr varchar(MAX), 
	@CostCategory char(1), 
	@OutsideRepair char(1),
	@POQty numeric(18,2),
	@POUnitPrice_USD numeric(18,2),
	@POGrossAmount_USD numeric(18,2),
	@PODiscountPer numeric(18,2),
	@PONetAmount_USD numeric(18,2)
)
AS
BEGIN
  DECLARE @NEXTID BIGINT
  SELECT @NEXTID=ISNULL(MAX(DocketSubJobId),0)+1 FROM DD_DocketSubJobs WHERE DOCKETID=@DocketId
  
  DECLARE @JOBCODE VARCHAR(50)
  SELECT @JOBCODE=JOBCODE FROM [dbo].[DD_DocketJobs] WHERE DOCKETID=@DocketId AND DOCKETJOBID=@DocketJobId
  SET @JOBCODE =RTRIM(LTRIM(@JOBCODE)) + ''-EXTRA-''

  DECLARE @NEXTJOBCODE VARCHAR(50)
  SELECT @NEXTJOBCODE=@JOBCODE + REPLACE(STR(ISNULL(MAX(RIGHT(SUBJOBCODE,2)),0)+1,2),'' '',''0'') FROM DD_DocketSubJobs WHERE DOCKETID=@DocketId AND SubJobId=0 AND LEFT(SUBJOBCODE,13)=@JOBCODE

  IF(ltrim(rtrim(@AttachmentName))='''')
  BEGIN
		INSERT INTO DD_DocketSubJobs(DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,Unit,BidQty,LongDescr, CostCategory, OutsideRepair, DefectNo)
		VALUES (@NEXTID,@DocketJobId,@DocketId,0,@NEXTJOBCODE,@SubJobName,@Unit,@BidQty,@LongDescr, @CostCategory, @OutsideRepair,'''')
		
   END
   ELSE
   BEGIN
		INSERT INTO DD_DocketSubJobs(DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,AttachmentName,Attachment,Unit,BidQty,LongDescr, CostCategory, OutsideRepair, DefectNo)
		VALUES (@NEXTID,@DocketJobId,@DocketId,0,@NEXTJOBCODE,@SubJobName,@AttachmentName,@Attachment,@Unit,@BidQty,@LongDescr, @CostCategory, @OutsideRepair,'''' )
   END


    DECLARE @RFQId BigInt 

	DECLARE InsertSubJob_cursor CURSOR FOR
	SELECT Distinct RFQId FROM DD_Docket_RFQ_SubJobs WHERE DocketId=@DocketId

	OPEN InsertSubJob_cursor	
	FETCH NEXT FROM InsertSubJob_cursor into @RFQId
	WHILE @@FETCH_STATUS = 0
	BEGIN
		IF (@CURRRFQId=@RFQId)
		BEGIN
		    INSERT INTO DD_Docket_RFQ_SubJobs(RFQId,DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,AttachmentName,Attachment,Unit,BidQty,LongDescr,CostCategory,OutsideRepair,POQty,POUnitPrice_USD,PODiscountPer,POGrossAmount_USD,PONetAmount_USD)		
			SELECT @RFQId,DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,AttachmentName,Attachment,Unit,BidQty,LongDescr,CostCategory,OutsideRepair,@POQty,@POUnitPrice_USD,@PODiscountPer,@POGrossAmount_USD,@PONetAmount_USD FROM [dbo].[DD_DocketSubJobs] WHERE DocketSubJobId=@NEXTID AND DocketJobId=@DocketJobId AND DocketId=@DocketId        
		END
		ELSE
		BEGIN
	 		INSERT INTO DD_Docket_RFQ_SubJobs(RFQId,DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,AttachmentName,Attachment,Unit,BidQty,LongDescr,CostCategory,OutsideRepair)		
			SELECT @RFQId,DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,AttachmentName,Attachment,Unit,BidQty,LongDescr,CostCategory,OutsideRepair FROM [dbo].[DD_DocketSubJobs] WHERE DocketSubJobId=@NEXTID AND DocketJobId=@DocketJobId AND DocketId=@DocketId        
		END
	FETCH NEXT FROM InsertSubJob_cursor into @RFQId	
	END
	CLOSE InsertSubJob_cursor
	DEALLOCATE InsertSubJob_cursor

END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdate_PlanningDate]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdate_PlanningDate]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


-- EXEC dbo.DD_InsertUpdate_PlanningDate 4,1,7,''19-Nov-2014,20-Nov-2014,21-Nov-2014,22-Nov-2014,23-Nov-2014,24-Nov-2014,25-Nov-2014''
CREATE proc [dbo].[DD_InsertUpdate_PlanningDate]
(
	@RfqId bigint,
	@DocketJobId bigint,
	@DocketId bigint,
	@For_Date Varchar(MAX)
)

as
begin

	DELETE FROM [DD_Docket_RFQ_Jobs_Planning] where RfqId=@RfqId and DocketJobId=@DocketJobId and DocketId=@DocketId 
	AND For_Date NOT IN (SELECT result FROM [dbo].[CSVtoTableDate](@For_Date, '',''))
 

	INSERT INTO [DD_Docket_RFQ_Jobs_Planning] (RfqId,DocketJobId,DocketId,For_Date,Per,Remark) SELECT @RfqId,@DocketJobId,@DocketId, result,'''','''' FROM [dbo].[CSVtoTableDate](@For_Date, '','') 
    WHERE result NOT IN (SELECT For_Date FROM [DD_Docket_RFQ_Jobs_Planning] where RfqId=@RfqId and DocketJobId=@DocketJobId and DocketId=@DocketId )

	if(not exists(select docketid from DD_Docket_RFQ_Jobs_Planning_History where RfqId=@RfqId and DocketJobId=@DocketJobId and DocketId=@DocketId and FOR_DATE= DBO.getDatePart(getdate())))
	begin
		INSERT INTO DD_Docket_RFQ_Jobs_Planning_History ([RfqId],[DocketJobId],[DocketId],[For_Date],[Dates])
		VALUES (@RfqId,@DocketJobId,@DocketId,DBO.getDatePart(getdate()), @For_Date)
	end

end




' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdate_Progress]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdate_Progress]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE proc [dbo].[DD_InsertUpdate_Progress]
(
	@RfqId bigint,
	@DocketJobId bigint,
	@DocketId bigint,
	@For_Date smalldatetime,
	@Per varchar(50),
	@Remark varchar(1000),
	@Report Bit
)

as
BEGIN

	 IF NOT EXISTS (SELECT * FROM DD_Docket_RFQ_Jobs_Planning WHERE RFQId=@RfqId AND DocketId=@DocketId AND DocketJobId=@DocketJobId AND FOR_DATE=@For_Date) 
	 BEGIN
	       
		   INSERT INTO DD_Docket_RFQ_Jobs_Planning ([RfqId],[DocketJobId],[DocketId],[For_Date],[Per],[Remark],Report)
		   VALUES(@RfqId,@DocketJobId,@DocketId,@For_Date,@Per,@Remark,@Report)

	 END
	 ELSE
	 BEGIN
	      
		  UPDATE DD_Docket_RFQ_Jobs_Planning SET Per=@Per,Remark=@Remark,Report=@Report WHERE RFQId=@RfqId AND DocketId=@DocketId AND DocketJobId=@DocketJobId AND FOR_DATE=@For_Date
	 
	 END

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateDocketMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateDocketMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
			      
CREATE PROC [dbo].[DD_InsertUpdateDocketMaster]
(
    @DocketId bigint,
    @VesselId int,
	@DocketType varchar(50),
	@DDType varchar(50),
	@Startdate smalldatetime,
	@EndDate smalldatetime,
	@Status Char(1),
	@JobsFrom int,
	@JobsFromDocketNo varchar(50)
)
AS
BEGIN

  IF(@DocketId<=0)
  BEGIN
    DECLARE @DocketNo Varchar(50)

	SELECT @DocketId= ISNULL(MAX(DocketId),0)+1 FROM DD_DocketMaster	
	SELECT @DocketNo = (Select VesselCode FROM dbo.vessel Where VesselId=@VesselId) + ''/'' + cast(year(@Startdate) AS varchar) + ''/DD'' + REPLACE(STR(ISNULL(MAX(RIGHT(LTRIM(RTRIM([DocketNo])),2)),0)+1,2),'' '',''0'') FROM [dbo].[DD_DocketMaster] WHERE VesselId = @VesselId AND Year([Startdate]) = Year(@Startdate)

	INSERT INTO DD_DocketMaster
    (
		DocketId,
		VesselId,
		DocketType,
		DDType,
		DocketNo,
		Startdate,
		EndDate,
		[Status]
			     
	)
     VALUES
	(
		@DocketId,
		@VesselId,
		@DocketType,
		@DDType,
		@DocketNo,
		@Startdate,
		@EndDate,
		''P''
	)

	IF(@JobsFrom = 1)
	BEGIN
		
			 INSERT INTO DD_DocketJobs(DocketJobId,DocketId,CatId,CatCode,CatName,JobId,JobCode,JobName,ComponentCode,ComponentName,JobDesc)
			 SELECT Row_Number() Over(Order By [JobId]), @DocketId,J.CatId,[CatCode],[CatName],J.JobId,[JobCode],[JobName],[ComponentCode],[ComponentName],J.JobDesc
										FROM DD_Jobs J
										INNER JOIN DD_JobCategory C ON J.[CatId] = C.[CatId]
										LEFT JOIN ComponentMaster CM ON J.[ComponentId] = CM.[ComponentId] 
										
			INSERT INTO DD_DocketSubJobs(DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,Unit,LongDescr, CostCategory, OutsideRepair, ReqForJobTrack) 
			SELECT Row_Number() Over(Order By S.[SubJobId]),(SELECT [DocketJobId] FROM [dbo].[DD_DocketJobs] DJ WHERE DJ.JOBCODE=J.JOBCODE AND DJ.DOCKETID=@DocketId ), @DocketId,S.[SubJobId],[SubJobCode],[SubJobName],[Unit],LongDescr, CostCategory, OutsideRepair, ReqForJobTrack 
			                             FROM DD_SubJobs S 
										 INNER JOIN DD_Jobs J ON S.JOBID=J.JOBID 
										 order BY SubJobId

	END
	ELSE
	BEGIN
	       DECLARE @LastDocketId bigint
		   SELECT @LastDocketId =DOCKETID FROM DD_DocketMaster WHERE LTRIM(RTRIM(DOCKETNO))=LTRIM(RTRIM(@JobsFromDocketNo))
		    
		   INSERT INTO DD_DocketJobs(DocketJobId,DocketId,CatId,CatCode,CatName,JobId,JobCode,JobName,ComponentCode,ComponentName,JobDesc) 
		   SELECT DocketJobId,@DocketId,CatId,[CatCode],[CatName],JobId,[JobCode],[JobName],[ComponentCode],[ComponentName],JobDesc
										FROM DD_DocketJobs WHERE [DocketId] =  @LastDocketId
		
		   INSERT INTO DD_DocketSubJobs(DocketSubJobId,DocketJobId,DocketId,SubJobId,SubJobCode,SubJobName,AttachmentName,Attachment,Unit,LongDescr, CostCategory, OutsideRepair,ReqForJobTrack)  
		   SELECT DocketSubJobId,DocketJobId,@DocketId,SubJobId,[SubJobCode],[SubJobName],[AttachmentName],[Attachment],[Unit],LongDescr, CostCategory, OutsideRepair,ReqForJobTrack
			                            FROM DD_DocketSubJobs S WHERE [DocketId] = @LastDocketId

	END

   END
   --ELSE
   --BEGIN
   --      UPDATE DD_DocketMaster 
			--	SET  VesselId = @VesselId,
			--		 DocketNo = @DocketNo,
			--		 Startdate=@Startdate,
			--		 EndDate=@EndDate,
			--		 [Status]= @Status												 
		 --WHERE DocketId = @DocketId
   --END
			
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateDocketReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateDocketReport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
			      
CREATE PROC [dbo].[DD_InsertUpdateDocketReport]
(
    @DocketId bigint,
    @CatId int,
	@ContentText varchar(max),
	@CreatedBy int
)
AS
BEGIN

  IF NOT EXISTS (SELECT * FROM DD_DocketReport WHERE DocketId=@DocketId AND CatId=@CatId )
  BEGIN    

	INSERT INTO DD_DocketReport
    (
        DocketId,
		CatId,
		ContentText,
		CreatedBy,
		CreatedOn    
			     
	)
     VALUES
	(
		@DocketId,
		@CatId,
		@ContentText,
		@CreatedBy,
		getdate()
	)
   END
   ELSE
   BEGIN
         UPDATE DD_DocketReport 
				SET ContentText=@ContentText								 
		 WHERE DocketId=@DocketId AND CatId=@CatId
   END
			
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateJob]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateJob]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
			      
CREATE PROC [dbo].[DD_InsertUpdateJob]
(
    @JobId bigint,
    @CatId int,
	@JobName varchar(500),
	@JobDesc varchar(max),
	@ComponentId bigint
)
AS
BEGIN

  IF(@JobId<=0)
  BEGIN
    DECLARE @JobCode Varchar(50)

	SELECT @JobId= ISNULL(MAX(JobId),0)+1 FROM DD_Jobs
	SELECT @JobCode=(SELECT LTRIM(RTRIM([CatCode])) FROM DD_JobCategory WHERE  [CatId] = @CatId)  + ''-'' + REPLACE(STR(ISNULL(MAX(RIGHT(LTRIM(RTRIM([JobCode])),3)),0)+1,3),'' '',''0'') FROM [dbo].[DD_Jobs] WHERE [CatId] = @CatId

	INSERT INTO DD_Jobs
    (
        JobId,
		CatId,
		JobCode,
		JobName,
		JobDesc,
		ComponentId    
			     
	)
     VALUES
	(
		@JobId,
		@CatId,
		@JobCode,
		@JobName,
		@JobDesc,
		@ComponentId
	)
   END
   ELSE
   BEGIN
         UPDATE DD_Jobs 
				SET JobName = @JobName,
					JobDesc=@JobDesc,
					ComponentId=@ComponentId								 
		 WHERE JobId = @JobId AND CatId = @CatId
   END
			
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateJobCategory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateJobCategory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[DD_InsertUpdateJobCategory]
(
    @CatId int,
	@CatCode varchar(50),
	@CatName varchar(500)
)
AS
BEGIN

  IF(@CatId<=0)
  BEGIN
    
	SELECT @CatId= ISNULL(MAX(CatId),0)+1 FROM DD_JobCategory

	INSERT INTO DD_JobCategory
    (
        CatId,
		CatCode,
		CatName    
			     
	)
     VALUES
	(
		@CatId,
		@CatCode,
		@CatName 
			
	)
   END
   ELSE
   BEGIN
         UPDATE DD_JobCategory 
				SET CatCode = @CatCode,
				    CatName = @CatName				 
		 WHERE CatId = @CatId
   END
			
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateSubJob]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateSubJob]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'			      
CREATE PROC [dbo].[DD_InsertUpdateSubJob]
(
    @SubJobId bigint,
    @JobId bigint,
	@SubJobName varchar(5000),
	@Unit varchar(50),
	@LongDescr varchar(MAX), 
	@CostCategory char(1), 
	@OutsideRepair char(1),
	@ReqForJobTrack char(1)
)
AS
BEGIN

  IF(@SubJobId<=0)
  BEGIN
    DECLARE @SubJobCode Varchar(50)

	SELECT @SubJobId= ISNULL(MAX(SubJobId),0)+1 FROM DD_SubJobs
	SELECT @SubJobCode = (SELECT LTRIM(RTRIM([JobCode])) FROM [DD_Jobs] WHERE  [JobId] = @JobId)  + ''-'' + REPLACE(STR(ISNULL(MAX(RIGHT(LTRIM(RTRIM([SubJobCode])),2)),0)+1,2),'' '',''0'')  FROM [dbo].[DD_SubJobs] WHERE [JobId] = @JobId
	
	INSERT INTO DD_SubJobs
    (
		SubJobId,
        JobId,
		SubJobCode,
		SubJobName,
		Unit,
		LongDescr, 
		CostCategory, 
		OutsideRepair,
		ReqForJobTrack
			     
	)
     VALUES
	(
		@SubJobId,
        @JobId,
		@SubJobCode,
		@SubJobName,
		@Unit,
		@LongDescr, 
		@CostCategory, 
		@OutsideRepair,
		@ReqForJobTrack
	)
   END
   ELSE
   BEGIN
         UPDATE DD_SubJobs 
				SET SubJobName = @SubJobName,
				    Unit = @Unit,
					LongDescr=@LongDescr, 
					CostCategory=@CostCategory, 
					OutsideRepair=@OutsideRepair,
					ReqForJobTrack=@ReqForJobTrack								 
		 WHERE SubJobId = @SubJobId AND JobId = @JobId 
   END
			
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateVesselSettings]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateVesselSettings]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[DD_InsertUpdateVesselSettings]
(
    @VesselCode char(3),
	@VesselName varchar(50) ,
	@VesselType varchar(100) ,
	@OwnerName varchar(100) ,
	@OwnerAddress varchar(100) ,
	@ManagementName varchar(100) ,
	@MangementAddress varchar(100) ,
	@FlagName varchar(50) ,
	@Build smalldatetime ,
	@Builder varchar(100) ,
	@IMONumber varchar(50) ,
	@CallSing varchar(50) ,
	@OfficialNumber varchar(50) ,
	@MMSINumber varchar(50) ,
	@FaxInmarsatC varchar(50) ,
	@PhoneInmarsatFB varchar(50) ,
	@Class varchar(50) ,
	@ClassNKNumber varchar(50) ,
	@LengthOverAll numeric(11, 3) ,
	@LengthBetweenPP numeric(11, 3) ,
	@BreadthMoulded numeric(11, 3) ,
	@DepthMoulded numeric(11, 3) ,
	@Draught_S numeric(11, 3) ,
	@Deadweight_S numeric(11, 3) ,
	@Int_Gross_Tonnage numeric(11, 3) ,
	@Int_Net_Tonnage numeric(11, 3) ,
	@SuezCanal_Net_Register_Tonnage numeric(11, 3) ,
	@PanamaCanal_UMS_Net_Tonnage numeric(11, 3) ,
	@LightShip numeric(11, 3) ,
	@MainEngine varchar(100) ,
	@Propeller_Size varchar(100) ,
	@Propeller_Type varchar(100) ,
	@Propeller_Material varchar(100) ,
	@Tail_Shaft_Oil varchar(100) ,
	@Trial_Speed numeric(11, 3) ,
	@Main_Generator_Engine varchar(100) ,
	@Main_Generators varchar(100) ,
	@Emergency_Generator_Engine varchar(100) ,
	@Electrical_Eqp_Main_Switch_Board varchar(100) ,
	@Boiler_Maker varchar(100) ,
	@Boiler_Model varchar(100) ,
	@Boiler_Type varchar(100) ,
	@Boiler_MaxWorkPressure varchar(100) ,
	@Boiler_NorWorkPressure varchar(100) ,
	@Boiler_SteamEvap varchar(100)
)
AS
BEGIN

  IF NOT EXISTS (SELECT * FROM [dbo].[VSL_Settings] WHERE [VesselCode] = @VesselCode)
  BEGIN
    
	INSERT INTO [VSL_Settings]
    (
            VesselCode,
			VesselName,
			VesselType,
			OwnerName,
			OwnerAddress,
			ManagementName,
			MangementAddress,
			FlagName,
			Build,
			Builder,
			IMONumber,
			CallSing,
			OfficialNumber,
			MMSINumber,
			FaxInmarsatC,
			PhoneInmarsatFB,
			Class,
			ClassNKNumber,
			LengthOverAll,
			LengthBetweenPP,
			BreadthMoulded,
			DepthMoulded,
			Draught_S,
			Deadweight_S,
			Int_Gross_Tonnage,
			Int_Net_Tonnage,
			SuezCanal_Net_Register_Tonnage,
			PanamaCanal_UMS_Net_Tonnage,
			LightShip,
			MainEngine,
			Propeller_Size,
			Propeller_Type,
			Propeller_Material,
			Tail_Shaft_Oil,
			Trial_Speed,
			Main_Generator_Engine,
			Main_Generators,
			Emergency_Generator_Engine,
			Electrical_Eqp_Main_Switch_Board,
			Boiler_Maker,
			Boiler_Model,
			Boiler_Type,
			Boiler_MaxWorkPressure,
			Boiler_NorWorkPressure,
			Boiler_SteamEvap     
	)
     VALUES
	(
	        @VesselCode,
			@VesselName,
			@VesselType,
			@OwnerName,
			@OwnerAddress,
			@ManagementName,
			@MangementAddress,
			@FlagName,
			@Build,
			@Builder,
			@IMONumber,
			@CallSing,
			@OfficialNumber,
			@MMSINumber,
			@FaxInmarsatC,
			@PhoneInmarsatFB,
			@Class,
			@ClassNKNumber,
			@LengthOverAll,
			@LengthBetweenPP,
			@BreadthMoulded,
			@DepthMoulded,
			@Draught_S,
			@Deadweight_S,
			@Int_Gross_Tonnage,
			@Int_Net_Tonnage,
			@SuezCanal_Net_Register_Tonnage,
			@PanamaCanal_UMS_Net_Tonnage,
			@LightShip,
			@MainEngine,
			@Propeller_Size,
			@Propeller_Type,
			@Propeller_Material,
			@Tail_Shaft_Oil,
			@Trial_Speed,
			@Main_Generator_Engine,
			@Main_Generators,
			@Emergency_Generator_Engine,
			@Electrical_Eqp_Main_Switch_Board,
			@Boiler_Maker,
			@Boiler_Model,
			@Boiler_Type,
			@Boiler_MaxWorkPressure,
			@Boiler_NorWorkPressure,
			@Boiler_SteamEvap
	)
   END
   ELSE
   BEGIN
         UPDATE [VSL_Settings] 
		 SET    VesselType = @VesselType,
				OwnerName = @OwnerName,
				OwnerAddress=@OwnerAddress,
				ManagementName=@ManagementName,
				MangementAddress=@MangementAddress,
				FlagName=@FlagName,
				Build=@Build,
				Builder=@Builder,
				IMONumber=@IMONumber,
				CallSing=@CallSing,
				OfficialNumber=@OfficialNumber,
				MMSINumber=@MMSINumber,
				FaxInmarsatC=@FaxInmarsatC,
				PhoneInmarsatFB=@PhoneInmarsatFB,
				Class=@Class,
				ClassNKNumber=@ClassNKNumber,
				LengthOverAll=@LengthOverAll,
				LengthBetweenPP=@LengthBetweenPP,
				BreadthMoulded=@BreadthMoulded,
				DepthMoulded=@DepthMoulded,
				Draught_S=@Draught_S,
				Deadweight_S=@Deadweight_S,
				Int_Gross_Tonnage=@Int_Gross_Tonnage,
				Int_Net_Tonnage=@Int_Net_Tonnage,
				SuezCanal_Net_Register_Tonnage=@SuezCanal_Net_Register_Tonnage,
				PanamaCanal_UMS_Net_Tonnage=@PanamaCanal_UMS_Net_Tonnage,
				LightShip=@LightShip,
				MainEngine=@MainEngine,
				Propeller_Size=@Propeller_Size,
				Propeller_Type=@Propeller_Type,
				Propeller_Material=@Propeller_Material,
				Tail_Shaft_Oil=@Tail_Shaft_Oil,
				Trial_Speed=@Trial_Speed,
				Main_Generator_Engine=@Main_Generator_Engine,
				Main_Generators=@Main_Generators,
				Emergency_Generator_Engine=@Emergency_Generator_Engine,
				Electrical_Eqp_Main_Switch_Board=@Electrical_Eqp_Main_Switch_Board,
				Boiler_Maker=@Boiler_Maker,
				Boiler_Model=@Boiler_Model,
				Boiler_Type=@Boiler_Type,
				Boiler_MaxWorkPressure=@Boiler_MaxWorkPressure,
				Boiler_NorWorkPressure=@Boiler_NorWorkPressure,
				Boiler_SteamEvap=@Boiler_SteamEvap		 
		 WHERE [VesselCode] = @VesselCode
   END
			
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_InsertUpdateYardMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_InsertUpdateYardMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[DD_InsertUpdateYardMaster]
(
    @YardId int,
	@YardName varchar(100),
	@Address varchar(500),
	@ContactNo varchar(100),
	@Email varchar(500),
	@ContactPerson varchar(50),
	@PortName varchar(50),
	@CountryId int
)
AS
BEGIN

  IF(@YardId<=0)
  BEGIN
    
	SELECT @YardId= ISNULL(MAX(YardId),0)+1 FROM DD_YardMaster

	INSERT INTO DD_YardMaster
    (
        YardId,
		YardName,
		Address,
		ContactNo,
		Email,
		ContactPerson,
		PortName,
		CountryId
	)
     VALUES
	(
		@YardId,
		@YardName,
		@Address,
		@ContactNo,
		@Email,
		@ContactPerson,
		@PortName,
		@CountryId
	)
   END
   ELSE
   BEGIN
         UPDATE DD_YardMaster 
				SET 
				YardName=@YardName,
				[Address]=@Address,
				ContactNo=@ContactNo,
				Email=@Email,
				ContactPerson = @ContactPerson,
				PortName = @PortName,
				CountryId = @CountryId
		 WHERE YardId=@YardId
   END
			
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_Modify_PlanningDate]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Modify_PlanningDate]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



-- EXEC dbo.DD_InsertUpdate_PlanningDate 4,1,7,''19-Nov-2014,20-Nov-2014,21-Nov-2014,22-Nov-2014,23-Nov-2014,24-Nov-2014,25-Nov-2014''
CREATE proc [dbo].[DD_Modify_PlanningDate]
(
	@RfqId bigint,
	@DocketJobId bigint,
	@DocketId bigint,
	@For_Date smalldatetime
)

as
begin

    IF EXISTS (SELECT Per FROM [DD_Docket_RFQ_Jobs_Planning] WHERE RfqId=@RfqId AND DocketJobId=@DocketJobId AND DocketId=@DocketId AND DBO.getDatePart(For_Date) = DBO.getDatePart(@For_Date) AND Per <> '''' )
	BEGIN
	       DELETE FROM [DD_Docket_RFQ_Jobs_Planning] WHERE RfqId=@RfqId AND DocketJobId=@DocketJobId AND DocketId=@DocketId AND DBO.getDatePart(For_Date) = DBO.getDatePart(@For_Date)
	END
    ELSE
	BEGIN
		INSERT INTO [DD_Docket_RFQ_Jobs_Planning] 
		(
			RfqId,
			DocketJobId,
			DocketId,
			For_Date,
			Per,
			Remark
		) 
		VALUES 
		(
			@RfqId,
			@DocketJobId,
			@DocketId,
			@For_Date,
			'''',
			''''
		)
	
	END
end





' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_PublishDocket]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_PublishDocket]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'		      
CREATE PROC [dbo].[DD_PublishDocket]
(
    @DocketId bigint,
	@PublishedBy varchar(50),
	@Attachment image
)
AS
BEGIN
	DECLARE @NEWVERSIONO VARCHAR(50)
	SELECT @NEWVERSIONO=REPLACE(STR(ISNULL(MAX(VERSIONNO),0)+1,3),'' '',''0'') FROM DD_Docket_Publish_History WHERE DocketId=@DocketId 
	
	DECLARE @TABLEID VARCHAR(50)
	SELECT @TABLEID=ISNULL(MAX(TABLEID),0)+1 FROM DD_Docket_Publish_History

	INSERT INTO DD_Docket_Publish_History(TABLEID,DocketId,VersionNo,PublishedBy,PublishedOn,Attachment)
	VALUES(@TABLEID,@DocketId,@NEWVERSIONO,@PublishedBy,getdate(),@Attachment)
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_RFQ_SHOWCOMPARISIONREPORT]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_RFQ_SHOWCOMPARISIONREPORT]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'--USE [eMANAGER]
--GO

--ALTER VIEW VW_PRINT_RFQ
--AS
--SELECT MST.RFQID,YARDNAME,VESSELNAME,RFQNO,DocketSubJobId,JOBS.DocketJobId,CATID,CATCODE,CATNAME,JOBS.JOBCODE,JOBS.JOBNAME,JOBDESC,SUBJOBCODE,SUBJOBNAME,ATTACHMENTNAME,ISNULL(CostCategory,''N'') as CostCategory, CASE WHEN [OutsideRepair] = ''Y'' THEN ''Yes''  WHEN [OutsideRepair] = ''N'' THEN ''No'' ELSE '''' END AS OutsideRepair,UNIT,BIDQTY,QUOTEQTY,UnitPrice_USD,DISCOUNTPER,NetAmount_USD 
--FROM [dbo].[DD_Docket_RFQ_Master] MST 
--INNER JOIN [dbo].[DD_Docket_RFQ_Jobs] JOBS ON MST.RFQID=JOBS.RFQID
--INNER JOIN [dbo].[DD_Docket_RFQ_SubJobs] SUBJOBS ON JOBS.RFQID=SUBJOBS.RFQID AND JOBS.DocketJobId=SUBJOBS.DocketJobId
--INNER JOIN [dbo].[DD_DocketMaster] DOCKET ON DOCKET.DOCKETID=MST.DOCKETID
--INNER JOIN [dbo].[DD_YardMaster] YM ON MST.YARDID=YM.YARDID
--INNER JOIN DBO.VESSEL V ON V.VESSELID=DOCKET.VESSELID
--===========================================================================================================================================================================
--select * from [DD_RFQ_SHOWCOMPARISIONREPORT]

CREATE PROC [dbo].[DD_RFQ_SHOWCOMPARISIONREPORT]

(
@DOCKETID BIGINT,
@RFQID BIGINT,
@RFQID1 BIGINT,
@RFQID2 BIGINT,
@RFQID3 BIGINT,
@REPORTTYPE CHAR(1)
)

AS

BEGIN

DECLARE @VSLNAME VARCHAR(50)
DECLARE @DOCKETNO VARCHAR(50)

DECLARE @YARDNAME VARCHAR(50)
DECLARE @YARDNAME1 VARCHAR(50)
DECLARE @YARDNAME2 VARCHAR(50)
DECLARE @YARDNAME3 VARCHAR(50)


SELECT @VSLNAME=VESSELNAME FROM DBO.VESSEL V WHERE V.VESSELID IN(SELECT VESSELID FROM DD_DOCKETMASTER WHERE DOCKETID=@DOCKETID)
SELECT @DOCKETNO=DOCKETNO FROM DD_DOCKETMASTER WHERE DOCKETID=@DOCKETID

SELECT @YARDNAME=YARDNAME FROM DD_YARDMASTER Y WHERE Y.YARDID IN (SELECT YARDID FROM DD_DOCKET_RFQ_MASTER WHERE RFQID=@RFQID)
SELECT @YARDNAME1=YARDNAME FROM DD_YARDMASTER Y WHERE Y.YARDID IN (SELECT YARDID FROM DD_DOCKET_RFQ_MASTER WHERE RFQID=@RFQID1)
SELECT @YARDNAME2=YARDNAME FROM DD_YARDMASTER Y WHERE Y.YARDID IN (SELECT YARDID FROM DD_DOCKET_RFQ_MASTER WHERE RFQID=@RFQID2)
SELECT @YARDNAME3=YARDNAME FROM DD_YARDMASTER Y WHERE Y.YARDID IN (SELECT YARDID FROM DD_DOCKET_RFQ_MASTER WHERE RFQID=@RFQID3)


--TRUNCATE TABLE DD_PRINT_RFQ_COMPARISON

--INSERT INTO DD_PRINT_RFQ_COMPARISON(vesselname,DOCKETNO,yardname,yardname1,CatCode,CatName,JobCode,JobName,JonDesc,SubJobCode,SubJobName,LongDesc,QuoteQty,UnitPrice,Disc,Total,QuoteQty1,UnitPrice1,Disc1,Total1)
IF(@REPORTTYPE<>'''')
BEGIN
	SELECT @VSLNAME as VesselName,@DOCKETNO as DocketNo,@YARDNAME as YardName,@YARDNAME1 as YardName1,@YARDNAME2 as YardName2,@YARDNAME3 as YardName3,DJ.CatCode,CatName,DJ.JOBCODE,JOBNAME,JobDesc,[SubJobCode],[SubJobName],[LongDescr],
	(SELECT NetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total,
	(SELECT NetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID1 AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total1,
	(SELECT NetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID2 AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total2,
	(SELECT NetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID3 AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total3
	FROM [dbo].[DD_DocketSubJobs] DSJ 
	INNER JOIN DD_DOCKETJOBS DJ ON DJ.DOCKETID=DSJ.DOCKETID AND DJ.DocketJobId=DSJ.DocketJobId 
	INNER JOIN DD_DocketMaster DM ON DM.DOCKETID=DSJ.DOCKETID WHERE DSJ.DOCKETID=@DOCKETID
	AND ISNULL(DSJ.CostCategory,''N'')=@REPORTTYPE
END
ELSE
BEGIN
	SELECT @VSLNAME as VesselName,@DOCKETNO as DocketNo,@YARDNAME as YardName,@YARDNAME1 as YardName1,@YARDNAME2 as YardName2,@YARDNAME3 as YardName3,DJ.CatCode,CatName,DJ.JOBCODE,JOBNAME,JobDesc,[SubJobCode],[SubJobName],[LongDescr],
	(SELECT NetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total,
	(SELECT NetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID1 AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total1,
	(SELECT NetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID2 AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total2,
	(SELECT NetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID3 AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total3
	FROM [dbo].[DD_DocketSubJobs] DSJ 
	INNER JOIN DD_DOCKETJOBS DJ ON DJ.DOCKETID=DSJ.DOCKETID AND DJ.DocketJobId=DSJ.DocketJobId 
	INNER JOIN DD_DocketMaster DM ON DM.DOCKETID=DSJ.DOCKETID WHERE DSJ.DOCKETID=@DOCKETID
END

END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_RFQ_SHOWCOMPARISIONREPORT_SUP]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_RFQ_SHOWCOMPARISIONREPORT_SUP]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
--USE [eMANAGER]
--GO

--ALTER VIEW VW_PRINT_RFQ
--AS
--SELECT MST.RFQID,YARDNAME,VESSELNAME,RFQNO,DocketSubJobId,JOBS.DocketJobId,CATID,CATCODE,CATNAME,JOBS.JOBCODE,JOBS.JOBNAME,JOBDESC,SUBJOBCODE,SUBJOBNAME,ATTACHMENTNAME,ISNULL(CostCategory,''N'') as CostCategory, CASE WHEN [OutsideRepair] = ''Y'' THEN ''Yes''  WHEN [OutsideRepair] = ''N'' THEN ''No'' ELSE '''' END AS OutsideRepair,UNIT,BIDQTY,QUOTEQTY,UnitPrice_USD,DISCOUNTPER,NetAmount_USD 
--FROM [dbo].[DD_Docket_RFQ_Master] MST 
--INNER JOIN [dbo].[DD_Docket_RFQ_Jobs] JOBS ON MST.RFQID=JOBS.RFQID
--INNER JOIN [dbo].[DD_Docket_RFQ_SubJobs] SUBJOBS ON JOBS.RFQID=SUBJOBS.RFQID AND JOBS.DocketJobId=SUBJOBS.DocketJobId
--INNER JOIN [dbo].[DD_DocketMaster] DOCKET ON DOCKET.DOCKETID=MST.DOCKETID
--INNER JOIN [dbo].[DD_YardMaster] YM ON MST.YARDID=YM.YARDID
--INNER JOIN DBO.VESSEL V ON V.VESSELID=DOCKET.VESSELID
--===========================================================================================================================================================================
--select * from [DD_RFQ_SHOWCOMPARISIONREPORT]

CREATE PROC [dbo].[DD_RFQ_SHOWCOMPARISIONREPORT_SUP]
(
@DOCKETID BIGINT,
@RFQID BIGINT,
@RFQID1 BIGINT,
@RFQID2 BIGINT,
@RFQID3 BIGINT,
@REPORTTYPE CHAR(1)
)

AS

BEGIN

DECLARE @VSLNAME VARCHAR(50)
DECLARE @DOCKETNO VARCHAR(50)

DECLARE @YARDNAME VARCHAR(50)
DECLARE @YARDNAME1 VARCHAR(50)
DECLARE @YARDNAME2 VARCHAR(50)
DECLARE @YARDNAME3 VARCHAR(50)


SELECT @VSLNAME=VESSELNAME FROM DBO.VESSEL V WHERE V.VESSELID IN(SELECT VESSELID FROM DD_DOCKETMASTER WHERE DOCKETID=@DOCKETID)
SELECT @DOCKETNO=DOCKETNO FROM DD_DOCKETMASTER WHERE DOCKETID=@DOCKETID

SELECT @YARDNAME=YARDNAME FROM DD_YARDMASTER Y WHERE Y.YARDID IN (SELECT YARDID FROM DD_DOCKET_RFQ_MASTER WHERE RFQID=@RFQID)
SELECT @YARDNAME1=YARDNAME FROM DD_YARDMASTER Y WHERE Y.YARDID IN (SELECT YARDID FROM DD_DOCKET_RFQ_MASTER WHERE RFQID=@RFQID1)
SELECT @YARDNAME2=YARDNAME FROM DD_YARDMASTER Y WHERE Y.YARDID IN (SELECT YARDID FROM DD_DOCKET_RFQ_MASTER WHERE RFQID=@RFQID2)
SELECT @YARDNAME3=YARDNAME FROM DD_YARDMASTER Y WHERE Y.YARDID IN (SELECT YARDID FROM DD_DOCKET_RFQ_MASTER WHERE RFQID=@RFQID3)


--TRUNCATE TABLE DD_PRINT_RFQ_COMPARISON

--INSERT INTO DD_PRINT_RFQ_COMPARISON(vesselname,DOCKETNO,yardname,yardname1,CatCode,CatName,JobCode,JobName,JonDesc,SubJobCode,SubJobName,LongDesc,QuoteQty,UnitPrice,Disc,Total,QuoteQty1,UnitPrice1,Disc1,Total1)
IF(@REPORTTYPE<>'''')
BEGIN
	SELECT @VSLNAME as VesselName,@DOCKETNO as DocketNo,@YARDNAME as YardName,@YARDNAME1 as YardName1,@YARDNAME2 as YardName2,@YARDNAME3 as YardName3,DJ.CatCode,CatName,DJ.JOBCODE,JOBNAME,JobDesc,[SubJobCode],[SubJobName],[LongDescr],
	(SELECT SUPNetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total,
	(SELECT SUPNetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID1 AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total1,
	(SELECT SUPNetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID2 AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total2,
	(SELECT SUPNetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID3 AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total3
	FROM [dbo].[DD_DocketSubJobs] DSJ 
	INNER JOIN DD_DOCKETJOBS DJ ON DJ.DOCKETID=DSJ.DOCKETID AND DJ.DocketJobId=DSJ.DocketJobId 
	INNER JOIN DD_DocketMaster DM ON DM.DOCKETID=DSJ.DOCKETID WHERE DSJ.DOCKETID=@DOCKETID
	AND ISNULL(DSJ.CostCategory,''N'')=@REPORTTYPE
END
ELSE
BEGIN
	SELECT @VSLNAME as VesselName,@DOCKETNO as DocketNo,@YARDNAME as YardName,@YARDNAME1 as YardName1,@YARDNAME2 as YardName2,@YARDNAME3 as YardName3,DJ.CatCode,CatName,DJ.JOBCODE,JOBNAME,JobDesc,[SubJobCode],[SubJobName],[LongDescr],
	(SELECT SUPNetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total,
	(SELECT SUPNetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID1 AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total1,
	(SELECT SUPNetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID2 AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total2,
	(SELECT SUPNetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE DOCKETID=@DOCKETID AND RFQID=@RFQID3 AND DOCKETJOBID=DSJ.DOCKETJOBID AND DOCKETSUBJOBID=DSJ.DOCKETSUBJOBID) AS Total3
	FROM [dbo].[DD_DocketSubJobs] DSJ 
	INNER JOIN DD_DOCKETJOBS DJ ON DJ.DOCKETID=DSJ.DOCKETID AND DJ.DocketJobId=DSJ.DocketJobId 
	INNER JOIN DD_DocketMaster DM ON DM.DOCKETID=DSJ.DOCKETID WHERE DSJ.DOCKETID=@DOCKETID
END

END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdateCostTracking]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdateCostTracking]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
			      
CREATE PROC [dbo].[DD_UpdateCostTracking]
(
    @RFQId bigint,
	@DocketId bigint,
	@DocketJobId bigint,
    @DocketSubJobId bigint,
	@EstUnitPrice numeric(18,2),
	@SubJobCode Varchar(50),
	@EstQty numeric(18,2),
	@EstDiscPer numeric(18,2),
	@Remarks Varchar(250)
)
AS
BEGIN

       DECLARE @EstAmount_USD numeric(18,2)
	   SET @EstAmount_USD = (@EstQty * @EstUnitPrice)
	   SET @EstAmount_USD =@EstAmount_USD- ((@EstDiscPer * @EstAmount_USD)/100)
       
         UPDATE DD_Docket_RFQ_SubJobs
		 SET   EstQty=@EstQty ,
			   EstDiscPer=@EstDiscPer,	
		       EstUnitPrice=@EstUnitPrice,
			   EstAmount_USD= @EstAmount_USD,
			   Remarks=@Remarks
		 WHERE RFQId = @RFQId AND DocketId=@DocketId AND DocketJobId=@DocketJobId  AND DocketSubJobId=@DocketSubJobId


END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdateCurrency]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdateCurrency]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'		      
CREATE PROC [dbo].[DD_UpdateCurrency]
(
    @RFQId bigint,
	@CURR CHAR(3)
)
AS
BEGIN
	 DECLARE @CREATEDON SMALLDATETIME
	 DECLARE @EXEC_RATE FLOAT
	 
	 SELECT @CREATEDON=CREATEDON FROM DD_Docket_RFQ_Master WHERE RFQID=@RFQId
	 UPDATE DD_Docket_RFQ_Master SET CURRENCY=@CURR WHERE RFQID=@RFQId
	 
	 SELECT TOP 1 @EXEC_RATE=EXC_RATE FROM MTMPOS.DBO.XCHANGEDAILY WHERE FOR_CURR=@CURR AND RATEDATE <=@CREATEDON ORDER BY RATEDATE DESC
	 IF(@EXEC_RATE=0)
		SET @EXEC_RATE=1
	 
     UPDATE DD_Docket_RFQ_SubJobs
	 SET UnitPrice_USD=ROUND(UnitPrice/@EXEC_RATE,2),
			GrossAmount_USD=ROUND(GrossAmount/@EXEC_RATE,2),
			NetAmount_USD=ROUND(NetAmount/@EXEC_RATE,2)
	 WHERE RFQId = @RFQId


	 UPDATE DD_Docket_RFQ_SubJobs
	 	SET SUPQty=QuoteQty,				    
			SUPDiscountPer=DiscountPer,				
			SUPUnitPrice_USD=ROUND(UnitPrice/@EXEC_RATE,2),
			SUPGrossAmount_USD=ROUND(GrossAmount/@EXEC_RATE,2),
			SUPNetAmount_USD=ROUND(NetAmount/@EXEC_RATE,2)
	 WHERE RFQId = @RFQId AND isnull(SUPUpdated,''N'')=''N''


	 UPDATE DD_Docket_RFQ_Master SET ExchRate=@EXEC_RATE  WHERE RFQID=@RFQId
	 SELECT @EXEC_RATE AS EXEC_RATE,(SELECT ISNULL(SUM(NetAmount),0) FROM DD_Docket_RFQ_SubJobs WHERE RFQID=@RFQId) AS NETAMOUNT

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdateJobSpecification]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdateJobSpecification]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'      
CREATE PROC [dbo].[DD_UpdateJobSpecification]
(
    @DocketId bigint,
	@DocketJobId bigint,
	@DocketSubJobId bigint,
    @SubJobName varchar(5000),
	@AttachmentName varchar(100),
	@Attachment Image,
	@Unit varchar(50),
	@BidQty numeric(18,2),
	@LongDescr varchar(MAX), 
	@CostCategory char(1), 
	@OutsideRepair char(1),
	@ReqForJobTrack char(1)
)
AS
BEGIN

  IF(ltrim(rtrim(@AttachmentName))='''')
  BEGIN
		UPDATE DD_DocketSubJobs 
		SET 
		SUBJOBNAME =@SubJobName, Unit = @Unit, BidQty=@BidQty,LongDescr=@LongDescr,CostCategory=@CostCategory,OutsideRepair=@OutsideRepair,ReqForJobTrack=@ReqForJobTrack  
		WHERE DOCKETID=@DocketId AND DOCKETJOBID=@DocketJobId AND DOCKETSUBJOBID=@DocketSubJobId

		UPDATE DD_Docket_RFQ_SubJobs 
			   SET SUBJOBNAME =@SubJobName, Unit = @Unit, BidQty=@BidQty,LongDescr=@LongDescr,CostCategory=@CostCategory,OutsideRepair=@OutsideRepair,ReqForJobTrack=@ReqForJobTrack 
		WHERE DocketId=@DocketId AND DocketJobId=@DocketJobId AND DocketSubJobId=@DocketSubJobId

   END
   ELSE
   BEGIN
        UPDATE DD_DocketSubJobs 
		SET 
		SUBJOBNAME=@SubJobName, 
		Unit = @Unit,
		AttachmentName=@AttachmentName,
		Attachment=@Attachment, 
		BidQty=@BidQty,
		LongDescr=@LongDescr,
		CostCategory=@CostCategory,
		OutsideRepair=@OutsideRepair,
		ReqForJobTrack=@ReqForJobTrack 
		WHERE DOCKETID=@DocketId AND DOCKETJOBID=@DocketJobId AND DOCKETSUBJOBID=@DocketSubJobId

		UPDATE DD_Docket_RFQ_SubJobs 
			   SET  SUBJOBNAME=@SubJobName, 
					Unit = @Unit,
					AttachmentName=@AttachmentName,
					Attachment=@Attachment, 
					BidQty=@BidQty,
					LongDescr=@LongDescr,
					CostCategory=@CostCategory,
					OutsideRepair=@OutsideRepair,
					ReqForJobTrack=@ReqForJobTrack 
		WHERE DocketId=@DocketId AND DocketJobId=@DocketJobId AND DocketSubJobId=@DocketSubJobId

   END
			
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdatePO]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdatePO]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'		      
CREATE PROC [dbo].[DD_UpdatePO]
(
    @RFQId bigint,
	@DocketId bigint,
	@DocketJobId bigint,
    @DocketSubJobId bigint,
	@POQty numeric(18,2),
	@UnitPrice numeric(18,2),
	@PODiscountPer numeric(18,2)
)
AS
BEGIN
     DECLARE @GrossAmount numeric(18,2)
	 DECLARE @NetAmount numeric(18,2) 

	 DECLARE @CURR CHAR(3)
	 DECLARE @CREATEDON SMALLDATETIME
	 DECLARE @EXEC_RATE FLOAT
	 SELECT @CURR=CURRENCY,@CREATEDON=CREATEDON,@EXEC_RATE=ExchRate FROM DD_Docket_RFQ_Master WHERE RFQID=@RFQId
	 IF(@EXEC_RATE=0)
		SET @EXEC_RATE=1
	 
	 SET @GrossAmount = (@POQty * @UnitPrice);
	 SET @NetAmount = @GrossAmount - (@GrossAmount * (@PODiscountPer/100));
  
         UPDATE DD_Docket_RFQ_SubJobs
				SET POQty=@POQty,				  
					PODiscountPer=@PODiscountPer,
					POGrossAmount=@GrossAmount,
					PONetAmount= @NetAmount,
					POUnitPrice_USD=ROUND(@UnitPrice/@EXEC_RATE,2),
					POGrossAmount_USD=ROUND(@GrossAmount/@EXEC_RATE,2),
					PONetAmount_USD=ROUND(@NetAmount/@EXEC_RATE,2)		
					
		 WHERE RFQId = @RFQId AND DocketId=@DocketId AND DocketJobId=@DocketJobId  AND DocketSubJobId=@DocketSubJobId
		 SELECT	
		 PONetAmount ,
		 (SELECT ISNULL(SUM(PONetAmount),0) FROM DD_Docket_RFQ_SubJobs WHERE RFQID=@RFQId AND DOCKETID=@DocketId) as PONetAmount_Total
		 FROM DD_Docket_RFQ_SubJobs WHERE RFQId = @RFQId AND DocketId=@DocketId AND DocketJobId=@DocketJobId  AND DocketSubJobId=@DocketSubJobId
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdateQuote]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdateQuote]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[DD_UpdateQuote]
(
    @RFQId bigint,
	@DocketId bigint,
	@DocketJobId bigint,
    @DocketSubJobId bigint,
	@QuoteQty numeric(18,2),
	@UnitPrice numeric(18,2),
	@DiscountPer numeric(18,2)
)
AS
BEGIN
     DECLARE @GrossAmount numeric(18,2)
	 DECLARE @NetAmount numeric(18,2) 

	 DECLARE @CURR CHAR(3)
	 DECLARE @CREATEDON SMALLDATETIME
	 DECLARE @EXEC_RATE FLOAT
	 SELECT @CURR=CURRENCY,@CREATEDON=CREATEDON FROM DD_Docket_RFQ_Master WHERE RFQID=@RFQId
	 
	 SELECT TOP 1 @EXEC_RATE=EXC_RATE FROM MTMPOS.DBO.XCHANGEDAILY WHERE FOR_CURR=@CURR AND RATEDATE <=@CREATEDON ORDER BY RATEDATE DESC
	 IF(@EXEC_RATE=0)
		SET @EXEC_RATE=1

	 SET @GrossAmount = (@QuoteQty * @UnitPrice);
	 SET @NetAmount = @GrossAmount - (@GrossAmount * (@DiscountPer/100));
  
         UPDATE DD_Docket_RFQ_SubJobs
				SET QuoteQty=@QuoteQty,
				    UnitPrice=@UnitPrice,
					DiscountPer=@DiscountPer,
					GrossAmount=@GrossAmount,
					NetAmount= @NetAmount,
					UnitPrice_USD=ROUND(@UnitPrice/@EXEC_RATE,2),
					GrossAmount_USD=ROUND(@GrossAmount/@EXEC_RATE,2),
					NetAmount_USD=ROUND(@NetAmount/@EXEC_RATE,2)
					
		 WHERE RFQId = @RFQId AND DocketId=@DocketId AND DocketJobId=@DocketJobId  AND DocketSubJobId=@DocketSubJobId
   DECLARE @SUPUpdated char(1)
   SELECT @SUPUpdated=isnull(SUPUpdated,''N'') FROM DD_Docket_RFQ_SubJobs  WHERE RFQId = @RFQId AND DocketId=@DocketId AND DocketJobId=@DocketJobId  AND DocketSubJobId=@DocketSubJobId
   IF(@SUPUpdated <> ''Y'')
   BEGIN
         UPDATE DD_Docket_RFQ_SubJobs
				SET SUPQty=@QuoteQty,				    
					SUPDiscountPer=@DiscountPer,				
					SUPUnitPrice_USD=ROUND(@UnitPrice/@EXEC_RATE,2),
					SUPGrossAmount_USD=ROUND(@GrossAmount/@EXEC_RATE,2),
					SUPNetAmount_USD=ROUND(@NetAmount/@EXEC_RATE,2)
					
		 WHERE RFQId = @RFQId AND DocketId=@DocketId AND DocketJobId=@DocketJobId  AND DocketSubJobId=@DocketSubJobId
   END
		SELECT 	NetAmount FROM DD_Docket_RFQ_SubJobs  WHERE RFQId = @RFQId AND DocketId=@DocketId AND DocketJobId=@DocketJobId  AND DocketSubJobId=@DocketSubJobId

END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdateSUPQuote]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdateSUPQuote]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'




			      
CREATE PROC [dbo].[DD_UpdateSUPQuote]
(
    @RFQId bigint,
	@SUBJOBCODE VARCHAR(50),
	@QuoteQty numeric(18,2),
	@UnitPrice numeric(18,2),
	@DiscountPer numeric(18,2),
	@Remarks VARCHAR(1000)
)
AS
BEGIN
     DECLARE @GrossAmount numeric(18,2)
	 DECLARE @NetAmount numeric(18,2) 

	 DECLARE @DocketSubJobId BIGINT
	 DECLARE @DocketJobId BIGINT
	 DECLARE @DocketId BIGINT

	 DECLARE @CURR CHAR(3)
	 DECLARE @CREATEDON SMALLDATETIME
	 DECLARE @EXEC_RATE FLOAT
	 SELECT @CURR=CURRENCY,@CREATEDON=CREATEDON,@DocketId=DocketId FROM DD_Docket_RFQ_Master WHERE RFQID=@RFQId
	 
	 SELECT @DocketSubJobId=DocketSubJobId,@DocketJobId=DocketJobId FROM DD_Docket_RFQ_SubJobs WHERE RFQId = @RFQId AND LTRIM(RTRIM(SubJobCode))=@SubJobCode

	 --SELECT TOP 1 @EXEC_RATE=EXC_RATE FROM MTMPOS.DBO.XCHANGEDAILY WHERE FOR_CURR=@CURR AND RATEDATE <=@CREATEDON ORDER BY RATEDATE DESC
	 --IF(@EXEC_RATE=0)
		--SET @EXEC_RATE=1

	 SET @GrossAmount = (@QuoteQty * @UnitPrice);
	 SET @NetAmount = @GrossAmount - (@GrossAmount * (@DiscountPer/100));
  
	 IF(LEFT(@SUBJOBCODE,2)=''ZA'')	
	 BEGIN
	 UPDATE 
	 DD_Docket_RFQ_SubJobs 
	 SET [SUPQty]=@QuoteQty,
		[SUPUnitPrice_USD]=@UnitPrice,
		[SUPDiscountPer]=@DiscountPer,
		[SUPGrossAmount_USD]=@GrossAmount,
		[SUPNetAmount_USD]= @NetAmount,
		[SUPUpdated]=''Y'',
		SUPRemarks=@Remarks		
	 WHERE DocketId=@DocketId AND LTRIM(RTRIM(SubJobCode))=@SubJobCode   
	 END
	 ELSE
	 BEGIN
		UPDATE DD_Docket_RFQ_SubJobs
				SET [SUPQty]=@QuoteQty,
				    [SUPUnitPrice_USD]=@UnitPrice,
					[SUPDiscountPer]=@DiscountPer,
					[SUPGrossAmount_USD]=@GrossAmount,
					[SUPNetAmount_USD]= @NetAmount,
					[SUPUpdated]=''Y'',
					SUPRemarks=@Remarks			
		WHERE RFQId = @RFQId AND LTRIM(RTRIM(SubJobCode))=@SubJobCode
	 END
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_UpdateSUPQuote_GETDATA]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UpdateSUPQuote_GETDATA]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROC [dbo].[DD_UpdateSUPQuote_GETDATA]
(
@RFQId bigint,
@SUBJOBCODE VARCHAR(50)
)
AS
BEGIN

    DECLARE @DocketSubJobId BIGINT
    DECLARE @DocketJobId BIGINT

    SELECT @DocketSubJobId=DocketSubJobId,@DocketJobId=DocketJobId FROM DD_Docket_RFQ_SubJobs WHERE RFQId = @RFQId AND LTRIM(RTRIM(SubJobCode))=@SubJobCode


	SELECT SUPNetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE RFQId = @RFQId AND LTRIM(RTRIM(SubJobCode))=@SubJobCode
    SELECT ISNULL(SUM(SUPNetAmount_USD),0) as SUPNetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE RFQID=@RFQId AND DocketJobId=@DocketJobId
    SELECT ISNULL(SUM(SUPNetAmount_USD),0) as SUPNetAmount_USD FROM DD_Docket_RFQ_SubJobs WHERE RFQID=@RFQId AND DocketJobId IN(select docketjobid from DD_Docket_RFQ_Jobs where RFQId=@RFQId and CatId=(SELECT CatId FROM DD_Docket_RFQ_Jobs WHERE DocketJobId=@DocketJobId AND RFQId=@RFQId))
    SELECT ISNULL(SUM(SUPNetAmount_USD),0) FROM DD_Docket_RFQ_SubJobs WHERE RFQID=@RFQId
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[DD_UploadDocument]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_UploadDocument]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[DD_UploadDocument]
(
    @DocumentId bigint,
    @DocketId bigint,
	@DocumentName varchar(500),
	@FileName varchar(50),
	@Attachment image
)
AS
BEGIN

  IF(@DocumentId<=0)
  BEGIN
    SELECT @DocumentId= ISNULL(MAX(DocumentId),0)+1 FROM DD_DocketDocuments
	IF(LTRIM(RTRIM(@FileName))<>'''')
		INSERT INTO DD_DocketDocuments(DocumentId,DocketId,DocumentName,[FileName],Attachment) VALUES(@DocumentId,@DocketId,@DocumentName,@FileName,@Attachment)
	ELSE
		INSERT INTO DD_DocketDocuments(DocumentId,DocketId,DocumentName) VALUES(@DocumentId,@DocketId,@DocumentName)
  END
  ELSE
  BEGIN
	IF(LTRIM(RTRIM(@FileName))<>'''')
		UPDATE DD_DocketDocuments SET DocumentName=@DocumentName,[FileName]=@FileName,Attachment=@Attachment WHERE DocumentId=@DocumentId
	ELSE
		UPDATE DD_DocketDocuments SET DocumentName=@DocumentName WHERE DocumentId=@DocumentId
  END

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_ActiveInactive_Drill]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_ActiveInactive_Drill]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[DT_ActiveInactive_Drill]
	@DrillId bigint
AS
BEGIN
	DECLARE @RECORDTYPE CHAR(1)
	DECLARE @STATUS CHAR(1)
	SELECT @RECORDTYPE=RECORDTYPE,@STATUS=STATUS from DT_DrillMaster WHERE DrillId=@DrillId

	IF(isnull(@STATUS,''I'')=''A'')
		SET @STATUS=''I''
	ELSE
		SET @STATUS=''A''

	IF(@RECORDTYPE=''D'')
	BEGIN
		UPDATE DT_DrillMaster SET STATUS=@STATUS WHERE DrillId=@DrillId
	END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_ActiveInactive_Training]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_ActiveInactive_Training]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

create PROCEDURE [dbo].[DT_ActiveInactive_Training]
	@TrainingId bigint
AS
BEGIN
	DECLARE @RECORDTYPE CHAR(1)
	DECLARE @STATUS CHAR(1)
	SELECT @RECORDTYPE=RECORDTYPE,@STATUS=STATUS from DT_TrainingMaster WHERE TrainingId=@TrainingId

	IF(isnull(@STATUS,''I'')=''A'')
		SET @STATUS=''I''
	ELSE
		SET @STATUS=''A''

	IF(@RECORDTYPE=''T'')
	BEGIN
		UPDATE DT_TrainingMaster SET STATUS=@STATUS WHERE TrainingId=@TrainingId
	END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_AddMatrixTrainings]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_AddMatrixTrainings]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
			      
CREATE PROC [dbo].[DT_AddMatrixTrainings]
(
    @MatrixId bigint,
	@DTId bigint,
	@RecordType char(1),
	@ValidityType char(1),
	@ValidityValue int,
	@Status char(1)
)
AS
BEGIN
   
   IF NOT EXISTS ( SELECT DTId FROM DT_MatrixDetails WHERE MatrixId=@MatrixId AND DTId=@DTId AND RecordType=@RecordType) 
   BEGIN
	INSERT INTO DT_MatrixDetails
    (
        MatrixId,
		DTId,
		RecordType,
		ValidityType,
		ValidityValue,
		[Status]
			     
	)
     VALUES
	(
		@MatrixId,
		@DTId,
		@RecordType,
		@ValidityType,
		@ValidityValue,
		@Status
	)
   END
   ELSE
   BEGIN
         UPDATE DT_MatrixDetails
		    SET  ValidityType=@ValidityType,
				    ValidityValue=@ValidityValue,
					[Status]= @Status
		WHERE MatrixId=@MatrixId AND DTId=@DTId AND RecordType=@RecordType
   END
			
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_AddMatrixTrainingsAttachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_AddMatrixTrainingsAttachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
		      
CREATE PROC [dbo].[DT_AddMatrixTrainingsAttachments]
(
    @MatrixId bigint,
	@DTId bigint,
	@RecordType char(1),
	@ImageText varchar(500)
)
AS
BEGIN
   
IF NOT EXISTS ( SELECT TableId FROM DT_MatrixDetailsAttachments WHERE MatrixId=@MatrixId AND DTId=@DTId AND RecordType=@RecordType AND rtrim(ltrim(ImageText))=rtrim(ltrim(@ImageText))) 
BEGIN
	DECLARE @TABLEID BIGINT
	SELECT @TABLEID=ISNULL(MAX(TABLEID),0)+1 FROM DT_MatrixDetailsAttachments 
	INSERT INTO DT_MatrixDetailsAttachments
    (
		TABLEID,
        MatrixId,
		DTId,
		RecordType,
		ImageText
	)
     VALUES
	(
		@TABLEID,
		@MatrixId,
		@DTId,
		@RecordType,
		@ImageText
	)
END

end

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_CreateMatrix]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_CreateMatrix]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
			      
CREATE PROC [dbo].[DT_CreateMatrix]
(
    @ApplicableDate smalldatetime
)
AS
BEGIN
    
    DECLARE @MatrixId bigint
	DECLARE @LAstMatrixId bigint

	SELECT @MatrixId= ISNULL(MAX(MatrixId),0)+1 FROM DT_MatrixMaster
	
	SELECT TOP 1 @LAstMatrixId= MatrixId from DBO.DT_MATRIXMASTER ORDER BY APPLICABLEDATE DESC

	INSERT INTO DT_MatrixMaster
    (
        MatrixId,
		ApplicableDate
			     
	)
     VALUES
	(
		@MatrixId,
		@ApplicableDate
	)

	INSERT INTO [dbo].[DT_MatrixDetails] SELECT @MatrixId,DTId,RecordType,ValidityType,ValidityValue,[Status] FROM [dbo].[DT_MatrixDetails] WHERE MatrixId = @LAstMatrixId
			
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_Execute]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Execute]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
-- EXEC [DT_Execute] ''LIG'', 4, ''T'', 13, ''03-May-2015'', ''xxx'', 5,5,8,8,13,52,''S'', 14,16,''W'',''xxx'',''03-Sep-2015'', ''xxx''
			      
CREATE PROC [dbo].[DT_Execute]
(
    @VesselCode char(3),
	@DTId bigint,
	@DTRecordType  char(1),
	@DoneId bigint,
	@DoneDate smalldatetime,
	@MasterName varchar(100),	
	@FromHrs int,
	@FromMin int,
	@ToHrs int,
	@ToMin int,
	@Lattitude1 int,
	@Lattitude2 int,
	@Lattitude3 char(1),
	@Longitude1 int,
	@Longitude2 int,
	@Longitude3 char(1),
	@PortName varchar(100),
	@NextDueDate smalldatetime,	
	@DoneBy varchar(50),
	@UpdatedBy varchar(50)
 
)
AS
BEGIN
    
	
	IF (@DoneId=0)
	BEGIN
    DECLARE @LastDueDate smalldatetime

	SELECT @DoneId= ISNULL(MAX(DoneId),0)+1 FROM [dbo].[DT_VSL_DrillTrainingsHistory] WHERE VesselCode=@VesselCode
	SELECT @LastDueDate = [NextDueDate] FROM [dbo].[DT_VSL_DrillTrainings] WHERE VesselCode=@VesselCode AND DTId=@DTId AND RecordType= @DTRecordType
	
	INSERT INTO [DT_VSL_DrillTrainingsHistory]
    (
        VesselCode,
		DTId,
		DTRecordType,
		DoneId,
		DoneDate,
		MasterName,
		FromHrs,
		FromMin,
		ToHrs,
		ToMin,
		Lattitude1,
		Lattitude2,
		Lattitude3,
		Longitude1,
		Longitude2,
		Longitude3,
		PortName,
		RecordType,
		LastDueDate,
		NextDueDate,
		PostPoneDate,
		PostPoneTillDate,
		DoneBy,
		UpdatedBy,
		UpdatedOn
	)
     VALUES
	(
		@VesselCode,
		@DTId,
		@DTRecordType,
		@DoneId,
		@DoneDate,
		@MasterName,
		@FromHrs,
		@FromMin,
		@ToHrs,
		@ToMin,
		@Lattitude1,
		@Lattitude2,
		@Lattitude3,
		@Longitude1,
		@Longitude2,
		@Longitude3,
		@PortName,
		''R'',
		@LastDueDate,
		@NextDueDate,
		null,
		null,
		@DoneBy,
		@UpdatedBy,
		getdate()
	)

	UPDATE  [dbo].[DT_VSL_DrillTrainings]
	SET 
	[LastDueDate] = @LastDueDate,
	DoneDate=@DoneDate,
	NextDueDate=@NextDueDate,
	[PostPoneDate]=null,
	[PostPoneTillDate]=null,
	DoneId=@DoneId,
	PlanDate=NULL,
	Updated=1,
	[UpdatedOn]=getdate()
	WHERE VesselCode=@VesselCode AND DTId=@DTId AND RecordType= @DTRecordType

	END
	ELSE
	BEGIN
	   
		UPDATE [DT_VSL_DrillTrainingsHistory]
		    SET DoneDate=@DoneDate,
			    MasterName=@MasterName,
				FromHrs=@FromHrs,
				FromMin=@FromMin,
				ToHrs=@ToHrs,
				ToMin=@ToMin,
				Lattitude1=@Lattitude1,
				Lattitude2=@Lattitude2,
				Lattitude3=@Lattitude3,
				Longitude1=@Longitude1,
				Longitude2=@Longitude2,
				Longitude3=@Longitude3,
				PortName=@PortName,
				NextDueDate=@NextDueDate,
				DoneBy=@DoneBy,
				UpdatedBy=@UpdatedBy,
				UpdatedOn=getdate()
		WHERE DoneId=@DoneId

		UPDATE  [dbo].[DT_VSL_DrillTrainings]
			SET 
				DoneDate=@DoneDate,
				NextDueDate=@NextDueDate,
				[PostPoneDate]=null,
				[PostPoneTillDate]=null,			
				Updated=1,
			    [UpdatedOn]=getdate()
		WHERE VesselCode=@VesselCode AND DTId=@DTId AND RecordType= @DTRecordType AND DoneId=@DoneId

	END

	SELECT @DoneId
			
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_Import_DrillMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Import_DrillMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[DT_Import_DrillMaster]
(
    @DrillId bigint,
	@DrillName varchar(1000),
	@RecordType  char(1),	 
	@DrillGroupId bigint,	
	@OfficeGuideLines Varchar(Max),	
	@AttachmentFileName varchar(150),
	@Attachment image,
	@Status char(1)
)
AS
BEGIN
    
   IF NOT EXISTS (SELECT DrillId FROM DT_DrillMaster WHERE DrillId=@DrillId)
   BEGIN
	INSERT INTO DT_DrillMaster
    (
        DrillId,
		DrillName,
		RecordType,	 
		DrillGroupId,	
		OfficeGuideLines ,	
		AttachmentFileName ,
		Attachment,
		[Status]
	)
     VALUES
	(
		@DrillId,
		@DrillName,
		@RecordType,	 
		@DrillGroupId,	
		@OfficeGuideLines ,	
		@AttachmentFileName ,
		@Attachment,
		@Status
	)
   END
   ELSE
   BEGIN
	
		UPDATE  DT_DrillMaster
		SET 
		DrillName = @DrillName,
		RecordType=@RecordType,
		DrillGroupId=@DrillGroupId,
		OfficeGuideLines=@OfficeGuideLines,
		AttachmentFileName=@AttachmentFileName,
		Attachment=@Attachment,
		[Status]=@Status
		WHERE DrillId=@DrillId
   
   END		
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_Import_MatrixDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Import_MatrixDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[DT_Import_MatrixDetails]
(
    @MatrixId bigint,
	@DTId bigint,
	@RecordType char(1),
	@ValidityType char(1),
	@ValidityValue int,
	@Status char(1)
)
AS
BEGIN
    
   IF NOT EXISTS (SELECT MatrixId FROM DT_MatrixDetails WHERE MatrixId=@MatrixId AND DTId=@DTId AND RecordType=@RecordType)
   BEGIN
	INSERT INTO DT_MatrixDetails
    (
        MatrixId,
		DTId,
		RecordType,
		ValidityType,
		ValidityValue,
		[Status]
	)
     VALUES
	(
		@MatrixId,
		@DTId,
		@RecordType,
		@ValidityType,
		@ValidityValue,
		@Status
	)
   END
   ELSE
   BEGIN
	
		UPDATE DT_MatrixDetails
		SET 
		    RecordType=@RecordType,
			ValidityType = @ValidityType,
			ValidityValue = @ValidityValue,
			[Status] = @Status
		WHERE MatrixId=@MatrixId AND DTId=@DTId AND RecordType=@RecordType
   
   END		
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_Import_MatrixDetailsAttachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Import_MatrixDetailsAttachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[DT_Import_MatrixDetailsAttachments]
(
    @TableId bigint,
    @MatrixId bigint,
	@DTId bigint,
	@RecordType Char(1),
	@ImageText varchar(500)
)
AS
BEGIN
	INSERT INTO DT_MatrixDetailsAttachments
    (
        TableId,
		MatrixId,
		DTId,
		RecordType,
		ImageText
	)
     VALUES
	(
		@TableId,
		@MatrixId,
		@DTId,
		@RecordType,
		@ImageText
	)
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_Import_MatrixMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Import_MatrixMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[DT_Import_MatrixMaster]
(
    @MatrixId bigint,
	@ApplicableDate SmallDateTime
)
AS
BEGIN
    
   IF NOT EXISTS (SELECT MatrixId FROM DT_MatrixMaster WHERE MatrixId=@MatrixId)
   BEGIN
	INSERT INTO DT_MatrixMaster
    (
        MatrixId,
		ApplicableDate
	)
     VALUES
	(
		@MatrixId,
		@ApplicableDate
	)
   END
   ELSE
   BEGIN
	
		UPDATE  DT_MatrixMaster
		SET 
		ApplicableDate = @ApplicableDate
		WHERE MatrixId=@MatrixId
   
   END		
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryAttachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryAttachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE proc [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryAttachments]
(
	@TableId	bigint,
	@VesselCode	char(3),
	@DoneId	bigint,
	@Description	varchar(500),
	@FileName	varchar(150),
	@Attachment	image
)
AS
BEGIN

IF NOT EXISTS(SELECT DONEID FROM DT_VSL_DrillTrainingHistoryAttachments WHERE VESSELCODE=@VesselCode AND TableId=@TableId)
BEGIN
	INSERT INTO DT_VSL_DrillTrainingHistoryAttachments
	(
	TableId,
	VesselCode	,
	DoneId	,
	[Description]	,
	[FileName]	,
	Attachment	
	)
	VALUES
	(
	@TableId,
	@VesselCode	,
	@DoneId	,
	@Description	,
	@FileName	,
	@Attachment	
	)
END
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'create proc [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryDetails]
(
	@VesselCode	char(3),
	@DoneId	bigint,
	@SrNo	int,
	@Details	varchar(1000),
	@OnTime	smalldatetime
)
AS
BEGIN

IF NOT EXISTS(SELECT DONEID FROM DT_VSL_DrillTrainingHistoryDetails WHERE VESSELCODE=@VesselCode AND DoneId=@DoneId AND SrNo=@SrNo)
BEGIN
	INSERT INTO DT_VSL_DrillTrainingHistoryDetails
	(
	VesselCode,
	DoneId,
	SrNo,
	Details,
	OnTime
	)
	VALUES
	(
	@VesselCode,
	@DoneId,
	@SrNo,
	@Details,
	@OnTime
	)
END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryRanks]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryRanks]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'create proc [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingHistoryRanks]
(
	@VesselCode	char(3),
	@DoneId	bigint,
	@CrewNumber	varchar(10),
	@CrewName	varchar(100),
	@RankName	varchar(100),
	@Present	bit
)
AS
BEGIN

IF NOT EXISTS(SELECT DONEID FROM DT_VSL_DrillTrainingHistoryRanks WHERE VESSELCODE=@VesselCode AND DoneId=@DoneId AND CrewNumber=@CrewNumber)
BEGIN
	INSERT INTO DT_VSL_DrillTrainingHistoryRanks
	(
	VesselCode,
	DoneId,
	CrewNumber,
	CrewName,
	RankName,
	Present
	)
	VALUES
	(
	@VesselCode,
	@DoneId,
	@CrewNumber,
	@CrewName,
	@RankName,
	@Present
	)
END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainings]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainings]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'create proc [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainings]
(
	@VesselCode	char(3),
	@DTId	bigint,
	@RecordType	char(1),
	@LastDueDate	smalldatetime,
	@DoneDate	smalldatetime,
	@NextDueDate	smalldatetime,
	@PlanDate	smalldatetime,
	@PostPoneDate	smalldatetime,
	@PostPoneTillDate	smalldatetime,
	@DoneId	bigint,
	@DoneBy	varchar(50),
	@Updated	bit,
	@UpdatedOn	smalldatetime
)
AS
BEGIN

IF NOT EXISTS(SELECT DONEID FROM DT_VSL_DrillTrainings WHERE VESSELCODE=@VesselCode AND DTId=@DTId AND RecordType=@RecordType)
BEGIN
	INSERT INTO DT_VSL_DrillTrainings
	(
	VesselCode,
	DTId,
	RecordType,
	LastDueDate,
	DoneDate,
	NextDueDate,
	PlanDate,
	PostPoneDate,
	PostPoneTillDate,
	DoneId,
	DoneBy,
	Updated,
	UpdatedOn
	)
	VALUES
	(
	@VesselCode,
	@DTId,
	@RecordType,
	@LastDueDate,
	@DoneDate,
	@NextDueDate,
	@PlanDate,
	@PostPoneDate,
	@PostPoneTillDate,
	@DoneId,
	@DoneBy,
	@Updated,
	@UpdatedOn
	)
END
ELSE
BEGIN

	UPDATE DT_VSL_DrillTrainings
	SET 
		LastDueDate=@LastDueDate,
		DoneDate=@DoneDate,
		NextDueDate=@NextDueDate,
		PlanDate=@PlanDate,
		PostPoneDate=@PostPoneDate,
		PostPoneTillDate=@PostPoneTillDate,
		DoneId=@DoneId,
		DoneBy=@DoneBy,
		Updated=@Updated,
		UpdatedOn=@UpdatedOn
	WHERE VESSELCODE=@VesselCode AND DTId=@DTId AND RecordType=@RecordType
END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingsHistory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingsHistory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE proc [dbo].[DT_IMPORT_OFC_DT_VSL_DrillTrainingsHistory]
(
@VesselCode	char(3),
@DTId	bigint,
@DTRecordType	char(1),
@DoneId	bigint,
@DoneDate	smalldatetime,
@RecordType	char(1),
@MasterName	varchar(100),
@FromHrs	int,
@FromMin	int,
@ToHrs	int,
@ToMin	int,
@Lattitude1	int,
@Lattitude2	int,
@Lattitude3	char(1),
@Longitude1	int,
@Longitude2	int,
@Longitude3	char(1),
@PortName	varchar(100),
@LastDueDate	smalldatetime,
@NextDueDate	smalldatetime,
@PostPoneDate	smalldatetime,
@PostPoneTillDate	smalldatetime,
@DoneBy	varchar(50),
@Imp_Comment	varchar(5000),
@Imp_CorrectiveAction	varchar(5000),
@OfficeRemarksBy varchar(100),
@OfficeRemarks	varchar(MAX),
@OfficeRemarksOn	smalldatetime,
@UpdatedBy	varchar(50),
@UpdatedOn	smalldatetime,
@ExportedBy	varchar(50),
@ExportedOn	smalldatetime,
@OfficeRecOn	smalldatetime
)
AS
BEGIN

IF NOT EXISTS(SELECT DONEID FROM DT_VSL_DrillTrainingsHistory WHERE VESSELCODE=@VesselCode AND DoneId=@DoneId)
BEGIN
	INSERT INTO DT_VSL_DrillTrainingsHistory
	(
	VesselCode,
	DTId,
	DTRecordType,
	DoneId,
	DoneDate,
	RecordType,
	MasterName,
	FromHrs,
	FromMin,
	ToHrs,
	ToMin,
	Lattitude1,
	Lattitude2,
	Lattitude3,
	Longitude1,
	Longitude2,
	Longitude3,
	PortName,
	LastDueDate,
	NextDueDate,
	PostPoneDate,
	PostPoneTillDate,
	DoneBy,
	Imp_Comment,
	Imp_CorrectiveAction,
	OfficeRemarksBy,
	OfficeRemarks,
	OfficeRemarksOn,
	UpdatedBy,
	UpdatedOn,
	ExportedBy,
	ExportedOn,
	OfficeRecOn
	)
	VALUES
	(
	@VesselCode,
	@DTId,
	@DTRecordType,
	@DoneId,
	@DoneDate,
	@RecordType,
	@MasterName,
	@FromHrs,
	@FromMin,
	@ToHrs,
	@ToMin,
	@Lattitude1,
	@Lattitude2,
	@Lattitude3,
	@Longitude1,
	@Longitude2,
	@Longitude3,
	@PortName,
	@LastDueDate,
	@NextDueDate,
	@PostPoneDate,
	@PostPoneTillDate,
	@DoneBy,
	@Imp_Comment,
	@Imp_CorrectiveAction,
	@OfficeRemarksBy,
	@OfficeRemarks,
	@OfficeRemarksOn,
	@UpdatedBy,
	@UpdatedOn,
	@ExportedBy,
	@ExportedOn,
	getdate()
	)
END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_Import_OfficeAck]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Import_OfficeAck]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
Create PROC [dbo].[DT_Import_OfficeAck]
(
    @VesselCode char(3),
	@DoneId bigint,
	@OfficeRecOn smalldatetime,
	@OfficeRemarksBy varchar(100),
	@OfficeRemarks Varchar(Max),
	@OfficeRemarksOn smalldatetime
)
AS
BEGIN
    
	UPDATE DT_VSL_DrillTrainingsHistory
	SET  
	     OfficeRecOn=@OfficeRecOn,
		 OfficeRemarksBy=@OfficeRemarksBy,
		 OfficeRemarks=@OfficeRemarks,
		 OfficeRemarksOn=@OfficeRemarksOn

	WHERE VesselCode=@VesselCode AND DoneId=@DoneId
   
   	
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_Import_TrainingMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_Import_TrainingMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[DT_Import_TrainingMaster]
(
    @TrainingId bigint,
	@TraininingName varchar(1000),
	@RecordType  char(1),	 
	@TrainingGroupId bigint,	
	@OfficeGuideLines Varchar(Max),	
	@AttachmentFileName varchar(150),
	@Attachment image,
	@Status char(1)
)
AS
BEGIN
    
   IF NOT EXISTS (SELECT TrainingId FROM DT_TrainingMaster WHERE TrainingId=@TrainingId)
   BEGIN
	INSERT INTO DT_TrainingMaster
    (
        TrainingId,
		TraininingName,
		RecordType,	 
		TrainingGroupId,	
		OfficeGuideLines ,	
		AttachmentFileName ,
		Attachment,
		[Status]
	)
     VALUES
	(
		@TrainingId,
		@TraininingName,
		@RecordType,	 
		@TrainingGroupId,	
		@OfficeGuideLines ,	
		@AttachmentFileName ,
		@Attachment,
		@Status
	)
   END
   ELSE
   BEGIN
	
		UPDATE  DT_TrainingMaster
		SET 
		TraininingName = @TraininingName,
		RecordType=@RecordType,
		TrainingGroupId=@TrainingGroupId,
		OfficeGuideLines=@OfficeGuideLines,
		AttachmentFileName=@AttachmentFileName,
		Attachment=@Attachment,
		[Status]=@Status
		WHERE TrainingId=@TrainingId
   
   END		
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryAttachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryAttachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


			      
CREATE PROC [dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryAttachments]
(
    @VesselCode char(3),
	@DoneId bigint,
	@Description varchar(500),
	@FileName varchar(150),
	@Attachment Image
)
AS
BEGIN
    
   
    DECLARE @TableId bigint

	SELECT @TableId=ISNULL(MAX(TableId),0)+1 FROM [dbo].[DT_VSL_DrillTrainingHistoryAttachments] WHERE [VesselCode] =@VesselCode
    
	INSERT INTO [dbo].[DT_VSL_DrillTrainingHistoryAttachments]
    (
		TableId,
        VesselCode,
		DoneId,
		[Description],
		[FileName],
		Attachment
	)
     VALUES
	(
		@TableId,
		@VesselCode,
		@DoneId,
		@Description,
		@FileName,
		@Attachment
	)

	
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


			      
CREATE PROC [dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryDetails]
(
    @VesselCode char(3),
	@DoneId bigint,
	@OldSrNo int,
	@SrNo int,
	@Details varchar(1000),
	@OnTime smalldatetime
)
AS
BEGIN
    IF EXISTS(SELECT DONEID FROM DT_VSL_DrillTrainingHistoryDetails WHERE VesselCode=@VesselCode AND DoneId=@DoneId AND SrNo=@OldSrNo)
	BEGIN
		UPDATE DT_VSL_DrillTrainingHistoryDetails
		SET
		SrNo=@SrNo,
		Details=@Details,
		OnTime=@OnTime 
		WHERE VesselCode=@VesselCode AND DoneId=@DoneId AND SrNo=@OldSrNo
	END
	ELSE
	BEGIN
		INSERT INTO [dbo].[DT_VSL_DrillTrainingHistoryDetails]
		(
			VesselCode,
			DoneId,
			SrNo,
			Details,
			OnTime 
		)
		 VALUES
		(
			@VesselCode,
			@DoneId,
			@SrNo,
			@Details,
			@OnTime
		)
	END
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryRanks]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryRanks]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[DT_InsertUpdate_VSL_DrillTrainingHistoryRanks]
(
	@VesselCode char(3),
    @DoneId bigint,    
	@CrewNumber varchar(10),
	@CrewName varchar(100),
	@RankName varchar(100),
	@Present bit
)

AS

BEGIN
IF EXISTS(SELECT * FROM [dbo].[DT_VSL_DrillTrainingHistoryRanks] WHERE VesselCode=@VesselCode AND DoneId=@DoneId AND CrewNumber=@CrewNumber)
BEGIN
	UPDATE [dbo].[DT_VSL_DrillTrainingHistoryRanks]
	SET CrewName=@CrewName,RankName=@RankName,Present=@Present
	WHERE VesselCode=@VesselCode AND DoneId=@DoneId AND CrewNumber=@CrewNumber
END
ELSE		
BEGIN
	INSERT INTO [dbo].[DT_VSL_DrillTrainingHistoryRanks]

		(

			VesselCode,

			DoneId,    

			CrewNumber,

			CrewName,

			RankName,

			Present    

			     

		)

		 VALUES

		(

			@VesselCode,

			@DoneId,    

			@CrewNumber,

			@CrewName,

			@RankName,

			@Present  

		)
END
END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_InsertUpdateDrillMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_InsertUpdateDrillMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


			      
CREATE PROC [dbo].[DT_InsertUpdateDrillMaster]
(
    @DrillId bigint,    
	@DrillName varchar(1000),
	@RecordType char(1),
	@DrillGroupId bigint,
	@OfficeGuidelines varchar(max),
	@AttachmentFileName varchar(150),
	@Attachment Image
)
AS
BEGIN

  IF(@DrillId<=0)
  BEGIN
	IF NOT EXISTS(SELECT DRILLID FROM DT_DrillMaster WHERE DrillName=@DrillName AND RecordType=@RecordType)
	BEGIN
		SELECT @DrillId= ISNULL(MAX(DrillId),0)+1 FROM DT_DrillMaster
		INSERT INTO DT_DrillMaster
		(
			DrillId,    
			DrillName,
			RecordType,		
			DrillGroupId,
			OfficeGuidelines,
			AttachmentFileName,
			Attachment,
			Status    
			     
		)
		 VALUES
		(
			@DrillId,    
			@DrillName,
			@RecordType,
			@DrillGroupId,
			@OfficeGuidelines,
			@AttachmentFileName,
			@Attachment,
			''A''    
		)
		END
   END
   ELSE
   BEGIN
       
         UPDATE DT_DrillMaster 
			SET DrillName = @DrillName,
				RecordType=@RecordType,
				OfficeGuidelines=@OfficeGuidelines,
				DrillGroupId=@DrillGroupId								 
		 WHERE DrillId=@DrillId

		 IF(LTRIM(RTRIM(@AttachmentFileName)) <> '''')
		 BEGIN
				UPDATE DT_DrillMaster 
					SET AttachmentFileName=@AttachmentFileName,
					    Attachment=@Attachment								 
				 WHERE DrillId=@DrillId
		 END

		  
   END
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_InsertUpdateImprovementAndCorrection]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_InsertUpdateImprovementAndCorrection]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


			      
CREATE PROC [dbo].[DT_InsertUpdateImprovementAndCorrection]
(
    @VesselCode char(3),
    @DTId bigint,    
	@DTRecordType char(1),
	@DoneId bigint,	
	@Imp_Comment VARCHAR(5000),
	@Imp_CorrectiveAction varchar(5000)
)
AS
BEGIN

   
    UPDATE [dbo].[DT_VSL_DrillTrainingsHistory] 
	SET Imp_Comment=@Imp_Comment,
		Imp_CorrectiveAction=@Imp_CorrectiveAction
	WHERE VesselCode=@VesselCode AND DTId=@DTId AND DTRecordType=@DTRecordType AND DoneId=@DoneId
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_InsertUpdateTrainingMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_InsertUpdateTrainingMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


			      
CREATE PROC [dbo].[DT_InsertUpdateTrainingMaster]
(
    @TrainingId bigint,    
	@TraininingName varchar(1000),
	@RecordType char(1),	
	@TrainingGroupId bigint,
	@OfficeGuidelines VARCHAR(MAX),
	@AttachmentFileName varchar(150),
	@Attachment Image
)
AS
BEGIN

  IF(@TrainingId<=0)
  BEGIN
	  IF NOT EXISTS(SELECT TRAININGID FROM DT_TrainingMaster WHERE TraininingName=@TraininingName AND RecordType=@RecordType)
	  BEGIN
		SELECT @TrainingId= ISNULL(MAX(TrainingId),0)+1 FROM DT_TrainingMaster
		INSERT INTO DT_TrainingMaster
		(
			TrainingId,    
			TraininingName,
			RecordType,
			TrainingGroupId,
			OfficeGuidelines,
			AttachmentFileName,
			Attachment,
			Status     
			     
		)
		 VALUES
		(
			@TrainingId,    
			@TraininingName,
			@RecordType,
			@TrainingGroupId,
			@OfficeGuidelines,
			@AttachmentFileName,
			@Attachment,
			''A''  
		)
	   END
   END
   ELSE
   BEGIN
         UPDATE DT_TrainingMaster 
			SET TraininingName = @TraininingName,
				RecordType=@RecordType,
				TrainingGroupId=@TrainingGroupId,
				OfficeGuidelines=@OfficeGuidelines
		 WHERE TrainingId=@TrainingId

		 
		 IF(LTRIM(RTRIM(@AttachmentFileName)) <> '''')
		 BEGIN
				UPDATE DT_TrainingMaster 
					SET AttachmentFileName=@AttachmentFileName,
					    Attachment=@Attachment								 
				 WHERE TrainingId=@TrainingId
		 END

   END
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[DT_RESET_DRILL_TRAIINGS]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_RESET_DRILL_TRAIINGS]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
--select * from [dbo].[DT_MatrixMaster]
--select * from [dbo].[DT_MatrixDetails]
--SELECT * FROM [dbo].[DT_DrillMaster]
--SELECT * FROM [dbo].[DT_TrainingMaster]


CREATE PROC [dbo].[DT_RESET_DRILL_TRAIINGS]
(
@VSLCODE CHAR(3),
@MATRIXID BIGINT
)
AS
BEGIN

	DECLARE @MATRIXSTART SMALLDATETIME
	DECLARE @MATRIXEND SMALLDATETIME

	--DECLARE @MATRIXID BIGINT
	--DECLARE @VSLCODE CHAR(3)
	DECLARE @DRILLID BIGINT
	DECLARE @TRAININGID BIGINT
	DECLARE @NEXTDUEDT SMALLDATETIME
	DECLARE @UPDATEDATE BIT

	--SET @VSLCODE=''LIG''
	--SET @MATRIXID=1

	SELECT @MATRIXSTART=APPLICABLEDATE FROM [DT_MatrixMaster] WHERE MATRIXID=@MATRIXID
	SELECT TOP 1 @MATRIXEND=DATEADD(DAY,-1,APPLICABLEDATE) FROM [DT_MatrixMaster] WHERE APPLICABLEDATE>=@MATRIXSTART ORDER BY APPLICABLEDATE

	----++++++++++++++++++++++++++++++++++++++  DRILL UPDATE ++++++++++++++++++++++++++++++++++++++

	DECLARE CS_DRILL CURSOR FOR SELECT DRILLID FROM DT_DrillMaster WHERE RecordType=''D'' -- LAST LEVEL ONLY
	OPEN CS_DRILL
	FETCH NEXT FROM CS_DRILL INTO @DRILLID
	WHILE(@@FETCH_STATUS=0)
	BEGIN
	----
	PRINT GETDATE()

	SET @NEXTDUEDT=NULL
	SET @UPDATEDATE=0
	
	IF EXISTS(SELECT DTID FROM DT_VSL_DrillTrainings WHERE VesselCode=@VSLCODE AND  DTID=@DRILLID AND RECORDTYPE=''D'')
	BEGIN
		----------------------------------
		SELECT @NEXTDUEDT=NEXTDUEDATE FROM DT_VSL_DrillTrainings WHERE VesselCode=@VSLCODE AND DTID=@DRILLID AND RECORDTYPE=''D''
		IF(@MATRIXEND=NULL)
		BEGIN
			IF(@NEXTDUEDT>=@MATRIXSTART) -- RECORD COMES UNDER MODIFIED MATRIX UPDATE NEXT DUE
			BEGIN
				SET @UPDATEDATE=1
			END
		END
		ELSE
		BEGIN
			IF(@NEXTDUEDT>=@MATRIXSTART AND @NEXTDUEDT=@MATRIXEND)
			BEGIN
				SET @UPDATEDATE=1
			END
		END
		----------------------------------
		IF(@UPDATEDATE=1)
		BEGIN
			UPDATE DT_VSL_DrillTrainings SET NEXTDUEDATE=DATEADD(DAY,5,DONEDATE) WHERE VesselCode=@VSLCODE AND DTID=@DRILLID AND RECORDTYPE=''D''
		END
		----------------------------------
	END
	ELSE
	BEGIN
		INSERT INTO DT_VSL_DrillTrainings(VesselCode,DTId,RecordType,Updated,UpdatedOn)
		VALUES(@VSLCODE,@DRILLID,''D'',1,GETDATE())
	END
	----
	FETCH NEXT FROM CS_DRILL INTO @DRILLID
	END
	CLOSE CS_DRILL
	DEALLOCATE CS_DRILL

	----++++++++++++++++++++++++++++++++++++++  TRAINING UPDATE ++++++++++++++++++++++++++++++++++++++

	DECLARE CS_TRAINING CURSOR FOR SELECT TRAININGID FROM DT_TrainingMaster WHERE RecordType=''T'' -- LAST LEVEL ONLY
	OPEN CS_TRAINING
	FETCH NEXT FROM CS_TRAINING INTO @TRAININGID
	WHILE(@@FETCH_STATUS=0)
	BEGIN
	----
	PRINT GETDATE()

	SET @NEXTDUEDT=NULL
	SET @UPDATEDATE=0

	IF EXISTS(SELECT DTID FROM DT_VSL_DrillTrainings WHERE VesselCode=@VSLCODE AND  DTID=@TRAININGID AND RECORDTYPE=''T'')
	BEGIN
		----------------------------------
		SELECT @NEXTDUEDT=NEXTDUEDATE FROM DT_VSL_DrillTrainings WHERE VesselCode=@VSLCODE AND DTID=@TRAININGID AND RECORDTYPE=''T''
		IF(@MATRIXEND=NULL)
		BEGIN
			IF(@NEXTDUEDT>=@MATRIXSTART) -- RECORD COMES UNDER MODIFIED MATRIX UPDATE NEXT DUE
			BEGIN
				SET @UPDATEDATE=1
			END
		END
		ELSE
		BEGIN
			IF(@NEXTDUEDT>=@MATRIXSTART AND @NEXTDUEDT=@MATRIXEND)
			BEGIN
				SET @UPDATEDATE=1
			END
		END
		----------------------------------
		IF(@UPDATEDATE=1)
		BEGIN
			UPDATE DT_VSL_DrillTrainings SET NEXTDUEDATE=DATEADD(DAY,5,DONEDATE) WHERE VesselCode=@VSLCODE AND DTID=@TRAININGID AND RECORDTYPE=''T''
		END
		----------------------------------
	END
	ELSE
	BEGIN
		INSERT INTO DT_VSL_DrillTrainings(VesselCode,DTId,RecordType,Updated,UpdatedOn)
		VALUES(@VSLCODE,@TRAININGID,''T'',1,GETDATE())
	END
	----
	FETCH NEXT FROM CS_TRAINING INTO @TRAININGID	
	END	
	CLOSE CS_TRAINING
	DEALLOCATE CS_TRAINING

END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[Accident_IMPORT_Accident_Report]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Accident_IMPORT_Accident_Report]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[Accident_IMPORT_Accident_Reportssss]
(
	@ReportId bigint,
	@ReportNo varchar(50),
	@VesselCode varchar(3) ,
	@AreaAudited varchar(255),
	@AreaAuditedOther varchar(50),
	@AuditType varchar(3),
	@AuditValue varchar(255),
	@AuditValueOther varchar(255),
	@NonConformanceDes varchar(max),
	@NCRMaker varchar(255),
	@NCRCreatedDate smalldatetime,
	@NCRMakerPos varchar(255),
	@PersonRecvNCR varchar(255),
	@RankRecvNCR varchar(255),
	@NameofGeneralManager varchar(255),
	@NCRTargetCompDate smalldatetime,
	@ImmediateCorrectiveAction varchar(max),
	@IMCName varchar(255),
	@IMCCompletedDate smalldatetime,
	@IMCRanck varchar(255),
	@RootCause varchar(500),
	@OhterRootCause varchar(max),
	@PreventivAction varchar(max),
	@CREATEDBY varchar(50),
	@CREATEDON smalldatetime,
	@UPDATED bit,
	@UPDATEDON smalldatetime,
	@EXPORTEDBY varchar(50),
	@EXPORTEDON smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
IF(NOT EXISTS(SELECT * FROM ER_G118_Report WHERE VESSELCODE=@VESSELCODE AND REPORTID=@REPORTID ))
BEGIN
	INSERT INTO ER_G118_Report
	(
		ReportId,
		ReportNo,
		VesselCode,
		AreaAudited,
		AreaAuditedOther,
		AuditType,
		AuditValue,
		AuditValueOther,
		NonConformanceDes,
		NCRMaker,
		NCRCreatedDate,
		NCRMakerPos,
		PersonRecvNCR,
		RankRecvNCR,
		NameofGeneralManager,
		NCRTargetCompDate,
		ImmediateCorrectiveAction,
		IMCName,
		IMCCompletedDate,
		IMCRanck,
		RootCause,
		OhterRootCause,
		PreventivAction,
		CREATEDBY ,
		CREATEDON ,
		UPDATED ,
		UPDATEDON ,
		EXPORTEDBY ,
		EXPORTEDON 
	)
	Values
	(
		@ReportId,
		@ReportNo,
		@VesselCode,
		@AreaAudited,
		@AreaAuditedOther,
		@AuditType,
		@AuditValue,
		@AuditValueOther,
		@NonConformanceDes,
		@NCRMaker,
		@NCRCreatedDate,
		@NCRMakerPos,
		@PersonRecvNCR,
		@RankRecvNCR,
		@NameofGeneralManager,
		@NCRTargetCompDate,
		@ImmediateCorrectiveAction,
		@IMCName,
		@IMCCompletedDate,
		@IMCRanck,
		@RootCause,
		@OhterRootCause,
		@PreventivAction,
		@CREATEDBY,
		@CREATEDON,
		@UPDATED,
		@UPDATEDON,
		@EXPORTEDBY,
		@EXPORTEDON 
	)
END
ELSE
BEGIN
	UPDATE ER_G118_Report
	SET 
		ReportNo=@ReportNo,
		AreaAudited=@AreaAudited,
		AreaAuditedOther=@AreaAuditedOther,
		AuditType=@AuditType,
		AuditValue=@AuditValue,
		AuditValueOther=@AuditValueOther,
		NonConformanceDes=@NonConformanceDes,
		NCRMaker=@NCRMaker,
		NCRCreatedDate=@NCRCreatedDate,
		NCRMakerPos=@NCRMakerPos,
		PersonRecvNCR=@PersonRecvNCR,
		RankRecvNCR=@RankRecvNCR,
		NameofGeneralManager=@NameofGeneralManager,
		NCRTargetCompDate=@NCRTargetCompDate,
		IMCName=@IMCName,
		IMCCompletedDate=@IMCCompletedDate,
		IMCRanck=@IMCRanck,
		RootCause=@RootCause,
		OhterRootCause=@OhterRootCause,
		PreventivAction=@PreventivAction,
		CREATEDBY=@CREATEDBY,
		CREATEDON=@CREATEDON,
		UPDATED=@UPDATED,
		UPDATEDON=@UPDATEDON,
		EXPORTEDBY=@EXPORTEDBY,
		EXPORTEDON=@EXPORTEDON 
	WHERE VESSELCODE=@VESSELCODE AND REPORTID=@REPORTID
END

END' 
END
GO
/****** Object:  StoredProcedure [dbo].[Accident_IMPORT_Accident_Report_Office]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Accident_IMPORT_Accident_Report_Office]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[Accident_IMPORT_Accident_Report_Office]
(
	@REPORTID bigint,
	@VESSELCODE char(3),
	@OfficeComment varchar(MAX),
	@OfficeCommentVarefiedBy varchar(255),
	@OfficeCommentVarefiedDate smalldatetime,
	@VerifiedPersonPOS varchar(255),
	@IS_CLOSED char(1),
	@ClosureDate smalldatetime,
	@ClosureRemarks varchar(max),
	@ClosureEvidence varchar(255),
	@CloserFile iMAGE,
	@ClosedBy varchar(255),
	@ClosedOn smalldatetime,
	@IS_CLOSURE_NOTIFIED char(1),
	@NOTIFYDATE smalldatetime,
	@CREATEDBY varchar(50),
	@CREATEDON smalldatetime,
	@UPDATED bit,
	@UPDATEDON smalldatetime,
	@STATUS char(1),
	@LOCKED char(1)
)
AS
BEGIN
SET NOCOUNT ON

IF NOT EXISTS(SELECT * FROM  ER_G118_Report_Office WHERE VESSELCODE=@VESSELCODE AND REPORTID = @REPORTID)
BEGIN
	INSERT INTO ER_G118_Report_Office
	(
		REPORTID ,
		VESSELCODE ,
		OfficeComment,
		OfficeCommentVarefiedBy,
		OfficeCommentVarefiedDate,
		VerifiedPersonPOS,
		IS_CLOSED,
		ClosureDate,
		ClosureRemarks,
		ClosureEvidence,
		CloserFile,
		ClosedBy,
		ClosedOn,
		IS_CLOSURE_NOTIFIED ,
		NOTIFYDATE ,
		CREATEDBY ,
		CREATEDON ,
		UPDATED ,
		UPDATEDON ,
		STATUS ,
		LOCKED  
	)
	Values
	(
		@REPORTID,
		@VESSELCODE,
		@OfficeComment,
		@OfficeCommentVarefiedBy,
		@OfficeCommentVarefiedDate,
		@VerifiedPersonPOS,
		@IS_CLOSED,
		@ClosureDate,
		@ClosureRemarks,
		@ClosureEvidence,
		@CloserFile,
		@ClosedBy,
		@ClosedOn,
		@IS_CLOSURE_NOTIFIED,
		@NOTIFYDATE,
		@CREATEDBY,
		@CREATEDON,
		@UPDATED,
		@UPDATEDON,
		@STATUS,
		@LOCKED
	)
END
ELSE
BEGIN
	 UPDATE ER_G118_Report_Office
	 SET	OfficeComment=@OfficeComment,
			OfficeCommentVarefiedBy=@OfficeCommentVarefiedBy,
			OfficeCommentVarefiedDate=@OfficeCommentVarefiedDate,
			VerifiedPersonPOS=@VerifiedPersonPOS,
			IS_CLOSED=@IS_CLOSED,
			ClosureDate=@ClosureDate,
			ClosureRemarks=@ClosureRemarks,
			ClosureEvidence=@ClosureEvidence,
			CloserFile=@CloserFile,
			ClosedBy=@ClosedBy,
			ClosedOn=@ClosedOn,
			IS_CLOSURE_NOTIFIED=@IS_CLOSURE_NOTIFIED,
			NOTIFYDATE=@NOTIFYDATE,
			CREATEDBY=@CREATEDBY,
			CREATEDON=@CREATEDON,
			UPDATED=@UPDATED,
			UPDATEDON=@UPDATEDON,
			STATUS=@STATUS,
			LOCKED=@LOCKED
	  WHERE VESSELCODE=@VESSELCODE AND REPORTID = @REPORTID
END
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_G118_InsertUpdate_ER_G118_Report]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_G118_InsertUpdate_ER_G118_Report]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[ER_G118_InsertUpdate_ER_G118_Report]
(
    @FORMNO  Varchar(50),
	@ReportId bigint,
	@ReportNo varchar(50),
	@VesselCode varchar(3) ,
	@AreaAudited varchar(255),
	@AreaAuditedOther varchar(50),
	@AuditType varchar(3),
	@AuditValue varchar(255),
	@AuditValueOther varchar(255),
	@NonConformanceDes varchar(max),
	@NCRMaker varchar(255),
	@NCRCreatedDate smalldatetime,
	@NCRMakerPos varchar(255),
	@PersonRecvNCR varchar(255),
	@RankRecvNCR varchar(255),
	@NameofGeneralManager varchar(255),
	@NCRTargetCompDate smalldatetime,
	@ImmediateCorrectiveAction varchar(max),
	@IMCName varchar(255),
	@IMCCompletedDate smalldatetime,
	@IMCRanck varchar(255),
	@RootCause varchar(500),
	@OhterRootCause varchar(max),
	@PreventivAction varchar(max),
	@CREATEDBY varchar(50),
	@UPDATEDBY varchar(50)
)
AS
BEGIN
SET NOCOUNT ON
IF(NOT EXISTS(SELECT * FROM ER_G118_Report WHERE REPORTID=@REPORTID))
BEGIN

	SELECT @REPORTID = ISNULL(Max(REPORTID), 0) + 1 FROM ER_G118_Report WHERE VesselCode = @VesselCode
	DECLARE @YR CHAR(4)
	SET @YR=YEAR(GETDATE())
	SELECT @REPORTNO = @VESSELCODE + ''/'' + cast(year(getdate()) AS varchar) + ''/'' + @FORMNO + ''-'' + REPLACE(str(ISNULL(max(RIGHT(ReportNo, 3)), 0)+1,3),'' '', ''0'') 
	FROM ER_G118_Report WHERE RIGHT(LEFT(ReportNo,8),4)=@YR AND VesselCode = @VesselCode
	 
	INSERT INTO ER_G118_Report
	(
		ReportId,
		ReportNo ,
		VesselCode  ,
		AreaAudited ,
		AreaAuditedOther,
		AuditType ,
		AuditValue ,
		AuditValueOther ,
		NonConformanceDes ,
		NCRMaker ,
		NCRCreatedDate,
		NCRMakerPos ,
		PersonRecvNCR ,
		RankRecvNCR ,
		NameofGeneralManager ,
		NCRTargetCompDate ,
		ImmediateCorrectiveAction ,
		IMCName ,
		IMCCompletedDate ,
		IMCRanck ,
		RootCause ,
		OhterRootCause ,
		PreventivAction,
		CREATEDBY ,
		CREATEDON ,
		UPDATED ,
		UPDATEDON  
		
	
	)
	Values
	(
		@ReportId,
		@ReportNo ,
		@VesselCode  ,
		@AreaAudited ,
		@AreaAuditedOther,
		@AuditType ,
		@AuditValue ,
		@AuditValueOther ,
		@NonConformanceDes ,
		@NCRMaker ,
		@NCRCreatedDate,
		@NCRMakerPos ,
		@PersonRecvNCR ,
		@RankRecvNCR ,
		@NameofGeneralManager ,
		@NCRTargetCompDate ,
		@ImmediateCorrectiveAction ,
		@IMCName ,
		@IMCCompletedDate ,
		@IMCRanck ,
		@RootCause ,
		@OhterRootCause ,
		@PreventivAction,
		@CREATEDBY,
		getdate(),
		1,
		getdate()
	)
END
ELSE
BEGIN
	UPDATE ER_G118_Report
	SET 
	    AreaAudited=@AreaAudited ,
		AreaAuditedOther=@AreaAuditedOther,
		AuditType=@AuditType ,
		AuditValue=@AuditValue ,
		AuditValueOther=@AuditValueOther ,
		NonConformanceDes=@NonConformanceDes ,
		NCRMaker=@NCRMaker,
		NCRCreatedDate=@NCRCreatedDate,
		NCRMakerPos=@NCRMakerPos,
		PersonRecvNCR=@PersonRecvNCR ,
		RankRecvNCR=@RankRecvNCR,
		NameofGeneralManager=@NameofGeneralManager ,
		NCRTargetCompDate=@NCRTargetCompDate ,
		ImmediateCorrectiveAction=@ImmediateCorrectiveAction ,
		IMCName=@IMCName ,
		IMCCompletedDate=@IMCCompletedDate ,
		IMCRanck=@IMCRanck,
		RootCause=@RootCause ,
		OhterRootCause=@OhterRootCause ,
		PreventivAction=@PreventivAction,
		UPDATED = 1,
		UPDATEDON = getdate()	
	WHERE REPORTID=@REPORTID

	EXEC [dbo].[ER_Insert_ER_Report_UpdationDetails] @FORMNO, @REPORTID, @UPDATEDBY

END

SELECT @REPORTID As REPORTID

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[Accident_InsertUpdate_Accident_Report_Office]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Accident_InsertUpdate_Accident_Report_Office]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[Accident_InsertUpdate_Accident_Report_Office]
(
	@FORMNO VARCHAR(50),
	@REPORTID bigint,
	@VESSELCODE char(3),
	@OfficeComment varchar(MAX),
	@OfficeCommentVarefiedBy varchar(255),
	@OfficeCommentVarefiedDate smalldatetime,
	@VerifiedPersonPOS varchar(255),
	@Is_Closed char(1),
	@ClosureDate smalldatetime,
	@ClosureRemarks varchar(max),
	@ClosureEvidence varchar(255),
	@CloserFile image,
	@ClosedBy varchar(255),
	@IS_CLOSURE_NOTIFIED char(1),
	@NOTIFYDATE smalldatetime,
	@CREATEDBY varchar(50),
	@UPDATEDBY varchar(50)
)
AS
BEGIN
SET NOCOUNT ON

IF NOT EXISTS(SELECT * FROM ER_G118_Report_Office  WHERE  VESSELCODE=@VESSELCODE AND REPORTID = @REPORTID)
BEGIN
	INSERT INTO ER_G118_Report_Office
	(
		REPORTID ,
		VESSELCODE ,
		OfficeComment,
		OfficeCommentVarefiedBy,
		OfficeCommentVarefiedDate,
		VerifiedPersonPOS,
		IS_CLOSED ,
		ClosureDate,
		ClosureRemarks,
		ClosureEvidence,
		CloserFile,
		CLOSEDBY ,
		ClosedOn,
		IS_CLOSURE_NOTIFIED ,
		NOTIFYDATE,
		CREATEDBY,
		CREATEDON,
		UPDATED,
		UPDATEDON,
		[Status],
		Locked 
	)
	Values
	(
		@REPORTID,
		@VESSELCODE,
		@OfficeComment,
		@OfficeCommentVarefiedBy,
		@OfficeCommentVarefiedDate,
		@VerifiedPersonPOS,
		@IS_CLOSED,
		@ClosureDate,
		@ClosureRemarks,
		@ClosureEvidence,
		@CloserFile,
		@CLOSEDBY,
		getdate(),
		@IS_CLOSURE_NOTIFIED,
		@NOTIFYDATE,
		@CREATEDBY,
		getdate(),
		1,
		getdate(),
		''A'',
		''Y''
	)
END
ELSE
BEGIN
      IF(LTRIM(RTRIM(@ClosureEvidence)) <> '''')
	  BEGIN
		  UPDATE ER_G118_Report_Office
		  SET   OfficeComment = @OfficeComment,
				OfficeCommentVarefiedBy = @OfficeCommentVarefiedBy,
				OfficeCommentVarefiedDate = @OfficeCommentVarefiedDate,
				VerifiedPersonPOS = @VerifiedPersonPOS,
				IS_CLOSED=@IS_CLOSED,
				ClosureDate = @ClosureDate,
				ClosureRemarks = @ClosureRemarks,
				ClosureEvidence = @ClosureEvidence,
				CloserFile=@CloserFile,
				CLOSEDBY = @CLOSEDBY,
				IS_CLOSURE_NOTIFIED = @IS_CLOSURE_NOTIFIED ,
				NOTIFYDATE = @NOTIFYDATE,
				UPDATED = 1 ,
				UPDATEDON = getdate()
				WHERE REPORTID = @REPORTID AND VESSELCODE=@VESSELCODE
		END
		ELSE
		BEGIN
			  UPDATE ER_G118_Report_Office
			  SET   OfficeComment = @OfficeComment,
					OfficeCommentVarefiedBy = @OfficeCommentVarefiedBy,
					OfficeCommentVarefiedDate = @OfficeCommentVarefiedDate,
					VerifiedPersonPOS = @VerifiedPersonPOS,
					IS_CLOSED=@IS_CLOSED,
					ClosureDate = @ClosureDate,
					ClosureRemarks = @ClosureRemarks,
					CLOSEDBY = @CLOSEDBY,
					IS_CLOSURE_NOTIFIED = @IS_CLOSURE_NOTIFIED ,
					NOTIFYDATE = @NOTIFYDATE,
					UPDATED = 1 ,
					UPDATEDON = getdate()
					WHERE REPORTID = @REPORTID AND VESSELCODE=@VESSELCODE
		END
			
END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_IMPORT_ER_Report_UpdationDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_IMPORT_ER_Report_UpdationDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ER_IMPORT_ER_Report_UpdationDetails]
(
	@FORMNO VARCHAR(50),
	@ReportId bigint,
	@UpdatedBy varchar(50),
	@UpdatedOn SMALLDATETIME
)
AS
BEGIN
SET NOCOUNT ON

	INSERT INTO ER_Report_UpdationDetails
	(
	    [FORMNO],
		[ReportId],
		[UpdatedBy],
		[UpdatedOn]
	)
	Values
	(
		@FORMNO,
		@ReportId,
		@UpdatedBy,
		@UpdatedOn
	)

END' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_IMPORT_Report_Documents_OfficeShip]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_IMPORT_Report_Documents_OfficeShip]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ER_IMPORT_Report_Documents_OfficeShip]
(
	@DOCID BIGINT,
	@FORMNO VARCHAR(50),
	@VESSELCODE CHAR(3),
	@REPORTID bigint,
	@DESCR varchar(500),
	@FILENAME varchar(500),
	@UPLOADEDBY varchar(50),
	@UPLOADEDON SMALLDATETIME,
	@STATUS	CHAR(1),
	@UPDATED BIT,
	@UPDATEDON SMALLDATETIME,
	@OFFICE_SHIP CHAR(1)
)
AS
BEGIN
	
	IF(@OFFICE_SHIP=''O'')
	BEGIN
		IF NOT EXISTS(SELECT * FROM ER_Report_Documents_Office WHERE VESSELCODE=@VESSELCODE AND REPORTID=@REPORTID AND DOCID=@DOCID)
		BEGIN
			INSERT INTO ER_Report_Documents_Office
			(
			DOCID ,
			VESSELCODE ,
			FORMNO ,
			REPORTID ,
			DESCR ,
			[FILENAME] ,
			UPLOADEDBY ,
			UPLOADEDON ,
			STATUS ,
			UPDATED ,
			UPDATEDON 
			)
			Values
			(
			@DOCID,
			@VESSELCODE ,
			@FORMNO ,
			@REPORTID,
			@DESCR,
			@FILENAME,
			@UPLOADEDBY,
			@UPLOADEDON,
			@STATUS,
			@UPDATED,
			@UPDATEDON
			)
			END
		ELSE
		BEGIN
			UPDATE ER_Report_Documents_Office
			SET 
			DESCR=@DESCR,
			FILENAME=@FILENAME,
			UPLOADEDBY=@UPLOADEDBY,
			UPLOADEDON=@UPLOADEDON,
			STATUS=@STATUS,
			UPDATED=@UPDATED,
			UPDATEDON=@UPDATEDON
			WHERE VESSELCODE=@VESSELCODE AND REPORTID=@REPORTID AND DOCID=@DOCID
		END
	END
	ELSE
	BEGIN
		IF NOT EXISTS(SELECT * FROM ER_Report_Documents_Ship WHERE VESSELCODE=@VESSELCODE AND REPORTID=@REPORTID AND DOCID=@DOCID)
		BEGIN
			INSERT INTO ER_Report_Documents_Ship
			(
			DOCID ,
			VESSELCODE ,
			FORMNO ,
			REPORTID ,
			DESCR ,
			[FILENAME] ,
			UPLOADEDBY ,
			UPLOADEDON ,
			STATUS ,
			UPDATED ,
			UPDATEDON 
			)
			Values
			(
			@DOCID,
			@VESSELCODE ,
			@FORMNO ,
			@REPORTID,
			@DESCR,
			@FILENAME,
			@UPLOADEDBY,
			@UPLOADEDON,
			@STATUS,
			@UPDATED,
			@UPDATEDON
			)
		END
		ELSE
		BEGIN
			UPDATE ER_Report_Documents_Ship
			SET 
			DESCR=@DESCR,
			FILENAME=@FILENAME,
			UPLOADEDBY=@UPLOADEDBY,
			UPLOADEDON=@UPLOADEDON,
			STATUS=@STATUS,
			UPDATED=@UPDATED,
			UPDATEDON=@UPDATEDON
			WHERE VESSELCODE=@VESSELCODE AND REPORTID=@REPORTID AND DOCID=@DOCID
		END
	END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_Insert_ER_Report_UpdationDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_Insert_ER_Report_UpdationDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ER_Insert_ER_Report_UpdationDetails]
(
	@FORMNO VARCHAR(50),
	@ReportId bigint,
	@UpdatedBy varchar(50)
)
AS
BEGIN
SET NOCOUNT ON

	INSERT INTO ER_Report_UpdationDetails
	(
	    [FORMNO],
		[ReportId],
		[UpdatedBy],
		[UpdatedOn]
	)
	Values
	(
		@FORMNO,
		@ReportId,
		@UpdatedBy,
		getdate()

	)

END' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_IMPORT_ER_S115_InjuredCrewDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_IMPORT_ER_S115_InjuredCrewDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ER_S115_IMPORT_ER_S115_InjuredCrewDetails]
(
@TABLEID bigint,
@REPORTID bigint,
@VESSELCODE char(3),
@IS_CREW char(1),
@IP_CrewNo varchar(50),
@IP_NAME varchar(50),
@IP_DOB smalldatetime,
@IP_NATIONALITY_IDNO varchar(50),
@IP_RANK_RATING int,
@IP_SIGNEDONDATE smalldatetime,
@IP_NOOFHRONBOARD float,
@IP_IS_VISITTODOCTOR_NECESSARY char(1),
@IP_ACTIVITY_OD char(1),
@IP_ACTIVITYHOURS float,
@IP_RESTRICTEDWORK char(1),
@IP_MEDICALTREATMENTREQD char(1),
@IP_AREAOFOPERATION int,
@IP_AREAOFOPERATION_OTHER varchar(50),
@IP_TYPEOFINJURY int,
@IP_TYPEOFINJURY_OTHER varchar(50),
@OCI_MI_REPORTING int,
@STATUS CHAR(1),
@UPDATED BIT,
@UPDATEDON SMALLDATETIME
)
AS
BEGIN
SET NOCOUNT ON

IF(NOT EXISTS(SELECT * FROM ER_S115_InjuryToPerson WHERE VESSELCODE=@VESSELCODE AND REPORTID=@REPORTID AND TABLEID=@TABLEID))
BEGIN
	INSERT INTO ER_S115_InjuryToPerson
	(
		TABLEID ,
		REPORTID ,
		VESSELCODE ,
		IS_CREW ,
		IP_CrewNo,
		IP_NAME ,
		IP_DOB ,
		IP_NATIONALITY_IDNO ,
		IP_RANK_RATING ,
		IP_SIGNEDONDATE ,
		IP_NOOFHRONBOARD ,
		IP_IS_VISITTODOCTOR_NECESSARY ,
		IP_ACTIVITY_OD ,
		IP_ACTIVITYHOURS ,
		IP_RESTRICTEDWORK ,
		IP_MEDICALTREATMENTREQD ,
		IP_AREAOFOPERATION ,
		IP_AREAOFOPERATION_OTHER ,
		IP_TYPEOFINJURY ,
		IP_TYPEOFINJURY_OTHER ,
		OCI_MI_REPORTING ,
		[STATUS],
		UPDATED,
		UPDATEDON

	)
	Values
	(
		@TABLEID,
		@REPORTID,
		@VESSELCODE,
		@IS_CREW,
		@IP_CrewNo,
		@IP_NAME,
		@IP_DOB,
		@IP_NATIONALITY_IDNO,
		@IP_RANK_RATING,
		@IP_SIGNEDONDATE,
		@IP_NOOFHRONBOARD,
		@IP_IS_VISITTODOCTOR_NECESSARY,
		@IP_ACTIVITY_OD,
		@IP_ACTIVITYHOURS,
		@IP_RESTRICTEDWORK,
		@IP_MEDICALTREATMENTREQD,
		@IP_AREAOFOPERATION,
		@IP_AREAOFOPERATION_OTHER,
		@IP_TYPEOFINJURY,
		@IP_TYPEOFINJURY_OTHER,
		@OCI_MI_REPORTING,
		''A'',
		@UPDATED,
		@UPDATEDON
	)
END
ELSE
BEGIN
      UPDATE ER_S115_InjuryToPerson
	    SET IS_CREW = @IS_CREW,
		IP_CrewNo = @IP_CrewNo,
		IP_NAME = @IP_NAME,
		IP_DOB = @IP_DOB,
		IP_NATIONALITY_IDNO = @IP_NATIONALITY_IDNO,
		IP_RANK_RATING = @IP_RANK_RATING,
		IP_SIGNEDONDATE = @IP_SIGNEDONDATE,
		IP_NOOFHRONBOARD = @IP_NOOFHRONBOARD,
		IP_IS_VISITTODOCTOR_NECESSARY = @IP_IS_VISITTODOCTOR_NECESSARY,
		IP_ACTIVITY_OD = @IP_ACTIVITY_OD,
		IP_ACTIVITYHOURS = @IP_ACTIVITYHOURS,
		IP_RESTRICTEDWORK = @IP_RESTRICTEDWORK,
		IP_MEDICALTREATMENTREQD = @IP_MEDICALTREATMENTREQD,
		IP_AREAOFOPERATION = @IP_AREAOFOPERATION,
		IP_AREAOFOPERATION_OTHER = @IP_AREAOFOPERATION_OTHER,
		IP_TYPEOFINJURY = @IP_TYPEOFINJURY,
		IP_TYPEOFINJURY_OTHER = @IP_TYPEOFINJURY_OTHER,
		OCI_MI_REPORTING = @OCI_MI_REPORTING,
		STATUS=@STATUS,
		UPDATED=@UPDATED,
		UPDATEDON=@UPDATEDON
		WHERE VESSELCODE=@VESSELCODE AND REPORTID=@REPORTID AND TABLEID=@TABLEID
END

END' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_IMPORT_ER_S115_Report]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_IMPORT_ER_S115_Report]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ER_S115_IMPORT_ER_S115_Report]
(
@REPORTID bigint,
@REPORTNO varchar(50),
@VESSELCODE char(3),
@LATITUDE varchar(50),
@LONGITUDE varchar(50),
@PORT varchar(50),
@REPORTDATE datetime,
@INCIDENTDATE datetime,
@ACCIDENTSEVERITY int,
@ACCIDENTCLASSIFICATION varchar(500),
@EVENTDESCRIPTION varchar(5000),
@ALCOHOL_DRUG_TESTING char(1),
@IS_VESSEL_DELAYED_GI char(1),
@IS_BAD_WEATHER char(1),
@VESSELACTIVITY int,
@IS_RESTRICTED_VISIBILITY char(1),
@Is_BreachOfCP char(1),
@CARGO_CONTAMINATION_DAMAGE char(1),
@CARGO_QTY_INDISPUTE char(1),
@CCD_NAMEOFCHARTERER varchar(50),
@CCD_TYPEOFCARGO varchar(50),
@CCD_TANK_HOLD_NOS varchar(50),
@CCD_TANKCOATING varchar(50),
@CCD_TANKCOATING_OTHER varchar(50),
@CCD_LOADPORT varchar(50),
@CCD_LP_TERMINAL varchar(50),
@CCD_LP_DATE smalldatetime,
@CCD_DISCHARGEPORT varchar(50),
@CCD_DP_TERMINAL varchar(50),
@CCD_DP_DATE smalldatetime,
@CCD_STS_OPERATION char(1),
@CQD_CARGOCONTAMINANT varchar(500),
@CQD_CARGOQTY int,
@CQD_TANKSINSPECTED char(1),
@CQD_WALLWASHTESTDONE char(1),
@NAVIGATION varchar(500),
@ENV_POLLUTION varchar(500),
@ENV_POLLUTION_OTHER varchar(50),
@IS_LOSSTOENV char(1),
@LE_SpillType int,
@LE_CATEGORY varchar(500),
@LE_CATEGORY_OTHER varchar(50),
@INCIDENT_FIRST_OBSEVED_DATE datetime,
@CEASED_OPERATION_DATE datetime,
@REPORTED_TO_AUTHORITY char(1),
@REPORTINGDATE datetime,
@AUTHORITYNAME varchar(50),
@MOORING varchar(500),
@IS_EQUIP_AFFECTED char(1),
@EQUIPMENTS varchar(500),
@IS_DAMAGETOTHIRDPARTY char(1),
@DAMAGETOTHIRDPARTY varchar(50),
@DAMAGETOTHIRDPARTY_OTHER varchar(50),
@IS_DAMAGETOOWNVESSEL char(1),
@DAMAGETOOWNVESSEL int,
@DAMAGETOOWNVESSEL_OTHER varchar(50),
@IS_EXPLOSION char(1),
@EXPLOSIONON varchar(500),
@EXPLOSIONON_OTHER varchar(50),
@SECURITY varchar(500),
@SECURITY_OTHER varchar(50),
@CA_HUMANACTIONS varchar(500),
@CA_HUMANACTIONS_OTHER varchar(50),
@CA_CONDITIONS varchar(500),
@CA_CONDITIONS_OTHER varchar(50),
@RC_HUMANFACTORS varchar(500),
@RC_HUMANFACTORS_OTHER varchar(50),
@RC_JOBFACTORS varchar(500),
@RC_JOBFACTORS_OTHER varchar(50),
@IS_IMMADIATEACTIONTAKEN char(1),
@IA_YES_DESC varchar(500),
@IS_ACTION_RECOMMENDED char(1),
@AR_YES_DESC varchar(500),
@IS_IMMEDIATETRAINING char(1),
@IT_DETAILS varchar(500),
@IS_FURTHERTRAININGREQ char(1),
@FT_DETAILS varchar(500),
@IS_SAFETYMEETING char(1),
@SM_DATE smalldatetime,
@IS_SUPPLEMENTARYINFO char(1),
@SI_DETAILS varchar(500),
@CREATEDBY varchar(50),
@CREATEDON SMALLDATETIME,
@UPDATED BIT,
@UPDATEDON SMALLDATETIME,
@EXPORTEDBY varchar(50),
@EXPORTEDON SMALLDATETIME
)
AS
BEGIN
SET NOCOUNT ON
IF(NOT EXISTS(SELECT * FROM ER_S115_Report WHERE VESSELCODE=@VESSELCODE AND REPORTID=@REPORTID ))
BEGIN
	INSERT INTO ER_S115_Report
	(
	REPORTID ,
	REPORTNO ,
	VESSELCODE ,
	LATITUDE ,
	LONGITUDE ,
	PORT ,
	REPORTDATE ,
	INCIDENTDATE ,
	ACCIDENTSEVERITY ,
	ACCIDENTCLASSIFICATION ,
	EVENTDESCRIPTION ,
	ALCOHOL_DRUG_TESTING ,
	IS_VESSEL_DELAYED_GI ,
	IS_BAD_WEATHER ,
	VESSELACTIVITY ,
	IS_RESTRICTED_VISIBILITY ,
	Is_BreachOfCP,
	CARGO_CONTAMINATION_DAMAGE ,
	CARGO_QTY_INDISPUTE ,
	CCD_NAMEOFCHARTERER ,
	CCD_TYPEOFCARGO ,
	CCD_TANK_HOLD_NOS ,
	CCD_TANKCOATING ,
	CCD_TANKCOATING_OTHER ,
	CCD_LOADPORT ,
	CCD_LP_TERMINAL ,
	CCD_LP_DATE ,
	CCD_DISCHARGEPORT ,
	CCD_DP_TERMINAL ,
	CCD_DP_DATE ,
	CCD_STS_OPERATION ,
	CQD_CARGOCONTAMINANT ,
	CQD_CARGOQTY ,
	CQD_TANKSINSPECTED ,
	CQD_WALLWASHTESTDONE ,
	NAVIGATION ,
	ENV_POLLUTION ,
	ENV_POLLUTION_OTHER ,
	IS_LOSSTOENV ,
	LE_SpillType,
	LE_CATEGORY ,
	LE_CATEGORY_OTHER ,
	INCIDENT_FIRST_OBSEVED_DATE ,
	CEASED_OPERATION_DATE ,
	REPORTED_TO_AUTHORITY ,
	REPORTINGDATE ,
	AUTHORITYNAME ,
	MOORING ,
	IS_EQUIP_AFFECTED ,
	EQUIPMENTS ,
	IS_DAMAGETOTHIRDPARTY ,
	DAMAGETOTHIRDPARTY ,
	DAMAGETOTHIRDPARTY_OTHER ,
	IS_DAMAGETOOWNVESSEL ,
	DAMAGETOOWNVESSEL ,
	DAMAGETOOWNVESSEL_OTHER ,
	IS_EXPLOSION ,
	EXPLOSIONON ,
	EXPLOSIONON_OTHER ,
	SECURITY ,
	SECURITY_OTHER ,
	CA_HUMANACTIONS ,
	CA_HUMANACTIONS_OTHER ,
	CA_CONDITIONS ,
	CA_CONDITIONS_OTHER ,
	RC_HUMANFACTORS ,
	RC_HUMANFACTORS_OTHER ,
	RC_JOBFACTORS ,
	RC_JOBFACTORS_OTHER ,
	IS_IMMADIATEACTIONTAKEN ,
	IA_YES_DESC ,
	IS_ACTION_RECOMMENDED ,
	AR_YES_DESC ,
	IS_IMMEDIATETRAINING ,
	IT_DETAILS ,
	IS_FURTHERTRAININGREQ ,
	FT_DETAILS ,
	IS_SAFETYMEETING ,
	SM_DATE ,
	IS_SUPPLEMENTARYINFO ,
	SI_DETAILS ,
	CREATEDBY ,
	CREATEDON ,
	UPDATED ,
	UPDATEDON ,
	EXPORTEDBY ,
	EXPORTEDON 
	)
	Values
	(
	@REPORTID,
	@REPORTNO,
	@VESSELCODE,
	@LATITUDE,
	@LONGITUDE,
	@PORT,
	@REPORTDATE,
	@INCIDENTDATE,
	@ACCIDENTSEVERITY,
	@ACCIDENTCLASSIFICATION,
	@EVENTDESCRIPTION,
	@ALCOHOL_DRUG_TESTING,
	@IS_VESSEL_DELAYED_GI,
	@IS_BAD_WEATHER,
	@VESSELACTIVITY,
	@IS_RESTRICTED_VISIBILITY,
	@Is_BreachOfCP,
	@CARGO_CONTAMINATION_DAMAGE,
	@CARGO_QTY_INDISPUTE,
	@CCD_NAMEOFCHARTERER,
	@CCD_TYPEOFCARGO,
	@CCD_TANK_HOLD_NOS,
	@CCD_TANKCOATING,
	@CCD_TANKCOATING_OTHER,
	@CCD_LOADPORT,
	@CCD_LP_TERMINAL,
	@CCD_LP_DATE,
	@CCD_DISCHARGEPORT,
	@CCD_DP_TERMINAL,
	@CCD_DP_DATE,
	@CCD_STS_OPERATION,
	@CQD_CARGOCONTAMINANT,
	@CQD_CARGOQTY,
	@CQD_TANKSINSPECTED,
	@CQD_WALLWASHTESTDONE,
	@NAVIGATION,
	@ENV_POLLUTION,
	@ENV_POLLUTION_OTHER,
	@IS_LOSSTOENV,
	@LE_SpillType,
	@LE_CATEGORY,
	@LE_CATEGORY_OTHER,
	@INCIDENT_FIRST_OBSEVED_DATE,
	@CEASED_OPERATION_DATE,
	@REPORTED_TO_AUTHORITY,
	@REPORTINGDATE,
	@AUTHORITYNAME,
	@MOORING,
	@IS_EQUIP_AFFECTED,
	@EQUIPMENTS,
	@IS_DAMAGETOTHIRDPARTY,
	@DAMAGETOTHIRDPARTY,
	@DAMAGETOTHIRDPARTY_OTHER,
	@IS_DAMAGETOOWNVESSEL,
	@DAMAGETOOWNVESSEL,
	@DAMAGETOOWNVESSEL_OTHER,
	@IS_EXPLOSION,
	@EXPLOSIONON,
	@EXPLOSIONON_OTHER,
	@SECURITY,
	@SECURITY_OTHER,
	@CA_HUMANACTIONS,
	@CA_HUMANACTIONS_OTHER,
	@CA_CONDITIONS,
	@CA_CONDITIONS_OTHER,
	@RC_HUMANFACTORS,
	@RC_HUMANFACTORS_OTHER,
	@RC_JOBFACTORS,
	@RC_JOBFACTORS_OTHER,
	@IS_IMMADIATEACTIONTAKEN,
	@IA_YES_DESC,
	@IS_ACTION_RECOMMENDED,
	@AR_YES_DESC,
	@IS_IMMEDIATETRAINING,
	@IT_DETAILS,
	@IS_FURTHERTRAININGREQ,
	@FT_DETAILS,
	@IS_SAFETYMEETING,
	@SM_DATE,
	@IS_SUPPLEMENTARYINFO,
	@SI_DETAILS,
	@CREATEDBY,
	getdate(),
	@UPDATED ,
	@UPDATEDON ,
	@EXPORTEDBY ,
	@EXPORTEDON 
	)
END
ELSE
BEGIN
	UPDATE ER_S115_Report
	SET 
	LATITUDE=@LATITUDE,
	LONGITUDE=@LONGITUDE,
	PORT=@PORT,
	REPORTDATE=@REPORTDATE,
	INCIDENTDATE=@INCIDENTDATE,
	ACCIDENTSEVERITY=@ACCIDENTSEVERITY,
	ACCIDENTCLASSIFICATION=@ACCIDENTCLASSIFICATION,
	EVENTDESCRIPTION=@EVENTDESCRIPTION,
	ALCOHOL_DRUG_TESTING=@ALCOHOL_DRUG_TESTING,
	IS_VESSEL_DELAYED_GI=@IS_VESSEL_DELAYED_GI,
	IS_BAD_WEATHER=@IS_BAD_WEATHER,
	VESSELACTIVITY=@VESSELACTIVITY,
	IS_RESTRICTED_VISIBILITY=@IS_RESTRICTED_VISIBILITY,
	Is_BreachOfCP=@Is_BreachOfCP,
	CARGO_CONTAMINATION_DAMAGE=@CARGO_CONTAMINATION_DAMAGE,
	CARGO_QTY_INDISPUTE=@CARGO_QTY_INDISPUTE,
	CCD_NAMEOFCHARTERER=@CCD_NAMEOFCHARTERER,
	CCD_TYPEOFCARGO=@CCD_TYPEOFCARGO,
	CCD_TANK_HOLD_NOS=@CCD_TANK_HOLD_NOS,
	CCD_TANKCOATING=@CCD_TANKCOATING,
	CCD_TANKCOATING_OTHER=@CCD_TANKCOATING_OTHER,
	CCD_LOADPORT=@CCD_LOADPORT,
	CCD_LP_TERMINAL=@CCD_LP_TERMINAL,
	CCD_LP_DATE=@CCD_LP_DATE,
	CCD_DISCHARGEPORT=@CCD_DISCHARGEPORT,
	CCD_DP_TERMINAL=@CCD_DP_TERMINAL,
	CCD_DP_DATE=@CCD_DP_DATE,
	CCD_STS_OPERATION=@CCD_STS_OPERATION,
	CQD_CARGOCONTAMINANT=@CQD_CARGOCONTAMINANT,
	CQD_CARGOQTY=@CQD_CARGOQTY,
	CQD_TANKSINSPECTED=@CQD_TANKSINSPECTED,
	CQD_WALLWASHTESTDONE=@CQD_WALLWASHTESTDONE,
	NAVIGATION=@NAVIGATION,
	ENV_POLLUTION=@ENV_POLLUTION,
	ENV_POLLUTION_OTHER=@ENV_POLLUTION_OTHER,
	IS_LOSSTOENV=@IS_LOSSTOENV,
	LE_SpillType=@LE_SpillType,
	LE_CATEGORY=@LE_CATEGORY,
	LE_CATEGORY_OTHER=@LE_CATEGORY_OTHER,
	INCIDENT_FIRST_OBSEVED_DATE=@INCIDENT_FIRST_OBSEVED_DATE,
	CEASED_OPERATION_DATE=@CEASED_OPERATION_DATE,
	REPORTED_TO_AUTHORITY=@REPORTED_TO_AUTHORITY,
	REPORTINGDATE=@REPORTINGDATE,
	AUTHORITYNAME=@AUTHORITYNAME,
	MOORING=@MOORING,
	IS_EQUIP_AFFECTED=@IS_EQUIP_AFFECTED,
	EQUIPMENTS=@EQUIPMENTS,
	IS_DAMAGETOTHIRDPARTY=@IS_DAMAGETOTHIRDPARTY,
	DAMAGETOTHIRDPARTY=@DAMAGETOTHIRDPARTY,
	DAMAGETOTHIRDPARTY_OTHER=@DAMAGETOTHIRDPARTY_OTHER,
	IS_DAMAGETOOWNVESSEL=@IS_DAMAGETOOWNVESSEL,
	DAMAGETOOWNVESSEL=@DAMAGETOOWNVESSEL,
	DAMAGETOOWNVESSEL_OTHER=@DAMAGETOOWNVESSEL_OTHER,
	IS_EXPLOSION=@IS_EXPLOSION,
	EXPLOSIONON=@EXPLOSIONON,
	EXPLOSIONON_OTHER=@EXPLOSIONON_OTHER,
	[SECURITY]=@SECURITY,
	SECURITY_OTHER=@SECURITY_OTHER,
	CA_HUMANACTIONS=@CA_HUMANACTIONS,
	CA_HUMANACTIONS_OTHER=@CA_HUMANACTIONS_OTHER,
	CA_CONDITIONS=@CA_CONDITIONS,
	CA_CONDITIONS_OTHER=@CA_CONDITIONS_OTHER,
	RC_HUMANFACTORS=@RC_HUMANFACTORS,
	RC_HUMANFACTORS_OTHER=@RC_HUMANFACTORS_OTHER,
	RC_JOBFACTORS=@RC_JOBFACTORS,
	RC_JOBFACTORS_OTHER=@RC_JOBFACTORS_OTHER,
	IS_IMMADIATEACTIONTAKEN=@IS_IMMADIATEACTIONTAKEN,
	IA_YES_DESC=@IA_YES_DESC,
	IS_ACTION_RECOMMENDED=@IS_ACTION_RECOMMENDED,
	AR_YES_DESC=@AR_YES_DESC,
	IS_IMMEDIATETRAINING=@IS_IMMEDIATETRAINING,
	IT_DETAILS=@IT_DETAILS,
	IS_FURTHERTRAININGREQ=@IS_FURTHERTRAININGREQ,
	FT_DETAILS=@FT_DETAILS,
	IS_SAFETYMEETING=@IS_SAFETYMEETING,
	SM_DATE=@SM_DATE,
	IS_SUPPLEMENTARYINFO=@IS_SUPPLEMENTARYINFO,
	SI_DETAILS=@SI_DETAILS,
	CREATEDBY=@CREATEDBY,
	CREATEDON=@CREATEDON,
	UPDATED=@UPDATED ,
	UPDATEDON=@UPDATEDON ,
	EXPORTEDBY=@EXPORTEDBY ,
	EXPORTEDON=@EXPORTEDON 
	WHERE VESSELCODE=@VESSELCODE AND REPORTID=@REPORTID
END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_IMPORT_ER_S115_Report_Office]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_IMPORT_ER_S115_Report_Office]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ER_S115_IMPORT_ER_S115_Report_Office]
(
@REPORTID bigint,
@VESSELCODE char(3),
@IS_VESSEL_DELAYED char(1),
@VESSELDELAYED_DAYS int,
@VESSELDELAYED_HOURS int,
@POTENTIAL_RECURRENCE int,
@IS_INVESTIGATIONDONE char(1),
@INVESTIGATIONDATE smalldatetime,
@NAMEOFPERSON_ORG varchar(50),
@O_HUMANACTIONS varchar(500),
@O_HUMANACTIONS_OTHER varchar(50),
@O_CONDITIONS varchar(500),
@O_CONDITIONS_OTHER varchar(50),
@O_HUMANFACTORS varchar(500),
@O_HUMANFACTORS_OTHER varchar(50),
@O_JOBFACTORS varchar(500),
@O_JOBFACTORS_OTHER varchar(50),
@ReasonDiffRCA varchar(500),
@IS_FOLLOWUPREQ char(1),
@TARGETDATE smalldatetime,
@FU_DETAILS varchar(500),
@FU_PIC varchar(50),
@SUGGESTIONS varchar(50),
@REMARKS varchar(500),
@IS_CLOSED char(1),
@CLOSEDATE smalldatetime,
@CLOSEDBY varchar(50),
@IS_CLOSURE_NOTIFIED char(1),
@NOTIFYDATE smalldatetime,
@CREATEDBY varchar(50),
@CreatedOn smalldatetime,
@Updated bit,
@UpdatedOn smalldatetime,
@Status char(1),
@Locked char(1)
)
AS
BEGIN
SET NOCOUNT ON

IF NOT EXISTS(SELECT * FROM  ER_S115_Report_Office WHERE VESSELCODE=@VESSELCODE AND REPORTID = @REPORTID)
BEGIN
	INSERT INTO ER_S115_Report_Office
	(
		REPORTID ,
		VESSELCODE ,
		IS_VESSEL_DELAYED ,
		VESSELDELAYED_DAYS ,
		VESSELDELAYED_HOURS ,
		POTENTIAL_RECURRENCE ,
		IS_INVESTIGATIONDONE ,
		INVESTIGATIONDATE ,
		NAMEOFPERSON_ORG ,
		O_HUMANACTIONS ,
		O_HUMANACTIONS_OTHER ,
		O_CONDITIONS ,
		O_CONDITIONS_OTHER ,
		O_HUMANFACTORS ,
		O_HUMANFACTORS_OTHER ,
		O_JOBFACTORS ,
		O_JOBFACTORS_OTHER ,
		ReasonDiffRCA,
		IS_FOLLOWUPREQ ,
		TARGETDATE ,
		FU_DETAILS ,
		FU_PIC ,
		SUGGESTIONS ,
		REMARKS ,
		IS_CLOSED ,
		CLOSEDATE ,
		CLOSEDBY ,
		IS_CLOSURE_NOTIFIED ,
		NOTIFYDATE ,
		CREATEDBY ,
		CREATEDON ,
		UPDATED ,
		UPDATEDON ,
		STATUS,
		Locked 
	)
	Values
	(
		@REPORTID,
		@VESSELCODE,
		@IS_VESSEL_DELAYED,
		@VESSELDELAYED_DAYS,
		@VESSELDELAYED_HOURS,
		@POTENTIAL_RECURRENCE,
		@IS_INVESTIGATIONDONE,
		@INVESTIGATIONDATE,
		@NAMEOFPERSON_ORG,
		@O_HUMANACTIONS,
		@O_HUMANACTIONS_OTHER,
		@O_CONDITIONS,
		@O_CONDITIONS_OTHER,
		@O_HUMANFACTORS,
		@O_HUMANFACTORS_OTHER,
		@O_JOBFACTORS,
		@O_JOBFACTORS_OTHER,
		@ReasonDiffRCA,
		@IS_FOLLOWUPREQ,
		@TARGETDATE,
		@FU_DETAILS,
		@FU_PIC,
		@SUGGESTIONS,
		@REMARKS,
		@IS_CLOSED,
		@CLOSEDATE,
		@CLOSEDBY,
		@IS_CLOSURE_NOTIFIED,
		@NOTIFYDATE,
		@CREATEDBY,
		@CreatedOn,
		@Updated,
		@UpdatedOn ,
		@Status,
		@Locked
	)
END
ELSE
BEGIN
      UPDATE ER_S115_Report_Office
	  SET   IS_VESSEL_DELAYED = @IS_VESSEL_DELAYED,
			VESSELDELAYED_DAYS = @VESSELDELAYED_DAYS ,
			VESSELDELAYED_HOURS = @VESSELDELAYED_HOURS,
			POTENTIAL_RECURRENCE = @POTENTIAL_RECURRENCE ,
			IS_INVESTIGATIONDONE = @IS_INVESTIGATIONDONE ,
			INVESTIGATIONDATE = @INVESTIGATIONDATE ,
			NAMEOFPERSON_ORG = @NAMEOFPERSON_ORG ,
			O_HUMANACTIONS = @O_HUMANACTIONS ,
			O_HUMANACTIONS_OTHER = @O_HUMANACTIONS_OTHER ,
			O_CONDITIONS = @O_CONDITIONS ,
			O_CONDITIONS_OTHER = @O_CONDITIONS_OTHER ,
			O_HUMANFACTORS = @O_HUMANFACTORS ,
			O_HUMANFACTORS_OTHER = @O_HUMANFACTORS_OTHER ,
			O_JOBFACTORS = @O_JOBFACTORS ,
			O_JOBFACTORS_OTHER = @O_JOBFACTORS_OTHER ,
			ReasonDiffRCA=@ReasonDiffRCA,
			IS_FOLLOWUPREQ = @IS_FOLLOWUPREQ ,
			TARGETDATE = @TARGETDATE ,
			FU_DETAILS = @FU_DETAILS ,
			FU_PIC = @FU_PIC ,
			SUGGESTIONS = @SUGGESTIONS ,
			REMARKS = @REMARKS ,
			IS_CLOSED = @IS_CLOSED ,
			CLOSEDATE = @CLOSEDATE ,
			CLOSEDBY = @CLOSEDBY ,
			IS_CLOSURE_NOTIFIED = @IS_CLOSURE_NOTIFIED ,
			NOTIFYDATE = @NOTIFYDATE,
			CREATEDBY=@CREATEDBY,
			CreatedOn=@CreatedOn,
			Updated=@Updated,
			UpdatedOn=@UpdatedOn ,
			Status=@Status,
			Locked=@Locked
			WHERE VESSELCODE=@VESSELCODE AND REPORTID = @REPORTID

			
END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_Insert_ER_Report_Documents_OfficeShip]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_Insert_ER_Report_Documents_OfficeShip]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ER_S115_Insert_ER_Report_Documents_OfficeShip]
(
	@VesselCode CHAR(3),
	@FORMNO VARCHAR(50),
	@REPORTID bigint,
	@DESCR varchar(500),
	@FILENAME varchar(500),
	@UPLOADEDBY varchar(50),
	@OFFICE_SHIP CHAR(1)
)
AS
BEGIN
	DECLARE @DOCID INT 
	SET NOCOUNT ON

	IF(@OFFICE_SHIP=''O'')
	BEGIN
		SELECT @DOCID=ISNULL(MAX(DOCID),0)+1 FROM ER_Report_Documents_Office
		INSERT INTO ER_Report_Documents_Office
		(
		DOCID ,
		VesselCode ,
		FORMNO ,
		REPORTID ,
		DESCR ,
		[FILENAME] ,
		UPLOADEDBY ,
		UPLOADEDON ,
		STATUS ,
		UPDATED ,
		UPDATEDON 
		)
		Values
		(
		@DOCID,
		@VesselCode ,
		@FORMNO ,
		@REPORTID,
		@DESCR,
		@FILENAME,
		@UPLOADEDBY,
		GETDATE(),
		''A'',
		1,
		GETDATE()
		)
	END
	ELSE
	BEGIN
		SELECT @DOCID=ISNULL(MAX(DOCID),0)+1 FROM ER_Report_Documents_Ship
		INSERT INTO ER_Report_Documents_Ship
		(
		DOCID ,
		VesselCode ,
		FORMNO ,
		REPORTID ,
		DESCR ,
		[FILENAME] ,
		UPLOADEDBY ,
		UPLOADEDON ,
		STATUS ,
		UPDATED ,
		UPDATEDON 
		)
		Values
		(
		@DOCID,
		@VesselCode ,
		@FORMNO ,
		@REPORTID,
		@DESCR,
		@FILENAME,
		@UPLOADEDBY,
		GETDATE(),
		''A'',
		1,
		GETDATE()
		)
	END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_InsertUpdate_ER_S115_InjuredCrewDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_InsertUpdate_ER_S115_InjuredCrewDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ER_S115_InsertUpdate_ER_S115_InjuredCrewDetails]
(
@TABLEID bigint,
@REPORTID bigint,
@VESSELCODE char(3),
@IS_CREW char(1),
@IP_CrewNo varchar(50),
@IP_NAME varchar(50),
@IP_DOB smalldatetime,
@IP_NATIONALITY_IDNO varchar(50),
@IP_RANK_RATING int,
@IP_SIGNEDONDATE smalldatetime,
@IP_NOOFHRONBOARD float,
@IP_IS_VISITTODOCTOR_NECESSARY char(1),
@IP_ACTIVITY_OD char(1),
@IP_ACTIVITYHOURS float,
@IP_RESTRICTEDWORK char(1),
@IP_MEDICALTREATMENTREQD char(1),
@IP_AREAOFOPERATION int,
@IP_AREAOFOPERATION_OTHER varchar(50),
@IP_TYPEOFINJURY int,
@IP_TYPEOFINJURY_OTHER varchar(50),
@OCI_MI_REPORTING int
)
AS
BEGIN
SET NOCOUNT ON

IF(@TABLEID <= 0)
BEGIN
	SELECT @TABLEID=ISNULL(MAX(TABLEID),0)+1 FROM ER_S115_InjuryToPerson WHERE VESSELCODE=@VESSELCODE
	INSERT INTO ER_S115_InjuryToPerson
	(
		TABLEID ,
		REPORTID ,
		VESSELCODE ,
		IS_CREW ,
		IP_CrewNo,
		IP_NAME ,
		IP_DOB ,
		IP_NATIONALITY_IDNO ,
		IP_RANK_RATING ,
		IP_SIGNEDONDATE ,
		IP_NOOFHRONBOARD ,
		IP_IS_VISITTODOCTOR_NECESSARY ,
		IP_ACTIVITY_OD ,
		IP_ACTIVITYHOURS ,
		IP_RESTRICTEDWORK ,
		IP_MEDICALTREATMENTREQD ,
		IP_AREAOFOPERATION ,
		IP_AREAOFOPERATION_OTHER ,
		IP_TYPEOFINJURY ,
		IP_TYPEOFINJURY_OTHER ,
		OCI_MI_REPORTING ,
		[STATUS]
	)
	Values
	(
		@TABLEID,
		@REPORTID,
		@VESSELCODE,
		@IS_CREW,
		@IP_CrewNo,
		@IP_NAME,
		@IP_DOB,
		@IP_NATIONALITY_IDNO,
		@IP_RANK_RATING,
		@IP_SIGNEDONDATE,
		@IP_NOOFHRONBOARD,
		@IP_IS_VISITTODOCTOR_NECESSARY,
		@IP_ACTIVITY_OD,
		@IP_ACTIVITYHOURS,
		@IP_RESTRICTEDWORK,
		@IP_MEDICALTREATMENTREQD,
		@IP_AREAOFOPERATION,
		@IP_AREAOFOPERATION_OTHER,
		@IP_TYPEOFINJURY,
		@IP_TYPEOFINJURY_OTHER,
		@OCI_MI_REPORTING,
		''A''
	)
END
ELSE
BEGIN
      UPDATE ER_S115_InjuryToPerson
	    SET IS_CREW = @IS_CREW,
		IP_CrewNo = @IP_CrewNo,
		IP_NAME = @IP_NAME,
		IP_DOB = @IP_DOB,
		IP_NATIONALITY_IDNO = @IP_NATIONALITY_IDNO,
		IP_RANK_RATING = @IP_RANK_RATING,
		IP_SIGNEDONDATE = @IP_SIGNEDONDATE,
		IP_NOOFHRONBOARD = @IP_NOOFHRONBOARD,
		IP_IS_VISITTODOCTOR_NECESSARY = @IP_IS_VISITTODOCTOR_NECESSARY,
		IP_ACTIVITY_OD = @IP_ACTIVITY_OD,
		IP_ACTIVITYHOURS = @IP_ACTIVITYHOURS,
		IP_RESTRICTEDWORK = @IP_RESTRICTEDWORK,
		IP_MEDICALTREATMENTREQD = @IP_MEDICALTREATMENTREQD,
		IP_AREAOFOPERATION = @IP_AREAOFOPERATION,
		IP_AREAOFOPERATION_OTHER = @IP_AREAOFOPERATION_OTHER,
		IP_TYPEOFINJURY = @IP_TYPEOFINJURY,
		IP_TYPEOFINJURY_OTHER = @IP_TYPEOFINJURY_OTHER,
		OCI_MI_REPORTING = @OCI_MI_REPORTING
		WHERE TABLEID = @TABLEID  AND REPORTID = @REPORTID AND VESSELCODE = @VESSELCODE
END

END' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_InsertUpdate_ER_S115_Report]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_InsertUpdate_ER_S115_Report]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[ER_S115_InsertUpdate_ER_S115_Report]
(
@FORMNO VARCHAR(50),
@REPORTID bigint,
@REPORTNO varchar(50),
@VESSELCODE char(3),
@LATITUDE varchar(50),
@LONGITUDE varchar(50),
@PORT varchar(50),
@REPORTDATE datetime,
@INCIDENTDATE datetime,
@ACCIDENTSEVERITY int,
@ACCIDENTCLASSIFICATION varchar(500),
@EVENTDESCRIPTION varchar(5000),
@ALCOHOL_DRUG_TESTING char(1),
@IS_VESSEL_DELAYED_GI char(1),
@IS_BAD_WEATHER char(1),
@VESSELACTIVITY int,
@IS_RESTRICTED_VISIBILITY char(1),
@Is_BreachOfCP char(1),
@CARGO_CONTAMINATION_DAMAGE char(1),
@CARGO_QTY_INDISPUTE char(1),
@CCD_NAMEOFCHARTERER varchar(50),
@CCD_TYPEOFCARGO varchar(50),
@CCD_TANK_HOLD_NOS varchar(50),
@CCD_TANKCOATING varchar(50),
@CCD_TANKCOATING_OTHER varchar(50),
@CCD_LOADPORT varchar(50),
@CCD_LP_TERMINAL varchar(50),
@CCD_LP_DATE smalldatetime,
@CCD_DISCHARGEPORT varchar(50),
@CCD_DP_TERMINAL varchar(50),
@CCD_DP_DATE smalldatetime,
@CCD_STS_OPERATION char(1),
@CQD_CARGOCONTAMINANT varchar(500),
@CQD_CARGOQTY int,
@CQD_TANKSINSPECTED char(1),
@CQD_WALLWASHTESTDONE char(1),
@NAVIGATION varchar(500),
@ENV_POLLUTION varchar(500),
@ENV_POLLUTION_OTHER varchar(50),
@IS_LOSSTOENV char(1),
@LE_SpillType int,
@LE_CATEGORY varchar(500),
@LE_CATEGORY_OTHER varchar(50),
@INCIDENT_FIRST_OBSEVED_DATE datetime,
@CEASED_OPERATION_DATE datetime,
@REPORTED_TO_AUTHORITY char(1),
@REPORTINGDATE datetime,
@AUTHORITYNAME varchar(50),
@MOORING varchar(500),
@IS_EQUIP_AFFECTED char(1),
@EQUIPMENTS varchar(500),
@IS_DAMAGETOTHIRDPARTY char(1),
@DAMAGETOTHIRDPARTY varchar(50),
@DAMAGETOTHIRDPARTY_OTHER varchar(50),
@IS_DAMAGETOOWNVESSEL char(1),
@DAMAGETOOWNVESSEL varchar(50),
@DAMAGETOOWNVESSEL_OTHER varchar(50),
@IS_EXPLOSION char(1),
@EXPLOSIONON varchar(500),
@EXPLOSIONON_OTHER varchar(50),
@SECURITY varchar(500),
@SECURITY_OTHER varchar(50),
@CA_HUMANACTIONS varchar(500),
@CA_HUMANACTIONS_OTHER varchar(50),
@CA_CONDITIONS varchar(500),
@CA_CONDITIONS_OTHER varchar(50),
@RC_HUMANFACTORS varchar(500),
@RC_HUMANFACTORS_OTHER varchar(50),
@RC_JOBFACTORS varchar(500),
@RC_JOBFACTORS_OTHER varchar(50),
@IS_IMMADIATEACTIONTAKEN char(1),
@IA_YES_DESC varchar(500),
@IS_ACTION_RECOMMENDED char(1),
@AR_YES_DESC varchar(500),
@IS_IMMEDIATETRAINING char(1),
@IT_DETAILS varchar(500),
@IS_FURTHERTRAININGREQ char(1),
@FT_DETAILS varchar(500),
@IS_SAFETYMEETING char(1),
@SM_DATE smalldatetime,
@IS_SUPPLEMENTARYINFO char(1),
@SI_DETAILS varchar(500),
@CREATEDBY varchar(50),
@UPDATEDBY varchar(50)

)
AS
BEGIN
SET NOCOUNT ON
IF(NOT EXISTS(SELECT * FROM ER_S115_Report WHERE REPORTID=@REPORTID))
BEGIN

	SELECT @REPORTID = ISNULL(Max(REPORTID), 0) + 1 FROM ER_S115_Report
	DECLARE @YR CHAR(4)
	SET @YR=YEAR(GETDATE())
	SELECT @REPORTNO = @VESSELCODE + ''/'' + cast(year(getdate()) AS varchar) + ''/'' + @FORMNO + ''-'' + REPLACE(str(ISNULL(max(RIGHT(ReportNo, 3)), 0)+1,3),'' '', ''0'') 
	FROM ER_S115_Report WHERE RIGHT(LEFT(ReportNo,8),4)=@YR
	 
	INSERT INTO ER_S115_Report
	(
	REPORTID ,
	REPORTNO ,
	VESSELCODE ,
	LATITUDE ,
	LONGITUDE ,
	PORT ,
	REPORTDATE ,
	INCIDENTDATE ,
	ACCIDENTSEVERITY ,
	ACCIDENTCLASSIFICATION ,
	EVENTDESCRIPTION ,
	ALCOHOL_DRUG_TESTING ,
	IS_VESSEL_DELAYED_GI ,
	IS_BAD_WEATHER ,
	VESSELACTIVITY ,
	IS_RESTRICTED_VISIBILITY ,
	Is_BreachOfCP,
	CARGO_CONTAMINATION_DAMAGE ,
	CARGO_QTY_INDISPUTE ,
	CCD_NAMEOFCHARTERER ,
	CCD_TYPEOFCARGO ,
	CCD_TANK_HOLD_NOS ,
	CCD_TANKCOATING ,
	CCD_TANKCOATING_OTHER ,
	CCD_LOADPORT ,
	CCD_LP_TERMINAL ,
	CCD_LP_DATE ,
	CCD_DISCHARGEPORT ,
	CCD_DP_TERMINAL ,
	CCD_DP_DATE ,
	CCD_STS_OPERATION ,
	CQD_CARGOCONTAMINANT ,
	CQD_CARGOQTY ,
	CQD_TANKSINSPECTED ,
	CQD_WALLWASHTESTDONE ,
	NAVIGATION ,
	ENV_POLLUTION ,
	ENV_POLLUTION_OTHER ,
	IS_LOSSTOENV ,
	LE_SpillType,
	LE_CATEGORY ,
	LE_CATEGORY_OTHER ,
	INCIDENT_FIRST_OBSEVED_DATE ,
	CEASED_OPERATION_DATE ,
	REPORTED_TO_AUTHORITY ,
	REPORTINGDATE ,
	AUTHORITYNAME ,
	MOORING ,
	IS_EQUIP_AFFECTED ,
	EQUIPMENTS ,
	IS_DAMAGETOTHIRDPARTY ,
	DAMAGETOTHIRDPARTY ,
	DAMAGETOTHIRDPARTY_OTHER ,
	IS_DAMAGETOOWNVESSEL ,
	DAMAGETOOWNVESSEL ,
	DAMAGETOOWNVESSEL_OTHER ,
	IS_EXPLOSION ,
	EXPLOSIONON ,
	EXPLOSIONON_OTHER ,
	SECURITY ,
	SECURITY_OTHER ,
	CA_HUMANACTIONS ,
	CA_HUMANACTIONS_OTHER ,
	CA_CONDITIONS ,
	CA_CONDITIONS_OTHER ,
	RC_HUMANFACTORS ,
	RC_HUMANFACTORS_OTHER ,
	RC_JOBFACTORS ,
	RC_JOBFACTORS_OTHER ,
	IS_IMMADIATEACTIONTAKEN ,
	IA_YES_DESC ,
	IS_ACTION_RECOMMENDED ,
	AR_YES_DESC ,
	IS_IMMEDIATETRAINING ,
	IT_DETAILS ,
	IS_FURTHERTRAININGREQ ,
	FT_DETAILS ,
	IS_SAFETYMEETING ,
	SM_DATE ,
	IS_SUPPLEMENTARYINFO ,
	SI_DETAILS ,
	CREATEDBY ,
	CREATEDON ,
	UPDATED ,
	UPDATEDON 	 
	)
	Values
	(
	@REPORTID,
	@REPORTNO,
	@VESSELCODE,
	@LATITUDE,
	@LONGITUDE,
	@PORT,
	@REPORTDATE,
	@INCIDENTDATE,
	@ACCIDENTSEVERITY,
	@ACCIDENTCLASSIFICATION,
	@EVENTDESCRIPTION,
	@ALCOHOL_DRUG_TESTING,
	@IS_VESSEL_DELAYED_GI,
	@IS_BAD_WEATHER,
	@VESSELACTIVITY,
	@IS_RESTRICTED_VISIBILITY,
	@Is_BreachOfCP,
	@CARGO_CONTAMINATION_DAMAGE,
	@CARGO_QTY_INDISPUTE,
	@CCD_NAMEOFCHARTERER,
	@CCD_TYPEOFCARGO,
	@CCD_TANK_HOLD_NOS,
	@CCD_TANKCOATING,
	@CCD_TANKCOATING_OTHER,
	@CCD_LOADPORT,
	@CCD_LP_TERMINAL,
	@CCD_LP_DATE,
	@CCD_DISCHARGEPORT,
	@CCD_DP_TERMINAL,
	@CCD_DP_DATE,
	@CCD_STS_OPERATION,
	@CQD_CARGOCONTAMINANT,
	@CQD_CARGOQTY,
	@CQD_TANKSINSPECTED,
	@CQD_WALLWASHTESTDONE,
	@NAVIGATION,
	@ENV_POLLUTION,
	@ENV_POLLUTION_OTHER,
	@IS_LOSSTOENV,
	@LE_SpillType,
	@LE_CATEGORY,
	@LE_CATEGORY_OTHER,
	@INCIDENT_FIRST_OBSEVED_DATE,
	@CEASED_OPERATION_DATE,
	@REPORTED_TO_AUTHORITY,
	@REPORTINGDATE,
	@AUTHORITYNAME,
	@MOORING,
	@IS_EQUIP_AFFECTED,
	@EQUIPMENTS,
	@IS_DAMAGETOTHIRDPARTY,
	@DAMAGETOTHIRDPARTY,
	@DAMAGETOTHIRDPARTY_OTHER,
	@IS_DAMAGETOOWNVESSEL,
	@DAMAGETOOWNVESSEL,
	@DAMAGETOOWNVESSEL_OTHER,
	@IS_EXPLOSION,
	@EXPLOSIONON,
	@EXPLOSIONON_OTHER,
	@SECURITY,
	@SECURITY_OTHER,
	@CA_HUMANACTIONS,
	@CA_HUMANACTIONS_OTHER,
	@CA_CONDITIONS,
	@CA_CONDITIONS_OTHER,
	@RC_HUMANFACTORS,
	@RC_HUMANFACTORS_OTHER,
	@RC_JOBFACTORS,
	@RC_JOBFACTORS_OTHER,
	@IS_IMMADIATEACTIONTAKEN,
	@IA_YES_DESC,
	@IS_ACTION_RECOMMENDED,
	@AR_YES_DESC,
	@IS_IMMEDIATETRAINING,
	@IT_DETAILS,
	@IS_FURTHERTRAININGREQ,
	@FT_DETAILS,
	@IS_SAFETYMEETING,
	@SM_DATE,
	@IS_SUPPLEMENTARYINFO,
	@SI_DETAILS,
	@CREATEDBY,
	getdate(),
	1,
	getdate()
	)
END
ELSE
BEGIN
	UPDATE ER_S115_Report
	SET 
	LATITUDE=@LATITUDE,
	LONGITUDE=@LONGITUDE,
	PORT=@PORT,
	REPORTDATE=@REPORTDATE,
	INCIDENTDATE=@INCIDENTDATE,
	ACCIDENTSEVERITY=@ACCIDENTSEVERITY,
	ACCIDENTCLASSIFICATION=@ACCIDENTCLASSIFICATION,
	EVENTDESCRIPTION=@EVENTDESCRIPTION,
	ALCOHOL_DRUG_TESTING=@ALCOHOL_DRUG_TESTING,
	IS_VESSEL_DELAYED_GI=@IS_VESSEL_DELAYED_GI,
	IS_BAD_WEATHER=@IS_BAD_WEATHER,
	VESSELACTIVITY=@VESSELACTIVITY,
	IS_RESTRICTED_VISIBILITY=@IS_RESTRICTED_VISIBILITY,
	Is_BreachOfCP=@Is_BreachOfCP,
	CARGO_CONTAMINATION_DAMAGE=@CARGO_CONTAMINATION_DAMAGE,
	CARGO_QTY_INDISPUTE=@CARGO_QTY_INDISPUTE,
	CCD_NAMEOFCHARTERER=@CCD_NAMEOFCHARTERER,
	CCD_TYPEOFCARGO=@CCD_TYPEOFCARGO,
	CCD_TANK_HOLD_NOS=@CCD_TANK_HOLD_NOS,
	CCD_TANKCOATING=@CCD_TANKCOATING,
	CCD_TANKCOATING_OTHER=@CCD_TANKCOATING_OTHER,
	CCD_LOADPORT=@CCD_LOADPORT,
	CCD_LP_TERMINAL=@CCD_LP_TERMINAL,
	CCD_LP_DATE=@CCD_LP_DATE,
	CCD_DISCHARGEPORT=@CCD_DISCHARGEPORT,
	CCD_DP_TERMINAL=@CCD_DP_TERMINAL,
	CCD_DP_DATE=@CCD_DP_DATE,
	CCD_STS_OPERATION=@CCD_STS_OPERATION,
	CQD_CARGOCONTAMINANT=@CQD_CARGOCONTAMINANT,
	CQD_CARGOQTY=@CQD_CARGOQTY,
	CQD_TANKSINSPECTED=@CQD_TANKSINSPECTED,
	CQD_WALLWASHTESTDONE=@CQD_WALLWASHTESTDONE,
	NAVIGATION=@NAVIGATION,
	ENV_POLLUTION=@ENV_POLLUTION,
	ENV_POLLUTION_OTHER=@ENV_POLLUTION_OTHER,
	IS_LOSSTOENV=@IS_LOSSTOENV,
	LE_SpillType=@LE_SpillType,
	LE_CATEGORY=@LE_CATEGORY,
	LE_CATEGORY_OTHER=@LE_CATEGORY_OTHER,
	INCIDENT_FIRST_OBSEVED_DATE=@INCIDENT_FIRST_OBSEVED_DATE,
	CEASED_OPERATION_DATE=@CEASED_OPERATION_DATE,
	REPORTED_TO_AUTHORITY=@REPORTED_TO_AUTHORITY,
	REPORTINGDATE=@REPORTINGDATE,
	AUTHORITYNAME=@AUTHORITYNAME,
	MOORING=@MOORING,
	IS_EQUIP_AFFECTED=@IS_EQUIP_AFFECTED,
	EQUIPMENTS=@EQUIPMENTS,

	IS_DAMAGETOTHIRDPARTY=@IS_DAMAGETOTHIRDPARTY,
	DAMAGETOTHIRDPARTY=@DAMAGETOTHIRDPARTY,
	DAMAGETOTHIRDPARTY_OTHER=@DAMAGETOTHIRDPARTY_OTHER,
	IS_DAMAGETOOWNVESSEL=@IS_DAMAGETOOWNVESSEL,
	DAMAGETOOWNVESSEL=@DAMAGETOOWNVESSEL,
	DAMAGETOOWNVESSEL_OTHER=@DAMAGETOOWNVESSEL_OTHER,

	IS_EXPLOSION=@IS_EXPLOSION,
	EXPLOSIONON=@EXPLOSIONON,
	EXPLOSIONON_OTHER=@EXPLOSIONON_OTHER,
	[SECURITY]=@SECURITY,
	SECURITY_OTHER=@SECURITY_OTHER,
	CA_HUMANACTIONS=@CA_HUMANACTIONS,
	CA_HUMANACTIONS_OTHER=@CA_HUMANACTIONS_OTHER,
	CA_CONDITIONS=@CA_CONDITIONS,
	CA_CONDITIONS_OTHER=@CA_CONDITIONS_OTHER,
	RC_HUMANFACTORS=@RC_HUMANFACTORS,
	RC_HUMANFACTORS_OTHER=@RC_HUMANFACTORS_OTHER,
	RC_JOBFACTORS=@RC_JOBFACTORS,
	RC_JOBFACTORS_OTHER=@RC_JOBFACTORS_OTHER,
	IS_IMMADIATEACTIONTAKEN=@IS_IMMADIATEACTIONTAKEN,
	IA_YES_DESC=@IA_YES_DESC,
	IS_ACTION_RECOMMENDED=@IS_ACTION_RECOMMENDED,
	AR_YES_DESC=@AR_YES_DESC,
	IS_IMMEDIATETRAINING=@IS_IMMEDIATETRAINING,
	IT_DETAILS=@IT_DETAILS,
	IS_FURTHERTRAININGREQ=@IS_FURTHERTRAININGREQ,
	FT_DETAILS=@FT_DETAILS,
	IS_SAFETYMEETING=@IS_SAFETYMEETING,
	SM_DATE=@SM_DATE,
	IS_SUPPLEMENTARYINFO=@IS_SUPPLEMENTARYINFO,
	SI_DETAILS=@SI_DETAILS,
	UPDATED=1,
	UPDATEDON=getdate()
	WHERE REPORTID=@REPORTID

	EXEC [dbo].[ER_Insert_ER_Report_UpdationDetails] @FORMNO, @REPORTID, @UPDATEDBY

END

SELECT @REPORTID As REPORTID

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_InsertUpdate_ER_S115_Report_Office]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_InsertUpdate_ER_S115_Report_Office]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ER_S115_InsertUpdate_ER_S115_Report_Office]
(
@FORMNO VARCHAR(50),
@REPORTID bigint,
@VESSELCODE char(3),
@IS_VESSEL_DELAYED char(1),
@VESSELDELAYED_DAYS int,
@VESSELDELAYED_HOURS int,
@POTENTIAL_RECURRENCE int,
@IS_INVESTIGATIONDONE char(1),
@INVESTIGATIONDATE smalldatetime,
@NAMEOFPERSON_ORG varchar(50),
@O_HUMANACTIONS varchar(500),
@O_HUMANACTIONS_OTHER varchar(50),
@O_CONDITIONS varchar(500),
@O_CONDITIONS_OTHER varchar(50),
@O_HUMANFACTORS varchar(500),
@O_HUMANFACTORS_OTHER varchar(50),
@O_JOBFACTORS varchar(500),
@O_JOBFACTORS_OTHER varchar(50),
@ReasonDiffRCA varchar(500),
@IS_FOLLOWUPREQ char(1),
@TARGETDATE smalldatetime,
@FU_DETAILS varchar(500),
@FU_PIC varchar(50),
@SUGGESTIONS varchar(50),
@REMARKS varchar(500),
@IS_CLOSED char(1),
@CLOSEDATE smalldatetime,
@CLOSEDBY varchar(50),
@IS_CLOSURE_NOTIFIED char(1),
@NOTIFYDATE smalldatetime,
@CREATEDBY varchar(50),
@UPDATEDBY varchar(50)
)
AS
BEGIN
SET NOCOUNT ON

IF NOT EXISTS(SELECT * FROM  ER_S115_Report_Office WHERE VESSELCODE=@VESSELCODE AND REPORTID = @REPORTID)
BEGIN
	INSERT INTO ER_S115_Report_Office
	(
		REPORTID ,
		VESSELCODE ,
		IS_VESSEL_DELAYED ,
		VESSELDELAYED_DAYS ,
		VESSELDELAYED_HOURS ,
		POTENTIAL_RECURRENCE ,
		IS_INVESTIGATIONDONE ,
		INVESTIGATIONDATE ,
		NAMEOFPERSON_ORG ,
		O_HUMANACTIONS ,
		O_HUMANACTIONS_OTHER ,
		O_CONDITIONS ,
		O_CONDITIONS_OTHER ,
		O_HUMANFACTORS ,
		O_HUMANFACTORS_OTHER ,
		O_JOBFACTORS ,
		O_JOBFACTORS_OTHER ,
		ReasonDiffRCA,
		IS_FOLLOWUPREQ ,
		TARGETDATE ,
		FU_DETAILS ,
		FU_PIC ,
		SUGGESTIONS ,
		REMARKS ,
		IS_CLOSED ,
		CLOSEDATE ,
		CLOSEDBY ,
		IS_CLOSURE_NOTIFIED ,
		NOTIFYDATE ,
		CREATEDBY ,
		CREATEDON ,
		UPDATED ,
		UPDATEDON ,
		STATUS,
		Locked
	)
	Values
	(
		@REPORTID,
		@VESSELCODE,
		@IS_VESSEL_DELAYED,
		@VESSELDELAYED_DAYS,
		@VESSELDELAYED_HOURS,
		@POTENTIAL_RECURRENCE,
		@IS_INVESTIGATIONDONE,
		@INVESTIGATIONDATE,
		@NAMEOFPERSON_ORG,
		@O_HUMANACTIONS,
		@O_HUMANACTIONS_OTHER,
		@O_CONDITIONS,
		@O_CONDITIONS_OTHER,
		@O_HUMANFACTORS,
		@O_HUMANFACTORS_OTHER,
		@O_JOBFACTORS,
		@O_JOBFACTORS_OTHER,
		@ReasonDiffRCA,
		@IS_FOLLOWUPREQ,
		@TARGETDATE,
		@FU_DETAILS,
		@FU_PIC,
		@SUGGESTIONS,
		@REMARKS,
		@IS_CLOSED,
		@CLOSEDATE,
		@CLOSEDBY,
		@IS_CLOSURE_NOTIFIED,
		@NOTIFYDATE,
		@CREATEDBY,
		getdate(),
		1,
		getdate(),
		''A'',
		''Y''
	)
END
ELSE
BEGIN
      UPDATE ER_S115_Report_Office
	  SET   IS_VESSEL_DELAYED = @IS_VESSEL_DELAYED,
			VESSELDELAYED_DAYS = @VESSELDELAYED_DAYS ,
			VESSELDELAYED_HOURS = @VESSELDELAYED_HOURS,
			POTENTIAL_RECURRENCE = @POTENTIAL_RECURRENCE ,
			IS_INVESTIGATIONDONE = @IS_INVESTIGATIONDONE ,
			INVESTIGATIONDATE = @INVESTIGATIONDATE ,
			NAMEOFPERSON_ORG = @NAMEOFPERSON_ORG ,
			O_HUMANACTIONS = @O_HUMANACTIONS ,
			O_HUMANACTIONS_OTHER = @O_HUMANACTIONS_OTHER ,
			O_CONDITIONS = @O_CONDITIONS ,
			O_CONDITIONS_OTHER = @O_CONDITIONS_OTHER ,
			O_HUMANFACTORS = @O_HUMANFACTORS ,
			O_HUMANFACTORS_OTHER = @O_HUMANFACTORS_OTHER ,
			O_JOBFACTORS = @O_JOBFACTORS ,
			O_JOBFACTORS_OTHER = @O_JOBFACTORS_OTHER ,
			ReasonDiffRCA=@ReasonDiffRCA,
			IS_FOLLOWUPREQ = @IS_FOLLOWUPREQ ,
			TARGETDATE = @TARGETDATE ,
			FU_DETAILS = @FU_DETAILS ,
			FU_PIC = @FU_PIC ,
			SUGGESTIONS = @SUGGESTIONS ,
			REMARKS = @REMARKS ,
			IS_CLOSED = @IS_CLOSED ,
			CLOSEDATE = @CLOSEDATE ,
			CLOSEDBY = @CLOSEDBY ,
			IS_CLOSURE_NOTIFIED = @IS_CLOSURE_NOTIFIED ,
			NOTIFYDATE = @NOTIFYDATE,
			UPDATED = 1 ,
			UPDATEDON = getdate()
			WHERE REPORTID = @REPORTID AND VESSELCODE=@VESSELCODE

			-- EXEC [dbo].[ER_Insert_ER_Report_UpdationDetails] @FORMNO, @REPORTID, @UPDATEDBY
END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_SHIPACKIMPORT]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_SHIPACKIMPORT]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[ER_S115_SHIPACKIMPORT]
(
@VESSELCODE varchar(3),
@ACCIDENTHAPPEN bit,
@CAPATAKEN bit,
@COMMENTS varchar(5000),
@REPORTID bigint,
@ACCVSLCODE varchar(3),
@PacketSentDate datetime
)
AS
BEGIN
SET NOCOUNT ON

IF EXISTS(SELECT * FROM ER_S115_Report_EmailBlast WHERE VESSELCODE=@VESSELCODE and REPORTID=@REPORTID and @ACCVSLCODE=@ACCVSLCODE)
BEGIN
	UPDATE ER_S115_Report_EmailBlast
	SET 
	ACCIDENTHAPPEN=@ACCIDENTHAPPEN,
	CAPATAKEN=@CAPATAKEN,
	COMMENTS=@COMMENTS
	WHERE VESSELCODE=@VESSELCODE and REPORTID=@REPORTID and @ACCVSLCODE=@ACCVSLCODE
END
ELSE
BEGIN
	INSERT INTO ER_S115_Report_EmailBlast
	(
	VESSELCODE,
	ACCIDENTHAPPEN ,
	CAPATAKEN ,
	COMMENTS ,
	REPORTID ,
	ACCVSLCODE ,
	PacketRecievedDate,
	PacketSentDate 
	)
	Values
	(
	@VESSELCODE,
	@ACCIDENTHAPPEN,
	@CAPATAKEN,
	@COMMENTS,
	@REPORTID,
	@ACCVSLCODE,
	Getdate(),
	@PacketSentDate 
	)
	END
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_S115_SHIPACKSENT]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_SHIPACKSENT]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[ER_S115_SHIPACKSENT]
(
	@VESSELCODE varchar(3),
	@REPORTID bigint
)
AS
BEGIN
SET NOCOUNT ON
DECLARE @TMPVSL CHAR(3)

DECLARE @RPTDT SMALLDATETIME
SELECT @RPTDT=REPORTDATE FROM ER_S115_Report WHERE VESSELCODE=@VESSELCODE and REPORTID=@REPORTID

DECLARE VSLS CURSOR FOR  SELECT VESSELCODE FROM DBO.VESSEL WHERE VESSELSTATUSID=1 AND VESSELID NOT IN (41,43,44)
OPEN VSLS
FETCH NEXT FROM VSLS INTO @TMPVSL
WHILE(@@FETCH_STATUS=0)
BEGIN
	IF NOT EXISTS(SELECT * FROM ER_S115_Report_EmailBlast WHERE VESSELCODE=@VESSELCODE and REPORTID=@REPORTID AND ACCVSLCODE=@TMPVSL)
	BEGIN
		INSERT INTO ER_S115_Report_EmailBlast
		(
		VESSELCODE,
		REPORTID ,
		ACCVSLCODE ,
		PacketSentDate 
		)
		Values
		(
		@TMPVSL,
		@REPORTID,
		@VESSELCODE,
		@RPTDT
		)
	END
	FETCH NEXT FROM VSLS INTO @TMPVSL
END
CLOSE VSLS
DEALLOCATE VSLS
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_S133_IMPORT_ER_S133_Report]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S133_IMPORT_ER_S133_Report]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ER_S133_IMPORT_ER_S133_Report]
(
@REPORTID bigint,
@REPORTNO varchar(50),
@VESSELCODE char(3),
@REPORTDATE datetime,
@DATEOFOCCURENCE datetime,
@FAMILYNAME varchar(50),
@FIRSTNAME varchar(50),
@RANKID int,
@CREWNO varchar(50),
@CATEGORY varchar(500),
@EVENTDESCR varchar(1000),
@SUGGESTIONS varchar(1000),
@SM_FAMILYNAME varchar(50),
@SM_FIRSTNAME varchar(50),
@SM_CREWNO varchar(50),
@CREATEDBY varchar(50),
@CREATEDON smalldatetime,
@UPDATED bit,
@UPDATEDON smalldatetime,
@EXPORTEDBY varchar(50),
@EXPORTEDON smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
IF(NOT EXISTS(SELECT * FROM ER_S133_Report WHERE VESSELCODE=@VESSELCODE AND REPORTID=@REPORTID ))
BEGIN
	INSERT INTO ER_S133_Report
	(
	REPORTID ,
	REPORTNO ,
	VESSELCODE ,
	REPORTDATE ,
	DATEOFOCCURENCE ,
	FAMILYNAME ,
	FIRSTNAME ,
	RANKID ,
	CREWNO ,
	CATEGORY ,
	EVENTDESCR ,
	SUGGESTIONS ,
	SM_FAMILYNAME ,
	SM_FIRSTNAME ,
	SM_CREWNO ,
	CREATEDBY ,
	CREATEDON ,
	UPDATED ,
	UPDATEDON ,
	EXPORTEDBY ,
	EXPORTEDON 
	)
	Values
	(
	@REPORTID,
	@REPORTNO,
	@VESSELCODE,
	@REPORTDATE,
	@DATEOFOCCURENCE,
	@FAMILYNAME,
	@FIRSTNAME,
	@RANKID,
	@CREWNO,
	@CATEGORY,
	@EVENTDESCR,
	@SUGGESTIONS,
	@SM_FAMILYNAME,
	@SM_FIRSTNAME,
	@SM_CREWNO,
	@CREATEDBY,
	@CREATEDON,
	@UPDATED,
	@UPDATEDON,
	@EXPORTEDBY,
	@EXPORTEDON 
	)
END
ELSE
BEGIN
	UPDATE ER_S133_Report
	SET 
	REPORTNO=@REPORTNO,
	REPORTDATE=@REPORTDATE,
	DATEOFOCCURENCE=@DATEOFOCCURENCE,
	FAMILYNAME=@FAMILYNAME,
	FIRSTNAME=@FIRSTNAME,
	RANKID=@RANKID,
	CREWNO=@CREWNO,
	CATEGORY=@CATEGORY,
	EVENTDESCR=@EVENTDESCR,
	SUGGESTIONS=@SUGGESTIONS,
	SM_FAMILYNAME=@SM_FAMILYNAME,
	SM_FIRSTNAME=@SM_FIRSTNAME,
	SM_CREWNO=@SM_CREWNO,
	CREATEDBY=@CREATEDBY,
	CREATEDON=@CREATEDON,
	UPDATED=@UPDATED,
	UPDATEDON=@UPDATEDON,
	EXPORTEDBY=@EXPORTEDBY,
	EXPORTEDON=@EXPORTEDON 
	WHERE VESSELCODE=@VESSELCODE AND REPORTID=@REPORTID
END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_S133_IMPORT_ER_S133_Report_Office]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S133_IMPORT_ER_S133_Report_Office]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ER_S133_IMPORT_ER_S133_Report_Office]
(
@REPORTID bigint,
@VESSELCODE char(3),
@REMARKS varchar(500),
@NMSEVERITY char(1),
@CA_HUMANACTIONS varchar(500),
@CA_HUMANACTIONS_OTHER varchar(50),
@CA_CONDITIONS varchar(500),
@CA_CONDITIONS_OTHER varchar(50),
@RC_HUMANFACTORS varchar(500),
@RC_HUMANFACTORS_OTHER varchar(50),
@RC_JOBFACTORS varchar(500),
@RC_JOBFACTORS_OTHER varchar(50),
@IS_CLOSED char(1),
@CLOSEDATE smalldatetime,
@CLOSEDBY varchar(50),
@IS_CLOSURE_NOTIFIED char(1),
@NOTIFYDATE smalldatetime,
@CREATEDBY varchar(50),
@CREATEDON smalldatetime,
@UPDATED bit,
@UPDATEDON smalldatetime,
@STATUS char(1),
@LOCKED char(1)
)
AS
BEGIN
SET NOCOUNT ON

IF NOT EXISTS(SELECT * FROM  ER_S133_Report_Office WHERE VESSELCODE=@VESSELCODE AND REPORTID = @REPORTID)
BEGIN
	INSERT INTO ER_S133_Report_Office
	(
		REPORTID ,
		VESSELCODE ,
		REMARKS ,
		NMSEVERITY ,
		CA_HUMANACTIONS ,
		CA_HUMANACTIONS_OTHER ,
		CA_CONDITIONS ,
		CA_CONDITIONS_OTHER ,
		RC_HUMANFACTORS ,
		RC_HUMANFACTORS_OTHER ,
		RC_JOBFACTORS ,
		RC_JOBFACTORS_OTHER ,
		IS_CLOSED ,
		CLOSEDATE ,
		CLOSEDBY ,
		IS_CLOSURE_NOTIFIED ,
		NOTIFYDATE ,
		CREATEDBY ,
		CREATEDON ,
		UPDATED ,
		UPDATEDON ,
		STATUS ,
		LOCKED  
	)
	Values
	(
		@REPORTID,
		@VESSELCODE,
		@REMARKS,
		@NMSEVERITY,
		@CA_HUMANACTIONS,
		@CA_HUMANACTIONS_OTHER,
		@CA_CONDITIONS,
		@CA_CONDITIONS_OTHER,
		@RC_HUMANFACTORS,
		@RC_HUMANFACTORS_OTHER,
		@RC_JOBFACTORS,
		@RC_JOBFACTORS_OTHER,
		@IS_CLOSED,
		@CLOSEDATE,
		@CLOSEDBY,
		@IS_CLOSURE_NOTIFIED,
		@NOTIFYDATE,
		@CREATEDBY,
		@CREATEDON,
		@UPDATED,
		@UPDATEDON,
		@STATUS,
		@LOCKED
	)
END
ELSE
BEGIN
	 UPDATE ER_S133_Report_Office
	 SET	REMARKS=@REMARKS,
			NMSEVERITY=@NMSEVERITY,
			CA_HUMANACTIONS=@CA_HUMANACTIONS,
			CA_HUMANACTIONS_OTHER=@CA_HUMANACTIONS_OTHER,
			CA_CONDITIONS=@CA_CONDITIONS,
			CA_CONDITIONS_OTHER=@CA_CONDITIONS_OTHER,
			RC_HUMANFACTORS=@RC_HUMANFACTORS,
			RC_HUMANFACTORS_OTHER=@RC_HUMANFACTORS_OTHER,
			RC_JOBFACTORS=@RC_JOBFACTORS,
			RC_JOBFACTORS_OTHER=@RC_JOBFACTORS_OTHER,
			IS_CLOSED=@IS_CLOSED,
			CLOSEDATE=@CLOSEDATE,
			CLOSEDBY=@CLOSEDBY,
			IS_CLOSURE_NOTIFIED=@IS_CLOSURE_NOTIFIED,
			NOTIFYDATE=@NOTIFYDATE,
			CREATEDBY=@CREATEDBY,
			CREATEDON=@CREATEDON,
			UPDATED=@UPDATED,
			UPDATEDON=@UPDATEDON,
			STATUS=@STATUS,
			LOCKED=@LOCKED
	  WHERE VESSELCODE=@VESSELCODE AND REPORTID = @REPORTID
END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_S133_InsertUpdate_ER_S133_Report]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S133_InsertUpdate_ER_S133_Report]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[ER_S133_InsertUpdate_ER_S133_Report]
(
@FORMNO VARCHAR(50),
@REPORTID bigint,
@REPORTNO varchar(50),
@VESSELCODE char(3),
@DATEOFOCCURENCE datetime,
@FAMILYNAME varchar(50),
@FIRSTNAME varchar(50),
@RANKID int,
@CREWNO varchar(50),
@CATEGORY varchar(500),
@EVENTDESCR varchar(1000),
@SUGGESTIONS varchar(1000),
@SM_FAMILYNAME varchar(50),
@SM_FIRSTNAME varchar(50),
@SM_CREWNO varchar(50),
@CREATEDBY varchar(50),
@UPDATEDBY varchar(50)
)
AS
BEGIN
SET NOCOUNT ON
IF(NOT EXISTS(SELECT * FROM ER_S133_Report WHERE REPORTID=@REPORTID))
BEGIN
     
	 SELECT @REPORTID = ISNULL(Max(REPORTID), 0) + 1 FROM ER_S133_Report
	 DECLARE @YR CHAR(4)
	 SET @YR=YEAR(GETDATE())
	 SELECT @REPORTNO = @VESSELCODE + ''/'' + cast(year(getdate()) AS varchar) + ''/'' + @FORMNO + ''-'' + REPLACE(str(ISNULL(max(RIGHT(ReportNo, 3)), 0)+1,3),'' '', ''0'') 
	 FROM ER_S133_Report WHERE RIGHT(LEFT(ReportNo,8),4)=@YR
	 
	
	INSERT INTO ER_S133_Report
	(
		REPORTID ,
		REPORTNO ,
		VESSELCODE ,
		ReportDate ,
		DATEOFOCCURENCE ,
		FAMILYNAME ,
		FIRSTNAME ,
		RANKID ,
		CREWNO ,
		CATEGORY ,
		EVENTDESCR ,
		SUGGESTIONS ,
		SM_FAMILYNAME ,
		SM_FIRSTNAME ,
		SM_CREWNO ,
		CREATEDBY ,
		CREATEDON ,
		UPDATED ,
		UPDATEDON 
	)
	Values
	(
		@REPORTID,
		@REPORTNO,
		@VESSELCODE,
		getdate(),
		@DATEOFOCCURENCE,
		@FAMILYNAME,
		@FIRSTNAME,
		@RANKID,
		@CREWNO,
		@CATEGORY,
		@EVENTDESCR,
		@SUGGESTIONS,
		@SM_FAMILYNAME,
		@SM_FIRSTNAME,
		@SM_CREWNO,
		@CREATEDBY,
		getdate(),
		1,
		getdate()
	)
END
ELSE
BEGIN
	UPDATE ER_S133_Report
	SET DATEOFOCCURENCE = @DATEOFOCCURENCE ,
		FAMILYNAME = @FAMILYNAME ,
		FIRSTNAME = @FIRSTNAME ,
		RANKID = @RANKID ,
		CREWNO = @CREWNO ,
		CATEGORY = @CATEGORY ,
		EVENTDESCR = @EVENTDESCR ,
		SUGGESTIONS = @SUGGESTIONS ,
		SM_FAMILYNAME = @SM_FAMILYNAME ,
		SM_FIRSTNAME = @SM_FIRSTNAME ,
		SM_CREWNO = @SM_CREWNO ,
		UPDATED = 1,
		UPDATEDON = getdate()

		WHERE REPORTID = @REPORTID AND VESSELCODE = @VESSELCODE

		EXEC [dbo].[ER_Insert_ER_Report_UpdationDetails] @FORMNO, @REPORTID, @UPDATEDBY

END

SELECT @REPORTID As REPORTID
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[ER_S133_InsertUpdate_ER_S133_Report_Office]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S133_InsertUpdate_ER_S133_Report_Office]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ER_S133_InsertUpdate_ER_S133_Report_Office]
(
@FORMNO VARCHAR(50),
@REPORTID bigint,
@VESSELCODE char(3),
@REMARKS varchar(500),
@NMSEVERITY char(1),
@CA_HUMANACTIONS varchar(500),
@CA_HUMANACTIONS_OTHER varchar(50),
@CA_CONDITIONS varchar(500),
@CA_CONDITIONS_OTHER varchar(50),
@RC_HUMANFACTORS varchar(500),
@RC_HUMANFACTORS_OTHER varchar(50),
@RC_JOBFACTORS varchar(500),
@RC_JOBFACTORS_OTHER varchar(50),
@IS_CLOSED char(1),
@CLOSEDATE smalldatetime,
@CLOSEDBY varchar(50),
@IS_CLOSURE_NOTIFIED char(1),
@NOTIFYDATE smalldatetime,
@CREATEDBY varchar(50),
@UPDATEDBY varchar(50)
)
AS
BEGIN
SET NOCOUNT ON

IF NOT EXISTS(SELECT * FROM ER_S133_Report_Office  WHERE  VESSELCODE=@VESSELCODE AND REPORTID = @REPORTID)
BEGIN
	INSERT INTO ER_S133_Report_Office
	(
		REPORTID ,
		VESSELCODE ,
		REMARKS ,
		NMSEVERITY ,
		CA_HUMANACTIONS ,
		CA_HUMANACTIONS_OTHER ,
		CA_CONDITIONS ,
		CA_CONDITIONS_OTHER ,
		RC_HUMANFACTORS ,
		RC_HUMANFACTORS_OTHER ,
		RC_JOBFACTORS ,
		RC_JOBFACTORS_OTHER ,
		IS_CLOSED ,
		CLOSEDATE ,
		CLOSEDBY ,
		IS_CLOSURE_NOTIFIED ,
		NOTIFYDATE ,
		CREATEDBY ,
		CREATEDON ,
		UPDATED ,
		UPDATEDON ,
		STATUS ,
		Locked 
	)
	Values
	(
		@REPORTID,
		@VESSELCODE,
		@REMARKS,
		@NMSEVERITY,
		@CA_HUMANACTIONS,
		@CA_HUMANACTIONS_OTHER,
		@CA_CONDITIONS,
		@CA_CONDITIONS_OTHER,
		@RC_HUMANFACTORS,
		@RC_HUMANFACTORS_OTHER,
		@RC_JOBFACTORS,
		@RC_JOBFACTORS_OTHER,
		@IS_CLOSED,
		@CLOSEDATE,
		@CLOSEDBY,
		@IS_CLOSURE_NOTIFIED,
		@NOTIFYDATE,
		@CREATEDBY,
		getdate(),
		1,
		getdate(),
		''A'',
		''Y''
	)
END
ELSE
BEGIN
      UPDATE ER_S133_Report_Office
	  SET   REMARKS=@REMARKS,
			NMSEVERITY=@NMSEVERITY,
			CA_HUMANACTIONS=@CA_HUMANACTIONS,
			CA_HUMANACTIONS_OTHER=@CA_HUMANACTIONS_OTHER,
			CA_CONDITIONS=@CA_CONDITIONS,
			CA_CONDITIONS_OTHER=@CA_CONDITIONS_OTHER,
			RC_HUMANFACTORS=@RC_HUMANFACTORS,
			RC_HUMANFACTORS_OTHER=@RC_HUMANFACTORS_OTHER,
			RC_JOBFACTORS=@RC_JOBFACTORS,
			RC_JOBFACTORS_OTHER=@RC_JOBFACTORS_OTHER,
			IS_CLOSED=@IS_CLOSED,
			CLOSEDATE = @CLOSEDATE ,
			CLOSEDBY = @CLOSEDBY ,
			IS_CLOSURE_NOTIFIED = @IS_CLOSURE_NOTIFIED ,
			NOTIFYDATE = @NOTIFYDATE,
			UPDATED = 1 ,
			UPDATEDON = getdate()
			WHERE REPORTID = @REPORTID AND VESSELCODE=@VESSELCODE

			-- EXEC [dbo].[ER_Insert_ER_Report_UpdationDetails] @FORMNO, @REPORTID, @UPDATEDBY
END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[EV_Import_RISKMGMT_DETAILS]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_Import_RISKMGMT_DETAILS]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROCEDURE [dbo].[EV_Import_RISKMGMT_DETAILS]
(
    @TABLID BIGINT,
	@RISKID BIGINT,
	@VESSELCODE CHAR(3),
	@ROUTINE CHAR(1),
	@HAZARDID BIGINT,
	@HAZARDNAME VARCHAR(1000),
	@LIKELIHOOD INT,
	@CONSEQUENCES INT,
	@RISKRANK CHAR(1),
	@Re_LIKELIHOOD INT,
	@Re_CONSEQUENCES INT,
	@Re_RISKRANK CHAR(1),
	@STD_CONTROL_MESASRUES VARCHAR(1000),
	@ADD_CONTROL_MEASURES VARCHAR(1000),
	@AGREED_TIME  VARCHAR(50),
	@PIC_NAME VARCHAR(50)
)
AS
BEGIN
	SET NOCOUNT ON
		INSERT INTO EV_VSL_RISKMGMT_DETAILS
		(
			TABLID,
			RISKID,
			VESSELCODE,
			ROUTINE,
			HAZARDID,
			HAZARDNAME,
			LIKELIHOOD,
			CONSEQUENCES,
			RISKRANK,
			Re_LIKELIHOOD,
			Re_CONSEQUENCES,
			Re_RISKRANK,
			STD_CONTROL_MESASRUES,
			ADD_CONTROL_MEASURES,
			AGREED_TIME,
			PIC_NAME
		)
		Values
		(
			@TABLID,
			@RISKID,
			@VESSELCODE,
			@ROUTINE,
			@HAZARDID,
			@HAZARDNAME,
			@LIKELIHOOD,
			@CONSEQUENCES,
			@RISKRANK,
			@Re_LIKELIHOOD,
			@Re_CONSEQUENCES,
			@Re_RISKRANK,
			@STD_CONTROL_MESASRUES,
			@ADD_CONTROL_MEASURES,
			@AGREED_TIME,
			@PIC_NAME
		)
		
	END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[EV_Import_RISKMGMT_MASTER]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_Import_RISKMGMT_MASTER]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROCEDURE [dbo].[EV_Import_RISKMGMT_MASTER]
(
    @Mode char(1), 
    @RISKID bigint,
	@VESSELCODE char(3),	
	@EventId bigint,
	@EVENTDATE smalldatetime,
	@REFNO varchar(50),
	@RiskDescr varchar(Max),
	@ALTERNATEMETHODS char(1),
	@Details varchar(Max),
	@HOD_NAME varchar(50),
	@SAF_OFF_NAME varchar(50),
	@MASTER_NAME varchar(50),
	@STATUS char(1),
	@OFFICE_COMMENTS varchar(1000),
	@OFFICECOMMENTBY varchar(50),
	@DESIGNATION varchar(50), 
	@COMMENTDATE smalldatetime,
	@CREATED_BY varchar(50),
	@CREATED_ON smalldatetime,
	@POSITION varchar(50)
)
AS
BEGIN
	SET NOCOUNT ON
	IF (@Mode=''S'')
	BEGIN
		  UPDATE EV_VSL_RISKMGMT_MASTER 
				 SET OFFICE_COMMENTS=@OFFICE_COMMENTS,
					 OFFICECOMMENTBY=@OFFICECOMMENTBY,
					 DESIGNATION=@DESIGNATION,
					 COMMENTDATE=@COMMENTDATE,
					 [STATUS]=@STATUS 
		  WHERE RISKID=@RISKID AND VESSELCODE=@VESSELCODE
	END
	ELSE
	BEGIN
		
		IF NOT EXISTS(SELECT * FROM EV_VSL_RISKMGMT_MASTER WHERE RISKID=@RISKID AND VESSELCODE=@VESSELCODE)	
		BEGIN
			INSERT INTO EV_VSL_RISKMGMT_MASTER
		(
			RISKID,
			VESSELCODE,	
			EventId,
			EVENTDATE,
			REFNO,
			RiskDescr,
			ALTERNATEMETHODS,
			Details,
			HOD_NAME,
			SAF_OFF_NAME,
			MASTER_NAME,
			[STATUS],
			OFFICE_COMMENTS,
			OFFICECOMMENTBY,
			DESIGNATION, 
			COMMENTDATE,
			CREATED_BY,
			CREATED_ON,
			POSITION
		)
		Values
		(
			@RISKID,
			@VESSELCODE,	
			@EventId,
			@EVENTDATE,
			@REFNO,
			@RiskDescr,
			@ALTERNATEMETHODS,
			@Details,
			@HOD_NAME,
			@SAF_OFF_NAME,
			@MASTER_NAME,
			@STATUS,
			@OFFICE_COMMENTS,
			@OFFICECOMMENTBY,
			@DESIGNATION, 
			@COMMENTDATE,
			@CREATED_BY,
			@CREATED_ON,
			@POSITION
		)
		END
		ELSE
		BEGIN
		  UPDATE EV_VSL_RISKMGMT_MASTER 
				 SET EVENTID=@EVENTID,
				 EVENTDATE=@EVENTDATE,
				 REFNO=@REFNO,
				 RiskDescr = @RiskDescr,
				 ALTERNATEMETHODS=@ALTERNATEMETHODS,
				 Details=@Details,
				 HOD_NAME=@HOD_NAME,
				 SAF_OFF_NAME=@SAF_OFF_NAME,
				 MASTER_NAME=@MASTER_NAME
				 
		  WHERE RISKID=@RISKID AND VESSELCODE=@VESSELCODE
		END
	END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[EV_ImportEventMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_ImportEventMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[EV_ImportEventMaster]
(
	@EventId bigint,
	@EventName varchar(50)
)
AS
BEGIN
SET NOCOUNT ON

IF NOT EXISTS(SELECT * FROM EV_EventMaster WHERE EventId=@EventId)	
BEGIN

		INSERT INTO EV_EventMaster
		(
			EventId,
			EventName
		)
		Values
		(
			@EventId,
			@EventName
		)
END
ELSE
BEGIN

      UPDATE EV_EventMaster SET EventName=@EventName WHERE EventId=@EventId
END 

END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[EV_ImportHazardMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_ImportHazardMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[EV_ImportHazardMaster]
(
    @HazardId bigint,
	@EventId bigint,
	@HazardName varchar(1000),
	@STD_CONTROL_MEASURES varchar(5000),
	@ADD_CONTROL_MEASURES varchar(5000)
)
AS
BEGIN
SET NOCOUNT ON

IF NOT EXISTS(SELECT * FROM EV_HazardMaster WHERE HazardId=@HazardId)	
BEGIN

		INSERT INTO EV_HazardMaster
		(
			HazardId,
			EventId,
			HazardName,
			STD_CONTROL_MEASURES,
			ADD_CONTROL_MEASURES
		)
		Values
		(
			@HazardId,
			@EventId,
			@HazardName,
			@STD_CONTROL_MEASURES,
			@ADD_CONTROL_MEASURES
		)
END
ELSE
BEGIN

      UPDATE EV_HazardMaster SET EventId=@EventId, HazardName=@HazardName,STD_CONTROL_MEASURES=@STD_CONTROL_MEASURES,ADD_CONTROL_MEASURES=@ADD_CONTROL_MEASURES WHERE HazardId=@HazardId
END 

END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[EV_InsertRiskDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_InsertRiskDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROCEDURE [dbo].[EV_InsertRiskDetails]
(
	@RISKID bigint,
    @VESSELCODE char(3),
	@ROUTINE char(1),
	@HAZARDID bigint,
	@HAZARDNAME varchar(1000),
	@LIKELIHOOD int,
	@CONSEQUENCES int,
	@RISKRANK char(1),
	@Re_LIKELIHOOD int,
	@Re_CONSEQUENCES int,
	@Re_RISKRANK char(1),
	@STD_CONTROL_MESASRUES varchar(1000),
	@ADD_CONTROL_MEASURES varchar(1000),
	@AGREED_TIME varchar(50),
	@PIC_NAME varchar(50)
)
AS
BEGIN
SET NOCOUNT ON
		DECLARE @TABLID bigint

		SELECT @TABLID = ISNULL(MAX(TABLID), 0) + 1 FROM EV_VSL_RISKMGMT_DETAILS WHERE VESSELCODE=@VESSELCODE AND RISKID=@RISKID

		INSERT INTO EV_VSL_RISKMGMT_DETAILS
		(
		    TABLID,
			RISKID,
			VESSELCODE,
			ROUTINE,
			HAZARDID,
			HAZARDNAME,
			LIKELIHOOD,
			CONSEQUENCES,
			RISKRANK,
			Re_LIKELIHOOD,
			Re_CONSEQUENCES,
			Re_RISKRANK,
			STD_CONTROL_MESASRUES,
			ADD_CONTROL_MEASURES,
			AGREED_TIME,
			PIC_NAME
		)
		Values
		(
		    @TABLID,
			@RISKID,
			@VESSELCODE,
			@ROUTINE,
			@HAZARDID,
			@HAZARDNAME,
			@LIKELIHOOD,
			@CONSEQUENCES,
			@RISKRANK,
			@Re_LIKELIHOOD,
			@Re_CONSEQUENCES,
			@Re_RISKRANK,
			@STD_CONTROL_MESASRUES,
			@ADD_CONTROL_MEASURES,
			@AGREED_TIME,
			@PIC_NAME
		)

END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[EV_InsertUpdateEventMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_InsertUpdateEventMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


			      
CREATE PROC [dbo].[EV_InsertUpdateEventMaster]
(
    @EventId int,
	@EventName varchar(50)
)
AS
BEGIN

  IF(@EventId<=0)
  BEGIN
    
	SELECT @EventId= ISNULL(MAX(EventId),0)+1 FROM EV_EventMaster

	INSERT INTO EV_EventMaster
    (
        EventId,
		EventName
	)
     VALUES
	(
		@EventId,
		@EventName			
	)
   END
   ELSE
   BEGIN
         UPDATE EV_EventMaster 
				SET EventName = @EventName				 
		 WHERE EventId = @EventId
   END
			
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[EV_InsertUpdateHazardMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_InsertUpdateHazardMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


			      
CREATE PROC [dbo].[EV_InsertUpdateHazardMaster]
(
    @HazardId int,
    @EventId int,
	@HazardName varchar(1000),
	@STD_CONTROL_MEASURES varchar(5000),
	@ADD_CONTROL_MEASURES varchar(5000)
)
AS
BEGIN

  IF(@HazardId<=0)
  BEGIN
    
	SELECT @HazardId= ISNULL(MAX(HazardId),0)+1 FROM EV_HazardMaster

	INSERT INTO EV_HazardMaster
    (
        HazardId,
		EventId,
		HazardName,
		STD_CONTROL_MEASURES,
		ADD_CONTROL_MEASURES
	)
     VALUES
	(
		@HazardId,
		@EventId,
		@HazardName,
		@STD_CONTROL_MEASURES,
		@ADD_CONTROL_MEASURES
	)
   END
   ELSE
   BEGIN
         UPDATE EV_HazardMaster 
				SET EventId = @EventId,
					HazardName = @HazardName,
					STD_CONTROL_MEASURES=@STD_CONTROL_MEASURES,
					ADD_CONTROL_MEASURES=@ADD_CONTROL_MEASURES 
		 WHERE HazardId=@HazardId 
   END
			
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[EV_InsertUpdateRiskMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_InsertUpdateRiskMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


					   
CREATE PROCEDURE [dbo].[EV_InsertUpdateRiskMaster]
(
	@RISKID BIGINT,
    @VESSELCODE char(3),
	@EventId bigint,
	@EVENTDATE smalldatetime,
	@REFNO varchar(50),
	@RiskDescr varchar(Max),
	@ALTERNATEMETHODS char(1),
	@Details varchar(Max),
	@HOD_NAME varchar(50),
	@SAF_OFF_NAME varchar(50),
	@MASTER_NAME varchar(50),
	@CREATED_BY varchar(50),
	@CREATED_ON smalldatetime,
	@POSITION varchar(50)
	
)
AS
BEGIN
SET NOCOUNT ON

IF @RISKID<=0
BEGIN
	
		SELECT @RISKID = ISNULL(MAX(RISKID), 0) + 1 FROM EV_VSL_RISKMGMT_MASTER WHERE VESSELCODE=@VESSELCODE

		INSERT INTO EV_VSL_RISKMGMT_MASTER
		(
			RISKID,
			VESSELCODE,
			EventId,
			EVENTDATE,
			REFNO,
			RiskDescr,
			ALTERNATEMETHODS,
			Details,
			HOD_NAME,
			SAF_OFF_NAME,
			MASTER_NAME,
			STATUS,
			CREATED_BY,
			CREATED_ON,
			POSITION
		)
		Values
		(
			@RISKID,
			@VESSELCODE,
			@EventId,
			@EVENTDATE,
			@REFNO,
			@RiskDescr,
			@ALTERNATEMETHODS,
			@Details,
			@HOD_NAME,
			@SAF_OFF_NAME,
			@MASTER_NAME,
			''O'',
			@CREATED_BY,
			@CREATED_ON,
			@POSITION
		)
END
ELSE
BEGIN

      UPDATE EV_VSL_RISKMGMT_MASTER 
	         SET    EVENTDATE = @EVENTDATE,
					REFNO = @REFNO,
					RiskDescr = @RiskDescr,
					ALTERNATEMETHODS = @ALTERNATEMETHODS,
					Details=@Details,
					HOD_NAME = @HOD_NAME,
					SAF_OFF_NAME = @SAF_OFF_NAME,
					MASTER_NAME = @MASTER_NAME 	  
	  WHERE VESSELCODE=@VESSELCODE AND RISKID=@RISKID

	  DELETE FROM EV_VSL_RISKMGMT_DETAILS  WHERE VESSELCODE=@VESSELCODE AND RISKID=@RISKID
END 

END


SELECT @RISKID


' 
END
GO
/****** Object:  StoredProcedure [dbo].[EV_Off_InsertRiskDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_Off_InsertRiskDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

					  
CREATE PROCEDURE [dbo].[EV_Off_InsertRiskDetails]
(
	@RISKID bigint,
    @OfficeId bigint,
	@ROUTINE char(1),
	@HAZARDID bigint,
	@HAZARDNAME varchar(1000),
	@LIKELIHOOD int,
	@CONSEQUENCES int,
	@RISKRANK char(1),
	@Re_LIKELIHOOD int,
	@Re_CONSEQUENCES int,
	@Re_RISKRANK char(1),
	@STD_CONTROL_MESASRUES varchar(1000),
	@ADD_CONTROL_MEASURES varchar(1000),
	@AGREED_TIME varchar(50),
	@PIC_NAME varchar(50)
)
AS
BEGIN
SET NOCOUNT ON
		DECLARE @TABLID bigint

		SELECT @TABLID = ISNULL(MAX(TABLID), 0) + 1 FROM EV_Off_RISKMGMT_DETAILS WHERE OfficeId=@OfficeId AND RISKID=@RISKID

		INSERT INTO EV_Off_RISKMGMT_DETAILS
		(
		    TABLID,
			RISKID,
			OfficeId,
			ROUTINE,
			HAZARDID,
			HAZARDNAME,
			LIKELIHOOD,
			CONSEQUENCES,
			RISKRANK,
			Re_LIKELIHOOD,
			Re_CONSEQUENCES,
			Re_RISKRANK,
			STD_CONTROL_MESASRUES,
			ADD_CONTROL_MEASURES,
			AGREED_TIME,
			PIC_NAME
		)
		Values
		(
		    @TABLID,
			@RISKID,
			@OfficeId,
			@ROUTINE,
			@HAZARDID,
			@HAZARDNAME,
			@LIKELIHOOD,
			@CONSEQUENCES,
			@RISKRANK,
			@Re_LIKELIHOOD,
			@Re_CONSEQUENCES,
			@Re_RISKRANK,
			@STD_CONTROL_MESASRUES,
			@ADD_CONTROL_MEASURES,
			@AGREED_TIME,
			@PIC_NAME
		)

END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[EV_Off_InsertUpdateRiskMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_Off_InsertUpdateRiskMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


					   
CREATE PROCEDURE [dbo].[EV_Off_InsertUpdateRiskMaster]
(
	@RISKID BIGINT,
    @OfficeId bigint,
	@EventId bigint,
	@EVENTDATE smalldatetime,
	@REFNO varchar(50),
	@RiskDescr varchar(Max),
	@ALTERNATEMETHODS char(1),
	@Details varchar(Max),
	@HOD_NAME varchar(50),
	@SAF_OFF_NAME varchar(50),
	@MASTER_NAME varchar(50),
	@CREATED_BY varchar(50),
	@CREATED_ON smalldatetime,
	@POSITION varchar(50)
	
)
AS
BEGIN
SET NOCOUNT ON

IF @RISKID<=0
BEGIN
	
		SELECT @RISKID = ISNULL(MAX(RISKID), 0) + 1 FROM EV_Off_RISKMGMT_MASTER

		INSERT INTO EV_Off_RISKMGMT_MASTER
		(
			RISKID,
			OfficeId,
			EventId,
			EVENTDATE,
			REFNO,
			RiskDescr,
			ALTERNATEMETHODS,
			Details,
			HOD_NAME,
			SAF_OFF_NAME,
			MASTER_NAME,
			STATUS,
			CREATED_BY,
			CREATED_ON,
			POSITION
		)
		Values
		(
			@RISKID,
			@OfficeId,
			@EventId,
			@EVENTDATE,
			@REFNO,
			@RiskDescr,
			@ALTERNATEMETHODS,
			@Details,
			@HOD_NAME,
			@SAF_OFF_NAME,
			@MASTER_NAME,
			''O'',
			@CREATED_BY,
			@CREATED_ON,
			@POSITION
		)
END
ELSE
BEGIN

      UPDATE EV_Off_RISKMGMT_MASTER 
	         SET    EVENTDATE = @EVENTDATE,
					REFNO = @REFNO,
					RiskDescr = @RiskDescr,
					ALTERNATEMETHODS = @ALTERNATEMETHODS,
					Details=@Details,
					HOD_NAME = @HOD_NAME,
					SAF_OFF_NAME = @SAF_OFF_NAME,
					MASTER_NAME = @MASTER_NAME	  
	  WHERE OfficeId=@OfficeId AND RISKID=@RISKID

	  DELETE FROM EV_Off_RISKMGMT_DETAILS  WHERE RISKID=@RISKID
END 

SELECT @RISKID

END







' 
END
GO
/****** Object:  StoredProcedure [dbo].[ExecQuery]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ExecQuery]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[ExecQuery]
@Query varchar(7000)
AS
BEGIN
	EXEC (@Query)
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[GET_INVETORYDATA]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GET_INVETORYDATA]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROC [dbo].[GET_INVETORYDATA]
(
	@VSL CHAR(3),
	@FDT SMALLDATETIME
)
AS
BEGIN

-- EXEC DBO.GET_INVETORYDATA ''SHI'',''01-FEB-2015''

DECLARE @LASTMONTH SMALLDATETIME
DECLARE @TDT SMALLDATETIME
DECLARE @LASTINVENTORYID BIGINT
DECLARE @CURRINVENTORYID BIGINT 

SET @LASTMONTH=DATEADD(m,-1,@FDT)
SET @TDT=DATEADD(d,-1, DATEADD(m,1,@FDT))

SELECT TOP 1 @LASTINVENTORYID=InventoryId FROM [dbo].[MP_VSL_InventoryMaster] WHERE VESSELCODE=@VSL AND [dbo].getdatepart([InventoryDate]) <= @LASTMONTH ORDER BY [InventoryDate] DESC
SELECT TOP 1 @CURRINVENTORYID=InventoryId FROM [dbo].[MP_VSL_InventoryMaster] WHERE VESSELCODE=@VSL AND [dbo].getdatepart([InventoryDate]) = @FDT ORDER BY [InventoryDate] DESC

PRINT @LASTINVENTORYID
PRINT @CURRINVENTORYID
-- ITEM CATEGORY 

DECLARE @TEMPTABLE TABLE(ROWTYPE CHAR(1),CategoryId1 INT ,CATEGORYCODE1 VARCHAR(5),CategoryName VARCHAR(255),ProductId INT,[ProductCode] VARCHAR(50),[ProductName] VARCHAR(255), [UnitName] VARCHAR(255),[OpeningStock] Float,[VSL_Supply] float,[Balance] float,Consumption float,SUPPLY1 FLOAT,SUPPLY2 FLOAT,SUPPLY3 FLOAT,[Spoilage] float)

INSERT INTO @TEMPTABLE
SELECT ''P'' AS ROWTYPE,CategoryId,'''','''',[ProductId],[ProductCode],[ProductName],[IMPACode], [OpeningStock],[Supply],[Balance], 0,0,0,0,Spoilage
FROM ( 
SELECT P.CategoryId,P.[ProductId],P.[ProductCode],P.[ProductName],P.[IMPACode], 
ISNULL((SELECT Quantity FROM [dbo].[MP_VSL_InventoryDetails] ID WHERE ID.[VesselCode] =@VSL AND ID.[InventoryId]=@LASTINVENTORYID AND ID.[ProductId] = P.[ProductId] 
), 0) AS [OpeningStock], 

ISNULL((SELECT (SUM(PackagingOrderQty*Quantity)) FROM [dbo].[MP_VSL_SupplyDetails]  
WHERE [VesselCode] = @VSL AND [SupplyId] IN (  
SELECT [SupplyId] FROM [dbo].[MP_VSL_SupplyMaster] WHERE  VESSELCODE=@VSL AND [dbo].getdatepart([ReceivingDate]) BETWEEN @FDT AND @TDT)  
AND [ProductId] = P.[ProductId]),0) AS [Supply],  

ISNULL( (SELECT [Quantity] FROM  [dbo].[MP_VSL_InventoryDetails] WHERE [VesselCode] = @VSL AND [InventoryId]=@CURRINVENTORYID AND [ProductId] = P.[ProductId]) 
,0) AS [Balance],

ISNULL( (SELECT [Spoilage] FROM  [dbo].[MP_VSL_InventoryDetails] WHERE [VesselCode] = @VSL AND [InventoryId]=@CURRINVENTORYID AND [ProductId] = P.[ProductId]) 
,0) AS [Spoilage]  

FROM [dbo].[MP_Products] P  

) B ORDER BY CategoryId,ProductId

UPDATE @TEMPTABLE SET CATEGORYCODE1=LEFT([ProductCode],2)
UPDATE @TEMPTABLE SET 
CategoryName=(select CategoryName from DBO.MP_MainCategory MC WHERE MC.CATEGORYCODE=CATEGORYCODE1)
,UnitName=(SELECT UNITNAME FROM MP_UnitMaster WHERE UNITID IN (select ORDERUNITID from DBO.MP_MainCategory MC WHERE MC.CATEGORYID=CategoryId1))
 
DECLARE @TEMPBIDID TABLE(PK INT IDENTITY, BIDID INT,BIDPONUM VARCHAR(50))

INSERT INTO @TEMPBIDID(BIDID,BIDPONUM)
SELECT TOP 3 PO.BidID,BIDPONUM FROM
MTMM2000SQL.DBO.tblsmdpomasterbid PO left join MTMM2000SQL.DBO.tblsmdpomaster PR ON PR.POID=PO.POID
left join MTMM2000SQL.DBO.tblSMDBIDStatusCodes STAT on STAT.BIDSTATUSID=PO.BIDSTATUSID
left join MTMM2000SQL.DBO.sql_tblSMDPRAccounts AC on AC.ACCOUNTID=PR.ACCOUNTID
WHERE pr.shipid=@VSL AND PO.BIDSTATUSID=6 AND ISPO=1 AND PR.PRTYPE = 1 AND AC.ACCOUNTNUMBER IN (1780 , 5180) AND BIDSMDLEVEL1APPROVALDATE BETWEEN @FDT AND @TDT

DECLARE @B1 INT
DECLARE @B2 INT
DECLARE @B3 INT

DECLARE @P1 INT
DECLARE @P2 INT
DECLARE @P3 INT

SELECT @B1=BIDID FROM @TEMPBIDID WHERE PK=1
SELECT @B2=BIDID FROM @TEMPBIDID WHERE PK=2
SELECT @B3=BIDID FROM @TEMPBIDID WHERE PK=3

SELECT @P1=POID FROM MTMM2000SQL.DBO.tblsmdpoMASTERbid WHERE BIDID=@B1
SELECT @P2=POID FROM MTMM2000SQL.DBO.tblsmdpoMASTERbid WHERE BIDID=@B2
SELECT @P3=POID FROM MTMM2000SQL.DBO.tblsmdpoMASTERbid WHERE BIDID=@B3

print @P1
print @P2
print @P3

DECLARE @VTABLE TABLE (RECID BIGINT , QTY FLOAT , PRODUCTID1 BIGINT)

IF( ISNULL(@B1,0) > 0)
BEGIN
	INSERT INTO @VTABLE SELECT RECID,QTYINV,(SELECT PROVISIONPRODUCTID FROM MTMPOS.DBO.Add_tblSMDPODetail D WHERE POID=@P1 AND D.RECID=B.RECID) FROM MTMM2000SQL.DBO.tblsmdpoDETAILbid B WHERE BIDID=@B1 
	UPDATE @TEMPTABLE SET SUPPLY1=ISNULL((SELECT QTY FROM @VTABLE WHERE PRODUCTID1=PRODUCTID),0)
END
ELSE
	UPDATE @TEMPTABLE SET SUPPLY1=0

DELETE FROM @VTABLE
IF( ISNULL(@B2,0) > 0)
BEGIN
	INSERT INTO @VTABLE SELECT RECID,QTYINV,(SELECT PROVISIONPRODUCTID FROM MTMPOS.DBO.Add_tblSMDPODetail D WHERE POID=@P2 AND D.RECID=B.RECID) FROM MTMM2000SQL.DBO.tblsmdpoDETAILbid B WHERE BIDID=@B2 
	UPDATE @TEMPTABLE SET SUPPLY2=ISNULL((SELECT QTY FROM @VTABLE WHERE PRODUCTID1=PRODUCTID),0)
END
ELSE
	UPDATE @TEMPTABLE SET SUPPLY2=0

DELETE FROM @VTABLE
IF( ISNULL(@B3,0) > 0)
BEGIN
	INSERT INTO @VTABLE SELECT RECID,QTYINV,(SELECT PROVISIONPRODUCTID FROM MTMPOS.DBO.Add_tblSMDPODetail D WHERE POID=@P3 AND D.RECID=B.RECID) FROM MTMM2000SQL.DBO.tblsmdpoDETAILbid B WHERE BIDID=@B3 
	UPDATE @TEMPTABLE SET SUPPLY3=ISNULL((SELECT QTY FROM @VTABLE WHERE PRODUCTID1=PRODUCTID),0)
END
ELSE
	UPDATE @TEMPTABLE SET SUPPLY3=0

UPDATE @TEMPTABLE SET CONSUMPTION=ISNULL([OpeningStock],0) + ISNULL(SUPPLY1,0) + ISNULL(SUPPLY2,0) + ISNULL(SUPPLY3,0) -ISNULL([Spoilage],0) -ISNULL([Balance],0) 


SELECT ProductId,PRODUCTCODE,CategoryName,PRODUCTNAME,UNITNAME,OpeningStock,VSL_Supply,SUPPLY1,SUPPLY2,SUPPLY3,CONSUMPTION,BALANCE,[Spoilage] FROM @TEMPTABLE ORDER BY CATEGORYCODE1


SELECT @B1 AS BIDID1,@B2 AS BIDID2,@B1 AS BIDID3
,(SELECT BIDPONUM FROM @TEMPBIDID WHERE BIDID=@B1) AS BIDPONUM1
,(SELECT BIDPONUM FROM @TEMPBIDID WHERE BIDID=@B2) AS BIDPONUM2
,(SELECT BIDPONUM FROM @TEMPBIDID WHERE BIDID=@B3) AS BIDPONUM3

--SELECT ''C'' AS ROWTYPE,CATEGORYCODE1 AS CATEGORYCODE,CATEGORYNAME,UnitName,SUM([OpeningStock]) AS OpeningStock,SUM(SUPPLY1) AS SUPPLY1, SUM(SUPPLY2) AS SUPPLY2,SUM(SUPPLY3) AS SUPPLY3,SUM(BALANCE) AS BALANCE,SUM(CONSUMPTION) AS CONSUMPTION FROM @TEMPTABLE 
--GROUP BY CATEGORYCODE1,CATEGORYNAME,UnitName
--ORDER BY CATEGORYCODE1

END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[GET_INVETORYDATA_SHIP]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GET_INVETORYDATA_SHIP]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



CREATE PROC [dbo].[GET_INVETORYDATA_SHIP]
(
	@VSL CHAR(3),
	@FDT SMALLDATETIME
)
AS
BEGIN

-- EXEC DBO.GET_INVETORYDATA_SHIP ''LIG'',''01-JAN-2015''

DECLARE @LASTMONTH SMALLDATETIME
DECLARE @TDT SMALLDATETIME
DECLARE @LASTINVENTORYID BIGINT
DECLARE @CURRINVENTORYID BIGINT 

SET @LASTMONTH=DATEADD(m,-1,@FDT)
SET @TDT=DATEADD(d,-1, DATEADD(m,1,@FDT))

SELECT TOP 1 @LASTINVENTORYID=InventoryId FROM [dbo].[MP_VSL_InventoryMaster] WHERE VESSELCODE=@VSL AND [dbo].getdatepart([InventoryDate]) <= @LASTMONTH ORDER BY [InventoryDate] DESC
SELECT TOP 1 @CURRINVENTORYID=InventoryId FROM [dbo].[MP_VSL_InventoryMaster] WHERE VESSELCODE=@VSL AND [dbo].getdatepart([InventoryDate]) = @FDT ORDER BY [InventoryDate] DESC
PRINT ''LAST''
PRINT @LASTINVENTORYID
PRINT ''CURR''
PRINT @CURRINVENTORYID
-- ITEM CATEGORY 

DECLARE @TEMPTABLE TABLE(ROWTYPE CHAR(1),CategoryId1 INT ,CATEGORYCODE1 VARCHAR(5),CategoryName VARCHAR(255),ProductId INT,[ProductCode] VARCHAR(50),[ProductName] VARCHAR(255), [UnitName] VARCHAR(255),[OpeningStock] Float,[VSL_Supply] float,[Balance] float,Consumption float,SUPPLY1 FLOAT,SUPPLY2 FLOAT,SUPPLY3 FLOAT,[Spoilage] float)

INSERT INTO @TEMPTABLE
SELECT ''P'' AS ROWTYPE,CategoryId,'''','''',[ProductId],[ProductCode],[ProductName],[IMPACode], [OpeningStock],[Supply],[Balance], 0,0,0,0,Spoilage
FROM ( 
SELECT P.CategoryId,P.[ProductId],P.[ProductCode],P.[ProductName],P.[IMPACode], 
ISNULL((SELECT Quantity FROM [dbo].[MP_VSL_InventoryDetails] ID WHERE ID.[VesselCode] =@VSL AND ID.[InventoryId]=@LASTINVENTORYID AND ID.[ProductId] = P.[ProductId] 
), 0) AS [OpeningStock], 

ISNULL((SELECT SUM( CASE WHEN PackagingUnit=0 THEN Quantity ELSE PackagingOrderQty*Quantity END) FROM [dbo].[MP_VSL_SupplyDetails]  
WHERE [VesselCode] = @VSL AND [SupplyId] IN (  
SELECT [SupplyId] FROM [dbo].[MP_VSL_SupplyMaster] WHERE  VESSELCODE=@VSL AND [dbo].getdatepart([ReceivingDate]) BETWEEN @FDT AND @TDT)  
AND [ProductId] = P.[ProductId]),0) AS [Supply],  

ISNULL( (SELECT [Quantity] FROM  [dbo].[MP_VSL_InventoryDetails] WHERE [VesselCode] = @VSL AND [InventoryId]=@CURRINVENTORYID AND [ProductId] = P.[ProductId]) 
,0) AS [Balance],

ISNULL( (SELECT [Spoilage] FROM  [dbo].[MP_VSL_InventoryDetails] WHERE [VesselCode] = @VSL AND [InventoryId]=@CURRINVENTORYID AND [ProductId] = P.[ProductId]) 
,0) AS [Spoilage] 

FROM [dbo].[MP_Products] P  

) B ORDER BY CategoryId,ProductId

UPDATE @TEMPTABLE SET CATEGORYCODE1=LEFT([ProductCode],2)
UPDATE @TEMPTABLE SET 
CategoryName=(select CategoryName from DBO.MP_MainCategory MC WHERE MC.CATEGORYCODE=CATEGORYCODE1)
,UnitName=(SELECT UNITNAME FROM MP_UnitMaster WHERE UNITID IN (select ORDERUNITID from DBO.MP_MainCategory MC WHERE MC.CATEGORYID=CategoryId1))
 
--DECLARE @TEMPBIDID TABLE(PK INT IDENTITY, BIDID INT,BIDPONUM VARCHAR(50))

--INSERT INTO @TEMPBIDID(BIDID,BIDPONUM)
--SELECT TOP 3 PO.BidID,BIDPONUM FROM
--MTMM2000SQL.DBO.tblsmdpomasterbid PO left join MTMM2000SQL.DBO.tblsmdpomaster PR ON PR.POID=PO.POID
--left join MTMM2000SQL.DBO.tblSMDBIDStatusCodes STAT on STAT.BIDSTATUSID=PO.BIDSTATUSID
--left join MTMM2000SQL.DBO.sql_tblSMDPRAccounts AC on AC.ACCOUNTID=PR.ACCOUNTID
--WHERE pr.shipid=@VSL AND PO.BIDSTATUSID=6 AND ISPO=1 AND PR.PRTYPE = 1 AND AC.ACCOUNTNUMBER IN (1780 , 5180) AND BIDSMDLEVEL1APPROVALDATE BETWEEN @FDT AND @TDT

----DECLARE @B1 INT
----DECLARE @B2 INT
----DECLARE @B3 INT

----DECLARE @P1 INT
----DECLARE @P2 INT
----DECLARE @P3 INT

----SELECT @B1=BIDID FROM @TEMPBIDID WHERE PK=1
----SELECT @B2=BIDID FROM @TEMPBIDID WHERE PK=2
----SELECT @B3=BIDID FROM @TEMPBIDID WHERE PK=3

----SELECT @P1=POID FROM MTMM2000SQL.DBO.tblsmdpoMASTERbid WHERE BIDID=@B1
----SELECT @P2=POID FROM MTMM2000SQL.DBO.tblsmdpoMASTERbid WHERE BIDID=@B2
----SELECT @P3=POID FROM MTMM2000SQL.DBO.tblsmdpoMASTERbid WHERE BIDID=@B3

----print @P1
----print @P2
----print @P3

----DECLARE @VTABLE TABLE (RECID BIGINT , QTY FLOAT , PRODUCTID1 BIGINT)

----IF( ISNULL(@B1,0) > 0)
----BEGIN
----	INSERT INTO @VTABLE SELECT RECID,QTYINV,(SELECT PROVISIONPRODUCTID FROM MTMPOS.DBO.Add_tblSMDPODetail D WHERE POID=@P1 AND D.RECID=B.RECID) FROM MTMM2000SQL.DBO.tblsmdpoDETAILbid B WHERE BIDID=@B1 
----	UPDATE @TEMPTABLE SET SUPPLY1=ISNULL((SELECT QTY FROM @VTABLE WHERE PRODUCTID1=PRODUCTID),0)
----END
----ELSE
----	UPDATE @TEMPTABLE SET SUPPLY1=0

----DELETE FROM @VTABLE
----IF( ISNULL(@B2,0) > 0)
----BEGIN
----	INSERT INTO @VTABLE SELECT RECID,QTYINV,(SELECT PROVISIONPRODUCTID FROM MTMPOS.DBO.Add_tblSMDPODetail D WHERE POID=@P2 AND D.RECID=B.RECID) FROM MTMM2000SQL.DBO.tblsmdpoDETAILbid B WHERE BIDID=@B2 
----	UPDATE @TEMPTABLE SET SUPPLY2=ISNULL((SELECT QTY FROM @VTABLE WHERE PRODUCTID1=PRODUCTID),0)
----END
----ELSE
----	UPDATE @TEMPTABLE SET SUPPLY2=0

----DELETE FROM @VTABLE
----IF( ISNULL(@B3,0) > 0)
----BEGIN
----	INSERT INTO @VTABLE SELECT RECID,QTYINV,(SELECT PROVISIONPRODUCTID FROM MTMPOS.DBO.Add_tblSMDPODetail D WHERE POID=@P3 AND D.RECID=B.RECID) FROM MTMM2000SQL.DBO.tblsmdpoDETAILbid B WHERE BIDID=@B3 
----	UPDATE @TEMPTABLE SET SUPPLY3=ISNULL((SELECT QTY FROM @VTABLE WHERE PRODUCTID1=PRODUCTID),0)
----END
----ELSE
----	UPDATE @TEMPTABLE SET SUPPLY3=0

UPDATE @TEMPTABLE SET CONSUMPTION=ISNULL([OpeningStock],0) + ISNULL([VSL_Supply],0) -ISNULL([Spoilage],0) -ISNULL([Balance],0)   


SELECT ProductId,PRODUCTCODE,CategoryName,PRODUCTNAME,UNITNAME,OpeningStock,VSL_Supply,SUPPLY1,SUPPLY2,SUPPLY3,CONSUMPTION,BALANCE,[Spoilage]  FROM @TEMPTABLE ORDER BY CATEGORYCODE1


--SELECT @B1 AS BIDID1,@B2 AS BIDID2,@B1 AS BIDID3
--,(SELECT BIDPONUM FROM @TEMPBIDID WHERE BIDID=@B1) AS BIDPONUM1
--,(SELECT BIDPONUM FROM @TEMPBIDID WHERE BIDID=@B2) AS BIDPONUM2
--,(SELECT BIDPONUM FROM @TEMPBIDID WHERE BIDID=@B3) AS BIDPONUM3

--SELECT ''C'' AS ROWTYPE,CATEGORYCODE1 AS CATEGORYCODE,CATEGORYNAME,UnitName,SUM([OpeningStock]) AS OpeningStock,SUM(SUPPLY1) AS SUPPLY1, SUM(SUPPLY2) AS SUPPLY2,SUM(SUPPLY3) AS SUPPLY3,SUM(BALANCE) AS BALANCE,SUM(CONSUMPTION) AS CONSUMPTION FROM @TEMPTABLE 
--GROUP BY CATEGORYCODE1,CATEGORYNAME,UnitName
--ORDER BY CATEGORYCODE1

END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[GET_SUPPLYDATA_SHIP]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GET_SUPPLYDATA_SHIP]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'




CREATE PROC [dbo].[GET_SUPPLYDATA_SHIP]
(
	@VSL CHAR(3),
	@SupplyId bigint
)

AS

BEGIN



-- EXEC DBO.[GET_SUPPLYDATA_SHIP] ''lig'',0

-- ITEM CATEGORY 

DECLARE @TEMPTABLE TABLE(CategoryId1 INT ,CATEGORYCODE1 VARCHAR(5),CategoryName VARCHAR(255),ProductId INT,[ProductCode] VARCHAR(50),[ProductName] VARCHAR(255), [UnitName] VARCHAR(255),SupplyDetailId bigint,SupplyUnitId int,[Qty] Float,[PackagingQty] float,[PackagingUnit] int,[PackagingOrderQty] float)
INSERT INTO @TEMPTABLE

SELECT P.CategoryId,'''','''',P.[ProductId],[ProductCode],[ProductName],isnull(UM.UnitName,UM_ORDER.UnitName) AS UnitName,SD.SupplyDetailId,SupplyUnitId,Quantity,PackagingQty,PackagingUnit,PackagingOrderQty
FROM [dbo].[MP_Products] P left join [dbo].[MP_VSL_SupplyDetails] SD ON SD.[VesselCode] =@VSL AND SD.SupplyId=@SupplyId AND SD.ProductId = P.ProductId 
LEFT JOIN [dbo].MP_UnitMaster UM ON UM.UNITID=P.SupplyUnitId
LEFT JOIN [dbo].MP_MainCategory MC1 ON MC1.CATEGORYID=P.CATEGORYID
LEFT JOIN [dbo].MP_MainCategory MC ON MC.CATEGORYID=MC1.ParentCategoryId
LEFT JOIN [dbo].MP_UnitMaster UM_ORDER ON UM_ORDER.UNITID=MC.OrderUnitId

ORDER BY P.CategoryId,ProductId


UPDATE @TEMPTABLE SET CATEGORYCODE1=LEFT([ProductCode],2)

UPDATE @TEMPTABLE SET 

CategoryName=(select CategoryName from DBO.MP_MainCategory MC WHERE MC.CATEGORYCODE=CATEGORYCODE1)

--,UnitName=(SELECT UNITNAME FROM MP_UnitMaster WHERE UNITID IN (select ORDERUNITID from DBO.MP_MainCategory MC WHERE MC.CATEGORYID=CategoryId1))

SELECT *,isnull(convert(varchar,case when PackagingOrderQty<=0 then NULL ELSE PackagingOrderQty END),'''') as PackagingOrderQty1 FROM @TEMPTABLE ORDER BY CATEGORYCODE1


END






' 
END
GO
/****** Object:  StoredProcedure [dbo].[Import_O_VNA_Details]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Import_O_VNA_Details]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROC [dbo].[Import_O_VNA_Details]
(
    @VESSELCODE char(3),
	@VNAID bigint,
	@QID bigint,
	@QNO varchar(50),
	@QTEXT varchar(max),
	@GUIDANCE varchar(max),
	@COMPLY varchar(50),
	@SHIPCOMMENTS varchar(max),
	@SHIPCOMMENTBY varchar(50),
	@SHIPCOMMENTDATE smalldatetime,
	@OFFICECOMMENTS varchar(max),
	@OFFICECOMMENTBY varchar(50),
	@OFFICECOMMENTDATE smalldatetime
)
AS
BEGIN
	
	      UPDATE [VNA_Details]

		  SET COMPLY=@COMPLY,
		      SHIPCOMMENTS=@SHIPCOMMENTS,
              SHIPCOMMENTBY=@SHIPCOMMENTBY ,
              SHIPCOMMENTDATE=@SHIPCOMMENTDATE 
		WHERE VESSELCODE=@VESSELCODE AND VNAID=@VNAID  AND QID=@QID		
	
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[Import_O_VNA_Master]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Import_O_VNA_Master]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



CREATE PROC [dbo].[Import_O_VNA_Master]
(
@VNAID BIGINT,
@VesselCode VARCHAR(3),
@VNANo VARCHAR(50),
@CreatedBy INT,
@CreatedOn SMALLDATETIME,
@OfficeRemark VARCHAR(MAX),
@ClosedBy VARCHAR(50),
@ClosedOn SMALLDATETIME,
@AuditFrom SMALLDATETIME,
@AuditTo SMALLDATETIME,
@PortFrom VARCHAR(50),
@PortTo VARCHAR(50),
@MasterCrewNo VARCHAR(10),
@MasterName VARCHAR(100)
)
AS
BEGIN
	
	    UPDATE VNA_Master
		SET AuditFrom=@AuditFrom,
		      AuditTo=@AuditTo,
              PortFrom=@PortFrom ,
              PortTo=@PortTo ,
			  MasterCrewNo=@MasterCrewNo,
			  MasterName=@MasterName
		WHERE VESSELCODE=@VESSELCODE AND VNAID=@VNAID
	
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[Import_S_VNA_Details]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Import_S_VNA_Details]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROC [dbo].[Import_S_VNA_Details]
(
    @VESSELCODE char(3),
	@VNAID bigint,
	@QID bigint,
	@QNO varchar(50),
	@QTEXT varchar(max),
	@GUIDANCE varchar(max),
	@COMPLY varchar(50),
	@SHIPCOMMENTS varchar(max),
	@SHIPCOMMENTBY varchar(50),
	@SHIPCOMMENTDATE smalldatetime,
	@OFFICECOMMENTS varchar(max),
	@OFFICECOMMENTBY varchar(50),
	@OFFICECOMMENTDATE smalldatetime
)
AS
BEGIN
	IF NOT EXISTS(SELECT VNAID FROM VNA_Details WHERE VESSELCODE=@VESSELCODE AND VNAID=@VNAID  AND QID=@QID)
	BEGIN	
		
		INSERT INTO [dbo].[VNA_Details]
           ([VESSELCODE]
           ,[VNAID]
           ,[QID]
           ,[QNO]
           ,[QTEXT]
           ,[GUIDANCE]
           ,[COMPLY]
           ,[SHIPCOMMENTS]
           ,[SHIPCOMMENTBY]
           ,[SHIPCOMMENTDATE]
           ,[OFFICECOMMENTS]
           ,[OFFICECOMMENTBY]
           ,[OFFICECOMMENTDATE])
     VALUES
	 (
           @VESSELCODE,
           @VNAID ,
           @QID ,
           @QNO ,
           @QTEXT,
           @GUIDANCE,
           @COMPLY,
           @SHIPCOMMENTS,
           @SHIPCOMMENTBY ,
           @SHIPCOMMENTDATE ,
           @OFFICECOMMENTS ,
           @OFFICECOMMENTBY,
           @OFFICECOMMENTDATE
		)
	END
	ELSE
	BEGIN

	      UPDATE [VNA_Details]

		  SET OFFICECOMMENTS=@OFFICECOMMENTS ,
              OFFICECOMMENTBY=@OFFICECOMMENTBY,
              OFFICECOMMENTDATE=@OFFICECOMMENTDATE
		WHERE VESSELCODE=@VESSELCODE AND VNAID=@VNAID  AND QID=@QID
		
	END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[Import_S_VNA_Master]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Import_S_VNA_Master]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



CREATE PROC [dbo].[Import_S_VNA_Master]
(
  @VNAId bigint,
  @VesselCode varchar(3),
  @VNANo varchar(50),
  @CreatedBy int,
  @CreatedOn smalldatetime,
  @OfficeRemark varchar(max),
  @ClosedBy varchar(50),
  @ClosedOn smalldatetime,
  @AuditFrom smalldatetime,
  @AuditTo smalldatetime,
  @PortFrom varchar(50),
  @PortTo varchar(50),
  @MasterCrewNo varchar(10),
  @MasterName varchar(100)
)
AS
BEGIN
	IF NOT EXISTS(SELECT VNAID FROM VNA_Master WHERE LTRIM(RTRIM(VNANo))=LTRIM(RTRIM(@VNANo)))
	BEGIN	
		--DECLARE @VNAID INT
		--SELECT @VNAID=ISNULL(MAX(VNAID),0)+1 FROM VNA_Master WHERE VesselCode=@VSLCODE

		INSERT INTO VNA_Master
		(
		  VNAId,
		  VesselCode,
		  VNANo,
		  CreatedBy,
		  CreatedOn,
		  OfficeRemark,
		  ClosedBy,
		  ClosedOn,
		  AuditFrom,
		  AuditTo,
		  PortFrom,
		  PortTo,
		  MasterCrewNo,
		  MasterName	
		)
		VALUES
		(
		  @VNAId,
		  @VesselCode,
		  @VNANo,
		  @CreatedBy,
		  @CreatedOn,
		  @OfficeRemark,
		  @ClosedBy,
		  @ClosedOn,
		  @AuditFrom,
		  @AuditTo,
		  @PortFrom,
		  @PortTo,
		  @MasterCrewNo,
		  @MasterName
		)
	END
	ELSE
	BEGIN

	      UPDATE VNA_Master

		  SET OfficeRemark=@OfficeRemark,
			  ClosedBy=@ClosedBy,
			  ClosedOn=@ClosedOn,
			  AuditFrom=@AuditFrom,
			  AuditTo=@AuditTo,
			  PortFrom=@PortFrom,
			  PortTo=@PortTo,
			  MasterCrewNo=@MasterCrewNo,
			  MasterName=@MasterName
		WHERE VesselCode=@VesselCode AND VNANo = @VNANo AND VNAId=@VNAId
		
	END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[InsertFocusCamp_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertFocusCamp_Vessel_Notifications]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
create proc [dbo].[InsertFocusCamp_Vessel_Notifications]
(
@FocusCampId bigint,
@VesselCode char(3)
)
as
begin
	if exists(select * from FocusCamp_Vessel_Notifications where FocusCampID=@FocusCampId AND VESSELCODE=@VesselCode)
	BEGIN
		UPDATE FocusCamp_Vessel_Notifications SET SENTON=GETDATE(),ACKON=NULL,ACKMESSAGE=NULL where FocusCampID=@FocusCampId AND VESSELCODE=@VesselCode
	END
	ELSE
	BEGIN
		INSERT INTO FocusCamp_Vessel_Notifications(FocusCampID,VESSELCODE,SENTON)
		VALUES(@FocusCampId,@VesselCode,GETDATE())	
	END
end

' 
END
GO
/****** Object:  StoredProcedure [dbo].[InsertLFI_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertLFI_Vessel_Notifications]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
create proc [dbo].[InsertLFI_Vessel_Notifications]
(
@LFIId bigint,
@VesselCode char(3)
)
as
begin
	if exists(select * from LFI_Vessel_Notifications where LFIID=@LFIId AND VESSELCODE=@VesselCode)
	BEGIN
		UPDATE LFI_Vessel_Notifications SET SENTON=GETDATE(),ACKON=NULL,ACKMESSAGE=NULL where LFIID=@LFIId AND VESSELCODE=@VesselCode
	END
	ELSE
	BEGIN
		INSERT INTO LFI_Vessel_Notifications(LFIID,VESSELCODE,SENTON)
		VALUES(@LFIId,@VesselCode,GETDATE())	
	END
end

' 
END
GO
/****** Object:  StoredProcedure [dbo].[InsertUpdate_VLI]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertUpdate_VLI]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE proc [dbo].[InsertUpdate_VLI]
(
@VLIId bigint,
@VLIDate smalldatetime,
@VesselId int,
@VisitedBY int,
@Remarks varchar(1000),
@LFIS varchar(1000),
@FCS varchar(1000)
)
as
begin
DECLARE @VisitedBYPOSITION INT
IF(@VLIId<=0)
BEGIN
	SELECT @VisitedBYPOSITION=POSITION FROM DBO.EMTM_HR_PERSONALDETAILS WHERE USERID=@VisitedBY
	SELECT @VLIID=ISNULL(MAX(VLIID),0)+1 FROM VLI
	INSERT INTO VLI(VLIID,VLIDATE,VESSELID,VISITEDBY,VisitedBYPOSITION,REMARKS)
	VALUES(@VLIID,@VLIDATE,@VESSELID,@VisitedBY,@VisitedBYPOSITION,@Remarks)
END
ELSE
BEGIN
	UPDATE VLI
	SET VLIDATE=@VLIDATE,
	VESSELID=@VESSELID,
	Remarks=@Remarks
	WHERE VLIID=@VLIID

	DELETE FROM VLI_LFI_FC WHERE VLIID=@VLIID
END

	INSERT INTO VLI_LFI_FC
	SELECT @VLIID,''L'',RESULT FROM [dbo].[CSVtoTable](@LFIS,'','')

	INSERT INTO VLI_LFI_FC
	SELECT @VLIID,''F'',RESULT FROM [dbo].[CSVtoTable](@FCS,'','')
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[INSERTUPDATEFocusCamp]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[INSERTUPDATEFocusCamp]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[INSERTUPDATEFocusCamp]
(
    @FocusCampID int,
	@FocusCampNUMBER varchar(50),
	@FocusCampDATE smalldatetime,
	@TITLE varchar(500),
	@ATTACHMENTFILENAME varchar(100),
	@ATTACHMENT image,
	@CREATEDBY varchar(50),
	@FocusCamp_Categories VARCHAR(500)
)
AS
BEGIN
	IF (@FocusCampID <=0 ) 
	BEGIN
		SELECT @FocusCampID=ISNULL(MAX(FocusCampID),0)+1 FROM FocusCamp
		INSERT INTO FocusCamp
		(
		FocusCampID ,
		FocusCampNUMBER ,
		FocusCampDATE ,
		TITLE ,
		ATTACHMENTFILENAME ,
		ATTACHMENT ,
		STATUS ,
		CREATEDBY ,
		CREATEDON 
		)
		Values
		(
		@FocusCampID,
		@FocusCampNUMBER,
		@FocusCampDATE,
		@TITLE,
		@ATTACHMENTFILENAME,
		@ATTACHMENT,
		''N'',
		@CREATEDBY,
		GETDATE()
		)

		INSERT INTO FocusCamp_Categories
		SELECT @FocusCampID,RESULT FROM [dbo].[CSVtoTable](@FocusCamp_Categories,'','')
	END
	ELSE
	BEGIN
	      IF(LTRIM(RTRIM(@ATTACHMENTFILENAME)) <> '''' )
		BEGIN
		      UPDATE FocusCamp
				SET FocusCampNUMBER = @FocusCampNUMBER,
					FocusCampDATE = @FocusCampDATE,
					TITLE =  @TITLE,
				    ATTACHMENTFILENAME = @ATTACHMENTFILENAME,
					ATTACHMENT = @ATTACHMENT
			  WHERE FocusCampID =  @FocusCampID 
		END
		ELSE
		BEGIN
		     UPDATE FocusCamp
				SET FocusCampNUMBER = @FocusCampNUMBER,
					FocusCampDATE = @FocusCampDATE,
					TITLE =  @TITLE
			WHERE FocusCampID =  @FocusCampID
		END

		DELETE FROM FocusCamp_Categories WHERE FocusCampID = @FocusCampID

		INSERT INTO FocusCamp_Categories
		SELECT @FocusCampID,RESULT FROM [dbo].[CSVtoTable](@FocusCamp_Categories,'','')
	END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[InsertUpdateFocusCamp_Vessel_Notifications_VSL]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertUpdateFocusCamp_Vessel_Notifications_VSL]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE proc [dbo].[InsertUpdateFocusCamp_Vessel_Notifications_VSL]
(
@FocusCampId bigint,
@VesselCode char(3),
@AckOn smalldatetime,
@AckMessage varchar(500),
@Discussed bit,
@Notice bit
)
as
begin
	if exists(select * from FocusCamp_Vessel_Notifications where FocusCampID=@FocusCampId AND VESSELCODE=@VesselCode)
	BEGIN
		UPDATE FocusCamp_Vessel_Notifications SET ACKON=@AckOn,ACKMESSAGE=@AckMessage,Discussed=@Discussed,Notice=@Notice where FocusCampID=@FocusCampId AND VESSELCODE=@VesselCode
	END
	ELSE
	BEGIN
		INSERT INTO FocusCamp_Vessel_Notifications(FocusCampID,VESSELCODE,AckOn,AckMessage,Discussed,Notice)
		VALUES(@FocusCampId,@VesselCode,@AckOn,@AckMessage,@Discussed,@Notice)	
	END
end
' 
END
GO
/****** Object:  StoredProcedure [dbo].[InsertUpdateFocusCamp_VSL]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertUpdateFocusCamp_VSL]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[InsertUpdateFocusCamp_VSL]
(
	@FocusCampID int,
	@FocusCampNUMBER varchar(50),
	@FocusCampDATE smalldatetime,
	@TITLE varchar(500),
	@ATTACHMENTFILENAME varchar(100),
	@ATTACHMENT image,
	@STATUS char(1),
	@CREATEDBY varchar(50),
	@CREATEDON smalldatetime,
	@PUBLISHEDBY varchar(50),
	@PUBLISHEDON smalldatetime
)
AS
BEGIN
SET NOCOUNT ON

IF EXISTS(SELECT * FROM FocusCamp WHERE FocusCampID=@FocusCampID)
	DELETE FROM FocusCamp WHERE FocusCampID=@FocusCampID

INSERT INTO FocusCamp
(
FocusCampID ,
FocusCampNUMBER ,
FocusCampDATE ,
TITLE ,
ATTACHMENTFILENAME ,
ATTACHMENT ,
STATUS ,
CREATEDBY ,
CREATEDON ,
PUBLISHEDBY ,
PUBLISHEDON 
)
Values
(
@FocusCampID,
@FocusCampNUMBER,
@FocusCampDATE,
@TITLE,
@ATTACHMENTFILENAME,
@ATTACHMENT,
@STATUS,
@CREATEDBY,
@CREATEDON,
@PUBLISHEDBY,
@PUBLISHEDON
)

END' 
END
GO
/****** Object:  StoredProcedure [dbo].[INSERTUPDATELFI]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[INSERTUPDATELFI]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[INSERTUPDATELFI]
(
    @LFIID int,
	@LFINUMBER varchar(50),
	@LFIDATE smalldatetime,
	@TITLE varchar(500),
	@ATTACHMENTFILENAME varchar(100),
	@ATTACHMENT image,
	@CREATEDBY varchar(50),
	@LFI_Categories VARCHAR(500)
)
AS
BEGIN
	IF(@LFIID <= 0)
	BEGIN
		SELECT @LFIID=ISNULL(MAX(LFIID),0)+1 FROM LFI
		INSERT INTO LFI
		(
		LFIID ,
		LFINUMBER ,
		LFIDATE ,
		TITLE ,
		ATTACHMENTFILENAME ,
		ATTACHMENT ,
		STATUS ,
		CREATEDBY ,
		CREATEDON 
		)
		Values
		(
		@LFIID,
		@LFINUMBER,
		@LFIDATE,
		@TITLE,
		@ATTACHMENTFILENAME,
		@ATTACHMENT,
		''N'',
		@CREATEDBY,
		GETDATE()
		)

		INSERT INTO LFI_Categories
		SELECT @LFIID,RESULT FROM [dbo].[CSVtoTable](@LFI_Categories,'','')
	END
	ELSE
	BEGIN
	     
		IF(LTRIM(RTRIM(@ATTACHMENTFILENAME)) <> '''' )
		BEGIN
		      UPDATE LFI
				SET LFINUMBER = @LFINUMBER,
					LFIDATE = @LFIDATE,
					TITLE =  @TITLE,
				    ATTACHMENTFILENAME = @ATTACHMENTFILENAME,
					ATTACHMENT = @ATTACHMENT
			  WHERE LFIID =  @LFIID 
		END
		ELSE
		BEGIN
		     UPDATE LFI
				SET LFINUMBER = @LFINUMBER,
					LFIDATE = @LFIDATE,
					TITLE =  @TITLE
			WHERE LFIID =  @LFIID
		END

		DELETE FROM LFI_Categories WHERE [LFIId] = @LFIID

		INSERT INTO LFI_Categories
		SELECT @LFIID,RESULT FROM [dbo].[CSVtoTable](@LFI_Categories,'','')
		
	END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[InsertUpdateLFI_Vessel_Notifications_VSL]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertUpdateLFI_Vessel_Notifications_VSL]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
create proc [dbo].[InsertUpdateLFI_Vessel_Notifications_VSL]
(
@LFIId bigint,
@VesselCode char(3),
@AckOn smalldatetime,
@AckMessage varchar(500),
@Discussed bit,
@Notice bit

)
as
begin
	if exists(select * from LFI_Vessel_Notifications where LFIID=@LFIId AND VESSELCODE=@VesselCode)
	BEGIN
		UPDATE LFI_Vessel_Notifications SET ACKON=@AckOn,ACKMESSAGE=@AckMessage,Discussed=@Discussed,Notice=@Notice where LFIID=@LFIId AND VESSELCODE=@VesselCode
	END
	ELSE
	BEGIN
		INSERT INTO LFI_Vessel_Notifications(LFIID,VESSELCODE,AckOn,AckMessage,Discussed,Notice)
		VALUES(@LFIId,@VesselCode,@AckOn,@AckMessage,@Discussed,@Notice)	
	END
end
' 
END
GO
/****** Object:  StoredProcedure [dbo].[InsertUpdateLFI_VSL]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertUpdateLFI_VSL]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[InsertUpdateLFI_VSL]
(
	@LFIID int,
	@LFINUMBER varchar(50),
	@LFIDATE smalldatetime,
	@TITLE varchar(500),
	@ATTACHMENTFILENAME varchar(100),
	@ATTACHMENT image,
	@STATUS char(1),
	@CREATEDBY varchar(50),
	@CREATEDON smalldatetime,
	@PUBLISHEDBY varchar(50),
	@PUBLISHEDON smalldatetime
)
AS
BEGIN
SET NOCOUNT ON

IF EXISTS(SELECT * FROM LFI WHERE LFIID=@LFIID)
	DELETE FROM LFI WHERE LFIID=@LFIID

INSERT INTO LFI
(
LFIID ,
LFINUMBER ,
LFIDATE ,
TITLE ,
ATTACHMENTFILENAME ,
ATTACHMENT ,
STATUS ,
CREATEDBY ,
CREATEDON ,
PUBLISHEDBY ,
PUBLISHEDON 
)
Values
(
@LFIID,
@LFINUMBER,
@LFIDATE,
@TITLE,
@ATTACHMENTFILENAME,
@ATTACHMENT,
@STATUS,
@CREATEDBY,
@CREATEDON,
@PUBLISHEDBY,
@PUBLISHEDON
)

END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_Copy_Provision]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_Copy_Provision]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[MP_Copy_Provision]
(
	@ProvisionId bigint,
	@VesselCode char(3),	
	@PortOfSupply Varchar(50),
	@ETA smalldatetime
)
AS
BEGIN
  
    DECLARE @NewProvisionId bigint
      
    SELECT @NewProvisionId = ISNULL(MAX(ProvisionId),0) + 1 FROM MP_VSL_ProvisionMaster WHERE VesselCode = @VesselCode

	INSERT INTO MP_VSL_ProvisionMaster([ProvisionId], [VesselCode],[Department],[AcctCode],[PortOfSupply],[ETA],[UpdatedOn],[Updated],[Status])
	SELECT @NewProvisionId,[VesselCode],[Department],[AcctCode],@PortOfSupply,@ETA,getdate(),1,''N'' FROM MP_VSL_ProvisionMaster WHERE ProvisionId=@ProvisionId AND VesselCode = @VesselCode
	
	INSERT INTO MP_VSL_ProvisionDetails(ProvisionId,VesselCode,ProductId,ReqQty,ROBQty,OrderQtyPerUnit,PackagingName,UnitName)
	SELECT @NewProvisionId,VesselCode,ProductId,ReqQty,ROBQty,OrderQtyPerUnit,PackagingName,UnitName FROM MP_VSL_ProvisionDetails WHERE ProvisionId=@ProvisionId AND VesselCode = @VesselCode

	--INSERT INTO [MP_VSL_ProvisionNationalityWise]([VesselCode],[ProvisionId],[NationalityId],[NoOfCrew],[NoOfDays])
    --SELECT [VesselCode],@NewProvisionId,[NationalityId],[NoOfCrew],[NoOfDays] FROM [MP_VSL_ProvisionNationalityWise] WHERE ProvisionId=@ProvisionId AND VesselCode = @VesselCode
		

	SELECT @NewProvisionId AS ProvisionId
			
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_DeleteMenuCalculator]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_DeleteMenuCalculator]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'     
CREATE PROC [dbo].[MP_DeleteMenuCalculator]
(
	@VesselCode char(3), 
	@MenuDate  smalldatetime,
	@CategoryId int,
	@MealId int
	
)
AS
BEGIN
			
	DELETE FROM  [MP_VSL_MenuCalculator] WHERE [VesselCode] = @VesselCode AND [MenuDate] = @MenuDate AND [MealId] = @MealId AND [CategoryId] = @CategoryId

			
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_DeleteMenuCalculator_Ship]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_DeleteMenuCalculator_Ship]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'  
CREATE PROC [dbo].[MP_DeleteMenuCalculator_Ship]
(
	@VesselCode char(3), 
	@MenuDate  smalldatetime,
	@CategoryId int,
	@MealId int
	
)
AS
BEGIN
			
	DELETE FROM  [MP_VSL_MenuCalculator_SHIP] WHERE [VesselCode] = @VesselCode AND [MenuDate] = @MenuDate AND [MealId] = @MealId AND [CategoryId] = @CategoryId

			
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_GetMonthlyConsumptionDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_GetMonthlyConsumptionDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
-- EXEC [MP_GetMonthlyConsumptionDetails] ''AGE'', 9, 2013, 1
			      
CREATE PROC [dbo].[MP_GetMonthlyConsumptionDetails]
(	
	@VesselCode char(3),
	@Month int,
    @Year int,
	@CategoryId int
)
AS
BEGIN

DECLARE @NationalityId int
DECLARE @MealId int
DECLARE @tbl table(NationalityId int,Members int,Consumption int)
DECLARE @EffectiveFrom DateTime

SET @EffectiveFrom = CAST(@Year AS varchar) + ''-'' +  CAST(@Month AS varchar) + ''-'' + ''01'' 


DECLARE ProductSummary_cursor CURSOR FOR SELECT [MealId] FROM [MP_MealsTypeMaster]
OPEN ProductSummary_cursor	
FETCH NEXT FROM ProductSummary_cursor into @MealId
WHILE @@FETCH_STATUS = 0
BEGIN

DECLARE ProductSummary_cursor1 CURSOR FOR SELECT NationalityId FROM [dbo].[MP_NationalityMaster]

OPEN ProductSummary_cursor1	
FETCH NEXT FROM ProductSummary_cursor1 into @NationalityId
WHILE @@FETCH_STATUS = 0
BEGIN
	
	DECLARE @MealConsumptionId int
	SELECT @MealConsumptionId = MAX([MealConsumptionId]) FROM [dbo].[MP_MealConsumptionMaster] WHERE [NationalityId] = @NationalityId AND [MealId] =  @MealId AND [EffectiveFrom] <= @EffectiveFrom
	
	DECLARE @Count int
	select	@Count = SUM(CCD.[BudgetManning])  FROM [dbo].[MP_CrewComplementDetails] CCD 
	WHERE CCD.[CCId] = (SELECT TOP 1 [CCId] FROM [dbo].[MP_CrewComplementMaster] WHERE VesselCode = @VesselCode AND [EffectiveFrom] <= @EffectiveFrom ORDER BY [EffectiveFrom] DESC )
	AND CCD.[VesselCode]= @VesselCode aND BudgetNationality = @NationalityId

	DECLARE @Consumption INT
	SELECT @Consumption=isnull((select sum(stdconsumption) from [dbo].[MP_MealConsumptionDetails] mcd where mcd.mealconsumptionid=@MealConsumptionId and categoryid=@categoryid),0)
	INSERT @tbl VALUES (@NationalityId,@Count,@Consumption )

FETCH NEXT FROM ProductSummary_cursor1 into @NationalityId
END
CLOSE ProductSummary_cursor1
DEALLOCATE ProductSummary_cursor1	    
	 	        					  
FETCH NEXT FROM ProductSummary_cursor into @MealId
END
CLOSE ProductSummary_cursor
DEALLOCATE ProductSummary_cursor


	SELECT NATIONALITYNAME,MEMBERS,STDCONSUMPTION,
	(SELECT UNITNAME FROM [dbo].[MP_UnitMaster] WHERE UNITID=MC.ConsumptionUnitId) AS ConsumptionUnit ,
	(DATEDIFF(d,@EffectiveFrom,DATEADD(m,1,@EffectiveFrom))) as MonthDays,
	((DATEDIFF(d,@EffectiveFrom,DATEADD(m,1,@EffectiveFrom))) * STDCONSUMPTION * MEMBERS)/Conversionfactor as MonthConsumption,
	(SELECT UNITNAME FROM [dbo].[MP_UnitMaster] WHERE UNITID=MC.OrderUnitId) AS OrderUnit 
	FROM 
	(	
		SELECT @CategoryId AS CategoryId,NationalityId,Members,SUM(Consumption) AS STDCONSUMPTION
		FROM @tbl 
		WHERE Members>0 GROUP BY NationalityId,Members
	) A 
		INNER JOIN [dbo].[MP_NationalityMaster] nm ON nm.[NationalityId] = A.NationalityId
		INNER JOIN [dbo].[MP_MainCategory] MC ON MC.[CategoryId] = A.[CategoryId]
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_GetMonthlyConsumptionVesselwise]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_GetMonthlyConsumptionVesselwise]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
-- EXEC [MP_GetMonthlyConsumptionVesselwise] ''AGE'', 9, 2013
			      
CREATE PROC [dbo].[MP_GetMonthlyConsumptionVesselwise]
(	
	@VesselCode char(3),
	@Month int,
    @Year int
)
AS
BEGIN

DECLARE @NationalityId int
DECLARE @MealId int
DECLARE @tbl table(MealConsumptionId int, Members int, ActDays int)
DECLARE @EffectiveFrom DateTime

SET @EffectiveFrom = CAST(@Year AS varchar) + ''-'' +  CAST(@Month AS varchar) + ''-'' + ''01'' 


DECLARE ProductSummary_cursor CURSOR FOR SELECT [MealId] FROM [MP_MealsTypeMaster]
OPEN ProductSummary_cursor	
FETCH NEXT FROM ProductSummary_cursor into @MealId
WHILE @@FETCH_STATUS = 0
BEGIN

DECLARE ProductSummary_cursor1 CURSOR FOR SELECT NationalityId FROM [dbo].[MP_NationalityMaster]

OPEN ProductSummary_cursor1	
FETCH NEXT FROM ProductSummary_cursor1 into @NationalityId
WHILE @@FETCH_STATUS = 0
BEGIN
	
	DECLARE @MealConsumptionId int
	SELECT @MealConsumptionId = MAX([MealConsumptionId]) FROM [dbo].[MP_MealConsumptionMaster] WHERE [NationalityId] = @NationalityId AND [MealId] =  @MealId AND [EffectiveFrom] <= @EffectiveFrom
	
	DECLARE @Count int
	select	@Count = SUM(CCD.[BudgetManning])  FROM [dbo].[MP_CrewComplementDetails] CCD 
	WHERE CCD.[CCId] = (SELECT TOP 1 [CCId] FROM [dbo].[MP_CrewComplementMaster] WHERE VesselCode = @VesselCode AND [EffectiveFrom] <= @EffectiveFrom ORDER BY [EffectiveFrom] DESC )
	AND CCD.[VesselCode]= @VesselCode aND BudgetNationality = @NationalityId

	DECLARE @Count1 int
	SELECT @Count1=SUM(([ToDay]-[FromDay]+1)) FROM [MP_VSL_ShipStaffDetails] SD 
	INNER JOIN [MP_VSL_ShipStaffMaster] SM ON SD.[ShipStaffId] = SM.[ShipStaffId]
	WHERE SD.[VesselCode] = @VesselCode AND [Month] = @Month AND [Year] = @Year AND Nationality = @NationalityId

	INSERT @tbl VALUES (@MealConsumptionId, @Count, @Count1)

FETCH NEXT FROM ProductSummary_cursor1 into @NationalityId
END
CLOSE ProductSummary_cursor1
DEALLOCATE ProductSummary_cursor1	    
	 	        					  
FETCH NEXT FROM ProductSummary_cursor into @MealId
END
CLOSE ProductSummary_cursor
DEALLOCATE ProductSummary_cursor



--SELECT * FROM  @tbl
--SELECT * FROM  @tblActual

SELECT CategoryId,[CategoryName], [UnitName], ROUND(((SUM(StdConsumption)/[ConversionFactor])) * (DATEDIFF(d,@EffectiveFrom,DATEADD(m,1,@EffectiveFrom))), 0) AS  StdConsumption
 ,ROUND(((SUM(StdConsumptionACT)/[ConversionFactor])), 0) AS StdConsumptionACT, SUM(([OpeningStock] + [Supply]) - [Balance]) AS [Consumption]

FROM (

		SELECT MC.[CategoryId], MC.[CategoryName],UM.[UnitName], (SUM(MCD.[StdConsumption])* tt.Members) As StdConsumption , 
		(SUM(MCD.[StdConsumption])* tt.ActDays) As StdConsumptionACT, MC.[ConversionFactor],
		ISNULL((SELECT SUM([Quantity]) FROM  [dbo].[MP_VSL_InventoryDetails] WHERE [VesselCode] = @VesselCode AND [InventoryId] IN (SELECT [InventoryId] FROM [dbo].[MP_VSL_InventoryMaster] WHERE [InventoryDate] <= DATEADD(m,-1,@EffectiveFrom))  
		AND [ProductId] IN (SELECT [ProductId] FROM [dbo].[MP_Products] P   
		WHERE P.[CategoryId] = (SELECT [CategoryId] FROM [dbo].[MP_MainCategory] WHERE [CategoryId] = P.[CategoryId] AND [ParentCategoryId] = MC.[CategoryId]))),0) AS [OpeningStock],  


		ISNULL((SELECT SUM([Quantity]) FROM [MP_VSL_SupplyDetails] 
		WHERE [VesselCode] = @VesselCode AND [SupplyId] IN ( 
		SELECT [SupplyId] FROM [MP_VSL_SupplyMaster] WHERE [ReceivingDate] BETWEEN @EffectiveFrom AND DATEADD(d,-1, DATEADD(m,1,@EffectiveFrom))) 
		AND [ProductId] IN (SELECT [ProductId] FROM [MP_Products] P 
		WHERE P.[CategoryId] = (SELECT [CategoryId] FROM [MP_MainCategory] WHERE [CategoryId] = P.[CategoryId] AND [ParentCategoryId] = MC.[CategoryId]))),0) AS [Supply], 

		ISNULL((SELECT SUM([Quantity]) FROM  [MP_VSL_InventoryDetails] 
		WHERE [VesselCode] = @VesselCode AND [InventoryId] IN ( 
		SELECT [InventoryId] FROM [MP_VSL_InventoryMaster] WHERE [InventoryDate] = @EffectiveFrom) 
		AND [ProductId] IN (SELECT [ProductId] FROM [MP_Products] P 
		WHERE P.[CategoryId] = (SELECT [CategoryId] FROM [MP_MainCategory] WHERE [CategoryId] = P.[CategoryId] AND [ParentCategoryId] = MC.[CategoryId]))),0) AS [Balance] 

		FROM [dbo].[MP_MainCategory] MC		
		LEFT JOIN [dbo].[MP_MealConsumptionDetails] MCD  ON MCD.[CategoryId] = MC.[CategoryId]
		INNER JOIN [dbo].[MP_UnitMaster] UM ON MC.[OrderUnitId] = UM.[UnitId]
		LEFT JOIN @tbl tt ON MCD.[MealConsumptionId] = tt.MealConsumptionId
		GROUP BY MC.[CategoryId],MC.[CategoryName], UM.[UnitName], tt.Members,  MC.[ConversionFactor], tt.ActDays

     ) a WHERE ISNULL(StdConsumption,0) > 0 OR ISNULL(StdConsumptionACT,0) > 0   GROUP BY CategoryId,[CategoryName], [UnitName],[ConversionFactor] 
			
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_GetProductSummary]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_GetProductSummary]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
--- EXEC [dbo].[MP_GetProductSummary] 2
			      
CREATE PROC [dbo].[MP_GetProductSummary]
(
	@NationalityId bigint
)
AS
BEGIN   

DECLARE @MealId int;
DECLARE @tbl table( MealConsumptionId int  );

DECLARE ProductSummary_cursor CURSOR FOR SELECT [MealId] FROM [MP_MealsTypeMaster]
OPEN ProductSummary_cursor	
FETCH NEXT FROM ProductSummary_cursor into @MealId
WHILE @@FETCH_STATUS = 0
BEGIN

DECLARE @MealConsumptionId int;

SELECT @MealConsumptionId = MAX([MealConsumptionId]) FROM [dbo].[MP_MealConsumptionMaster] WHERE [NationalityId] = @NationalityId AND [MealId] =  @MealId
       
INSERT @tbl VALUES (@MealConsumptionId)	    
	 	        					  
FETCH NEXT FROM ProductSummary_cursor into @MealId
END
CLOSE ProductSummary_cursor
DEALLOCATE ProductSummary_cursor

SELECT MC.[CategoryName], UCM.[UnitName], SUM(MCD.[StdConsumption]) As StdConsumption
FROM [dbo].[MP_MealConsumptionDetails] MCD
INNER JOIN [dbo].[MP_MainCategory] MC ON MCD.[CategoryId] = MC.[CategoryId]
INNER JOIN [dbo].[MP_UnitMaster] UCM ON MCD.[UnitId] = UCM.[UnitId]
WHERE MCD.[MealConsumptionId] IN (SELECT * FROM @tbl)
GROUP BY MC.[CategoryName], UCM.[UnitName] 
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_ImportCrewComplement]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_ImportCrewComplement]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
-- EXEC [MP_ImportCrewComplement] ''AGE'', ''01-Aug-2013''
			      
CREATE PROC [dbo].[MP_ImportCrewComplement]
(	
	@VesselCode char(3),
	@EffectiveFrom DateTime
)
AS
BEGIN
     DECLARE @CCId bigint;

	 IF NOT EXISTS (SELECT * FROM [dbo].[MP_CrewComplementMaster] WHERE [VesselCode] = @VesselCode AND  REPLACE(CONVERT(VARCHAR(20), [EffectiveFrom], 106), '' '', ''-'') =  REPLACE(CONVERT(VARCHAR(20), @EffectiveFrom, 106), '' '', ''-''))
	 BEGIN

     SELECT @CCId = ISNULL((MAX([CCId])), 0)+1 FROM [MP_CrewComplementMaster]

	INSERT INTO [MP_CrewComplementMaster]
    (
           [CCId],
		   [VesselCode],
		   [EffectiveFrom],
		   [Updated],
		   [UpdatedOn],
		   [AckRecd],
		   [AckRecdOn]  
	)
     VALUES
	(
	       @CCId,
           @VesselCode,
		   @EffectiveFrom,
		   1,
		   getdate(),
		   Null,
		   Null
	)

	INSERT INTO [MP_CrewComplementDetails] SELECT @CCId,@VesselCode,[RankId],[BudgetManning],[BudgetNationality] FROM [dbo].[VesselBudgetManning] WHERE [VesselId] = (SELECT [VesselId] FROM [dbo].[Vessel] WHERE [VesselCode] = @VesselCode)

	END
	ELSE
	BEGIN	       
		   SELECT @CCId = CCId FROM [MP_CrewComplementMaster] WHERE [VesselCode] = @VesselCode AND  REPLACE(CONVERT(VARCHAR(20), [EffectiveFrom], 106), '' '', ''-'') = REPLACE(CONVERT(VARCHAR(20), @EffectiveFrom, 106), '' '', ''-'')

		   DELETE FROM [MP_CrewComplementDetails] WHERE [CCId]= @CCId AND [VesselCode] = @VesselCode

		   INSERT INTO [MP_CrewComplementDetails] SELECT @CCId,@VesselCode,[RankId],[BudgetManning],[BudgetNationality] FROM [dbo].[VesselBudgetManning] WHERE [VesselId] = (SELECT [VesselId] FROM [dbo].[Vessel] WHERE [VesselCode] = @VesselCode)

		   UPDATE [MP_CrewComplementMaster] SET [Updated] = 1, [UpdatedOn] = getdate() WHERE [CCId]= @CCId

	END

	SELECT @CCId
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertAccountDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertAccountDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'	      
CREATE PROC [dbo].[MP_InsertAccountDetails]
(
    @AccountDetailId bigint,
    @AccountId bigint,
	@VesselCode char(3),    
	@Name Varchar(50),
	@Rank Varchar(50),
	@Company Varchar(50),
	@FromDay int,
	@ToDay int,
	@NoOfMealsServed int,
	@Remarks Varchar(5000),
	@Status Char(1)
)
AS
BEGIN

    IF(@Status = ''D'')
	BEGIN
		DELETE FROM [MP_VSL_AccountDetails] WHERE [AccountDetailId] = @AccountDetailId 
	END 
	ELSE
	BEGIN
			IF(@AccountDetailId <= 0)
			BEGIN

			SELECT @AccountDetailId = ISNULL(MAX(AccountDetailId),0) + 1 FROM [MP_VSL_AccountDetails] WHERE [VesselCode] = @VesselCode
	
			INSERT INTO [MP_VSL_AccountDetails]
			(
				[AccountDetailId],
				[AccountId],
				[VesselCode],
				[Name],
				[Rank],
				[Company],
				[FromDay],
				[ToDay],
				[NoOfMealsServed],
				[Remarks]
                  
			)
			 VALUES
			(
				@AccountDetailId,
				@AccountId,
				@VesselCode,
				@Name,
				@Rank,
				@Company,
				@FromDay,
				@ToDay,
				@NoOfMealsServed,
				@Remarks
			)

			END
			ELSE
			BEGIN
					UPDATE [MP_VSL_AccountDetails]
						SET [Name] = @Name,
							[Rank] = @Rank,
							[Company] = @Company,
							[FromDay] = @FromDay,
							[ToDay] = @ToDay,
							[NoOfMealsServed] = @NoOfMealsServed,
							[Remarks] = @Remarks
				WHERE [AccountDetailId] = @AccountDetailId  
				
			END	
    END		
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertAccountMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertAccountMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'    
CREATE PROC [dbo].[MP_InsertAccountMaster]
(
    @AccountId bigint,
	@AccountType bigint,
	@VesselCode char(3),
    @Month int,
	@Year int,
	@UpdatedBy Varchar(50)
)
AS
BEGIN
     
	 

    IF (@AccountId <= 0)
	BEGIN
    SELECT @AccountId = ISNULL(MAX(AccountId),0) + 1 FROM [MP_VSL_AccountMaster] WHERE VesselCode = @VesselCode
	INSERT INTO [MP_VSL_AccountMaster]
    (
	    [AccountId],
		[AccountType],
		[VesselCode],
		[Month],
		[Year],			
		[UpdatedBy],
		[UpdatedOn],
		[Updated]
                  
	)
     VALUES
	(
	    @AccountId,
		@AccountType,
		@VesselCode,
		@Month,
		@Year,		
		@UpdatedBy,
		getdate(),
		1
	)
	END
	ELSE
	BEGIN
	      UPDATE [MP_VSL_AccountMaster]

		  SET [UpdatedBy] = @UpdatedBy,
			  [UpdatedOn] = getdate(),
			  [Updated] = 1
		  WHERE AccountId = @AccountId

	END	

	SELECT @AccountId AS [AccountId]
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertDeleteProducts_Packaging]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertDeleteProducts_Packaging]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROC [dbo].[MP_InsertDeleteProducts_Packaging]
(
    @ProductId bigint,    
	@Qty int,
	@UnitId int,
	@OrderQty float,
	@INSERTDELETE CHAR(1)
)
AS
BEGIN
	IF(@INSERTDELETE=''I'')
	BEGIN
		INSERT INTO MP_Products_Packaging
		(
			 ProductId,		      
			 Qty,
			 UnitId,
			 OrderQty
		)
		 VALUES
		(
			 @ProductId,		      
			 @Qty,
			 @UnitId,
			 @OrderQty
		)	
	END
	ELSE
	BEGIN
		DELETE FROM dbo.MP_PRODUCTS_PACKAGING WHERE PRODUCTID=@PRODUCTID AND QTY=@QTY AND UNITID=@UNITID
	END	

	INSERT INTO VSL_MP_PRODUCTS SELECT VESSELCODE,@ProductId,1,GETDATE(),0,NULL FROM DBO.VESSEL V WHERE VESSELSTATUSID<>2 AND VESSELID NOT IN (41,43,44 ) AND V.VESSELCODE NOT IN (SELECT VESSELCODE FROM VSL_MP_PRODUCTS WHERE PRODUCTID=@ProductId)
	UPDATE VSL_MP_PRODUCTS SET UPDATED = 1, UPDATEDON = getdate() WHERE ProductId=@ProductId
			
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertInventoryDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertInventoryDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[MP_InsertInventoryDetails]
(
	@VesselCode char(3),
    @InventoryId bigint,
	@ProductId bigint,	
	@Quantity float,
	@Spoilage float
)
AS
BEGIN  
   
	INSERT INTO [MP_VSL_InventoryDetails]
    (
		   VesselCode,
		   InventoryId,
		   ProductId,	
		   Quantity,
		   Spoilage
	)
     VALUES
	(
		   @VesselCode,
		   @InventoryId,
		   @ProductId,	
		   @Quantity,
		   @Spoilage
	)
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertInventoryMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertInventoryMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'	      
CREATE Proc [dbo].[MP_InsertInventoryMaster]
(
    @InventoryId  bigint,	
	@VesselCode Char(3),
	@InventoryDate smalldatetime,
	@UpdatedBy Varchar(50)
)
AS
BEGIN

   IF NOT EXISTS (SELECT * FROM [MP_VSL_InventoryMaster] WHERE VesselCode = @VesselCode AND InventoryDate = @InventoryDate) 
   BEGIN
   
    SELECT @InventoryId = ISNULL(MAX(InventoryId),0) + 1 FROM MP_VSL_InventoryMaster WHERE VesselCode = @VesselCode
	
	INSERT INTO [MP_VSL_InventoryMaster]
    (
	    InventoryId,	
		VesselCode,
		InventoryDate,
		UpdatedBy,
		UpdatedOn,
		Updated
	)
     VALUES
	(
	    @InventoryId,	
		@VesselCode,
		@InventoryDate,
		@UpdatedBy,
		getdate(),
		1
	)

	END
	ELSE
	BEGIN
		SELECT @InventoryId = InventoryId FROM MP_VSL_InventoryMaster WHERE VesselCode = @VesselCode AND InventoryDate = @InventoryDate

		UPDATE MP_VSL_InventoryMaster 
		       SET UpdatedBy = @UpdatedBy,
			       UpdatedOn = getdate(),
				   Updated = 1
		WHERE InventoryId = @InventoryId

		DELETE FROM [MP_VSL_InventoryDetails] WHERE [VesselCode] = @VesselCode AND [InventoryId] = @InventoryId

	END
   

   SELECT @InventoryId AS InventoryId;
			
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertMealConsumptionDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertMealConsumptionDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[MP_InsertMealConsumptionDetails]
(
	@MealConsumptionDetailId bigint,
    @MealConsumptionId bigint,
	@CategoryId bigint,
	@UnitId bigint,
	@StdConsumption float
)
AS
BEGIN   

	SELECT @MealConsumptionDetailId =  ISNULL(MAX(MealConsumptionDetailId), 0)+1 FROM [MP_MealConsumptionDetails]

	INSERT INTO [MP_MealConsumptionDetails]
    (
              [MealConsumptionDetailId],
			  [MealConsumptionId],
			  [CategoryId],
			  [UnitId],
			  [StdConsumption]
	)
     VALUES
	(
	       @MealConsumptionDetailId,
		   @MealConsumptionId,
		   @CategoryId,
		   @UnitId,
		   @StdConsumption
	)
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertMealConsumptionMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertMealConsumptionMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[MP_InsertMealConsumptionMaster]
(
	@MealConsumptionId bigint,
    @NationalityId bigint,
	@MealId bigint,
	@Version Varchar(50),
	@EffectiveFrom DateTime
)
AS
BEGIN	
    
	IF(@MealConsumptionId <= 0)
	BEGIN

	SELECT @MealConsumptionId =  ISNULL(MAX(MealConsumptionId), 0)+1 FROM [dbo].[MP_MealConsumptionMaster];
    
	INSERT INTO [dbo].[MP_MealConsumptionMaster]
     (
       [MealConsumptionId],
       [NationalityId],
       [MealId],
       [Version],
       [EffectiveFrom]
     )
    VALUES
     (
        @MealConsumptionId,
		@NationalityId,
		@MealId,
		@Version,
		@EffectiveFrom
      )  

  END

  INSERT INTO VSL_MP_MealConsumptionMaster SELECT VESSELCODE,@MealConsumptionId,1,GETDATE(),0,NULL FROM DBO.VESSEL V WHERE VESSELSTATUSID<>2 AND VESSELID NOT IN (41,43,44 ) AND V.VESSELCODE NOT IN (SELECT VESSELCODE FROM VSL_MP_MealConsumptionMaster WHERE MealConsumptionId=@MealConsumptionId)

  UPDATE VSL_MP_MealConsumptionMaster SET UPDATED = 1, UPDATEDON = getdate() WHERE MealConsumptionId=@MealConsumptionId

  SELECT @MealConsumptionId AS MealConsumptionId;
  			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertMenuCalculator]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertMenuCalculator]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[MP_InsertMenuCalculator]
(
	@VesselCode char(3), 
	@MenuDate  smalldatetime,
	@CategoryId int,
	@MealId int
	
)
AS
BEGIN

   IF NOT EXISTS(SELECT * FROM [MP_VSL_MenuCalculator] WHERE [VesselCode]= @VesselCode AND [MenuDate]=@MenuDate AND [MealId]=@MealId AND [CategoryId]= @CategoryId)
   BEGIN
			
	INSERT INTO [MP_VSL_MenuCalculator]
	(
		[VesselCode],
		[MenuDate],
		[CategoryId],
		[MealId]
                  
	)
		VALUES
	(
		@VesselCode, 
		@MenuDate,
		@CategoryId,
		@MealId
	)

	END

			
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertMenuCalculator_SHIP]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertMenuCalculator_SHIP]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROC [dbo].[MP_InsertMenuCalculator_SHIP]
(
	@VesselCode char(3), 
	@MenuDate  smalldatetime,
	@CategoryId int,
	@MealId int
	
)
AS
BEGIN

   IF NOT EXISTS(SELECT * FROM [MP_VSL_MenuCalculator_SHIP] WHERE [VesselCode]= @VesselCode AND [MenuDate]=@MenuDate AND [MealId]=@MealId AND [CategoryId]= @CategoryId)
   BEGIN
			
	INSERT INTO [MP_VSL_MenuCalculator_SHIP]
	(
		[VesselCode],
		[MenuDate],
		[CategoryId],
		[MealId]
                  
	)
		VALUES
	(
		@VesselCode, 
		@MenuDate,
		@CategoryId,
		@MealId
	)

	END

			
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertNationality]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertNationality]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[MP_InsertNationality]
(
    @NationalityId bigint,	
	@NationalityName Varchar(100)
)
AS
BEGIN

	INSERT INTO MP_NationalityMaster
    (
           NationalityId,
           NationalityName      
	)
     VALUES
	(
	       @NationalityId,
           @NationalityName
	)
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertOpeningStockDetails_Removed]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertOpeningStockDetails_Removed]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[MP_InsertOpeningStockDetails_Removed]
(
	@VesselCode char(3),
    @OpeningStockId bigint,
	@ProductId bigint,	
	@Quantity float
)
AS
BEGIN  
   
	INSERT INTO [MP_VSL_OpeningStockDetails]
    (
		   VesselCode,
		   OpeningStockId,
		   ProductId,	
		   Quantity
	)
     VALUES
	(
		   @VesselCode,
		   @OpeningStockId,
		   @ProductId,	
		   @Quantity
	)   
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertOpeningStockMaster_Removed]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertOpeningStockMaster_Removed]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'			      
CREATE Proc [dbo].[MP_InsertOpeningStockMaster_Removed]
(
    @OpeningStockId  bigint,	
	@VesselCode Char(3),
	@OpeningStockDate smalldatetime
)
AS
BEGIN 

   IF NOT EXISTS (SELECT * FROM [MP_VSL_OpeningStockMaster] WHERE VesselCode = @VesselCode AND OpeningStockDate = @OpeningStockDate) 
   BEGIN
   
    SELECT @OpeningStockId = ISNULL(MAX(OpeningStockId),0) + 1 FROM [MP_VSL_OpeningStockMaster] WHERE VesselCode = @VesselCode
	
	INSERT INTO [MP_VSL_OpeningStockMaster]
    (
	    OpeningStockId,	
		VesselCode,
		OpeningStockDate
	)
     VALUES
	(
	    @OpeningStockId,	
		@VesselCode,
		@OpeningStockDate
	)

	END
	ELSE
	BEGIN
		SELECT @OpeningStockId = OpeningStockId FROM [MP_VSL_OpeningStockMaster] WHERE VesselCode = @VesselCode AND OpeningStockDate = @OpeningStockDate
		DELETE FROM [MP_VSL_OpeningStockDetails] WHERE VesselCode = @VesselCode AND OpeningStockId = @OpeningStockId

	END

   SELECT @OpeningStockId AS OpeningStockId;
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertProvisionDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertProvisionDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[MP_InsertProvisionDetails]
(
	@VesselCode char(3),
    @ProvisionId bigint,
	@ProductId bigint,	
	@ROBQty float,
	@ReqQty float,
	@ReqQty_Office float,
	@OrderQtyPerUnit float,
	@PackagingName Varchar(50),
	@UnitName Varchar(50)
)
AS
BEGIN

  
    
	INSERT INTO [MP_VSL_ProvisionDetails]
    (
		   VesselCode,
		   ProvisionId,
		   ProductId,	
		   ROBQty,
		   ReqQty,
		   ReqQty_Office,
		   OrderQtyPerUnit,
		   PackagingName,
		   UnitName     
	)
     VALUES
	(
		   @VesselCode,
		   @ProvisionId,
		   @ProductId,	
		   @ROBQty,
		   @ReqQty,
		   @ReqQty_Office,
		   @OrderQtyPerUnit,
		   @PackagingName,
		   @UnitName
	)
			
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertProvisionMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertProvisionMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[MP_InsertProvisionMaster]
(
    @ProvisionId bigint,	
	@VesselCode Char(3),
	@Department Varchar(50),
	@AcctCode Varchar(50),
	@RequisitionNo Varchar(50),
	@PortOfSupply Varchar(50),
	@ETA smalldatetime,
	@Remarks Varchar(5000),
	@UpdatedBy Varchar(50)

)
AS
BEGIN
    
	IF (@ProvisionId <= 0)
	BEGIN

    SELECT @ProvisionId = ISNULL(MAX(ProvisionId),0) + 1 FROM [MP_VSL_ProvisionMaster] WHERE VesselCode = @VesselCode
	INSERT INTO [MP_VSL_ProvisionMaster]
    (
         [ProvisionId],
		 [VesselCode],
		 [Department],
		 [AcctCode],
		 [RequisitionNo],
		 [PortOfSupply],
		 [ETA],
		 [Remarks],
		 [UpdatedBy],
		 [UpdatedOn],
		 [Updated],
		 [Status]
		         
	)
     VALUES
	(
	       @ProvisionId,	
		   @VesselCode,
		   @Department,
		   @AcctCode,
		   @RequisitionNo,
		   @PortOfSupply,
		   @ETA,
		   @Remarks,
		   @UpdatedBy,
		   getdate(),
		   1,
		   ''N''
	)
   
   END
   ELSE
   BEGIN

      UPDATE [MP_VSL_ProvisionMaster]
			SET [Department] = @Department,
				[AcctCode] = @AcctCode,
				[RequisitionNo] = @RequisitionNo,
				[PortOfSupply] = @PortOfSupply,
				[ETA] = @ETA,
				[Remarks] = @Remarks,
				[UpdatedBy] = @UpdatedBy,
				[UpdatedOn] = getdate(),
				[Updated] = 1
	 WHERE VesselCode = @VesselCode AND ProvisionId = @ProvisionId

	 DELETE FROM [MP_VSL_ProvisionDetails] WHERE [VesselCode] = @VesselCode AND [ProvisionId] = @ProvisionId

   END

   SELECT @ProvisionId AS ProvisionId;
			
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertProvisionOtherItems]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertProvisionOtherItems]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[MP_InsertProvisionOtherItems]
(
    @VesselCode Char(3),
    @ProvisionId bigint,
    @OtherItemId bigint,   
	@ProductName Varchar(50),
	@Packaging Varchar(50),
	@ROBQty float,
	@ReqQty float,
	@UnitId int,
	@ReqQty_Office float
)
AS
BEGIN

    
	IF(@OtherItemId <= 0)
	BEGIN

	SELECT @OtherItemId = ISNULL(MAX(OtherItemId),0) + 1 FROM [MP_VSL_ProvisionOtherItems] WHERE [VesselCode] = @VesselCode AND [ProvisionId] = @ProvisionId
	
	INSERT INTO [MP_VSL_ProvisionOtherItems]
	(
		[VesselCode],
		[ProvisionId],
		[OtherItemId],   
		[ProductName],
		[Packaging],
		[ROBQty],
		[ReqQty],
		[UnitId],
		[ReqQty_Office]
                  
	)
		VALUES
	(
	    @VesselCode,
		@ProvisionId,
		@OtherItemId,   
		@ProductName,
		@Packaging,
		@ROBQty,
		@ReqQty,
		@UnitId,
		@ReqQty_Office
	)

	END
	ELSE
	BEGIN
			UPDATE [MP_VSL_ProvisionOtherItems]
				SET [ProductName] = @ProductName,
					[Packaging] = @Packaging,
					[ROBQty] = @ROBQty,
					[ReqQty] = @ReqQty,
					[UnitId] = @UnitId,
					[ReqQty_Office] = @ReqQty_Office
		WHERE [VesselCode] = @VesselCode AND [ProvisionId] = @ProvisionId AND  [OtherItemId] = @OtherItemId
				
	END	
    
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertShipStaffDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertShipStaffDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROC [dbo].[MP_InsertShipStaffDetails]
(
    @ShipStaffDetailId bigint,
    @ShipStaffId bigint,
	@VesselCode char(3),    
	@Name Varchar(50),
	@Rank int,
	@Nationality int,
	@FromDay int,
	@ToDay int,
	@Status Char(1)
)
AS
BEGIN
     
	IF(@Status = ''D'')
	BEGIN
		DELETE FROM [MP_VSL_ShipStaffDetails] WHERE [ShipStaffDetailId] = @ShipStaffDetailId AND [ShipStaffId] = @ShipStaffId AND [VesselCode] = @VesselCode
	END 
	ELSE
	BEGIN
	IF(@ShipStaffDetailId <= 0)
	BEGIN
	SELECT @ShipStaffDetailId = ISNULL(MAX(ShipStaffDetailId),0) + 1 FROM [MP_VSL_ShipStaffDetails] WHERE VesselCode = @VesselCode
	INSERT INTO [MP_VSL_ShipStaffDetails]
	(
		[ShipStaffDetailId],
		[ShipStaffId],
		[VesselCode],		
		[Name],
		[Rank],
		[Nationality],
		[FromDay],
		[ToDay]                  
	)
		VALUES
	(
		@ShipStaffDetailId,
		@ShipStaffId,
		@VesselCode,			
		@Name,
		@Rank,
		@Nationality,
		@FromDay,
		@ToDay
	)
	END
	ELSE
	BEGIN
			UPDATE [MP_VSL_ShipStaffDetails]
				SET [Name] = @Name,
					[Rank] = @Rank,
					[Nationality] = @Nationality,
					[FromDay] = @FromDay,
					[ToDay] = @ToDay
		WHERE [ShipStaffDetailId] = @ShipStaffDetailId AND [ShipStaffId] = @ShipStaffId AND [VesselCode] = @VesselCode  
				
	END	
	END	
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertShipStaffMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertShipStaffMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'     
CREATE PROC [dbo].[MP_InsertShipStaffMaster]
(
    @ShipStaffId bigint,
	@VesselCode char(3),
    @Month int,
	@Year int,
	@UpdatedBy Varchar(50)
)
AS
BEGIN
     
	 

    IF (@ShipStaffId <= 0)
	BEGIN
    SELECT @ShipStaffId = ISNULL(MAX(ShipStaffId),0) + 1 FROM [MP_VSL_ShipStaffMaster] WHERE VesselCode = @VesselCode
	INSERT INTO [MP_VSL_ShipStaffMaster]
    (
	    [ShipStaffId],
		[VesselCode],
		[Month],
		[Year],			
		[UpdatedBy],
		[UpdatedOn],
		[Updated]
                  
	)
     VALUES
	(
	    @ShipStaffId,
		@VesselCode,
		@Month,
		@Year,		
		@UpdatedBy,
		getdate(),
		1
	)
	END
	ELSE
	BEGIN
	      UPDATE [MP_VSL_ShipStaffMaster]

		  SET [UpdatedBy] = @UpdatedBy,
			  [UpdatedOn] = getdate(),
			  [Updated] = 1
		  
		  WHERE ShipStaffId = @ShipStaffId

	END	

	SELECT @ShipStaffId AS [ShipStaffId]
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertSupplyDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertSupplyDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
			      
CREATE PROC [dbo].[MP_InsertSupplyDetails]
(
    @SupplyDetailId bigint,
	@VesselCode char(3),
    @SupplyId bigint,
	@ProductId bigint,	
	@Quantity float,
	@PackagingQty float,
	@PackagingUnit int,
	@PackagingOrderQty float
)
AS
BEGIN

	IF(@SupplyDetailId<=0)
	BEGIN
    SELECT @SupplyDetailId = ISNULL(MAX(SupplyDetailId),0) + 1 FROM [MP_VSL_SupplyDetails] WHERE VesselCode = @VesselCode
	INSERT INTO [MP_VSL_SupplyDetails]
    (
           SupplyDetailId,
		   VesselCode,	
		   SupplyId,
		   ProductId,
		   Quantity,
		   PackagingQty,
		   PackagingUnit,
		   PackagingOrderQty         
	)
     VALUES
	(
	       @SupplyDetailId,
		   @VesselCode,	
		   @SupplyId,
		   @ProductId,
		   @Quantity,
		   @PackagingQty,
		   @PackagingUnit,
		   @PackagingOrderQty
	)
    END
    ELSE
    BEGIN
		UPDATE MP_VSL_SupplyDetails
		SET 
		Quantity=@Quantity,
		PackagingQty=@PackagingQty,
		PackagingUnit=@PackagingUnit,
		PackagingOrderQty=@PackagingOrderQty  
		WHERE VesselCode = @VesselCode AND SupplyDetailId=@SupplyDetailId
    END

   SELECT @SupplyDetailId AS SupplyDetailId;
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertSupplyMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertSupplyMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[MP_InsertSupplyMaster]
(
    @SupplyId bigint,	
	@VesselCode Char(3),
	@Mode Varchar(50),
	@PONumber Varchar(50),
	@VenderName Varchar(50),
	@Port Varchar(50),
	@ReceivingDate smalldatetime,
	@UpdatedBy Varchar(50)	
)
AS
BEGIN

  IF (@SupplyId <= 0)
  BEGIN
    SELECT @SupplyId = ISNULL(MAX(SupplyId),0) + 1 FROM [MP_VSL_SupplyMaster] WHERE VesselCode = @VesselCode
	INSERT INTO [MP_VSL_SupplyMaster]
    (
           SupplyId,	
		   VesselCode,
		   Mode,
		   PONumber,
		   VenderName,
		   Port,
		   ReceivingDate,
		   UpdatedBy,
		   UpdatedOn,
		   Updated
		         
	)
     VALUES
	(
	       @SupplyId,	
		   @VesselCode,
		   @Mode,
		   @PONumber,
		   @VenderName,
		   @Port,
		   @ReceivingDate,
		   @UpdatedBy,
		   getdate(),
		   1
	)
  END
  ELSE
  BEGIN
        UPDATE [MP_VSL_SupplyMaster] 
		   SET VesselCode = @VesselCode,
			   Mode = @Mode,
			   PONumber = @PONumber,
			   VenderName = @VenderName,
			   Port = @Port,
			   ReceivingDate = @ReceivingDate,
			   UpdatedBy = @UpdatedBy,
			   UpdatedOn = getdate(),
			   Updated = 1
		WHERE  VesselCode = @VesselCode and SupplyId = @SupplyId
  END 

   SELECT @SupplyId AS SupplyId;
			
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdate_ProvisionReqMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdate_ProvisionReqMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[MP_InsertUpdate_ProvisionReqMaster]
(
	@VesselCode Char(3),
	@ProvisionId bigint,	
	@Department Varchar(50),
	@AcctCode Varchar(50),
	@RequisitionNo Varchar(50),
	@PortOfSupply Varchar(50),
	@ETA smalldatetime,
	@Remarks Varchar(5000),
	@UpdatedBy Varchar(50),
	@UserId int
)
AS
BEGIN
    
  IF (@ProvisionId <= 0)
  BEGIN

    SELECT @ProvisionId = ISNULL(MAX(ProvisionId),0) + 1 FROM MP_VSL_ProvisionMaster WHERE VesselCode = @VesselCode

	INSERT INTO MP_VSL_ProvisionMaster
    (
         [ProvisionId],
		 [VesselCode],
		 [Department],
		 [AcctCode],
		 [RequisitionNo],
		 [PortOfSupply],
		 [ETA],
		 [Remarks],
		 [UpdatedBy],
		 [UpdatedOn],
		 [Updated],
		 [Status]
	)
     VALUES
	(
		 @ProvisionId,
	     @VesselCode,
		 @Department,
		 @AcctCode,
		 @RequisitionNo,
		 @PortOfSupply,
		 @ETA,
		 @Remarks,
		 @UpdatedBy,
		 getdate(),
		 1,
		 ''N''
	)
	
	INSERT INTO MP_VSL_ProvisionDetails(ProvisionId,VesselCode,ProductId,ReqQty,ROBQty,OrderQtyPerUnit,PackagingName,UnitName)
	SELECT @ProvisionId,VesselCode,ProductId,QTY,ROB,OrderQtyPerUnit,PackagingName,UnitName FROM MP_VSL_TMP_Provision WHERE USERID=@UserId

	INSERT INTO MP_VSL_ProvisionOtherItems(ProvisionId,VesselCode,OtherItemId,ProductName,Packaging,ReqQty,ROBQty,UnitId)
	SELECT @ProvisionId,VesselCode,OtherItemId,ProductName,Packaging,QTY,ROB,UnitId FROM MP_VSL_TMP_Provision_OtherItems WHERE USERID=@UserId
	
  END
  ELSE
  BEGIN
     
	 UPDATE MP_VSL_ProvisionMaster
	 SET
		 Department=@Department,
		 AcctCode=@AcctCode,
		 RequisitionNo=@RequisitionNo,
		 PortOfSupply=@PortOfSupply,
		 ETA=@ETA,
		 Remarks=@Remarks,
		 UpdatedBy=@UpdatedBy,
		 UpdatedOn=getdate(),
		 Updated=1
	 WHERE VesselCode = @VesselCode AND ProvisionId = @ProvisionId

	 -----------------------------------------------

	 DELETE FROM MP_VSL_ProvisionDetails WHERE VesselCode = @VesselCode AND ProvisionId = @ProvisionId
	 
	 DECLARE @ProductId bigINT
	 DECLARE @QTY FLOAT
	 DECLARE @ROB FLOAT

	 DECLARE @OrderQtyPerUnit FLOAT
	 DECLARE @PackagingName VARCHAR(50)
	 DECLARE @UnitName VARCHAR(50)
	 ----

	 DECLARE CS CURSOR FOR SELECT ProductId,QTY,ROB,OrderQtyPerUnit,PackagingName,UnitName FROM MP_VSL_TMP_Provision WHERE USERID=@UserId
	 OPEN CS
	   FETCH NEXT FROM CS INTO @ProductId,@QTY,@ROB,@OrderQtyPerUnit,@PackagingName,@UnitName
	   WHILE(@@FETCH_STATUS=0)
	   BEGIN
			IF EXISTS(SELECT * FROM MP_VSL_ProvisionDetails WHERE VESSELCODE=@VesselCode AND ProvisionId=@ProvisionId AND ProductId=@ProductId)
			BEGIN
				UPDATE MP_VSL_ProvisionDetails SET ReqQty=@QTY,ROBQty=@ROB,OrderQtyPerUnit=@OrderQtyPerUnit,PackagingName=@PackagingName,UnitName=@UnitName
				WHERE VESSELCODE=@VesselCode AND ProvisionId=@ProvisionId AND ProductId=@ProductId
			END
			ELSE
			BEGIN
				
				INSERT INTO MP_VSL_ProvisionDetails(ProvisionId,VesselCode,ProductId,ReqQty,ROBQty,OrderQtyPerUnit,PackagingName,UnitName)
				VALUES(@ProvisionId,@VesselCode,@ProductId,@QTY,@ROB,@OrderQtyPerUnit,@PackagingName,@UnitName)

			END
	   FETCH NEXT FROM CS INTO @ProductId,@QTY,@ROB,@OrderQtyPerUnit,@PackagingName,@UnitName
	 END
	 CLOSE CS
	 DEALLOCATE CS

	 -----------------------------------------------

	 DELETE FROM MP_VSL_ProvisionOtherItems WHERE VesselCode = @VesselCode AND ProvisionId = @ProvisionId

	 DECLARE @OtherItemId1 bigINT
	 DECLARE @ProductName1 VARCHAR(50)
	 DECLARE @Packaging1 VARCHAR(50)

	 DECLARE @ROBQty1 FLOAT
	 DECLARE @ReqQty1 FLOAT
	 DECLARE @UnitId1 INT

	 DECLARE CS1 CURSOR FOR SELECT OtherItemId,ProductName,Packaging,ROB,QTY,UnitId FROM MP_VSL_TMP_Provision_OtherItems WHERE USERID=@UserId
	 OPEN CS1
	   FETCH NEXT FROM CS1 INTO @OtherItemId1,@ProductName1,@Packaging1,@ROBQty1,@ReqQty1,@UnitId1
	   WHILE(@@FETCH_STATUS=0)
	   BEGIN
			IF EXISTS(SELECT * FROM MP_VSL_ProvisionOtherItems WHERE VESSELCODE=@VesselCode AND ProvisionId=@ProvisionId AND OtherItemId=@OtherItemId1)
			BEGIN
				UPDATE MP_VSL_ProvisionOtherItems SET ProductName=@ProductName1,Packaging=@Packaging1,ReqQty=@ReqQty1,ROBQty=@ROBQty1,UnitId=@UnitId1
				WHERE VESSELCODE=@VesselCode AND ProvisionId=@ProvisionId AND OtherItemId=@OtherItemId1
			END
			ELSE
			BEGIN
				INSERT INTO MP_VSL_ProvisionOtherItems(ProvisionId,VesselCode,OtherItemId,ProductName,Packaging,ReqQty,ROBQty,UnitId)
				VALUES(@ProvisionId,@VesselCode,@OtherItemId1,@ProductName1,@Packaging1,@ReqQty1,@ROBQty1,@UnitId1)
			END
	   FETCH NEXT FROM CS1 INTO @OtherItemId1,@ProductName1,@Packaging1,@ROBQty1,@ReqQty1,@UnitId1
	 END
	 CLOSE CS1
	 DEALLOCATE CS1

   END

  DELETE FROM MP_VSL_TMP_Provision WHERE USERID=@UserId
  DELETE FROM MP_VSL_TMP_Provision_OtherItems WHERE USERID=@UserId

  SELECT @ProvisionId AS ProvisionId
			
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdate_SparesReqMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdate_SparesReqMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[MP_InsertUpdate_SparesReqMaster]
(
	@VesselCode Char(3),
	@SpareReqId bigint,	
	@AccountCode Varchar(50),
	@Port Varchar(50),
	@ETA smalldatetime,
	@Remarks Varchar(5000),
	@UpdatedBy Varchar(50),
	@UserId int
)
AS
BEGIN
    
  IF (@SpareReqId <= 0)
  BEGIN

    SELECT @SpareReqId = ISNULL(MAX(SpareReqId),0) + 1 FROM MP_VSL_SparesReqMaster WHERE VesselCode = @VesselCode

	INSERT INTO MP_VSL_SparesReqMaster
    (
         [VesselCode],
		 [SpareReqId],
		 [AccountCode],
		 [Port],
		 [ETA],
		 [Remarks],
		 [UpdatedBy],
		 [UpdatedOn],
		 [Updated],
		 [Status]
	)
     VALUES
	(
	     @VesselCode,
		 @SpareReqId,
		 @AccountCode,
		 @Port,
		 @ETA,
		 @Remarks,
		 @UpdatedBy,
		 getdate(),
		 1,
		 ''N''
	)
	
	INSERT INTO MP_VSL_SparesReqDetails(SpareReqId,VesselCode,ComponentId,Office_Ship,SpareId,QTY,ROB,UOM)
	SELECT @SpareReqId,VesselCode,ComponentId,Office_Ship,SpareId,QTY,ROB,UOM
	FROM MP_VSL_TMP_Spares WHERE USERID=@UserId
	
  END
  ELSE
  BEGIN
     
	 UPDATE MP_VSL_SparesReqMaster
			SET [AccountCode] = @AccountCode,
				[Port]= @Port,
				[ETA] = @ETA,
				[Remarks] = @Remarks,
				[UpdatedBy] = @UpdatedBy,
				[UpdatedOn] = getdate(),
				[Updated] = 1
	 WHERE VesselCode = @VesselCode AND SpareReqId = @SpareReqId

	 DELETE FROM MP_VSL_SparesReqDetails WHERE VesselCode = @VesselCode AND SpareReqId = @SpareReqId

	 DECLARE @ComponentId INT
	 DECLARE @Office_Ship CHAR(1)
	 DECLARE @SpareId INT
	 DECLARE @QTY FLOAT
	 DECLARE @ROB FLOAT
	 DECLARE @UOM VARCHAR(50)


	 DECLARE CS CURSOR FOR SELECT ComponentId,Office_Ship,SpareId,QTY,ROB,UOM FROM MP_VSL_TMP_Spares WHERE USERID=@UserId
	 OPEN CS
	   FETCH NEXT FROM CS INTO @ComponentId,@Office_Ship,@SpareId,@QTY,@ROB,@UOM
	   WHILE(@@FETCH_STATUS=0)
	   BEGIN
			IF EXISTS(SELECT * FROM MP_VSL_SparesReqDetails WHERE VESSELCODE=@VesselCode AND SpareReqId=@SpareReqId AND ComponentId=@ComponentId AND Office_Ship=@Office_Ship AND SpareId=@SpareId)
			BEGIN
				UPDATE MP_VSL_SparesReqDetails SET QTY=@QTY,ROB=@ROB,UOM=@UOM
				WHERE VESSELCODE=@VesselCode AND SpareReqId=@SpareReqId AND ComponentId=@ComponentId AND Office_Ship=@Office_Ship AND SpareId=@SpareId
			END
			ELSE
			BEGIN
				INSERT INTO MP_VSL_SparesReqDetails(SpareReqId,VesselCode,ComponentId,Office_Ship,SpareId,QTY,ROB,UOM)
				VALUES(@SpareReqId,@VesselCode,@ComponentId,@Office_Ship,@SpareId,@QTY,@ROB,@UOM)
			END
	   FETCH NEXT FROM CS INTO @ComponentId,@Office_Ship,@SpareId,@QTY,@ROB,@UOM
	 END
	 CLOSE CS
	 DEALLOCATE CS

   END

  DELETE FROM MP_VSL_TMP_Spares WHERE USERID=@UserId
  SELECT @SpareReqId AS SpareReqId
			
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdate_StoreReqMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdate_StoreReqMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[MP_InsertUpdate_StoreReqMaster]
(
	@VesselCode Char(3),
	@StoreReqId bigint,	
	@AccountCode Varchar(50),
	@Port Varchar(50),
	@ETA smalldatetime,
	@Remarks Varchar(5000),
	@UpdatedBy Varchar(50),
	@UserId int
)
AS
BEGIN
    
  IF (@StoreReqId <= 0)
  BEGIN

    SELECT @StoreReqId = ISNULL(MAX(StoreReqId),0) + 1 FROM MP_VSL_StoreReqMaster WHERE VesselCode = @VesselCode

	INSERT INTO MP_VSL_StoreReqMaster
    (
         [VesselCode],
		 [StoreReqId],
		 [AccountCode],
		 [Port],
		 [ETA],
		 [Remarks],
		 [UpdatedBy],
		 [UpdatedOn],
		 [Updated],
		 [Status]
	)
     VALUES
	(
	     @VesselCode,
		 @StoreReqId,
		 @AccountCode,
		 @Port,
		 @ETA,
		 @Remarks,
		 @UpdatedBy,
		 getdate(),
		 1,
		 ''N''
	)
	
	INSERT INTO MP_VSL_StoreReqDetails(StoreReqId,VesselCode,ItemId,QTY,ROB)
	SELECT @StoreReqId,VesselCode,ItemId,QTY,ROB
	FROM MP_VSL_TMP_Stores WHERE USERID=@UserId
	
  END
  ELSE
  BEGIN
     
	 UPDATE MP_VSL_StoreReqMaster
			SET [AccountCode] = @AccountCode,
				[Port]= @Port,
				[ETA] = @ETA,
				[Remarks] = @Remarks,
				[UpdatedBy] = @UpdatedBy,
				[UpdatedOn] = getdate(),
				[Updated] = 1
	 WHERE VesselCode = @VesselCode AND StoreReqId = @StoreReqId

	 DELETE FROM MP_VSL_StoreReqDetails WHERE VesselCode = @VesselCode AND StoreReqId = @StoreReqId

	 DECLARE @ItemId bigINT
	 DECLARE @QTY FLOAT
	 DECLARE @ROB FLOAT
	 
	 DECLARE CS CURSOR FOR SELECT ItemId,QTY,ROB FROM MP_VSL_TMP_Stores WHERE USERID=@UserId
	 OPEN CS
	   FETCH NEXT FROM CS INTO @ItemId,@QTY,@ROB
	   WHILE(@@FETCH_STATUS=0)
	   BEGIN
			IF EXISTS(SELECT * FROM MP_VSL_StoreReqDetails WHERE VESSELCODE=@VesselCode AND StoreReqId=@StoreReqId AND ItemId=@ItemId)
			BEGIN
				UPDATE MP_VSL_StoreReqDetails SET QTY=@QTY,ROB=@ROB
				WHERE VESSELCODE=@VesselCode AND StoreReqId=@StoreReqId AND ItemId=@ItemId
			END
			ELSE
			BEGIN
				INSERT INTO MP_VSL_StoreReqDetails(StoreReqId,VesselCode,ItemId,QTY,ROB)
				VALUES(@StoreReqId,@VesselCode,@ItemId,@QTY,@ROB)
			END
	   FETCH NEXT FROM CS INTO @ItemId,@QTY,@ROB
	 END
	 CLOSE CS
	 DEALLOCATE CS

   END

  DELETE FROM MP_VSL_TMP_Stores WHERE USERID=@UserId
  SELECT @StoreReqId AS StoreReqId
			
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateCategory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateCategory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[MP_InsertUpdateCategory]
(
    @CategoryId bigint,	
	@CategoryCode char(5),
	@CategoryName Varchar(50),
	@Inactive bit,
	@ParentCategoryId bigint,
	@OrderUnitId bigint,
	@ConsumptionUnitId bigint,
	@ConversionFactor float,	
	@Level char(1)		
)
AS
BEGIN
IF(@CategoryId = 0) -- Insert Category
BEGIN
    SELECT @CategoryId = ISNULL(MAX(CategoryId),0)+1 FROM MP_MainCategory
	INSERT INTO MP_MainCategory
    (
            CategoryId 
		   ,CategoryCode
           ,CategoryName          
           ,Inactive
           ,ParentCategoryId
		   ,OrderUnitId		   
		   ,ConsumptionUnitId	
		   ,ConversionFactor	   
           ,[Level]                
	)
     VALUES
	(
	       @CategoryId,
		   @CategoryCode,
           @CategoryName,           
           @Inactive,
           @ParentCategoryId,
		   @OrderUnitId,		   
		   @ConsumptionUnitId,
		   @ConversionFactor,
           @Level          
	)	
END
ELSE
BEGIN
	UPDATE MP_MainCategory   
    SET
	CategoryCode = @CategoryCode,
    CategoryName = @CategoryName,    
	OrderUnitId=@OrderUnitId,		   
	ConsumptionUnitId=@ConsumptionUnitId,
	ConversionFactor=@ConversionFactor
	WHERE CategoryId = @CategoryId AND ParentCategoryId = @ParentCategoryId AND [Level] = @Level

	IF(@Level=''C'')
	BEGIN
		UPDATE MP_MainCategory set 
		OrderUnitId=@OrderUnitId,		   
		ConsumptionUnitId=@ConsumptionUnitId,
		ConversionFactor=@ConversionFactor
		WHERE CategoryId IN (select CATEGORYID FROM MP_MainCategory WHERE LEFT(CATEGORYCODE,2)=LTRIM(RTRIM(@CategoryCode)))
	END
END	
SELECT @CategoryId;
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateConsumptionUnits]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateConsumptionUnits]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[MP_InsertUpdateConsumptionUnits]
(
    @UnitId bigint,	
	@UnitName Varchar(100)
)
AS
BEGIN

  IF (@UnitId <= 0)
  BEGIN
    SELECT @UnitId = ISNULL(MAX(UnitId),0) + 1 FROM [MP_UnitConsumptionMaster]
	INSERT INTO [MP_UnitConsumptionMaster]
    (
           UnitId,
           UnitName      
	)
     VALUES
	(
	       @UnitId,
           @UnitName
	)
   END
   ELSE
   BEGIN
         UPDATE [MP_UnitConsumptionMaster] SET UnitName = @UnitName WHERE UnitId = @UnitId
   END

   SELECT @UnitId AS UnitId;
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateMealsType]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateMealsType]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[MP_InsertUpdateMealsType]
(
    @MealId bigint,	
	@MealType Varchar(100)
)
AS
BEGIN

  IF (@MealId = 0)
  BEGIN
    SELECT @MealId = ISNULL(MAX(MealId),0) + 1 FROM MP_MealsTypeMaster
	INSERT INTO MP_MealsTypeMaster
    (
           MealId,
           MealType      
	)
     VALUES
	(
	       @MealId,
           @MealType
	)
   END
   ELSE
   BEGIN
         UPDATE MP_MealsTypeMaster SET MealType = @MealType WHERE MealId = @MealId
   END

   SELECT @MealId AS MealId;
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateProducts]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateProducts]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'		      
CREATE PROC [dbo].[MP_InsertUpdateProducts]
(
    @CategoryId bigint,
    @ProductId	bigint,    
	@ProductCode char(9),
	@ProductName Varchar(50),
	@SupplyUnitId int,
	@IMPACode Varchar(50),	
	@Inactive bit
)
AS
BEGIN
IF(@ProductId = 0) -- Insert Product
BEGIN
    SELECT @ProductId = ISNULL(MAX(ProductId),0)+1 FROM MP_Products
	INSERT INTO MP_Products
    (
         CategoryId,
         ProductId,		      
		 ProductCode,
         ProductName,
		 SupplyUnitId,
         IMPACode,
		 Inactive
		 
	)
     VALUES
	(
	     @CategoryId,
         @ProductId,		 
		 @ProductCode,
         @ProductName,
		 @SupplyUnitId,
		 @IMPACode,
         @Inactive
	)	
END
ELSE
BEGIN
	UPDATE MP_Products   
    SET    
	ProductCode = @ProductCode, 
    ProductName = @ProductName,
	SupplyUnitId = @SupplyUnitId,
    IMPACode = @IMPACode,
	Inactive = @Inactive
    WHERE CategoryId = @CategoryId AND ProductId = @ProductId 
     
END

INSERT INTO VSL_MP_PRODUCTS SELECT VESSELCODE,@ProductId,1,GETDATE(),0,NULL FROM DBO.VESSEL V WHERE VESSELSTATUSID<>2 AND VESSELID NOT IN (41,43,44 ) AND V.VESSELCODE NOT IN (SELECT VESSELCODE FROM VSL_MP_PRODUCTS WHERE PRODUCTID=@ProductId)

UPDATE VSL_MP_PRODUCTS SET UPDATED = 1, UPDATEDON = getdate() WHERE ProductId=@ProductId
			
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateProvisionNationalityWise]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateProvisionNationalityWise]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N' 
CREATE PROC [dbo].[MP_InsertUpdateProvisionNationalityWise]
(
    @VesselCode Char(3),
    @ProvisionId bigint, 
	@NationalityId int,
    @NoOfCrew int,
	@NoOfDays int
)
AS
BEGIN
     
	 

    IF NOT Exists (SELECT * FROM [MP_VSL_ProvisionNationalityWise] WHERE [VesselCode] = @VesselCode AND [ProvisionId] = @ProvisionId AND [NationalityId] = @NationalityId)
	BEGIN    
	INSERT INTO [MP_VSL_ProvisionNationalityWise]
    (
	    [VesselCode],
	    [ProvisionId], 
		[NationalityId],
		[NoOfCrew],
		[NoOfDays]
                  
	)
     VALUES
	(
		@VesselCode,
	    @ProvisionId, 
		@NationalityId,
		@NoOfCrew,
		@NoOfDays
	)
	END
	ELSE
	BEGIN
	      UPDATE [MP_VSL_ProvisionNationalityWise]

		  SET [NoOfCrew] = @NoOfCrew,
			  [NoOfDays] = @NoOfDays
		  WHERE [VesselCode] = @VesselCode AND [ProvisionId] = @ProvisionId AND [NationalityId] = @NationalityId

	END	
		
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateSupplyUnits]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateSupplyUnits]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'			      
CREATE PROC [dbo].[MP_InsertUpdateSupplyUnits]
(
    @UnitId bigint,	
	@UnitName Varchar(100)
)
AS
BEGIN

  IF (@UnitId <= 0)
  BEGIN
    SELECT @UnitId = ISNULL(MAX(UnitId),0) + 1 FROM [MP_UnitSupplyMaster]
	INSERT INTO [MP_UnitSupplyMaster]
    (
           UnitId,
           UnitName      
	)
     VALUES
	(
	       @UnitId,
           @UnitName
	)
   END
   ELSE
   BEGIN
         UPDATE [MP_UnitSupplyMaster] SET UnitName = @UnitName WHERE UnitId = @UnitId
   END

   SELECT @UnitId AS UnitId;
			
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertUpdateUnits]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertUpdateUnits]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[MP_InsertUpdateUnits]
(
    @UnitId bigint,	
	@UnitName Varchar(100)
)
AS
BEGIN

  IF (@UnitId <= 0)
  BEGIN
    SELECT @UnitId = ISNULL(MAX(UnitId),0) + 1 FROM MP_UnitMaster
	INSERT INTO MP_UnitMaster
    (
           UnitId,
           UnitName
		         
	)
     VALUES
	(
	       @UnitId,
           @UnitName
	)
   END
   ELSE
   BEGIN
         UPDATE MP_UnitMaster SET UnitName = @UnitName WHERE UnitId = @UnitId
   END

   SELECT @UnitId AS UnitId;
			
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_InsertVictuals]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_InsertVictuals]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROC [dbo].[MP_InsertVictuals]
(
    @VID bigint,
    @VesselCode Char(3),
	@EffectiveDate SmallDateTime,	
	@VesselAccount float,
	@OwnerAccount float,
	@CharterAccount float
)
AS
BEGIN	
	
	IF(@VID <= 0)
	BEGIN
	IF NOT EXISTS (SELECT * FROM [MP_VictualingMaster] WHERE [VesselCode] = @VesselCode AND [EffectiveDate] = @EffectiveDate)
	BEGIN
		SELECT @VID =  ISNULL(MAX(VID), 0) + 1 FROM [MP_VictualingMaster] 

		INSERT INTO [MP_VictualingMaster]
		(
			[VID],
			[VesselCode],
			[EffectiveDate],
			[VesselAccount],
			[OwnerAccount],
			[CharterAccount]
                  
		)
			VALUES
		(
			@VID,
			@VesselCode,
			@EffectiveDate,
			@VesselAccount,
			@OwnerAccount,
			@CharterAccount
		)

		END
	END
	ELSE
	BEGIN
	      UPDATE [MP_VictualingMaster]
		  SET [VesselAccount] = @VesselAccount,
			  [OwnerAccount] = @OwnerAccount,
			  [CharterAccount] = @CharterAccount
		WHERE [VID] = @VID
	END
    		
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_TMP_AppBlankProvision_OtherItem]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_TMP_AppBlankProvision_OtherItem]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE proc [dbo].[MP_TMP_AppBlankProvision_OtherItem]
@UserId bigint,
@VesselCode varchar(3)
as
begin
	DECLARE @OtherItemId int
	SELECT @OtherItemId=ISNULL(MAX(OtherItemId),0)+1 FROM MP_VSL_TMP_Provision_OtherItems WHERE UserId=@UserId and VesselCode=@VesselCode
	INSERT INTO MP_VSL_TMP_Provision_OtherItems(UserId,VesselCode,OtherItemId,ProductName,Packaging,Qty,ROB,UnitId) VALUES(@UserId,@VesselCode,@OtherItemId,'''','''',0,0,0)
end


' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_TMP_AppUpdateProvisions]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_TMP_AppUpdateProvisions]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE proc [dbo].[MP_TMP_AppUpdateProvisions]
(
@UserId int,
@VesselCode char(3),
@ProductId int,
--@QTY float,
--@ROB float,
--@OrderQtyPerUnit int,
--@PackagingName varchar(50),
@UOM varchar(50)
)
as
BEGIN

IF EXISTS(SELECT * FROM MP_VSL_TMP_Provision WHERE UserId=@UserId AND VesselCode=@VesselCode AND ProductId=@ProductId)
BEGIN
	PRINT ''A''
	--UPDATE MP_VSL_TMP_Provision
	--SET QTY=@QTY,ROB=@ROB
	--WHERE UserId=@UserId AND VesselCode=@VesselCode AND ProductId=@ProductId
END
ELSE
BEGIN
	INSERT INTO MP_VSL_TMP_Provision(UserId,VesselCode,ProductId,QTY,ROB,OrderQtyPerUnit,PackagingName,	UnitName)
	VALUES(@UserId,@VesselCode,@ProductId,0,0,0,'''',@UOM)
END

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_TMP_AppUpdateSpares]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_TMP_AppUpdateSpares]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE proc [dbo].[MP_TMP_AppUpdateSpares]
(
@UserId int,
@VesselCode char(3),
@ComponentId int,
@Office_Ship char(1),
@SpareId int,
@QTY float,
@ROB float,
@UOM varchar(50)
)
as
BEGIN

IF EXISTS(SELECT * FROM MP_VSL_TMP_Spares WHERE UserId=@UserId AND VesselCode=@VesselCode AND ComponentId=@ComponentId AND Office_Ship=@Office_Ship AND SpareId=@SpareId)
BEGIN
	UPDATE MP_VSL_TMP_Spares
	SET QTY=@QTY,ROB=@ROB,UOM=@UOM
	WHERE UserId=@UserId AND VesselCode=@VesselCode AND ComponentId=@ComponentId AND Office_Ship=@Office_Ship AND SpareId=@SpareId
END
ELSE
BEGIN
	INSERT INTO MP_VSL_TMP_Spares(UserId,VesselCode,ComponentId,Office_Ship,SpareId,QTY,ROB,UOM)
	VALUES(@UserId,@VesselCode,@ComponentId,@Office_Ship,@SpareId,@QTY,@ROB,@UOM)
END

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_TMP_AppUpdateStores]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_TMP_AppUpdateStores]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE proc [dbo].[MP_TMP_AppUpdateStores]
(
@UserId int,
@VesselCode char(3),
@ItemId Bigint,
@QTY float,
@ROB float
)
as
BEGIN

IF EXISTS(SELECT * FROM MP_VSL_TMP_Stores WHERE UserId=@UserId AND VesselCode=@VesselCode AND ItemId=@ItemId)
BEGIN
	UPDATE MP_VSL_TMP_Stores
	SET QTY=@QTY,ROB=@ROB
	WHERE UserId=@UserId AND VesselCode=@VesselCode AND ItemId=@ItemId
END
ELSE
BEGIN
	INSERT INTO MP_VSL_TMP_Stores(UserId,VesselCode,ItemId,QTY,ROB)
	VALUES(@UserId,@VesselCode,@ItemId,@QTY,@ROB)
END

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[MP_VSL_AddModify_StoreItem]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_AddModify_StoreItem]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROC [dbo].[MP_VSL_AddModify_StoreItem]
(
	@UserId int,
	@VesselCode char(3),
	@ItemId bigint,
	@ItemName varchar(1000),
	@Description varchar(1000),
	@ISSA_IMPA varchar(100),
	@UOM VARCHAR(50),
	@ROB FLOAT,
	@QTY FLOAT,
	@AccountCode int
)
AS
BEGIN
	IF(@ItemId<=0)
	BEGIN
		SELECT @ItemId=ISNULL(MAX(ItemId),0)+1 FROM MP_VSL_StoreItemMaster WHERE VESSELCODE=@VesselCode
		INSERT INTO MP_VSL_StoreItemMaster(VesselCode,ItemId,ItemName,[Description],ISSA_IMPA,UOM,AccountCode)
		VALUES(@VesselCode,@ItemId,@ItemName,@Description,@ISSA_IMPA,@UOM,@AccountCode)
	END
	ELSE
	BEGIN
		UPDATE MP_VSL_StoreItemMaster 
		SET 
		ItemName=@ItemName,
		[Description]=@Description 
		,ISSA_IMPA=@ISSA_IMPA 
		,UOM=@UOM
		,AccountCode=@AccountCode
		WHERE VesselCode=@VesselCode AND ItemId=@ItemId
	END
	
	IF EXISTS(SELECT * FROM MP_VSL_TMP_Stores WHERE UserId=@UserId AND VESSELCODE=@VesselCode AND ITEMID=@ITEMID)
	BEGIN
		UPDATE [dbo].[MP_VSL_TMP_Stores]
		SET QTY=@QTY,ROB=@ROB
		WHERE UserId=@UserId AND VESSELCODE=@VesselCode AND ITEMID=@ITEMID
	END
	ELSE
	BEGIN
		INSERT INTO [dbo].[MP_VSL_TMP_Stores](UserId,VESSELCODE,ITEMID,QTY,ROB)
		VALUES(@UserId,@VESSELCODE,@ITEMID,@QTY,@ROB)
	END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[MWUC_ImportCATMASTER]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_ImportCATMASTER]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[MWUC_ImportCATMASTER]
(
    @VESSELCODE char(3),
	@CATID int,
	@CATNAME varchar(500)
)
AS
BEGIN 

		IF NOT EXISTS( SELECT CATID FROM MWUC_CATMASTER WHERE VESSELCODE = @VESSELCODE AND CATID=@CATID)
		BEGIN
		INSERT INTO MWUC_CATMASTER
		(
			VESSELCODE,
			CATID,
			CATNAME
		)
		 VALUES
		(
			@VESSELCODE,
			@CATID,
			@CATNAME
		)
	   END
	   ELSE
	   BEGIN
			UPDATE MWUC_CATMASTER 
			SET CATNAME=@CATNAME
			WHERE VESSELCODE = @VESSELCODE AND CATID=@CATID
	   END
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[MWUC_ImportDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_ImportDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
			      
CREATE PROC [dbo].[MWUC_ImportDetails]
(
    @MODE char(1),
    @VESSELCODE char(3),
	@TABLEID bigint,
	@CATID int,
	@SHIPCOMMENT varchar(max),
	@SHIPCOMMENTON smalldatetime,
	@OFFICECOMMENT varchar(max),
	@OFFICECOMMENTBY varchar(50),
	@OFFICECOMMENTPOSITION varchar(50),
	@OFFICECOMMENTON smalldatetime
)
AS
BEGIN

  IF(LTRIM(RTRIM(@MODE)) = ''O'')
  BEGIN
	  IF NOT EXISTS( SELECT CATID FROM MWUC_DETAILS WHERE VESSELCODE = @VESSELCODE AND TABLEID=@TABLEID AND CATID=@CATID)
	  BEGIN

		INSERT INTO MWUC_DETAILS
		(
			VESSELCODE,
			TABLEID,
			CATID,
			SHIPCOMMENT,
			SHIPCOMMENTON 
			     
		)
		 VALUES
		(
			@VESSELCODE,
			@TABLEID,
			@CATID,
			@SHIPCOMMENT,
			getdate()
		)
	   END
   END
   ELSE
   BEGIN

    UPDATE MWUC_DETAILS 
		SET OFFICECOMMENT=@OFFICECOMMENT,
		    OFFICECOMMENTBY=@OFFICECOMMENTBY,
			OFFICECOMMENTPOSITION=@OFFICECOMMENTPOSITION,
			OFFICECOMMENTON=@OFFICECOMMENTON
	WHERE VESSELCODE = @VESSELCODE AND TABLEID=@TABLEID AND CATID=@CATID
	
	END
			
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[MWUC_ImportMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_ImportMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


			      
CREATE PROC [dbo].[MWUC_ImportMaster]
(
    @MODE char(1),
    @VESSELCODE char(3),
	@TABLEID bigint,
	@FORDATE smalldatetime,
	@MASTERCREWNO varchar(10),
	@MASTERNAME varchar(50),
	@CREATEDON smalldatetime,
	@OFFICERECDON smalldatetime,
	@OFFICECLOSEDON smalldatetime
)
AS
BEGIN 

 IF(LTRIM(RTRIM(@MODE)) = ''O'')
 BEGIN
		IF NOT EXISTS( SELECT TABLEID FROM MWUC_MASTER WHERE VESSELCODE = @VESSELCODE AND TABLEID=@TABLEID)
		BEGIN
		INSERT INTO MWUC_MASTER
		(
			VESSELCODE,
			TABLEID,
			FORDATE,
			MASTERCREWNO,
			MASTERNAME,
			CREATEDON,
			OFFICERECDON   
			     
		)
		 VALUES
		(
			@VESSELCODE,
			@TABLEID,
			@FORDATE,
			@MASTERCREWNO,
			@MASTERNAME,
			@CREATEDON,
			GETDATE()
		)

		
	   END

   END
   ELSE
   BEGIN
      UPDATE MWUC_MASTER 
			SET OFFICERECDON=@OFFICERECDON,
				OFFICECLOSEDON=@OFFICECLOSEDON
		 WHERE VESSELCODE = @VESSELCODE AND TABLEID=@TABLEID
	END
END






' 
END
GO
/****** Object:  StoredProcedure [dbo].[MWUC_InsertUpdateCategory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_InsertUpdateCategory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
			      
CREATE PROC [dbo].[MWUC_InsertUpdateCategory]
(
    @VESSELCODE char(3),
    @CATID int,
	@CATNAME varchar(500)
)
AS
BEGIN

  IF(@CATID<=0)
  BEGIN
    

	SELECT @CATID= ISNULL(MAX(CATID),0)+1 FROM MWUC_CATMASTER WHERE VESSELCODE = @VESSELCODE
	

	INSERT INTO MWUC_CATMASTER
    (
        VESSELCODE,
		CATID,
		CATNAME    
			     
	)
     VALUES
	(
		@VESSELCODE,
		@CATID,
		@CATNAME
	)
   END
   ELSE
   BEGIN
         UPDATE MWUC_CATMASTER 
				SET CATNAME = @CATNAME
		 WHERE VESSELCODE = @VESSELCODE AND CATID=@CATID
   END
			
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[MWUC_InsertUpdateDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_InsertUpdateDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
			      
CREATE PROC [dbo].[MWUC_InsertUpdateDetails]
(
    @VESSELCODE char(3),
	@TABLEID bigint,
	@CATID int,
	@SHIPCOMMENT varchar(max)
)
AS
BEGIN

  IF NOT EXISTS( SELECT CATID FROM MWUC_DETAILS WHERE VESSELCODE = @VESSELCODE AND TABLEID=@TABLEID AND CATID=@CATID)
  BEGIN

	INSERT INTO MWUC_DETAILS
    (
        VESSELCODE,
		TABLEID,
		CATID,
		SHIPCOMMENT,
		SHIPCOMMENTON 
			     
	)
     VALUES
	(
		@VESSELCODE,
		@TABLEID,
		@CATID,
		@SHIPCOMMENT,
		getdate()
	)
   END
   ELSE
   BEGIN
         UPDATE MWUC_DETAILS 
				SET SHIPCOMMENT=@SHIPCOMMENT
		 WHERE VESSELCODE = @VESSELCODE AND TABLEID=@TABLEID AND CATID=@CATID
   END
			
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[MWUC_InsertUpdateMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_InsertUpdateMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
			      
CREATE PROC [dbo].[MWUC_InsertUpdateMaster]
(
    @VESSELCODE char(3),
	@TABLEID bigint,
	@FORDATE smalldatetime,
	@MASTERCREWNO varchar(10),
	@MASTERNAME varchar(50)
)
AS
BEGIN

  IF(@TABLEID<=0)
  BEGIN

	SELECT @TABLEID= ISNULL(MAX(TABLEID),0)+1 FROM MWUC_MASTER WHERE VESSELCODE = @VESSELCODE
	

	INSERT INTO MWUC_MASTER
    (
        VESSELCODE,
		TABLEID,
		FORDATE,
		MASTERCREWNO,
		MASTERNAME,
		CREATEDON   
			     
	)
     VALUES
	(
		@VESSELCODE,
		@TABLEID,
		@FORDATE,
		@MASTERCREWNO,
		@MASTERNAME,
		getdate()
	)
   END
   ELSE
   BEGIN
         UPDATE MWUC_MASTER 
				SET FORDATE=@FORDATE,
					MASTERCREWNO=@MASTERCREWNO,
					MASTERNAME=@MASTERNAME
		 WHERE VESSELCODE = @VESSELCODE AND TABLEID=@TABLEID
   END

   SELECT @TABLEID AS TABLEID 
			
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[OfficeVerifyJobHistory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[OfficeVerifyJobHistory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[OfficeVerifyJobHistory]
	@VesselCode char(3),
	@HistoryId Int,
	@Comments varchar(4000),
	@VerifiedBy varchar(50)
AS
BEGIN
	
	if EXISTS(select * from VSL_VesselJobUpdateHistory_OfficeComments	WHERE VESSELCODE=@VesselCode AND HistoryId=@HistoryId)
	BEGIN
		UPDATE	dbo.VSL_VesselJobUpdateHistory_OfficeComments
		SET 
		VesselCode=@VesselCode,
		HistoryID=@HistoryId,
		Comments=@Comments,
		
		Verified=1,
		VERIFIEDBY=@VerifiedBy,
		VERIFIEDON=GETDATE(),
		

		Updated=1,
		UpdatedOn=GETDATE()
		WHERE VESSELCODE=@VesselCode AND HistoryId=@HistoryId
	END
	ELSE
	BEGIN
		INSERT INTO dbo.VSL_VesselJobUpdateHistory_OfficeComments
		 (VesselCode ,HistoryId,Comments,Verified,VerifiedBy,VerifiedOn,Updated,UpdatedOn)
			VALUES
		(@VesselCode,@HistoryId,@Comments,1,@VerifiedBy,GETDATE(),1,GETDATE())
	  
	END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[PMS_Status_Report]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PMS_Status_Report]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[PMS_Status_Report]
(
	@FleetID int
)
AS
BEGIN

DECLARE @VCODE CHAR(3)
DECLARE @LASTPACKET VARCHAR(50)
DECLARE @LASTUPDATEON SMALLDATETIME
DECLARE @NC_OD INT
DECLARE @C_OD INT
DECLARE @O_DEF INT
DECLARE @OD_DEF INT
DECLARE @V_TABLE TABLE(VESSELCODE CHAR(3),LASTPACKET VARCHAR(50), LASTUPDATEON SMALLDATETIME,NC_OD INT,C_OD INT,O_DEF INT, OD_DEF INT)

DECLARE CS CURSOR FOR SELECT VESSELCODE FROM DBO.VESSEL WHERE VESSELSTATUSID<>2 AND VESSELID NOT IN (41,43,44) and ( CASE WHEN @FleetID<=0 THEN 1 WHEN FleetId=@FleetID THEN 1 ELSE 0 END  ) = 1
OPEN CS
FETCH NEXT FROM CS INTO @VCODE
WHILE (@@FETCH_STATUS=0)
BEGIN
	SET @LASTPACKET=''''
	SET @LASTUPDATEON=NULL
	SET @NC_OD=0
	SET @C_OD=0
	SET @O_DEF=0
	SET @OD_DEF=0
	-- LAST PACKET NAME & DATE
	SELECT TOP 1 @LASTPACKET=PACKETNAME,@LASTUPDATEON=PACKETDATE FROM IE_PacketReceived WHERE VESSELCODE=@VCODE ORDER BY PACKETID DESC
	
	-- NON CRITICAL OVER DUE
	SELECT @NC_OD=COUNT(VCJM.CompJobId) FROM VSL_VesselComponentJobMaster VCJM 
    INNER JOIN VSL_VesselComponentJobMaster_Updates VCJMU ON VCJM.VesselCode = VCJMU.VesselCode AND VCJM.ComponentId = VCJMU.ComponentId AND VCJM.CompJobId = VCJMU.CompJobId AND VCJM.Status = ''A'' 
    INNER JOIN VSL_ComponentMasterForVessel VCM ON VCJM.VesselCode = VCM.VesselCode AND VCJM.ComponentId = VCM.ComponentId AND VCM.Status = ''A'' 
    INNER JOIN ComponentsJobMapping CJM ON VCJM.CompjobId=CJM.CompjobId 
    INNER JOIN ComponentMaster CM ON CM.ComponentId = VCJM.ComponentId AND CriticalEquip<>1 
    INNER JOIN JobMaster JM  ON JM.JobId = VCJM.JobId 
    INNER JOIN JobIntervalMaster JIM ON JIM.IntervalId = VCJM.IntervalId 
    LEFT JOIN VSL_PlanMaster PM ON PM.VesselCode = VCJM.VesselCode AND PM.ComponentId = VCJM.ComponentId AND PM.CompJobId = VCJM.CompJobId 
    LEFT JOIN Rank RM ON RM.RankId = PM.AssignedTo 
    WHERE VCJM.VesselCode=@VCODE AND (VCJMU.NextDueDate < CONVERT(SMALLDATETIME,CONVERT(VARCHAR,GETDATE())) OR VCJMU.NextDueDate IS NULL) 
	
	-- CRITICAL OVER DUE
	SELECT @C_OD=COUNT(VCJM.CompJobId) FROM VSL_VesselComponentJobMaster VCJM 
    INNER JOIN VSL_VesselComponentJobMaster_Updates VCJMU ON VCJM.VesselCode = VCJMU.VesselCode AND VCJM.ComponentId = VCJMU.ComponentId AND VCJM.CompJobId = VCJMU.CompJobId AND VCJM.Status = ''A'' 
    INNER JOIN VSL_ComponentMasterForVessel VCM ON VCJM.VesselCode = VCM.VesselCode AND VCJM.ComponentId = VCM.ComponentId AND VCM.Status = ''A'' 
    INNER JOIN ComponentsJobMapping CJM ON VCJM.CompjobId=CJM.CompjobId 
    INNER JOIN ComponentMaster CM ON CM.ComponentId = VCJM.ComponentId AND CriticalEquip=1
    INNER JOIN JobMaster JM  ON JM.JobId = VCJM.JobId 
    INNER JOIN JobIntervalMaster JIM ON JIM.IntervalId = VCJM.IntervalId 
    LEFT JOIN VSL_PlanMaster PM ON PM.VesselCode = VCJM.VesselCode AND PM.ComponentId = VCJM.ComponentId AND PM.CompJobId = VCJM.CompJobId 
    LEFT JOIN Rank RM ON RM.RankId = PM.AssignedTo 
    WHERE VCJM.VesselCode=@VCODE AND (VCJMU.NextDueDate < CONVERT(SMALLDATETIME,CONVERT(VARCHAR,GETDATE())) OR VCJMU.NextDueDate IS NULL) 
    
	-- OPEN DEFECTS
	SELECT @O_DEF=COUNT(*) from vw_DefectJobs VCJM INNER JOIN VSL_ComponentMasterForVessel D ON VCJM.VESSELCODE =D.VESSELCODE AND VCJM.COMPONENTID=D.COMPONENTID AND D.Status = ''A'' AND D.Status = ''A''
	WHERE COMPLETIONDT IS NULL AND VCJM.VESSELCODE=@VCODE
	
	-- OVERDUE DEFECTS
	SELECT @OD_DEF=COUNT(*) from vw_DefectJobs VCJM INNER JOIN VSL_ComponentMasterForVessel D ON VCJM.VESSELCODE =D.VESSELCODE AND VCJM.COMPONENTID=D.COMPONENTID AND D.Status = ''A'' AND D.Status = ''A''
	 WHERE COMPLETIONDT IS NULL AND VCJM.VESSELCODE=@VCODE AND dbo.getDatePart(TARGETDT)<dbo.getDatePart(GETDATE())
	
	INSERT INTO @V_TABLE(VESSELCODE,LASTPACKET,LASTUPDATEON,NC_OD,C_OD,O_DEF,OD_DEF) VALUES(@VCODE,@LASTPACKET,@LASTUPDATEON,@NC_OD,@C_OD,@O_DEF,@OD_DEF)
	
	FETCH NEXT FROM CS INTO @VCODE
END
CLOSE CS
DEALLOCATE CS
SELECT VT.VESSELCODE,V.VESSELNAME,LASTPACKET,LASTUPDATEON,NC_OD,C_OD,O_DEF,OD_DEF FROM @V_TABLE VT INNER JOIN DBO.VESSEL V ON V.VESSELCODE=VT.VESSELCODE
ORDER BY V.VESSELCODE

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[REG_InsertRegulation_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[REG_InsertRegulation_Vessel_Notifications]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
create proc [dbo].[REG_InsertRegulation_Vessel_Notifications]
(
@RegId bigint,
@VesselCode char(3)
)
as
begin
	if exists(select * from Reg_Vessel_Notifications where RegId=@RegId AND VESSELCODE=@VesselCode)
	BEGIN
		UPDATE Reg_Vessel_Notifications SET SENTON=GETDATE(),ACKON=NULL,ACKMESSAGE=NULL where RegId=@RegId AND VESSELCODE=@VesselCode
	END
	ELSE
	BEGIN
		INSERT INTO Reg_Vessel_Notifications(RegId,VESSELCODE,SENTON)
		VALUES(@RegId,@VesselCode,GETDATE())	
	END
end







' 
END
GO
/****** Object:  StoredProcedure [dbo].[REG_INSERTUPDATERegulation]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[REG_INSERTUPDATERegulation]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[REG_INSERTUPDATERegulation]
(
    @RegID int,
	@RegNUMBER varchar(50),
	@MSId int,
	@SSId int,
	@RegDATE smalldatetime,
	@EarAppDate smalldatetime,
	@TITLE varchar(500),
	@Tag varchar(100),
	@SMSChangeReqd char(1),
	@ATTACHMENTFILENAME varchar(100),
	@ATTACHMENT image,
	@CREATEDBY varchar(50),
	@Reg_Categories VARCHAR(500)
)
AS
BEGIN
	IF(@RegID <= 0)
	BEGIN
		SELECT @RegID=ISNULL(MAX(RegID),0)+1 FROM Reg_Regulation
		INSERT INTO Reg_Regulation
		(
		RegID ,
		RegNUMBER ,
		MSId,
		SSId,
		RegDATE,
		EarAppDate,
		TITLE ,
		Tag,
		SMSChangeReqd,
		ATTACHMENTFILENAME ,
		ATTACHMENT ,
		[STATUS] ,
		CREATEDBY ,
		CREATEDON 
		)
		Values
		(
		@RegID,
		@RegNUMBER,
		@MSId,
		@SSId,
		@RegDATE,
		@EarAppDate,
		@TITLE,
		@Tag,
		@SMSChangeReqd,
		@ATTACHMENTFILENAME,
		@ATTACHMENT,
		''O'',
		@CREATEDBY,
		GETDATE()
		)

		INSERT INTO Reg_Categories
		SELECT @RegID,RESULT FROM [dbo].[CSVtoTable](@Reg_Categories,'','')
	END
	ELSE
	BEGIN
	     
		IF(LTRIM(RTRIM(@ATTACHMENTFILENAME)) <> '''' )
		BEGIN
		      UPDATE Reg_Regulation
				SET RegNUMBER = @RegNUMBER,
				    MSId = @MSId,
					SSId = @SSId,
					EarAppDate = @EarAppDate,
					RegDATE = @RegDATE,
					TITLE =  @TITLE,
					Tag=@Tag,
					SMSChangeReqd=@SMSChangeReqd,
				    ATTACHMENTFILENAME = @ATTACHMENTFILENAME,
					ATTACHMENT = @ATTACHMENT
			  WHERE RegID =  @RegID 
		END
		ELSE
		BEGIN
		     UPDATE Reg_Regulation
				SET RegNUMBER = @RegNUMBER,
				    MSId = @MSId,
					SSId = @SSId,
					EarAppDate = @EarAppDate,
					RegDATE = @RegDATE,
					TITLE =  @TITLE,
					Tag=@Tag,
					SMSChangeReqd=@SMSChangeReqd
			WHERE RegID =  @RegID
		END

		DELETE FROM Reg_Categories WHERE [RegId] = @RegID

		INSERT INTO Reg_Categories
		SELECT @RegID,RESULT FROM [dbo].[CSVtoTable](@Reg_Categories,'','')
		
	END
END











' 
END
GO
/****** Object:  StoredProcedure [dbo].[REG_InsertUpdateRegulation_Vessel_Notifications_VSL]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[REG_InsertUpdateRegulation_Vessel_Notifications_VSL]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE proc [dbo].[REG_InsertUpdateRegulation_Vessel_Notifications_VSL]
(
@RegId bigint,
@VesselCode char(3),
@AckOn smalldatetime,
@AckMessage varchar(500),
@Discussed bit,
@Notice bit

)
as
begin
	if exists(select * from Reg_Vessel_Notifications where RegID=@RegId AND VESSELCODE=@VesselCode)
	BEGIN
		UPDATE Reg_Vessel_Notifications SET ACKON=@AckOn,ACKMESSAGE=@AckMessage,Discussed=@Discussed,Notice=@Notice where RegID=@RegId AND VESSELCODE=@VesselCode
	END
	ELSE
	BEGIN
		INSERT INTO Reg_Vessel_Notifications(RegID,VESSELCODE,AckOn,AckMessage,Discussed,Notice)
		VALUES(@RegId,@VesselCode,@AckOn,@AckMessage,@Discussed,@Notice)	
	END
end
' 
END
GO
/****** Object:  StoredProcedure [dbo].[REG_InsertUpdateRegulation_VSL]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[REG_InsertUpdateRegulation_VSL]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[REG_InsertUpdateRegulation_VSL]
(
	@RegID int,
	@RegNUMBER varchar(50),
	@MSId int,
	@SSId int,
	@RegDATE smalldatetime,
	@EarAppDate smalldatetime,
	@TITLE varchar(500),
	@Tag varchar(100),
	@ATTACHMENTFILENAME varchar(100),
	@ATTACHMENT image,
	@STATUS char(1),
	@CREATEDBY varchar(50),
	@CREATEDON smalldatetime,
	@PUBLISHEDBY varchar(50),
	@PUBLISHEDON smalldatetime
)
AS
BEGIN
SET NOCOUNT ON

IF EXISTS(SELECT * FROM Reg_Regulation WHERE RegID=@RegID)
	DELETE FROM Reg_Regulation WHERE RegID=@RegID

INSERT INTO Reg_Regulation
(
RegID ,
RegNUMBER ,
MSId,
SSId,
RegDATE ,
EarAppDate,
TITLE ,
Tag,
ATTACHMENTFILENAME ,
ATTACHMENT ,
STATUS ,
CREATEDBY ,
CREATEDON ,
PUBLISHEDBY ,
PUBLISHEDON 
)
Values
(
@RegID,
@RegNUMBER,
@MSId,
@SSId,
@RegDATE,
@EarAppDate,
@TITLE,
@Tag,
@ATTACHMENTFILENAME,
@ATTACHMENT,
@STATUS,
@CREATEDBY,
@CREATEDON,
@PUBLISHEDBY,
@PUBLISHEDON
)

END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[rpt_DRYDOCKJOBLIST]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[rpt_DRYDOCKJOBLIST]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[rpt_DRYDOCKJOBLIST]
(
	@VSLLIST VARCHAR(500)
	--@FROMDATE SMALLDATETIME,
	--@TODATE SMALLDATETIME
)
AS
BEGIN
	-- EXEC DBO.[rpt_DRYDOCKJOBLIST] ''LIG'',''01-JAN-2001'',''01-JAN-2013''
	--===============================
	--DECLARE @VSLLIST VARCHAR(500)
	--DECLARE @FROMDATE SMALLDATETIME
	--DECLARE @TODATE SMALLDATETIME
	--===============================
	--SET @VSLLIST=''LIG,AME''
	--SET @COMPCODE=''220.16%''
	--SET @COMPNAME=''%%''
	--SET @JOBCAT=''1,2,3,4,5,6,7,8,9,10,11,12,14,15''
	--SET @JOBTYPES=''1,2,3,4,5''
	--SET @CRIT=0
	--SET @CLASS=0
	--SET @CLASSCODE=''%%''
	--SET @ASSIGNEDTO=''0,1,2,3,4,5,6,7,8,9''
	--SET @PLANSTATUS=''1,3,0''
	--SET @DUEDAYS=''10000''
	--SET @OD=1
	--===============================
	DECLARE @TEMP TABLE
	(
	[VesselCode] [char](3) ,
	[ClassEquipCode] [varchar](50) ,
	[ComponentCode] [char](20) ,
	[ComponentName] [varchar](100) ,
	[CriticalType] [char](1) ,
	[JobCode] [char](3) ,
	[JobType] [varchar](50) ,
	[JobName] [varchar](500) ,
	[IntervalName] [varchar](1) ,
	[RankCode] [varchar](50) ,
	[LastDone] smalldatetime,
	[LastHour] [int] ,
	[DefectNo] [varchar](15),
	[TagetClosureDate] smalldatetime,
	[DD_By_Code] [varchar](50),
	[DD_By_Name] [varchar](50)
	)
	--===============================
		INSERT INTO @TEMP
			SELECT 
			VCJMU.VesselCode,
			VCM.ClassEquipCode,
			CM.ComponentCode,
			CM.ComponentName,
			CM.CriticalType,
			JM.JobCode,
			JM.JobName AS JobType,
			CASE WHEN LEN(CJM.DescrSh) > 100 THEN Substring(CJM.DescrSh,0,100) + ''...'' ELSE CJM.DescrSh END AS JobName,
			JIM.IntervalName ,
			RM.RankCode,
			REPLACE(CONVERT(VARCHAR(15),VCJMU.LastDone,106),'' '',''-'') AS LastDone,
			VCJMU.LastHour,
			'''' as DefectNo,VPM.PostPoneDate as TagetClosureDate,
			VPM.P_DoneBy_Code as DD_By,VPM.P_DoneBy_Name as DD_on 
			FROM 
			VSL_PLANMASTER VPM 
			INNER JOIN VSL_VesselComponentJobMaster VCJM ON VPM.VESSELCODE=VCJM.VESSELCODE AND VPM.ComponentId = VCJM.ComponentId AND VPM.CompJobId = VCJM.CompJobId
			INNER JOIN VSL_VesselComponentJobMaster_Updates VCJMU ON VCJM.VesselCode = VCJMU.VesselCode AND VCJM.ComponentId = VCJMU.ComponentId AND VCJM.CompJobId = VCJMU.CompJobId AND VCJM.STATUS=''A'' 
			INNER JOIN VSL_ComponentMasterForVessel VCM ON VCJM.VesselCode = VCM.VesselCode AND VCJM.ComponentId = VCM.ComponentId AND VCM.STATUS=''A'' 
			INNER JOIN ComponentsJobMapping CJM ON VCJM.CompjobId=CJM.CompjobId 
			INNER JOIN ComponentMaster CM ON CM.ComponentId = VCJM.ComponentId 
			INNER JOIN JobMaster JM  ON JM.JobId = VCJM.JobId 
			INNER JOIN JobIntervalMaster JIM ON JIM.IntervalId = VCJM.IntervalId 
			LEFT JOIN VSL_PlanMaster PM ON PM.VesselCode = VCJM.VesselCode AND PM.ComponentId = VCJM.ComponentId AND PM.CompJobId = VCJM.CompJobId 
			LEFT JOIN Rank RM ON RM.RankId = PM.AssignedTo
			WHERE VPM.STATUS=3 AND VPM.VESSELCODE IN (SELECT RESULT FROM dbo.CSVtoTableString(@VSLLIST,'','')) --	AND VPM.PostPoneDate BETWEEN @FROMDATE AND @TODATE
			
		-- DEFECT DATA
		INSERT INTO @TEMP
			SELECT DDM.VESSELCODE,
			VCM.CLASSEQUIPCODE,
			CM.COMPONENTCODE,
			CM.COMPONENTNAME,
			CM.CRITICALTYPE,
			''DFR'' AS JOBCODE,
			''Defect'',convert(varchar(250),DefectDetails) as JobName,'''',
			'''' AS RANKCODE,'''' as LastDone,0 as LastHour,DefectNo,TargetDt as TagetClosureDate,'''',''''
			FROM VSL_DEFECTDETAILSMASTER DDM 
			INNER JOIN VSL_ComponentMasterForVessel VCM ON DDM.VesselCode=VCM.VESSELCODE AND DDM.ComponentId = VCM.ComponentId and DDM.COMPLETIONDT IS NULL AND VCM.STATUS=''A''
			INNER JOIN SETTINGS SS ON DDM.VESSELCODE=SS.SHIPCODE
			INNER JOIN ComponentMaster CM ON CM.ComponentId = DDM.ComponentId 
			WHERE DRYDOCK=''Y'' AND DDM.VESSELCODE IN (SELECT RESULT FROM dbo.CSVtoTableString(@VSLLIST,'',''))
			AND DDM.COMPLETIONDT IS NULL
			--	AND DDM.TARGETDT BETWEEN @FROMDATE AND @TODATE
		
	SELECT ROW_NUMBER() OVER(ORDER BY COMPONENTCODE)  AS ROWNUMBER	
	,(Select ShipName from Settings S Where S.ShipCode=T.VesselCode)VesselName
	,* FROM @TEMP T
END


















' 
END
GO
/****** Object:  StoredProcedure [dbo].[SCM_IMPORT_SCM_MASTER]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_IMPORT_SCM_MASTER]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROCEDURE [dbo].[SCM_IMPORT_SCM_MASTER]
(
    @Mode char(1),   
    @SCMId bigint,
    @VesselCode char(3),
    @SDate smalldatetime,
    @ShipPosFrom varchar(50),
    @ShipPosTo varchar(50),
    @CommTime varchar(5),
    @CompTime varchar(5),
    @Ocassion char(1),
    @ShipPosition char(1),
    @Str_MinOfPrevSaFeCom bit,
    @Str_AbsPrevSageCom bit,
    @NAME_OTHER varchar(50),
    @Str_OffCommPrevSafeCom bit,
    @Sef_AvailableOnBoard varchar(5000),
    @Sef_AccidentNarMiss varchar(5000),
    @Sef_ReviewOfMooring varchar(5000),
    @Sef_CrewNotFamilierWithAll varchar(5000),
    @Sef_BestPractice varchar(5000),
    @Hel_ReviewHelth varchar(5000),
    @Hel_BestPractice varchar(5000),
    @Sec_ReviewAnyImmediateSecurity varchar(5000),
    @Sec_BestPractices varchar(5000),
    @Qul_ReviewOfRegulatory varchar(5000),
    @Qul_ReviewOfQuality varchar(5000),
    @Qul_KPI varchar(5000),
    @Qul_CrewWelfare varchar(5000),
    @Qul_BestPractices varchar(5000),
    @Env_EnvironmentalKPIs varchar(5000),
    @Env_BestPractices varchar(5000),
    @AnyOtherIssues varchar(5000),
    @RANK_OTHER varchar(50),
    @OUTSTANDINGITEMS varchar(1000),
    @ReceviedOn smalldatetime,
    @OfficeComments varchar(5000),
    @SUPTD_CompliancewithRegulations varchar(5000),
    @SUPTD_DeviationsfromSafety varchar(5000),
    @SUPTD_DetailsofTraining varchar(5000),
    @SUPTD_HealthSafetyMeasures varchar(5000),
    @SUPTD_Suggestions varchar(5000),
    @SUPTD_BPI varchar(5000),
    @SUPTD_AnyOtherTopic varchar(5000),
    @UpdatedBy varchar(50),
    @UpdatedOn smalldatetime,
    @ReportsPK bigint,
    @BestPractice varchar(5000)
)
AS
BEGIN
SET NOCOUNT ON
	
	IF (@Mode = ''O'')
	BEGIN

		IF NOT EXISTS (SELECT ReportsPK FROM [dbo].[SCM_MASTER] WHERE  VesselCode=@VesselCode AND ReportsPK=@ReportsPK)
		BEGIN
		SELECT @SCMID= ISNULL(MAX(SCMID),0)+1 FROM [dbo].[SCM_MASTER] 
		INSERT INTO [dbo].[SCM_MASTER]
	(
		SCMId ,
        VesselCode ,
        SDate ,
        ShipPosFrom ,
        ShipPosTo ,
        CommTime ,
        CompTime ,
        Ocassion ,
        ShipPosition,
        Str_MinOfPrevSaFeCom,
        Str_AbsPrevSageCom,
        NAME_OTHER ,
        Str_OffCommPrevSafeCom,
        Sef_AvailableOnBoard,
        Sef_AccidentNarMiss,
        Sef_ReviewOfMooring,
        Sef_CrewNotFamilierWithAll,
        Sef_BestPractice,
        Hel_ReviewHelth,
        Hel_BestPractice,
        Sec_ReviewAnyImmediateSecurity,
        Sec_BestPractices,
        Qul_ReviewOfRegulatory,
        Qul_ReviewOfQuality,
        Qul_KPI,
        Qul_CrewWelfare,
        Qul_BestPractices,
        Env_EnvironmentalKPIs,
        Env_BestPractices,
        AnyOtherIssues,
        RANK_OTHER ,
        OUTSTANDINGITEMS,
        ReceviedOn ,
        OfficeComments,
        SUPTD_CompliancewithRegulations,
        SUPTD_DeviationsfromSafety,
        SUPTD_DetailsofTraining,
        SUPTD_HealthSafetyMeasures,
        SUPTD_Suggestions,
        SUPTD_BPI,
        SUPTD_AnyOtherTopic,
        UpdatedBy ,
        UpdatedOn ,
        ReportsPK ,
        BestPractice
	)
	Values
	(
		@SCMId ,
        @VesselCode ,
        @SDate ,
        @ShipPosFrom ,
        @ShipPosTo ,
        @CommTime ,
        @CompTime ,
        @Ocassion ,
        @ShipPosition,
        @Str_MinOfPrevSaFeCom,
        @Str_AbsPrevSageCom,
        @NAME_OTHER ,
        @Str_OffCommPrevSafeCom,
        @Sef_AvailableOnBoard,
        @Sef_AccidentNarMiss,
        @Sef_ReviewOfMooring,
        @Sef_CrewNotFamilierWithAll,
        @Sef_BestPractice,
        @Hel_ReviewHelth,
        @Hel_BestPractice,
        @Sec_ReviewAnyImmediateSecurity,
        @Sec_BestPractices,
        @Qul_ReviewOfRegulatory,
        @Qul_ReviewOfQuality,
        @Qul_KPI,
        @Qul_CrewWelfare,
        @Qul_BestPractices,
        @Env_EnvironmentalKPIs,
        @Env_BestPractices,
        @AnyOtherIssues,
        @RANK_OTHER ,
        @OUTSTANDINGITEMS,
        @ReceviedOn ,
        @OfficeComments,
        @SUPTD_CompliancewithRegulations,
        @SUPTD_DeviationsfromSafety,
        @SUPTD_DetailsofTraining,
        @SUPTD_HealthSafetyMeasures,
        @SUPTD_Suggestions,
        @SUPTD_BPI,
        @SUPTD_AnyOtherTopic,
        @UpdatedBy ,
        @UpdatedOn ,
        @ReportsPK ,
        @BestPractice
	)
		END
	
	END
	ELSE
	BEGIN
	   
	   UPDATE SCM_MASTER
		SET OfficeComments= @OfficeComments,
			UpdatedBy = @UpdatedBy,
			UpdatedOn = @UpdatedOn			
			
		WHERE VESSELCODE =  @VESSELCODE AND ReportsPK=@ReportsPK	     

	END
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[SCM_IMPORT_SCM_NCRDETAILS]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_IMPORT_SCM_NCRDETAILS]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROCEDURE [dbo].[SCM_IMPORT_SCM_NCRDETAILS]
(
    @SCMId bigint,
	@NUMBER varchar(50),
	@CDATE smalldatetime,
	@REMARKS varchar(1000),
	@ReportsPK bigint,
	@VesselCode char(3)
)
AS
BEGIN
SET NOCOUNT ON

		--IF NOT EXISTS (SELECT ReportsPK FROM [dbo].[SCM_NCRDETAILS] WHERE VesselCode=@VesselCode AND ReportsPK=@ReportsPK)
		--BEGIN
		
		SELECT @SCMId = SCMId FROM [dbo].[SCM_MASTER] WHERE VesselCode=@VesselCode AND ReportsPK=@ReportsPK
		  
		INSERT INTO [dbo].[SCM_NCRDETAILS]
		(
			SCMId,
			NUMBER,
			CDATE,
			REMARKS,
			ReportsPK,
			VesselCode
		)
		Values
		(
			@SCMId,
			@NUMBER,
			@CDATE,
			@REMARKS,
			@ReportsPK,
			@VesselCode
		)
		
		--END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[SCM_IMPORT_SCM_RANKDETAILS]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_IMPORT_SCM_RANKDETAILS]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROCEDURE [dbo].[SCM_IMPORT_SCM_RANKDETAILS]
(
   @SCMId bigint,
	@RankName varchar(50),
	@Name varchar(50),
	@Remarks varchar(50),
	@Absent int,
	@ReportsPK bigint,
	@VesselCode char(3)
)
AS
BEGIN
SET NOCOUNT ON

		--IF NOT EXISTS (SELECT ReportsPK FROM [dbo].[SCM_RANKDETAILS] WHERE VesselCode=@VesselCode AND ReportsPK=@ReportsPK)
		--BEGIN
		
		SELECT @SCMId = SCMId FROM [dbo].[SCM_MASTER] WHERE VesselCode=@VesselCode AND ReportsPK=@ReportsPK
		  
		INSERT INTO [dbo].SCM_RANKDETAILS
		(
			SCMId,
			RankName,
			Name,
			Remarks,
			[Absent],
			ReportsPK,
			VesselCode
		)
		Values
		(
			@SCMId,
			@RankName,
			@Name,
			@Remarks,
			@Absent,
			@ReportsPK,
			@VesselCode
		)
		
	--	END
	
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[SCM_INSERT_SCM_NCRDETAILS]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_INSERT_SCM_NCRDETAILS]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[SCM_INSERT_SCM_NCRDETAILS]
(
@SCMID bigint,
@NUMBER varchar(50),
@CDATE smalldatetime,
@REMARKS varchar(1000),
@ReportsPK bigint,
@VesselCode char(3)
)
AS
BEGIN
SET NOCOUNT ON
INSERT INTO SCM_NCRDETAILS
(
SCMID ,
NUMBER ,
CDATE ,
REMARKS,
ReportsPK,
VesselCode 
)
Values
(
NULL,
@NUMBER,
@CDATE,
@REMARKS,
@ReportsPK,
@VesselCode
)
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[SCM_INSERTUPDATE_SCM_MASTER]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_INSERTUPDATE_SCM_MASTER]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[SCM_INSERTUPDATE_SCM_MASTER]
(
    
	@VESSELCODE char(3),
	@SDATE smalldatetime,
	@ShipPosFrom varchar(50),
	@ShipPosTo varchar(50),

	@COMMTIME varchar(5),
	@COMPTIME varchar(5),
	@OCASSION char(1),
	@SHIPPOSITION char(1),
	@Str_MINOFPREVSAGECOM bit,
	@Str_ABSPREVSAGECOM bit,
	--@NAME_OTHER varchar(50),
	@Str_OFFCOMMPREVSAFECOM bit,
	@SEF_AVAILABLEONBOARD varchar(5000),
	@SEF_ACCIDENTNARMISS varchar(5000),
	@SEF_REVIEWOFMOORING varchar(5000),
	@SEF_CREWNOTFAMILIERWITHALL varchar(5000),
	@Sef_BestPractice varchar(5000),

	@Hel_REVIEWHELTH varchar(5000),
	@Hel_BESTPRACTICE varchar(5000),
	@SEC_REVIEWANYIMMEDIATESECURITY varchar(5000),
	@SEC_BESTPRACTICES varchar(5000),
	@QUL_REVIEWOFREGULATORY varchar(5000),
	@QUL_REVIEWOFQUALITY varchar(5000),
	@QUL_KPI varchar(5000),
	@QUL_CREWWELFARE varchar(5000),
	@QUL_BESTPRACTICES varchar(5000),
	@ENV_ENVIRONMENTALKPIS varchar(5000),
	@ENV_BESTPRACTICES varchar(5000),
	@ANYOTHERISSUES varchar(5000),
	--@RANK_OTHER varchar(50),
	@OUTSTANDINGITEMS varchar(1000),
	@ReportsPK Bigint,
	@BestPractice varchar(5000)
)
AS
BEGIN
SET NOCOUNT ON
	
	IF (@ReportsPK <= 0)
	BEGIN
	SELECT @ReportsPK= ISNULL(MAX(ReportsPK),0)+1 FROM SCM_MASTER WHERE VESSELCODE =  @VESSELCODE
	INSERT INTO SCM_MASTER
	(
		SCMID ,
		VESSELCODE ,
		SDATE ,
		ShipPosFrom ,
		ShipPosTo ,		

		COMMTIME ,
		COMPTIME ,
		OCASSION ,
		SHIPPOSITION ,
		Str_MINOFPREVSAFECOM ,
		Str_ABSPREVSAGECOM ,
		--NAME_OTHER ,
		Str_OFFCOMMPREVSAFECOM ,
		SEF_AVAILABLEONBOARD ,
		SEF_ACCIDENTNARMISS ,
		SEF_REVIEWOFMOORING ,
		SEF_CREWNOTFAMILIERWITHALL ,
		Sef_BestPractice,
		Hel_REVIEWHELTH ,
		Hel_BESTPRACTICE ,
		SEC_REVIEWANYIMMEDIATESECURITY ,
		SEC_BESTPRACTICES ,
		QUL_REVIEWOFREGULATORY ,
		QUL_REVIEWOFQUALITY ,
		QUL_KPI ,
		QUL_CREWWELFARE ,
		QUL_BESTPRACTICES ,
		ENV_ENVIRONMENTALKPIS ,
		ENV_BESTPRACTICES ,
		ANYOTHERISSUES ,
		--RANK_OTHER ,
		OUTSTANDINGITEMS ,
		ReceviedOn,
		ReportsPK,
		BestPractice
	)
	Values
	(
		NULL,
		@VESSELCODE,
		@SDATE,
		@ShipPosFrom ,
		@ShipPosTo ,		
		@COMMTIME,
		@COMPTIME,
		@OCASSION,
		@SHIPPOSITION,
		@Str_MINOFPREVSAGECOM,
		@Str_ABSPREVSAGECOM,
		--@NAME_OTHER,
		@Str_OFFCOMMPREVSAFECOM,
		@SEF_AVAILABLEONBOARD,
		@SEF_ACCIDENTNARMISS,
		@SEF_REVIEWOFMOORING,
		@SEF_CREWNOTFAMILIERWITHALL,
		@Sef_BestPractice,
		@Hel_REVIEWHELTH,
		@Hel_BESTPRACTICE,
		@SEC_REVIEWANYIMMEDIATESECURITY,
		@SEC_BESTPRACTICES,
		@QUL_REVIEWOFREGULATORY,
		@QUL_REVIEWOFQUALITY,
		@QUL_KPI,
		@QUL_CREWWELFARE,
		@QUL_BESTPRACTICES,
		@ENV_ENVIRONMENTALKPIS,
		@ENV_BESTPRACTICES,
		@ANYOTHERISSUES,
		--@RANK_OTHER,
		@OUTSTANDINGITEMS,
		Getdate(),
		@ReportsPK,
		@BestPractice
	)
	END
	ELSE
	BEGIN
	      UPDATE SCM_MASTER
		        SET ShipPosFrom = @ShipPosFrom,
					ShipPosTo= @ShipPosTo ,
					COMMTIME= @COMMTIME ,
					COMPTIME= @COMPTIME ,
					OCASSION= @OCASSION ,
					SHIPPOSITION= @SHIPPOSITION ,
					Str_MINOFPREVSAFECOM= @Str_MINOFPREVSAGECOM ,
					Str_ABSPREVSAGECOM= @Str_ABSPREVSAGECOM ,		
					Str_OFFCOMMPREVSAFECOM= @Str_OFFCOMMPREVSAFECOM ,
					SEF_AVAILABLEONBOARD= @SEF_AVAILABLEONBOARD ,
					SEF_ACCIDENTNARMISS= @SEF_ACCIDENTNARMISS ,
					SEF_REVIEWOFMOORING= @SEF_REVIEWOFMOORING ,
					SEF_CREWNOTFAMILIERWITHALL= @SEF_CREWNOTFAMILIERWITHALL ,
					Hel_REVIEWHELTH= @Hel_REVIEWHELTH ,
					SEC_REVIEWANYIMMEDIATESECURITY= @SEC_REVIEWANYIMMEDIATESECURITY ,
					QUL_REVIEWOFREGULATORY= @QUL_REVIEWOFREGULATORY ,
					QUL_REVIEWOFQUALITY= @QUL_REVIEWOFQUALITY ,
					QUL_KPI= @QUL_KPI ,
					QUL_CREWWELFARE= @QUL_CREWWELFARE ,
					ENV_ENVIRONMENTALKPIS= @ENV_ENVIRONMENTALKPIS ,
					ANYOTHERISSUES= @ANYOTHERISSUES ,		
					OUTSTANDINGITEMS= @OUTSTANDINGITEMS,
					BestPractice=@BestPractice
				WHERE VESSELCODE =  @VESSELCODE AND ReportsPK=@ReportsPK
	END

	SELECT @ReportsPK
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[SCM_INSERTUPDATE_SCM_MASTER_SUPTD]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_INSERTUPDATE_SCM_MASTER_SUPTD]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[SCM_INSERTUPDATE_SCM_MASTER_SUPTD]
(
	@VESSELCODE char(3),
	@SDATE smalldatetime,
	@ShipPosFrom varchar(50),
	@ShipPosTo varchar(50),

	@COMMTIME varchar(5),
	@COMPTIME varchar(5),
	@OCASSION char(1),
	@SHIPPOSITION char(1),
	@Str_MINOFPREVSAGECOM bit,
	@Str_ABSPREVSAGECOM bit,
	@Str_OFFCOMMPREVSAFECOM bit,	

	@SUPTD_CompliancewithRegulations VARCHAR(5000),
	@SUPTD_DeviationsfromSafety VARCHAR(5000),
	@SUPTD_DetailsofTraining VARCHAR(5000),
	@SUPTD_HealthSafetyMeasures VARCHAR(5000),
	@SUPTD_Suggestions VARCHAR(5000),
	@SUPTD_BPI VARCHAR(5000),
	@SUPTD_AnyOtherTopic VARCHAR(5000),
	@ReportsPK Bigint
)
AS
BEGIN
SET NOCOUNT ON
IF (@ReportsPK <= 0)
	BEGIN
	SELECT @ReportsPK= ISNULL(MAX(ReportsPK),0)+1 FROM SCM_MASTER WHERE VESSELCODE =  @VESSELCODE	
	
	INSERT INTO SCM_MASTER
	(
		SCMID ,
		VESSELCODE ,
		SDATE ,
		ShipPosFrom ,
		ShipPosTo ,		

		COMMTIME ,
		COMPTIME ,
		OCASSION ,
		SHIPPOSITION ,
		Str_MINOFPREVSAFECOM ,
		Str_ABSPREVSAGECOM ,
		Str_OFFCOMMPREVSAFECOM ,
		
		SUPTD_CompliancewithRegulations,
		SUPTD_DeviationsfromSafety,
		SUPTD_DetailsofTraining,
		SUPTD_HealthSafetyMeasures,
		SUPTD_Suggestions,
		SUPTD_BPI,
		SUPTD_AnyOtherTopic,		
		ReceviedOn,
		ReportsPK
	)
	Values
	(
		NUll,
		@VESSELCODE,
		@SDATE,
		@ShipPosFrom ,
		@ShipPosTo ,		
		@COMMTIME,
		@COMPTIME,
		@OCASSION,
		@SHIPPOSITION,
		@Str_MINOFPREVSAGECOM,
		@Str_ABSPREVSAGECOM,
		@Str_OFFCOMMPREVSAFECOM,
				
		@SUPTD_CompliancewithRegulations,
		@SUPTD_DeviationsfromSafety,
		@SUPTD_DetailsofTraining,
		@SUPTD_HealthSafetyMeasures,
		@SUPTD_Suggestions,
		@SUPTD_BPI,
		@SUPTD_AnyOtherTopic,
		Getdate(),
		@ReportsPK

	)
END
ELSE
BEGIN
	UPDATE SCM_MASTER
	SET SDATE=@SDATE,
		ShipPosFrom=@ShipPosFrom ,
		ShipPosTo=@ShipPosTo ,		
		COMMTIME=@COMMTIME,
		COMPTIME=@COMPTIME,
		OCASSION=@OCASSION,
		SHIPPOSITION=@SHIPPOSITION,
		Str_MINOFPREVSAFECOM=@Str_MINOFPREVSAGECOM,
		Str_ABSPREVSAGECOM=@Str_ABSPREVSAGECOM,
		Str_OFFCOMMPREVSAFECOM=@Str_OFFCOMMPREVSAFECOM,
				
		SUPTD_CompliancewithRegulations=@SUPTD_CompliancewithRegulations,
		SUPTD_DeviationsfromSafety=@SUPTD_DeviationsfromSafety,
		SUPTD_DetailsofTraining=@SUPTD_DetailsofTraining,
		SUPTD_HealthSafetyMeasures=@SUPTD_HealthSafetyMeasures,
		SUPTD_Suggestions=@SUPTD_Suggestions,
		SUPTD_BPI=@SUPTD_BPI,
		SUPTD_AnyOtherTopic=@SUPTD_AnyOtherTopic
	WHERE ReportsPK=@ReportsPK AND VESSELCODE =  @VESSELCODE 
END

SELECT @ReportsPK

END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[SCM_INSERTUPDATE_SCM_RANKDETAILS]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_INSERTUPDATE_SCM_RANKDETAILS]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SCM_INSERTUPDATE_SCM_RANKDETAILS]
(
	@SCMID bigint,
	@RANKNAME varchar(50),
	@NAME varchar(50),
	@REMARKS varchar(50),
	@ABSENT int,
	@ReportsPK bigint,
    @VesselCode char(3)
)
AS
BEGIN
SET NOCOUNT ON



INSERT INTO SCM_RANKDETAILS
(
	SCMID ,
	RANKNAME ,
	NAME ,
	REMARKS ,
	ABSENT,
	ReportsPK,
    VesselCode
)
Values
(
	NULL,
	@RANKNAME,
	@NAME,
	@REMARKS,
	@ABSENT,
	@ReportsPK,
    @VesselCode
)
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[Ship_IU_SMS_APP_COM_ManualDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ship_IU_SMS_APP_COM_ManualDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[Ship_IU_SMS_APP_COM_ManualDetails]
(
	@VESSELID smallint,
	@MANUALID bigint,
	@SECTIONID varchar(100),
	@SNO bigint,
	@SCHEDULED bit,
	@SENTDATE smalldatetime,
	@SENDBY varchar(50),
	@ACKSTATUS char(1),
	@ACKBY varchar(50),
	@ACKON smalldatetime
)
AS
BEGIN
	SET NOCOUNT ON
	IF NOT EXISTS(SELECT VESSELID FROM SMS_APP_COM_ManualDetails WHERE VESSELID=@VESSELID AND MANUALID=@MANUALID AND SECTIONID=@SECTIONID )
	BEGIN
	INSERT INTO SMS_APP_COM_ManualDetails
	(
		VESSELID ,
		MANUALID ,
		SECTIONID ,
		SNO ,
		SCHEDULED ,
		SENTDATE ,
		SENDBY ,
		ACKSTATUS ,
		ACKBY ,
		ACKON 
	)
	Values
	(
		@VESSELID,
		@MANUALID,
		@SECTIONID,
		@SNO,
		@SCHEDULED,
		@SENTDATE,
		@SENDBY,
		@ACKSTATUS,
		@ACKBY,
		@ACKON
	)
	END
ELSE
BEGIN
	UPDATE SMS_APP_COM_ManualDetails SET 
		SCHEDULED=@SCHEDULED,
		SENTDATE=@SENTDATE,
		SENDBY=@SENDBY,
		ACKSTATUS=@ACKSTATUS,
		ACKBY=@ACKBY,
		ACKON=@ACKON
	WHERE VESSELID=@VESSELID AND MANUALID=@VESSELID AND SECTIONID=@SECTIONID

END

END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[SHIP_IU_SMS_APP_ManualDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_IU_SMS_APP_ManualDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROCEDURE [dbo].[SHIP_IU_SMS_APP_ManualDetails]
(
	@MANUALID bigint,
	@SECTIONID varchar(100),
	@PARENTSECTIONID varchar(100),
	@HEADING varchar(500),
	@SEARCHTAGS varchar(500),
	@FILENAME varchar(100),
	@FILECONTENT image,
	@APPROVED char(1),
	@APPROVEDON smalldatetime,
	@STATUS char(1),
	@SVERSION varchar(50),
	@MODIFIEDBY varchar(50),
	@MODIFIEDON smalldatetime,
	@REQREMARKS varchar(1000),
	@APPREMARKS varchar(1000),
	@REJREMARKS varchar(1000)
)
AS
BEGIN

	--SELECT Ship_RecdOn,Ship_Comments,Ship_AckSent,* FROM SMS_APP_ManualDetails
	SET NOCOUNT ON
	
	DELETE FROM SMS_APP_ManualDetailsForms WHERE MANUALID=@MANUALID AND SECTIONID=@SECTIONID

	IF NOT EXISTS(SELECT MANUALID FROM SMS_APP_ManualDetails WHERE MANUALID=@MANUALID AND SECTIONID=@SECTIONID )
	BEGIN
	INSERT INTO SMS_APP_ManualDetails
	(
		MANUALID ,
		SECTIONID ,
		PARENTSECTIONID ,
		HEADING ,
		SEARCHTAGS ,
		FILENAME ,
		FILECONTENT ,
		APPROVED ,
		APPROVEDON ,
		STATUS ,
		SVERSION ,
		MODIFIEDBY ,
		MODIFIEDON ,
		REQREMARKS ,
		APPREMARKS ,
		REJREMARKS ,
		Ship_RecdOn,		
		Ship_AckScheduled,
		Ship_AckScheduledBy,
		Ship_AckSent,
		Ship_AckSentOn
	)
	Values
	(
		@MANUALID,
		@SECTIONID,
		@PARENTSECTIONID,
		@HEADING,
		@SEARCHTAGS,
		@FILENAME,
		@FILECONTENT,
		@APPROVED,
		@APPROVEDON,
		@STATUS,
		@SVERSION,
		@MODIFIEDBY,
		@MODIFIEDON,
		@REQREMARKS,
		@APPREMARKS,
		@REJREMARKS,
		Getdate(),
		1,
		''AUTO'',
		0,
		null
		--0,
		--'''',
		--0,
		--null
	)
	END
	ELSE
	BEGIN
		UPDATE SMS_APP_ManualDetails SET 
		PARENTSECTIONID=@PARENTSECTIONID,
		HEADING=@HEADING,
		SEARCHTAGS=@SEARCHTAGS,
		FILENAME=@FILENAME,
		FILECONTENT=@FILECONTENT,
		APPROVED=@APPROVED,
		APPROVEDON=@APPROVEDON,
		STATUS=@STATUS,
		SVERSION=@SVERSION,
		MODIFIEDBY=@MODIFIEDBY,
		MODIFIEDON=@MODIFIEDON,
		REQREMARKS=@REQREMARKS,
		APPREMARKS=@APPREMARKS,
		REJREMARKS=@REJREMARKS,
		Ship_RecdOn=Getdate(),
		
		Ship_AckScheduled=1,
		Ship_AckScheduledBy=''AUTO'',
		Ship_AckSent=0,
		Ship_AckSentOn=null

		--Ship_AckScheduled=0,
		--Ship_AckScheduledBy='''',
		--Ship_AckSent=0,
		--Ship_AckSentOn=null
		WHERE MANUALID=@MANUALID AND SECTIONID=@SECTIONID
	END
END







' 
END
GO
/****** Object:  StoredProcedure [dbo].[Ship_IU_SMS_APP_ManualMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ship_IU_SMS_APP_ManualMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[Ship_IU_SMS_APP_ManualMaster]
(
	@MANUALID bigint,
	@MANUALNAME varchar(100),
	@VERSIONNO varchar(50),
	@CREATEDON smalldatetime,
	@MAPPROVED char(1),
	@MAPPROVEDON smalldatetime
)
AS
BEGIN
	SET NOCOUNT ON
	
	IF NOT EXISTS(SELECT MANUALID FROM SMS_APP_ManualMaster WHERE MANUALID=@MANUALID)
	BEGIN
		INSERT INTO SMS_APP_ManualMaster 	
		(	MANUALID ,MANUALNAME ,VERSIONNO ,CREATEDON ,MAPPROVED ,MAPPROVEDON 	)
		Values
		(	@MANUALID,@MANUALNAME,@VERSIONNO,@CREATEDON,@MAPPROVED,@MAPPROVEDON	)
	END
	ELSE
	BEGIN
		UPDATE SMS_APP_ManualMaster SET
		MANUALNAME=@MANUALNAME ,
		VERSIONNO =@VERSIONNO ,
		CREATEDON =@CREATEDON ,
		MAPPROVED =@MAPPROVED ,
		MAPPROVEDON=@MAPPROVEDON
		WHERE MANUALID =@MANUALID
	END
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[SHIP_IU_SMS_Forms]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_IU_SMS_Forms]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
-------------------------------------------------

CREATE PROCEDURE [dbo].[SHIP_IU_SMS_Forms]
(
	@FORMID bigint,
	@FORMNAME varchar(100),
	@FORMNO varchar(50),
	@VERSIONNO varchar(50),
	@FILENAME varchar(100),
	@FILECONTENT image,
	@CREATEDON smalldatetime,
	@UPDATED bit,
	@UPDATEDON smalldatetime
)
AS
BEGIN
	SET NOCOUNT ON
	IF NOT EXISTS(SELECT FORMID FROM SMS_Forms WHERE ltrim(rtrim(FORMID))=ltrim(rtrim(@FORMID)))
	BEGIN
		INSERT INTO SMS_Forms
		(
		FORMID ,
		FORMNAME ,
		FORMNO ,
		VERSIONNO ,
		FILENAME ,
		FILECONTENT ,
		CREATEDON ,
		UPDATED ,
		UPDATEDON 
		)
		Values
		(
		@FORMID,
		@FORMNAME,
		@FORMNO,
		@VERSIONNO,
		@FILENAME,
		@FILECONTENT,
		@CREATEDON,
		@UPDATED,
		@UPDATEDON
		)
	END
	ELSE
	BEGIN
		UPDATE SMS_Forms SET 
			FORMNAME=@FORMNAME,
			VERSIONNO=@VERSIONNO,
			FILENAME=@FILENAME,
			FILECONTENT=@FILECONTENT,
			CREATEDON=@CREATEDON,
			UPDATED=@UPDATED,
			UPDATEDON=@UPDATEDON
		WHERE ltrim(rtrim(FORMID))=ltrim(rtrim(@FORMID))
	END
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[Ship_SMS_Get_CommunicationData]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ship_SMS_Get_CommunicationData]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE Proc [dbo].[Ship_SMS_Get_CommunicationData]
AS
BEGIN

Select (select top 1 ShipCode from Settings) AS VesselCode,MANUALID,SECTIONID,Ship_AckScheduledBy from dbo.SMS_APP_ManualDetails where SHIP_ACKSCHEDULED=1 OR Ship_RecdOn>=DATEADD(MONTH,-12,GETDATE())
SELECT DISTINCT FormNo,(select Top 1 FormID from SMS_Forms FI Where FI.FormNo=F.FormNo order by FormID Desc) FORMID FROM SMS_Forms F

Select (select top 1 ShipCode from Settings) AS VesselCode, ISNULL(Max(TableID),0)+1 as PacketID, 1 as Version from VSL_SMS_PacketSent
SELECT VesselCode,CommentId,ManualId,SectionId,MVersion,SVersion,CommentText,CommentBy,CommentOn,ReceivedInOffice FROM [SMS_ShipComments] WHERE [ReceivedInOffice] = ''N'' ORDER BY [CommentId] ASC
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[SHIP_SMS_SENTACKNOWLEDGEMENT]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_SMS_SENTACKNOWLEDGEMENT]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[SHIP_SMS_SENTACKNOWLEDGEMENT]
(
	@VESSELCODE CHAR(3),
	@PACKETID INT,
	@ACKFILE VARCHAR(50)
)
AS
BEGIN

INSERT INTO VSL_SMS_PacketSent(VESSELCODE,TABLEID,PACKETNAME,CREATEDON )
VALUES(@VESSELCODE,@PACKETID,@ACKFILE,GETDATE()) 

UPDATE dbo.SMS_APP_ManualDetails 
SET 
SHIP_ACKSCHEDULED=0 ,
Ship_AckSent=1 ,
Ship_AckSentOn=GETDATE() 
where SHIP_ACKSCHEDULED=1


END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[SHIP_UP_SMS_APP_ManualDetailsForms]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_UP_SMS_APP_ManualDetailsForms]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[SHIP_UP_SMS_APP_ManualDetailsForms]
(
	@MANUALID bigint,
	@SECTIONID varchar(100),
	@FORMID bigint
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT MANUALID FROM SMS_APP_ManualDetailsForms WHERE MANUALID=@MANUALID AND SECTIONID=@SECTIONID AND FORMID=@FORMID)
BEGIN
	INSERT INTO SMS_APP_ManualDetailsForms
	(
		MANUALID ,
		SECTIONID ,
		FORMID 
	)
	Values
	(
		@MANUALID,
		@SECTIONID,
		@FORMID
	)
END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[SHIP_VPR_InsertUpdate_PortAnchorageReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_VPR_InsertUpdate_PortAnchorageReport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[SHIP_VPR_InsertUpdate_PortAnchorageReport]
(
@AnchorageID BIGINT,
@VESSELID varchar(3),
@REPORTDATE smalldatetime,
@VOYAGENO varchar(100),
@ARRIVALPORT varchar(50),
@POB varchar(100),
@LETGOANCHORAGE smalldatetime,
@LETGOANCHORAGEHH int,
@LETGOANCHORAGEMM int,
@PILOTAWAYHH int,
@PILOTAWAYMM int,
@ANCHORAGEREASON varchar(255),
@ETBDT smalldatetime,
@ETBHOURS int,
@ETBMIN int,
@COURCET decimal(18,2),
@WINDDIRECTIONT decimal(18,2),
@WINDFORCE int,
@SEADIRECTION decimal(18,2),
@SEASTATE int,
@CURRENTDIRECTION decimal(18,2),
@CURRENTSTRENGTH decimal(18,2),
@WEATHERREMARKS varchar(max),
@LATTITUDE1 int,
@LATTITUDE2 int,
@LATTITUDE3 int,
@LONGITUDE1 int,
@LONGITUD2 int,
@LONGITUD3 int,
@LOCATIONDESCRIPTION varchar(max),
@MEIFO45 decimal(18,2),
@MEIFO1 decimal(18,2),
@MEMGO5 decimal(18,2),
@MEMGO1 decimal(18,2),
@MEMDO decimal(18,2),
@AEIFO45 decimal(18,2),
@AEIFO1 decimal(18,2),
@AEMGO5 decimal(18,2),
@AEMGO1 decimal(18,2),
@AEMDO decimal(18,2),
@CARGOHEATINGIFO45 decimal(18,2),
@CARGOHEATINGIFO1 decimal(18,2),
@CARGOHEATINGMGO5 decimal(18,2),
@CARGOHEATINGMGO1 decimal(18,2),
@CARGOHEATINGMDO decimal(18,2),
@MECCLUBE decimal(18,2),
@MECYLLUBE decimal(18,2),
@AECCLUBE decimal(18,2),
@HYDLUBE decimal(18,2),
@MDOLUBE decimal(18,2),
@GENERATEDFRESHWATER decimal(18,2),
@CONSUMEDFRESHWATER decimal(18,2),
@TCW varchar(50),
@BW varchar(50) ,

@ROBIFO45 decimal(18, 2) ,
@ROBIFO1 decimal(18, 2) ,
@ROBMGO5 decimal(18, 2) ,
@ROBMGO1 decimal(18, 2) ,
@ROBMDO decimal(18, 2) ,
@ROBMECC decimal(18, 2) ,
@ROBMECYL decimal(18, 2) ,
@ROBAECC decimal(18, 2) ,
@ROBHYD decimal(18, 2) ,
@ROBMDOLube decimal(18, 2) ,
@ROBFesshWater decimal(18, 2) 
)
AS
BEGIN
SET NOCOUNT ON
IF(@AnchorageID<=0)
BEGIN
		DECLARE @ReportsPK BIGINT
		SELECT @ReportsPK=ISNULL(MAX(ReportsPK),0)+1 FROM VW_VSL_VPR_ALLREPORTS WHERE VESSELID=@VESSELID
		SELECT @AnchorageID= ISNULL(MAX(AnchorageID), 0) + 1 FROM [dbo].[VSL_VPRPortAnchorageReport] WHERE VESSELID=@VESSELID

		INSERT INTO VSL_VPRPortAnchorageReport
		(
		ReportsPK,
		AnchorageID,
		VESSELID ,
		REPORTDATE ,
		VOYAGENO ,
		ARRIVALPORT ,
		POB ,
		LETGOANCHORAGE ,
		LETGOANCHORAGEHH ,
		LETGOANCHORAGEMM ,
		PILOTAWAYHH ,
		PILOTAWAYMM ,
		ANCHORAGEREASON ,
		ETBDT ,
		ETBHOURS ,
		ETBMIN ,
		COURCET ,
		WINDDIRECTIONT ,
		WINDFORCE ,
		SEADIRECTION ,
		SEASTATE ,
		CURRENTDIRECTION ,
		CURRENTSTRENGTH ,
		WEATHERREMARKS ,
		LATTITUDE1 ,
		LATTITUDE2 ,
		LATTITUDE3 ,
		LONGITUDE1 ,
		LONGITUD2 ,
		LONGITUD3 ,
		LOCATIONDESCRIPTION ,
		MEIFO45 ,
		MEIFO1 ,
		MEMGO5 ,
		MEMGO1 ,
		MEMDO ,
		AEIFO45 ,
		AEIFO1 ,
		AEMGO5 ,
		AEMGO1 ,
		AEMDO ,
		CARGOHEATINGIFO45 ,
		CARGOHEATINGIFO1 ,
		CARGOHEATINGMGO5 ,
		CARGOHEATINGMGO1 ,
		CARGOHEATINGMDO ,
		MECCLUBE ,
		MECYLLUBE ,
		AECCLUBE ,
		HYDLUBE ,
		MDOLUBE ,
		GENERATEDFRESHWATER ,
		CONSUMEDFRESHWATER ,
		TCW ,
		BW ,
		ROBIFO45,
		ROBIFO1,
		ROBMGO5,
		ROBMGO1,
		ROBMDO,
		ROBMECC,
		ROBMECYL,
		ROBAECC,
		ROBHYD,
		ROBMDOLube,
		ROBFesshWater
		)
		Values
		(
		@ReportsPK,
		@AnchorageID,
		@VESSELID,
		@REPORTDATE,
		@VOYAGENO,
		@ARRIVALPORT,
		@POB,
		@LETGOANCHORAGE,
		@LETGOANCHORAGEHH,
		@LETGOANCHORAGEMM,
		@PILOTAWAYHH,
		@PILOTAWAYMM,
		@ANCHORAGEREASON,
		@ETBDT,
		@ETBHOURS,
		@ETBMIN,
		@COURCET,
		@WINDDIRECTIONT,
		@WINDFORCE,
		@SEADIRECTION,
		@SEASTATE,
		@CURRENTDIRECTION,
		@CURRENTSTRENGTH,
		@WEATHERREMARKS,
		@LATTITUDE1,
		@LATTITUDE2,
		@LATTITUDE3,
		@LONGITUDE1,
		@LONGITUD2,
		@LONGITUD3,
		@LOCATIONDESCRIPTION,
		@MEIFO45,
		@MEIFO1,
		@MEMGO5,
		@MEMGO1,
		@MEMDO,
		@AEIFO45,
		@AEIFO1,
		@AEMGO5,
		@AEMGO1,
		@AEMDO,
		@CARGOHEATINGIFO45,
		@CARGOHEATINGIFO1,
		@CARGOHEATINGMGO5,
		@CARGOHEATINGMGO1,
		@CARGOHEATINGMDO,
		@MECCLUBE,
		@MECYLLUBE,
		@AECCLUBE,
		@HYDLUBE,
		@MDOLUBE,
		@GENERATEDFRESHWATER,
		@CONSUMEDFRESHWATER,
		@TCW,
		@BW ,
		@ROBIFO45,
		@ROBIFO1,
		@ROBMGO5,
		@ROBMGO1,
		@ROBMDO,
		@ROBMECC,
		@ROBMECYL,
		@ROBAECC,
		@ROBHYD,
		@ROBMDOLube,
		@ROBFesshWater
		)
END
ELSE
BEGIN
		UPDATE VSL_VPRPortAnchorageReport
		SET 
		REPORTDATE=@REPORTDATE,
		VOYAGENO=@VOYAGENO,
		ARRIVALPORT=@ARRIVALPORT,
		POB=@POB,
		LETGOANCHORAGE=@LETGOANCHORAGE,
		LETGOANCHORAGEHH=@LETGOANCHORAGEHH,
		LETGOANCHORAGEMM=@LETGOANCHORAGEMM,
		PILOTAWAYHH=@PILOTAWAYHH,
		PILOTAWAYMM=@PILOTAWAYMM,
		ANCHORAGEREASON=@ANCHORAGEREASON,
		ETBDT=@ETBDT,
		ETBHOURS=@ETBHOURS,
		ETBMIN=@ETBMIN,
		COURCET=@COURCET,
		WINDDIRECTIONT=@WINDDIRECTIONT,
		WINDFORCE=@WINDFORCE,
		SEADIRECTION=@SEADIRECTION,
		SEASTATE=@SEASTATE,
		CURRENTDIRECTION=@CURRENTDIRECTION,
		CURRENTSTRENGTH=@CURRENTSTRENGTH,
		WEATHERREMARKS=@WEATHERREMARKS,
		LATTITUDE1=@LATTITUDE1,
		LATTITUDE2=@LATTITUDE2,
		LATTITUDE3=@LATTITUDE3,
		LONGITUDE1=@LONGITUDE1,
		LONGITUD2=@LONGITUD2,
		LONGITUD3=@LONGITUD3,
		LOCATIONDESCRIPTION=@LOCATIONDESCRIPTION,
		MEIFO45=@MEIFO45,
		MEIFO1=@MEIFO1,
		MEMGO5=@MEMGO5,
		MEMGO1=@MEMGO1,
		MEMDO=@MEMDO,
		AEIFO45=@AEIFO45,
		AEIFO1=@AEIFO1,
		AEMGO5=@AEMGO5,
		AEMGO1=@AEMGO1,
		AEMDO=@AEMDO,
		CARGOHEATINGIFO45=@CARGOHEATINGIFO45,
		CARGOHEATINGIFO1=@CARGOHEATINGIFO1,
		CARGOHEATINGMGO5=@CARGOHEATINGMGO5,
		CARGOHEATINGMGO1=@CARGOHEATINGMGO1,
		CARGOHEATINGMDO=@CARGOHEATINGMDO,
		MECCLUBE=@MECCLUBE,
		MECYLLUBE=@MECYLLUBE,
		AECCLUBE=@AECCLUBE,
		HYDLUBE=@HYDLUBE,
		MDOLUBE=@MDOLUBE,
		GENERATEDFRESHWATER=@GENERATEDFRESHWATER,
		CONSUMEDFRESHWATER=@CONSUMEDFRESHWATER,
		TCW=@TCW,
		BW=@BW,
		ROBIFO45=@ROBIFO45,
		ROBIFO1=@ROBIFO1,
		ROBMGO5=@ROBMGO5,
		ROBMGO1=@ROBMGO1,
		ROBMDO=@ROBMDO,
		ROBMECC=@ROBMECC,
		ROBMECYL=@ROBMECYL,
		ROBAECC=@ROBAECC,
		ROBHYD=@ROBHYD,
		ROBMDOLube=@ROBMDOLube,
		ROBFesshWater=@ROBFesshWater

		WHERE VESSELID=@VESSELID AND AnchorageID=@AnchorageID
END

SELECT @AnchorageID AS AnchorageID

END







' 
END
GO
/****** Object:  StoredProcedure [dbo].[SHIP_VPR_InsertUpdate_PortDriftReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_VPR_InsertUpdate_PortDriftReport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE proc [dbo].[SHIP_VPR_InsertUpdate_PortDriftReport]
(
--  Voyage Information	 
	@PortDriftID bigint,
	@VesselID varchar(3) ,
	@ReportDate smalldatetime ,
	@VoyageNo varchar(100) ,
--	Since Last Report
	@ArrivalPort varchar(50) ,
	@ComDDDate smalldatetime ,
	@DriftHour int ,
	@DriftMin int ,
	@DriftReason char(1) ,
	@ETBDT smalldatetime ,
	@ETBHours int ,
	@ETBMin int ,
--	Weather
	@CourceT decimal(18, 2) ,
	@WindDirectionT decimal(18, 2) ,
	@WindForce int ,
	@SeaDirection decimal(18, 2) ,
	@SeaState int ,
	@CurrentDirection decimal(18, 2) ,
	@CurrentStrength decimal(18, 2) ,
	@WeatherRemarks varchar(max) ,
--	Ship Position
	@Lattitude1 int ,
	@Lattitude2 int ,
	@Lattitude3 int ,
	@Longitude1 int ,
	@Longitud2 int ,
	@Longitud3 int ,
	@LocationDescription varchar(max) ,
--	Consumption
	@MEIFO45 decimal(18, 2) ,
	@MEIFO1 decimal(18, 2) ,
	@MEMGO5 decimal(18, 2) ,
	@MEMGO1 decimal(18, 2) ,
	@MEMDO decimal(18, 2) ,

	@AEIFO45 decimal(18, 2) ,
	@AEIFO1 decimal(18, 2) ,
	@AEMGO5 decimal(18, 2) ,
	@AEMGO1 decimal(18, 2) ,
	@AEMDO decimal(18, 2) ,

	@CargoHeatingIFO45 decimal(18, 2) ,
	@CargoHeatingIFO1 decimal(18, 2) ,
	@CargoHeatingMGO5 decimal(18, 2) ,
	@CargoHeatingMGO1 decimal(18, 2) ,
	@CargoHeatingMDO decimal(18, 2) ,

--	Consumption(Since Last Report) Lube and Fresh Water
	@MECCLube decimal(18, 2) ,
	@MECYLLube decimal(18, 2) ,
	@AECCLube decimal(18, 2) ,
	@HYDLube decimal(18, 2) ,
	@MDOLube decimal(18, 2) ,

	@GeneratedFreshWater decimal(18, 2) ,
	@ConsumedFreshWater decimal(18, 2) ,

	@TCW varchar(50),
	@BW varchar(50),

	@ROBIFO45 decimal(18, 2) ,
	@ROBIFO1 decimal(18, 2) ,
	@ROBMGO5 decimal(18, 2) ,
	@ROBMGO1 decimal(18, 2) ,
	@ROBMDO decimal(18, 2) ,
	@ROBMECC decimal(18, 2) ,
	@ROBMECYL decimal(18, 2) ,
	@ROBAECC decimal(18, 2) ,
	@ROBHYD decimal(18, 2) ,
	@ROBMDOLube decimal(18, 2) ,
	@ROBFesshWater decimal(18, 2) 
)
AS
BEGIN

	IF(@PortDriftID <=0)
	BEGIN
		DECLARE @ReportsPK BIGINT
		SELECT @ReportsPK=ISNULL(MAX(ReportsPK),0)+1 FROM VW_VSL_VPR_ALLREPORTS WHERE VESSELID=@VESSELID

		SELECT @PortDriftID= ISNULL(MAX(PortDriftID), 0) + 1 FROM [dbo].[VSL_VPRPortDriftReport] WHERE VESSELID=@VESSELID
		INSERT INTO VSL_VPRPortDriftReport
		(
		ReportsPK,
		PortDriftID,
		VesselID ,
		ReportDate ,
		VoyageNo ,
		ArrivalPort ,
		ComDDDate ,
		DriftHour ,
		DriftMin ,
		DriftReason ,
		ETBDT ,
		ETBHours ,
		ETBMin ,
		CourceT ,
		WindDirectionT ,
		WindForce ,
		SeaDirection ,
		SeaState ,
		CurrentDirection ,
		CurrentStrength ,
		WeatherRemarks ,
	
		Lattitude1 ,
		Lattitude2 ,
		Lattitude3 ,
		Longitude1 ,
		Longitud2 ,
		Longitud3 ,
		LocationDescription ,
	
		MEIFO45 ,
		MEIFO1 ,
		MEMGO5 ,
		MEMGO1 ,
		MEMDO ,

		AEIFO45 ,
		AEIFO1 ,
		AEMGO5 ,
		AEMGO1 ,
		AEMDO ,

		CargoHeatingIFO45 ,
		CargoHeatingIFO1 ,
		CargoHeatingMGO5 ,
		CargoHeatingMGO1 ,
		CargoHeatingMDO ,

		MECCLube ,
		MECYLLube ,
		AECCLube ,
		HYDLube ,
		MDOLube ,

		GeneratedFreshWater ,
		ConsumedFreshWater ,
		TCW ,
		BW ,
		ROBIFO45,
		ROBIFO1,
		ROBMGO5,
		ROBMGO1,
		ROBMDO,
		ROBMECC,
		ROBMECYL,
		ROBAECC,
		ROBHYD,
		ROBMDOLube,
		ROBFesshWater
	)
	VALUES
	(
		@ReportsPK,
		@PortDriftID,
		@VesselID ,
		@ReportDate ,
		@VoyageNo ,
		@ArrivalPort ,
		@ComDDDate ,
		@DriftHour ,
		@DriftMin ,
		@DriftReason ,
		@ETBDT ,
		@ETBHours ,
		@ETBMin ,
		@CourceT ,
		@WindDirectionT ,
		@WindForce ,
		@SeaDirection ,
		@SeaState ,
		@CurrentDirection ,
		@CurrentStrength ,
		@WeatherRemarks ,
	
		@Lattitude1 ,
		@Lattitude2 ,
		@Lattitude3 ,
		@Longitude1 ,
		@Longitud2 ,
		@Longitud3 ,
		@LocationDescription ,
	
		@MEIFO45 ,
		@MEIFO1 ,
		@MEMGO5 ,
		@MEMGO1 ,
		@MEMDO ,

		@AEIFO45 ,
		@AEIFO1 ,
		@AEMGO5 ,
		@AEMGO1 ,
		@AEMDO ,

		@CargoHeatingIFO45 ,
		@CargoHeatingIFO1 ,
		@CargoHeatingMGO5 ,
		@CargoHeatingMGO1 ,
		@CargoHeatingMDO ,

		@MECCLube ,
		@MECYLLube ,
		@AECCLube ,
		@HYDLube ,
		@MDOLube ,

		@GeneratedFreshWater ,
		@ConsumedFreshWater ,
		@TCW ,
		@BW ,

		@ROBIFO45,
		@ROBIFO1,
		@ROBMGO5,
		@ROBMGO1,
		@ROBMDO,
		@ROBMECC,
		@ROBMECYL,
		@ROBAECC,
		@ROBHYD,
		@ROBMDOLube,
		@ROBFesshWater
	)
	END
	ELSE
	BEGIN
		UPDATE VSL_VPRPortDriftReport
		SET 
		ReportDate=@ReportDate ,
		VoyageNo=@VoyageNo ,
		ArrivalPort=@ArrivalPort ,
		ComDDDate=@ComDDDate ,
		DriftHour=@DriftHour ,
		DriftMin=@DriftMin ,
		DriftReason=@DriftReason ,
		ETBDT=@ETBDT ,
		ETBHours=@ETBHours ,
		ETBMin=@ETBMin ,
		CourceT=@CourceT ,
		WindDirectionT=@WindDirectionT ,
		WindForce=@WindForce ,
		SeaDirection=@SeaDirection ,
		SeaState=@SeaState ,
		CurrentDirection=@CurrentDirection ,
		CurrentStrength=@CurrentStrength ,
		WeatherRemarks=@WeatherRemarks ,
	
		Lattitude1=@Lattitude1 ,
		Lattitude2=@Lattitude2 ,
		Lattitude3=@Lattitude3 ,
		Longitude1=@Longitude1 ,
		Longitud2=@Longitud2 ,
		Longitud3=@Longitud3 ,
		LocationDescription=@LocationDescription ,
	
		MEIFO45=@MEIFO45 ,
		MEIFO1=@MEIFO1 ,
		MEMGO5=@MEMGO5 ,
		MEMGO1=@MEMGO1 ,
		MEMDO=@MEMDO ,

		AEIFO45=@AEIFO45 ,
		AEIFO1=@AEIFO1 ,
		AEMGO5=@AEMGO5 ,
		AEMGO1=@AEMGO1 ,
		AEMDO=@AEMDO ,

		CargoHeatingIFO45=@CargoHeatingIFO45 ,
		CargoHeatingIFO1=@CargoHeatingIFO1 ,
		CargoHeatingMGO5=@CargoHeatingMGO5 ,
		CargoHeatingMGO1=@CargoHeatingMGO1 ,
		CargoHeatingMDO=@CargoHeatingMDO ,

		MECCLube=@MECCLube ,
		MECYLLube=@MECYLLube ,
		AECCLube=@AECCLube ,
		HYDLube=@HYDLube ,
		MDOLube=@MDOLube ,

		GeneratedFreshWater=@GeneratedFreshWater ,
		ConsumedFreshWater=@ConsumedFreshWater ,
		TCW=@TCW ,
		BW=@BW ,
		ROBIFO45=@ROBIFO45,
		ROBIFO1=@ROBIFO1,
		ROBMGO5=@ROBMGO5,
		ROBMGO1=@ROBMGO1,
		ROBMDO=@ROBMDO,
		ROBMECC=@ROBMECC,
		ROBMECYL=@ROBMECYL,
		ROBAECC=@ROBAECC,
		ROBHYD=@ROBHYD,
		ROBMDOLube=@ROBMDOLube,
		ROBFesshWater=@ROBFesshWater

		WHERE PortDriftID=@PortDriftID AND VesselID =@VesselID 
	END
	
	SELECT @PortDriftID AS PortDriftID
	  
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[SHIP_VPR_InsertUpdate_VPRArrivalReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_VPR_InsertUpdate_VPRArrivalReport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[SHIP_VPR_InsertUpdate_VPRArrivalReport]
(
	@ArrivalID bigint,
	@VesselID varchar(3) ,
	@ReportDate smalldatetime ,
	@VoyageNo varchar(100) ,

	@SteamingHrs int ,
	@SteamingMin int ,
	@DistanceMadeGood decimal(18, 2),
	@AvgSpeed decimal(18, 2) ,
	@Stoppages int ,
	@StoppagesHH int ,
	@StoppagesMM int ,
	@Remarks varchar(max) ,

	@VoyCondition int ,
	@DepPort varchar(50) ,
	@DepArrivalPort varchar(250) ,
	@EOSPDate smalldatetime ,
	@EOSPHrs int ,
	@EOSPMin int ,
	@DraftFwd decimal(18, 2) ,
	@DraftAft decimal(18, 2) ,
	@ArrivalPortAgent varchar(250) ,
	@PersonalIncharge varchar(250) ,
	@AddressContactDetails varchar(max) ,
--	Weather
	@CourceT decimal(18, 2) ,
	@WindDirectionT decimal(18, 2) ,
	@WindForce int ,
	@SeaDirection decimal(18, 2) ,
	@SeaState int ,
	@CurrentDirection decimal(18, 2) ,
	@CurrentStrength decimal(18, 2) ,
	@WeatherRemarks varchar(max) ,
--	Ship Position
	@Lattitude1 int ,
	@Lattitude2 int ,
	@Lattitude3 int ,
	@Longitude1 int ,
	@Longitud2 int ,
	@Longitud3 int ,
	@LocationDescription varchar(max) ,
--	ROB & Consumption
	@ROBIFO45Fuel decimal(18, 2) ,
	@ROBIFO1Fuel decimal(18, 2) ,
	@ROBMGO5Fuel decimal(18, 2) ,
	@ROBMGO1Fuel decimal(18, 2) ,
	@ROBMDOFuel decimal(18, 2) ,

	@ROBIFO45Lube decimal(18, 2) ,
	@ROBIFO1Lube decimal(18, 2) ,
	@ROBMGO5Lube decimal(18, 2) ,
	@ROBMGO1Lube decimal(18, 2) ,
	@ROBMDOLube decimal(18, 2) ,

	@ROBFreshWater decimal(18, 2) ,

--	Consumption(Since Last Report)-Fuel
	@MEIFO45 decimal(18, 2) ,
	@MEIFO1 decimal(18, 2) ,
	@MEMGO5 decimal(18, 2) ,
	@MEMGO1 decimal(18, 2) ,
	@MEMDO decimal(18, 2) ,

	@AEIFO45 decimal(18, 2) ,
	@AEIFO1 decimal(18, 2) ,
	@AEMGO5 decimal(18, 2) ,
	@AEMGO1 decimal(18, 2) ,
	@AEMDO decimal(18, 2) ,

	@CargoHeatingIFO45 decimal(18, 2) ,
	@CargoHeatingIFO1 decimal(18, 2) ,
	@CargoHeatingMGO5 decimal(18, 2) ,
	@CargoHeatingMGO1 decimal(18, 2) ,
	@CargoHeatingMDO decimal(18, 2) ,

--	Consumption(Since Last Report) Lube and Fresh Water
	@MECCLube decimal(18, 2) ,
	@MECYLLube decimal(18, 2) ,
	@AECCLube decimal(18, 2) ,
	@HYDLube decimal(18, 2) ,
	@MDOLube decimal(18, 2) ,

	@GeneratedFreshWater decimal(18, 2) ,
	@ConsumedFreshWater decimal(18, 2) ,

	@TCW varchar(50),
	@BW varchar(50),
--	Other
	@TCU20L varchar(50),
	@TCU40L varchar(50),
	@TCU45L varchar(50),
	@TCU20E varchar(50),
	@TCU40E varchar(50),
	@TCU45E varchar(50),
	@NextActivity char(1),
	@ETBDATE smalldatetime ,
	@ETBHrs int ,
	@ETBMin int ,
	@TotalCargoWeight decimal(18, 2) ,
	@BallastWeight decimal(18, 2)
)
AS
BEGIN
SET NOCOUNT ON

IF(@ArrivalID <= 0)
BEGIN

	DECLARE @ReportsPK BIGINT
	SELECT @ReportsPK=ISNULL(MAX(ReportsPK),0)+1 FROM VW_VSL_VPR_ALLREPORTS WHERE VESSELID=@VESSELID
    SELECT @ArrivalID= ISNULL(MAX(ArrivalID), 0) + 1 FROM [dbo].[VSL_VPRArrivalReport] WHERE VesselID=@VesselID

	INSERT INTO [dbo].[VSL_VPRArrivalReport]
	(
		ReportsPK,
		ArrivalID,
		VesselID,
		ReportDate,
		VoyageNo,
		SteamingHrs,
		SteamingMin,
		DistanceMadeGood,
		AvgSpeed,
		Stoppages,
		StoppagesHH,
		StoppagesMM,
		Remarks,
		VoyCondition,
		DepPort, 
		DepArrivalPort,
		EOSPDate,
		EOSPHrs,
		EOSPMin,
		DraftFwd,
		DraftAft,
		ArrivalPortAgent,
		PersonalIncharge,
		AddressContactDetails,	
		CourceT,
		WindDirectionT,
		WindForce,
		SeaDirection,
		SeaState,
		CurrentDirection,
		CurrentStrength,
		WeatherRemarks,
		Lattitude1,
		Lattitude2,
		Lattitude3,
		Longitude1,
		Longitud2,
		Longitud3,
		LocationDescription,
		ROBIFO45Fuel,
		ROBIFO1Fuel,
		ROBMGO5Fuel,
		ROBMGO1Fuel,
		ROBMDOFuel,
		ROBIFO45Lube,
		ROBIFO1Lube,
		ROBMGO5Lube,
		ROBMGO1Lube,
		ROBMDOLube,
		ROBFreshWater,
		MEIFO45,
		MEIFO1,
		MEMGO5,
		MEMGO1,
		MEMDO,
		AEIFO45,
		AEIFO1,
		AEMGO5,
		AEMGO1,
		AEMDO,
		CargoHeatingIFO45,
		CargoHeatingIFO1,
		CargoHeatingMGO5,
		CargoHeatingMGO1,
		CargoHeatingMDO,
		MECCLube,
		MECYLLube,
		AECCLube,
		HYDLube,
		MDOLube,
		GeneratedFreshWater,
		ConsumedFreshWater,
		TCW,
		BW,
		TCU20L,
		TCU40L,
		TCU45L,
		TCU20E,
		TCU40E,
		TCU45E,
		NextActivity,
		ETBDATE,
		ETBHrs,
		ETBMin,
		TotalCargoWeight,
		BallastWeight 
	)
	Values
	(
		@ReportsPK,
	    @ArrivalID,
		@VesselID,
		@ReportDate,
		@VoyageNo,
		@SteamingHrs,
		@SteamingMin,
		@DistanceMadeGood,
		@AvgSpeed,
		@Stoppages,
		@StoppagesHH,
		@StoppagesMM,
		@Remarks,
		@VoyCondition,
		@DepPort, 
		@DepArrivalPort,
		@EOSPDate,
		@EOSPHrs,
		@EOSPMin,
		@DraftFwd,
		@DraftAft,
		@ArrivalPortAgent,
		@PersonalIncharge,
		@AddressContactDetails,	
		@CourceT,
		@WindDirectionT,
		@WindForce,
		@SeaDirection,
		@SeaState,
		@CurrentDirection,
		@CurrentStrength,
		@WeatherRemarks,
		@Lattitude1,
		@Lattitude2,
		@Lattitude3,
		@Longitude1,
		@Longitud2,
		@Longitud3,
		@LocationDescription,
		@ROBIFO45Fuel,
		@ROBIFO1Fuel,
		@ROBMGO5Fuel,
		@ROBMGO1Fuel,
		@ROBMDOFuel,
		@ROBIFO45Lube,
		@ROBIFO1Lube,
		@ROBMGO5Lube,
		@ROBMGO1Lube,
		@ROBMDOLube,
		@ROBFreshWater,
		@MEIFO45,
		@MEIFO1,
		@MEMGO5,
		@MEMGO1,
		@MEMDO,
		@AEIFO45,
		@AEIFO1,
		@AEMGO5,
		@AEMGO1,
		@AEMDO,
		@CargoHeatingIFO45,
		@CargoHeatingIFO1,
		@CargoHeatingMGO5,
		@CargoHeatingMGO1,
		@CargoHeatingMDO,
		@MECCLube,
		@MECYLLube,
		@AECCLube,
		@HYDLube,
		@MDOLube,
		@GeneratedFreshWater,
		@ConsumedFreshWater,
		@TCW,
		@BW,
		@TCU20L,
		@TCU40L,
		@TCU45L,
		@TCU20E,
		@TCU40E,
		@TCU45E,
		@NextActivity,
		@ETBDATE,
		@ETBHrs,
		@ETBMin,
		@TotalCargoWeight,
		@BallastWeight 
	)
END
ELSE
BEGIN
        UPDATE [dbo].[VSL_VPRArrivalReport]

		SET 
			ReportDate=@ReportDate ,
			VoyageNo=@VoyageNo ,
			SteamingHrs=@SteamingHrs ,
			SteamingMin=@SteamingMin ,
			DistanceMadeGood=@DistanceMadeGood ,
			AvgSpeed=@AvgSpeed ,
			Stoppages=@Stoppages ,
			StoppagesHH= @StoppagesHH,
			StoppagesMM=@StoppagesMM ,
			Remarks= @Remarks,
			VoyCondition=@VoyCondition ,
			DepPort=@DepPort , 
			DepArrivalPort=@DepArrivalPort ,
			EOSPDate=@EOSPDate ,
			EOSPHrs=@EOSPHrs ,
			EOSPMin= @EOSPMin,
			DraftFwd=@DraftFwd ,
			DraftAft=@DraftAft ,
			ArrivalPortAgent=@ArrivalPortAgent ,
			PersonalIncharge=@PersonalIncharge ,
			AddressContactDetails=@AddressContactDetails ,	
			CourceT=@CourceT ,
			WindDirectionT=@WindDirectionT ,
			WindForce=@WindForce ,
			SeaDirection=@SeaDirection ,
			SeaState=@SeaState ,
			CurrentDirection=@CurrentDirection ,
			CurrentStrength=@CurrentStrength ,
			WeatherRemarks=@WeatherRemarks ,
			Lattitude1=@Lattitude1 ,
			Lattitude2=@Lattitude2 ,
			Lattitude3=@Lattitude3 ,
			Longitude1=@Longitude1 ,
			Longitud2=@Longitud2 ,
			Longitud3=@Longitud3 ,
			LocationDescription=@LocationDescription ,
			ROBIFO45Fuel=@ROBIFO45Fuel ,
			ROBIFO1Fuel=@ROBIFO1Fuel ,
			ROBMGO5Fuel=@ROBMGO5Fuel ,
			ROBMGO1Fuel=@ROBMGO1Fuel ,
			ROBMDOFuel= @ROBMDOFuel,
			ROBIFO45Lube=@ROBIFO45Lube ,
			ROBIFO1Lube=@ROBIFO1Lube ,
			ROBMGO5Lube=@ROBMGO5Lube ,
			ROBMGO1Lube=@ROBMGO1Lube ,
			ROBMDOLube=@ROBMDOLube ,
			ROBFreshWater=@ROBFreshWater ,
			MEIFO45=@MEIFO45 ,
			MEIFO1=@MEIFO1 ,
			MEMGO5=@MEMGO5 ,
			MEMGO1=@MEMGO1 ,
			MEMDO= @MEMDO,
			AEIFO45=@AEIFO45 ,
			AEIFO1=@AEIFO1 ,
			AEMGO5=@AEMGO5 ,
			AEMGO1=@AEMGO1 ,
			AEMDO=@AEMDO ,
			CargoHeatingIFO45=@CargoHeatingIFO45 ,
			CargoHeatingIFO1=@CargoHeatingIFO1 ,
			CargoHeatingMGO5=@CargoHeatingMGO5 ,
			CargoHeatingMGO1=@CargoHeatingMGO1 ,
			CargoHeatingMDO=@CargoHeatingMDO ,
			MECCLube=@MECCLube ,
			MECYLLube=@MECYLLube ,
			AECCLube=@AECCLube ,
			HYDLube= @HYDLube,
			MDOLube= @MDOLube,
			GeneratedFreshWater=@GeneratedFreshWater ,
			ConsumedFreshWater= @ConsumedFreshWater,
			TCW=@TCW ,
			BW=@BW ,
			TCU20L=@TCU20L ,
			TCU40L=@TCU40L ,
			TCU45L=@TCU45L ,
			TCU20E=@TCU20E,
			TCU40E=@TCU40E ,
			TCU45E=@TCU45E ,
			NextActivity=@NextActivity ,
			ETBDATE=@ETBDATE ,
			ETBHrs=@ETBHrs ,
			ETBMin=@ETBMin ,
			TotalCargoWeight=@TotalCargoWeight ,
			BallastWeight=@BallastWeight 
		WHERE ArrivalID=@ArrivalID AND VesselID=@VesselID
END
    SELECT @ArrivalID AS ArrivalID
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[SHIP_VPR_InsertUpdate_VPRDepartureReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_VPR_InsertUpdate_VPRDepartureReport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[SHIP_VPR_InsertUpdate_VPRDepartureReport]
(
	@DepartureID int,
	@VESSELID varchar(3),
	@REPORTDATE smalldatetime,
	@VOYAGENO varchar(100),
	@RESTRICTEDAREA int,
	@AREANAME int,
	@ETARESTRICTEDAREA smalldatetime,
	@CHARTERERNAME varchar(250),
	@CHARTERPARTYSPEED decimal(18,2),
	@VOYORDERSPEED decimal(18,2),
	@VOYINSTRUCTIONS varchar(1000),
	@VOYCONDITION varchar(250),
	@DEPPORT varchar(50),
	@DEPARRIVALPORT varchar(250),
	@COSPDATE smalldatetime,
	@COSPHRS int,
	@COSPMIN int,
	@ARRIVALPORTETA smalldatetime,
	@ARRIVALPORTETAHRS int,
	@ARRIVALPORTETAMIN int,
	@DRAFTFWD decimal(18,2),
	@DRAFTAFT decimal(18,2),
	@DISTANCETOGO decimal(18,2),
	@ARRIVALPORTAGENT varchar(250),
	@PERSONALINCHARGE varchar(250),
	@ADDRESSCONTACTDETAILS varchar(max),
	@PORT1 varchar(50),
	@PORTETA1 smalldatetime,
	@PORT2 varchar(50),
	@PORTETA2 smalldatetime,
	@PORT3 varchar(50),
	@PORTETA3 smalldatetime,
	@COURCET decimal(18,2),
	@WINDDIRECTIONT decimal(18,2),
	@WINDFORCE int,
	@SEADIRECTION decimal(18,2),
	@SEASTATE int,
	@CURRENTDIRECTION decimal(18,2),
	@CURRENTSTRENGTH decimal(18,2),
	@WEATHERREMARKS varchar(max),
	@LATTITUDE1 int,
	@LATTITUDE2 int,
	@LATTITUDE3 int,
	@LONGITUDE1 int,
	@LONGITUD2 int,
	@LONGITUD3 int,
	@LOCATIONDESCRIPTION varchar(max),
	@ROBIFO45 decimal(18,2),
	@ROBIFO1 decimal(18,2),
	@ROBMGO5 decimal(18,2),
	@ROBMGO1 decimal(18,2),
	@ROBMDO  decimal(18,2),
	@ROBMECC decimal(18,2),
	@ROBMECYL decimal(18,2),
	@ROBAECC decimal(18,2),
	@ROBHYD decimal(18,2),
	@ROBMDOLUBE decimal(18,2),
	@ROBFESSHWATER decimal(18,2),
	@ROBIFO45RECV decimal(18,2),
	@ROBIFO1RECV decimal(18,2),
	@ROBMGO5RECV decimal(18,2),
	@ROBMGO1RECV decimal(18,2),
	@ROBMDORECV decimal(18,2),
	@ROBMECCRECV decimal(18,2),
	@ROBMECYLRECV decimal(18,2),
	@ROBAECCRECV decimal(18,2),
	@ROBHYDRECV decimal(18,2),
	@ROBMDOLUBERECV decimal(18,2),
	@ROBFESSHWATERRECV decimal(18,2),
	@TCW varchar(50),
	@BW varchar(50),
	@TCU20L varchar(50),
	@TCU40L varchar(50),
	@TCU45L varchar(50),
	@TCU20E varchar(50),
	@TCU40E varchar(50),
	@TCU45E varchar(50)
)
AS
BEGIN
SET NOCOUNT ON

IF(@DepartureID <= 0)
BEGIN

	DECLARE @ReportsPK BIGINT
	SELECT @ReportsPK=ISNULL(MAX(ReportsPK),0)+1 FROM VW_VSL_VPR_ALLREPORTS WHERE VESSELID=@VESSELID
    SELECT @DepartureID= ISNULL(MAX(DepartureID), 0) + 1 FROM [dbo].[VSL_VPRDepartureReport] WHERE VESSELID=@VESSELID


	INSERT INTO [dbo].[VSL_VPRDepartureReport]
	(
		ReportsPK,
		DepartureID,
		VESSELID ,
		REPORTDATE ,
		VOYAGENO ,
		RESTRICTEDAREA ,
		AREANAME ,
		ETARESTRICTEDAREA ,
		CHARTERERNAME ,
		CHARTERPARTYSPEED ,
		VOYORDERSPEED ,
		VOYINSTRUCTIONS ,
		VOYCONDITION ,
		DEPPORT ,
		DEPARRIVALPORT ,
		COSPDATE ,
		COSPHRS ,
		COSPMIN ,
		ARRIVALPORTETA ,
		ARRIVALPORTETAHRS ,
		ARRIVALPORTETAMIN ,
		DRAFTFWD ,
		DRAFTAFT ,
		DISTANCETOGO ,
		ARRIVALPORTAGENT ,
		PERSONALINCHARGE ,
		ADDRESSCONTACTDETAILS ,
		PORT1 ,
		PORTETA1 ,
		PORT2 ,
		PORTETA2 ,
		PORT3 ,
		PORTETA3 ,
		COURCET ,
		WINDDIRECTIONT ,
		WINDFORCE ,
		SEADIRECTION ,
		SEASTATE ,
		CURRENTDIRECTION ,
		CURRENTSTRENGTH ,
		WEATHERREMARKS ,
		LATTITUDE1 ,
		LATTITUDE2 ,
		LATTITUDE3 ,
		LONGITUDE1 ,
		LONGITUD2 ,
		LONGITUD3 ,
		LOCATIONDESCRIPTION ,
		ROBIFO45 ,
		ROBIFO1 ,
		ROBMGO5 ,
		ROBMGO1 ,
		ROBMDO  ,
		ROBMECC ,
		ROBMECYL ,
		ROBAECC ,
		ROBHYD ,
		ROBMDOLUBE ,
		ROBFESSHWATER ,
		ROBIFO45RECV ,
		ROBIFO1RECV ,
		ROBMGO5RECV ,
		ROBMGO1RECV ,
		ROBMDORECV ,
		ROBMECCRECV ,
		ROBMECYLRECV ,
		ROBAECCRECV ,
		ROBHYDRECV ,
		ROBMDOLUBERECV ,
		ROBFESSHWATERRECV ,
		TCW ,
		BW ,
		TCU20L ,
		TCU40L ,
		TCU45L ,
		TCU20E ,
		TCU40E ,
		TCU45E 
	)
	Values
	(
		@ReportsPK,
	    @DepartureID,
		@VESSELID,
		@REPORTDATE,
		@VOYAGENO,
		@RESTRICTEDAREA,
		@AREANAME,
		@ETARESTRICTEDAREA,
		@CHARTERERNAME,
		@CHARTERPARTYSPEED,
		@VOYORDERSPEED,
		@VOYINSTRUCTIONS,
		@VOYCONDITION,
		@DEPPORT,
		@DEPARRIVALPORT,
		@COSPDATE,
		@COSPHRS,
		@COSPMIN,
		@ARRIVALPORTETA,
		@ARRIVALPORTETAHRS,
		@ARRIVALPORTETAMIN,
		@DRAFTFWD,
		@DRAFTAFT,
		@DISTANCETOGO,
		@ARRIVALPORTAGENT,
		@PERSONALINCHARGE,
		@ADDRESSCONTACTDETAILS,
		@PORT1,
		@PORTETA1,
		@PORT2,
		@PORTETA2,
		@PORT3,
		@PORTETA3,
		@COURCET,
		@WINDDIRECTIONT,
		@WINDFORCE,
		@SEADIRECTION,
		@SEASTATE,
		@CURRENTDIRECTION,
		@CURRENTSTRENGTH,
		@WEATHERREMARKS,
		@LATTITUDE1,
		@LATTITUDE2,
		@LATTITUDE3,
		@LONGITUDE1,
		@LONGITUD2,
		@LONGITUD3,
		@LOCATIONDESCRIPTION,
		@ROBIFO45,
		@ROBIFO1,
		@ROBMGO5,
		@ROBMGO1,
		@ROBMDO ,
		@ROBMECC,
		@ROBMECYL,
		@ROBAECC,
		@ROBHYD,
		@ROBMDOLUBE,
		@ROBFESSHWATER,
		@ROBIFO45RECV,
		@ROBIFO1RECV,
		@ROBMGO5RECV,
		@ROBMGO1RECV,
		@ROBMDORECV,
		@ROBMECCRECV,
		@ROBMECYLRECV,
		@ROBAECCRECV,
		@ROBHYDRECV,
		@ROBMDOLUBERECV,
		@ROBFESSHWATERRECV,
		@TCW,
		@BW,
		@TCU20L,
		@TCU40L,
		@TCU45L,
		@TCU20E,
		@TCU40E,
		@TCU45E
		)
END
ELSE
BEGIN
        UPDATE [dbo].[VSL_VPRDepartureReport]

		SET REPORTDATE=@REPORTDATE,
			VOYAGENO=@VOYAGENO, 
			RESTRICTEDAREA=@RESTRICTEDAREA,
			AREANAME=@AREANAME,
			ETARESTRICTEDAREA=@ETARESTRICTEDAREA,
			CHARTERERNAME=@CHARTERERNAME,
			CHARTERPARTYSPEED=@CHARTERPARTYSPEED,
			VOYORDERSPEED=@VOYORDERSPEED,
			VOYINSTRUCTIONS=@VOYINSTRUCTIONS,
			VOYCONDITION=@VOYCONDITION,
			DEPPORT=@DEPPORT,
			DEPARRIVALPORT=@DEPARRIVALPORT,
			COSPDATE=@COSPDATE,
			COSPHRS=@COSPHRS,
			COSPMIN=@COSPMIN,
			ARRIVALPORTETA=@ARRIVALPORTETA,
			ARRIVALPORTETAHRS=@ARRIVALPORTETAHRS,
			ARRIVALPORTETAMIN=@ARRIVALPORTETAMIN,
			DRAFTFWD=@DRAFTFWD,
			DRAFTAFT=@DRAFTAFT,
			DISTANCETOGO=@DISTANCETOGO,
			ARRIVALPORTAGENT=@ARRIVALPORTAGENT,
			PERSONALINCHARGE=@PERSONALINCHARGE,
			ADDRESSCONTACTDETAILS=@ADDRESSCONTACTDETAILS,
			PORT1=@PORT1,
			PORTETA1=@PORTETA1,
			PORT2=@PORT2,
			PORTETA2=@PORTETA2,
			PORT3=@PORT3,
			PORTETA3=@PORTETA3,
			COURCET=@COURCET,
			WINDDIRECTIONT=@WINDDIRECTIONT,
			WINDFORCE=@WINDFORCE,
			SEADIRECTION=@SEADIRECTION,
			SEASTATE=@SEASTATE,
			CURRENTDIRECTION=@CURRENTDIRECTION,
			CURRENTSTRENGTH=@CURRENTSTRENGTH,
			WEATHERREMARKS=@WEATHERREMARKS,
			LATTITUDE1=@LATTITUDE1,
			LATTITUDE2=@LATTITUDE2,
			LATTITUDE3=@LATTITUDE3,
			LONGITUDE1=@LONGITUDE1,
			LONGITUD2=@LONGITUD2,
			LONGITUD3=@LONGITUD3,
			LOCATIONDESCRIPTION=@LOCATIONDESCRIPTION,
			ROBIFO45=@ROBIFO45,
			ROBIFO1=@ROBIFO1,
			ROBMGO5=@ROBMGO5,
			ROBMGO1=@ROBMGO1,
			ROBMDO=@ROBMDO,
			ROBMECC=@ROBMECC,
			ROBMECYL=@ROBMECYL,
			ROBAECC=@ROBAECC,
			ROBHYD=@ROBHYD,
			ROBMDOLUBE=@ROBMDOLUBE,
			ROBFESSHWATER=@ROBFESSHWATER,
			ROBIFO45RECV=@ROBIFO45RECV,
			ROBIFO1RECV=@ROBIFO1RECV,
			ROBMGO5RECV=@ROBMGO5RECV,
			ROBMGO1RECV=@ROBMGO1RECV,
			ROBMDORECV=@ROBMDORECV,
			ROBMECCRECV=@ROBMECCRECV,
			ROBMECYLRECV=@ROBMECYLRECV,
			ROBAECCRECV=@ROBAECCRECV,
			ROBHYDRECV=@ROBHYDRECV,
			ROBMDOLUBERECV=@ROBMDOLUBERECV,
			ROBFESSHWATERRECV=@ROBFESSHWATERRECV,
			TCW=@TCW,
			BW=@BW,
			TCU20L=@TCU20L,
			TCU40L=@TCU40L,
			TCU45L=@TCU45L,
			TCU20E=@TCU20E,
			TCU40E=@TCU40E,
			TCU45E=@TCU45E
		WHERE DepartureID=@DepartureID AND VESSELID=@VESSELID
END
	SELECT @DepartureID As DepartureID
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[SHIP_VPR_InsertUpdate_VPRNoonReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_VPR_InsertUpdate_VPRNoonReport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROCEDURE [dbo].[SHIP_VPR_InsertUpdate_VPRNoonReport]
(
	@NoonID BIGINT, 
	@VesselID varchar(3) ,
	@ReportDate smalldatetime ,
	@Location int ,
	@VoyageNo varchar(100) ,
	@RestrictedArea int ,
	@AreaName int ,
	@ETARestrictedArea smalldatetime ,

	@ChartererName varchar(250) ,
	@CharterPartySpeed decimal(18, 2) ,
	@VoyOrderSpeed decimal(18, 2) ,
	@VoyInstructions varchar(1000),

	@SteamingHrs int ,
	@SteamingMin int ,
	@DistanceMadeGood decimal(18, 2),
	@AvgSpeed decimal(18, 2) ,
	@Stoppages int ,
	@StoppagesHH int ,
	@StoppagesMM int ,
	@Displacement int ,
	@Remarks varchar(max) ,

	@VoyCondition int ,
	@DepPort varchar(50) ,
	@DepArrivalPort varchar(250) ,
	@COSPDate smalldatetime ,
	@COSPHrs int ,
	@COSPMin int ,
	@TimeZone varchar(250) ,
	@ArrivalPortETA smalldatetime ,
	@ArrivalPortETAHrs int ,
	@ArrivalPortETAMin int ,
	@DraftFwd decimal(18, 2) ,
	@DraftAft decimal(18, 2) ,
	@DistanceToGo decimal(18, 2) ,
	@ArrivalPortAgent varchar(250) ,
	@PersonalIncharge varchar(250) ,
	@AddressContactDetails varchar(max) ,

	@Port1 varchar(50),
    @PortETA1 smalldatetime,
	@Port2 varchar(50),
    @PortETA2 smalldatetime,
	@Port3 varchar(50),
    @PortETA3 smalldatetime,

	@CourceT decimal(18, 2) ,
	@WindDirectionT decimal(18, 2) ,
	@WindForce int ,
	@SeaDirection decimal(18, 2) ,
	@SeaState int ,
	@CurrentDirection decimal(18, 2) ,
	@CurrentStrength decimal(18, 2) ,
	@WeatherRemarks varchar(max) ,

	@Lattitude1 int ,
	@Lattitude2 int ,
	@Lattitude3 int ,
	@Longitude1 int ,
	@Longitud2 int ,
	@Longitud3 int ,
	@LocationDescription varchar(max) ,
	
	@ROBIFO45Fuel decimal(18, 2) ,
	@ROBIFO1Fuel decimal(18, 2) ,
	@ROBMGO5Fuel decimal(18, 2) ,
	@ROBMGO1Fuel decimal(18, 2) ,
	@ROBMDOFuel decimal(18, 2) ,

	@ROBIFO45Lube decimal(18, 2) ,
	@ROBIFO1Lube decimal(18, 2) ,
	@ROBMGO5Lube decimal(18, 2) ,
	@ROBMGO1Lube decimal(18, 2) ,

	@ROBIFO45FreshWater decimal(18, 2) ,
	
	@MEIFO45 decimal(18, 2) ,
	@MEIFO1 decimal(18, 2) ,
	@MEMGO5 decimal(18, 2) ,
	@MEMGO1 decimal(18, 2) ,
	@MEMDO decimal(18, 2) ,
	@AEIFO45 decimal(18, 2) ,
	@AEIFO1 decimal(18, 2) ,
	@AEMGO5 decimal(18, 2) ,
	@AEMGO1 decimal(18, 2) ,
	@AEMDO decimal(18, 2) ,
	@CargoHeatingIFO45 decimal(18, 2) ,
	@CargoHeatingIFO1 decimal(18, 2) ,
	@CargoHeatingMGO5 decimal(18, 2) ,
	@CargoHeatingMGO1 decimal(18, 2) ,
	@CargoHeatingMDO decimal(18, 2) ,
	@TankCleaningIFO45 decimal(18, 2) ,
	@TankCleaningIFO1 decimal(18, 2) ,
	@TankCleaningMGO5 decimal(18, 2) ,
	@TankCleaningMGO1 decimal(18, 2) ,
	@TankCleaningMDO decimal(18, 2) ,
	@GasFreeingIFO45 decimal(18, 2) ,
	@GasFreeingIFO1 decimal(18, 2) ,
	@GasFreeingMGO5 decimal(18, 2) ,
	@GasFreeingMGO1 decimal(18, 2) ,
	@GasFreeingMDO decimal(18, 2) ,
	@IGSIFO45 decimal(18, 2) ,
	@IGSIFO1 decimal(18, 2) ,
	@IGSMGO5 decimal(18, 2) ,
	@IGSMGO1 decimal(18, 2) ,
	@IGSMDO decimal(18, 2) ,

	@Total_IFO45 decimal(18, 2) ,
	@Total_IFO1 decimal(18, 2) ,
	@Total_MGO5 decimal(18, 2) ,
	@Total_MGO1 decimal(18, 2) ,
	@Total_MDO decimal(18, 2) ,

	@MECCLube decimal(18, 2) ,
	@MECYLLube decimal(18, 2) ,
	@AECCLube decimal(18, 2) ,
	@HYDLube decimal(18, 2) ,

	@GeneratedFreshWater decimal(18, 2) ,
	@ConsumedFreshWater decimal(18, 2) ,

	@ExhTempMin decimal(18, 2) ,
	@ExhTempMax decimal(18, 2) ,
	@MERPM decimal(18, 2) ,
	@EngineDistance decimal(18, 2) ,
	@Slip decimal(18, 2) ,
	@MEOutput decimal(18, 2) ,
	@METhermalLoad decimal(18, 2) ,
	@MELoadIndicator decimal(18, 2) ,
	@METCNo1RPM decimal(18, 2) ,
	@METCNo2RPM decimal(18, 2) ,
	@MESCAVPressure decimal(18, 2) ,
	@SCAVTEMP decimal(18, 2) ,
	@LubeOilPressure decimal(18, 2) ,
	@SeaWaterTemp decimal(18, 2) ,
	@EngRoomTemp decimal(18, 2) ,
	@BligPump decimal(18, 2) ,

	@AUX1Load decimal(18, 2) ,
	@AUX2Load decimal(18, 2) ,
	@AUX3Load decimal(18, 2) ,
	@AUX4Load decimal(18, 2) ,
	@TotalAUXLoad decimal(18, 2) ,
	@AENo1 decimal(18, 2) ,
	@AENo2 decimal(18, 2) ,
	@AENo3 decimal(18, 2) ,
	@AENo4 decimal(18, 2) ,
	@AEFOInletTemp decimal(18, 2) ,
	@TotalCargoWeight decimal(18, 2) ,
	@BallastWeight decimal(18, 2) 
)
AS
BEGIN
SET NOCOUNT ON

IF(@NoonID <= 0)
BEGIN

	DECLARE @ReportsPK BIGINT
	SELECT @ReportsPK=ISNULL(MAX(ReportsPK),0)+1 FROM VW_VSL_VPR_ALLREPORTS WHERE VESSELID=@VESSELID
    SELECT @NoonID= ISNULL(MAX(NoonID), 0) + 1 FROM [dbo].[VSL_VPRNoonReport] WHERE VESSELID=@VESSELID

	INSERT INTO [dbo].[VSL_VPRNoonReport]
	(
	   ReportsPK
	  ,NoonID
	  ,VesselID
      ,ReportDate
      ,Location
      ,VoyageNo
      ,RestrictedArea
      ,AreaName
      ,ETARestrictedArea
      ,ChartererName
      ,CharterPartySpeed
      ,VoyOrderSpeed
      ,VoyInstructions
      ,SteamingHrs
      ,SteamingMin
      ,DistanceMadeGood
      ,AvgSpeed
      ,Stoppages
	  ,StoppagesHH
	  ,StoppagesMM
	  ,Displacement
      ,Remarks
      ,VoyCondition
      ,DepPort
      ,DepArrivalPort
      ,COSPDate
      ,COSPHrs
      ,COSPMin
      ,TimeZone
      ,ArrivalPortETA
      ,ArrivalPortETAHrs
      ,ArrivalPortETAMin
      ,DraftFwd
      ,DraftAft
      ,DistanceToGo
      ,ArrivalPortAgent
      ,PersonalIncharge
      ,AddressContactDetails
		
	  ,Port1 
	  ,PortETA1 
	  ,Port2 
	  ,PortETA2 
	  ,Port3 
	  ,PortETA3 

      ,CourceT
      ,WindDirectionT
      ,WindForce
      ,SeaDirection
      ,SeaState
      ,CurrentDirection
      ,CurrentStrength
      ,WeatherRemarks
      ,Lattitude1
      ,Lattitude2
      ,Lattitude3
      ,Longitude1
      ,Longitud2
      ,Longitud3
      ,LocationDescription
      ,ROBIFO45Fuel
	  ,ROBIFO1Fuel
	  ,ROBMGO5Fuel
	  ,ROBMGO1Fuel
      ,ROBMDOFuel

      ,ROBIFO45Lube
      ,ROBIFO1Lube
      ,ROBMGO5Lube
	  ,ROBMGO1Lube
	
	  ,ROBIFO45FreshWater      
	
	  ,MEIFO45
      ,MEIFO1
      ,MEMGO5
      ,MEMGO1
      ,MEMDO
      ,AEIFO45
      ,AEIFO1
      ,AEMGO5
      ,AEMGO1
      ,AEMDO
      ,CargoHeatingIFO45
      ,CargoHeatingIFO1
      ,CargoHeatingMGO5
      ,CargoHeatingMGO1
      ,CargoHeatingMDO
      ,TankCleaningIFO45
      ,TankCleaningIFO1
      ,TankCleaningMGO5
      ,TankCleaningMGO1
      ,TankCleaningMDO
      ,GasFreeingIFO45
      ,GasFreeingIFO1
      ,GasFreeingMGO5
      ,GasFreeingMGO1
      ,GasFreeingMDO
      ,IGSIFO45
      ,IGSIFO1
      ,IGSMGO5
      ,IGSMGO1
      ,IGSMDO
	  ,Total_IFO45 
	  ,Total_IFO1
      ,Total_MGO5
	  ,Total_MGO1
	  ,Total_MDO 

      ,MECCLube
      ,MECYLLube
      ,AECCLube
      ,HYDLube
	  
      ,GeneratedFreshWater
      ,ConsumedFreshWater
      ,ExhTempMin
      ,ExhTempMax
      ,MERPM
      ,EngineDistance
      ,Slip
      ,MEOutput
      ,METhermalLoad
	  ,MELoadIndicator
      ,METCNo1RPM
      ,METCNo2RPM
      ,MESCAVPressure
      ,SCAVTEMP
      ,LubeOilPressure
      ,SeaWaterTemp
      ,EngRoomTemp
	  ,BligPump
		
      ,AUX1Load
      ,AUX2Load
      ,AUX3Load
      ,AUX4Load
      ,TotalAUXLoad
      ,AENo1
      ,AENo2
      ,AENo3
      ,AENo4
	  ,AEFOInletTemp
	  ,TotalCargoWeight
      ,BallastWeight
	)
	Values
	(
	  @ReportsPK
	  ,@NoonID
	  ,@VesselID
      ,@ReportDate
      ,@Location
      ,@VoyageNo
      ,@RestrictedArea
      ,@AreaName
      ,@ETARestrictedArea
      ,@ChartererName
      ,@CharterPartySpeed
      ,@VoyOrderSpeed
      ,@VoyInstructions
      ,@SteamingHrs
      ,@SteamingMin
      ,@DistanceMadeGood
      ,@AvgSpeed
      ,@Stoppages
	  ,@StoppagesHH
	  ,@StoppagesMM
	  ,@Displacement
      ,@Remarks
      ,@VoyCondition
      ,@DepPort
      ,@DepArrivalPort
      ,@COSPDate
      ,@COSPHrs
      ,@COSPMin
      ,@TimeZone
      ,@ArrivalPortETA
      ,@ArrivalPortETAHrs
      ,@ArrivalPortETAMin
      ,@DraftFwd
      ,@DraftAft
      ,@DistanceToGo
      ,@ArrivalPortAgent
      ,@PersonalIncharge
      ,@AddressContactDetails

	  ,@Port1 
	  ,@PortETA1 
	  ,@Port2 
	  ,@PortETA2 
	  ,@Port3 
	  ,@PortETA3 
	
      ,@CourceT
      ,@WindDirectionT
      ,@WindForce
      ,@SeaDirection
      ,@SeaState
      ,@CurrentDirection
      ,@CurrentStrength
      ,@WeatherRemarks
      ,@Lattitude1
      ,@Lattitude2
      ,@Lattitude3
      ,@Longitude1
      ,@Longitud2
      ,@Longitud3
      ,@LocationDescription
	  
      ,@ROBIFO45Fuel
	  ,@ROBIFO1Fuel
	  ,@ROBMGO5Fuel
	  ,@ROBMGO1Fuel
	  ,@ROBMDOFuel

      ,@ROBIFO45Lube
      ,@ROBIFO1Lube
      ,@ROBMGO5Lube
      ,@ROBMGO1Lube
      
	  ,@ROBIFO45FreshWater
	      

      ,@MEIFO45
      ,@MEIFO1
      ,@MEMGO5
      ,@MEMGO1
      ,@MEMDO
      ,@AEIFO45
      ,@AEIFO1
      ,@AEMGO5
      ,@AEMGO1
      ,@AEMDO
      ,@CargoHeatingIFO45
      ,@CargoHeatingIFO1
      ,@CargoHeatingMGO5
      ,@CargoHeatingMGO1
      ,@CargoHeatingMDO
      ,@TankCleaningIFO45
      ,@TankCleaningIFO1
      ,@TankCleaningMGO5
      ,@TankCleaningMGO1
      ,@TankCleaningMDO
      ,@GasFreeingIFO45
      ,@GasFreeingIFO1
      ,@GasFreeingMGO5
      ,@GasFreeingMGO1
      ,@GasFreeingMDO
      ,@IGSIFO45
      ,@IGSIFO1
      ,@IGSMGO5
      ,@IGSMGO1
      ,@IGSMDO

	  ,@Total_IFO45 
	  ,@Total_IFO1
	  ,@Total_MGO5
	  ,@Total_MGO1
	  ,@Total_MDO 

      ,@MECCLube
      ,@MECYLLube
      ,@AECCLube
      ,@HYDLube
	  
      ,@GeneratedFreshWater
      ,@ConsumedFreshWater
      ,@ExhTempMin
      ,@ExhTempMax
      ,@MERPM
      ,@EngineDistance
      ,@Slip
      ,@MEOutput
      ,@METhermalLoad
	  ,@MELoadIndicator
      ,@METCNo1RPM
      ,@METCNo2RPM
      ,@MESCAVPressure
      ,@SCAVTEMP
      ,@LubeOilPressure
      ,@SeaWaterTemp
      ,@EngRoomTemp
	  ,@BligPump
      ,@AUX1Load
      ,@AUX2Load
      ,@AUX3Load
      ,@AUX4Load
      ,@TotalAUXLoad
      ,@AENo1
      ,@AENo2
      ,@AENo3
      ,@AENo4
	  ,@AEFOInletTemp
	  ,@TotalCargoWeight
      ,@BallastWeight
	)
END
ELSE
BEGIN
      UPDATE [dbo].[VSL_VPRNoonReport]

	  SET
		
      ReportDate	=@ReportDate,
      Location	=@Location,
      VoyageNo	=@VoyageNo,
      RestrictedArea	=@RestrictedArea,
      AreaName	=@AreaName,
      ETARestrictedArea	=@ETARestrictedArea,
      ChartererName	=@ChartererName,
      CharterPartySpeed	=@CharterPartySpeed,
      VoyOrderSpeed	=@VoyOrderSpeed,
      VoyInstructions	=@VoyInstructions,
      SteamingHrs	=@SteamingHrs,
      SteamingMin	=@SteamingMin,
      DistanceMadeGood	=@DistanceMadeGood,
      AvgSpeed	=@AvgSpeed,
      Stoppages	=@Stoppages,
	  StoppagesHH=@StoppagesHH,
	  StoppagesMM=@StoppagesMM,
	  Displacement=@Displacement,
      Remarks	=@Remarks,
      VoyCondition	=@VoyCondition,
      DepPort	=@DepPort,
      DepArrivalPort	=@DepArrivalPort,
      COSPDate	=@COSPDate,
      COSPHrs	=@COSPHrs,
      COSPMin	=@COSPMin,
      TimeZone	=@TimeZone,
      ArrivalPortETA	=@ArrivalPortETA,
      ArrivalPortETAHrs	=@ArrivalPortETAHrs,
      ArrivalPortETAMin	=@ArrivalPortETAMin,
      DraftFwd	=@DraftFwd,
      DraftAft	=@DraftAft,
      DistanceToGo	=@DistanceToGo,
      ArrivalPortAgent	=@ArrivalPortAgent,
      PersonalIncharge	=@PersonalIncharge,
      AddressContactDetails	=@AddressContactDetails,
	  Port1 	=	 @Port1,
	  PortETA1 	=	 @PortETA1,
	  Port2 	=	 @Port2,
	  PortETA2 	=	 @PortETA2,
	  Port3 	=	 @Port3,
	  PortETA3 	=	 @PortETA3,
 	
      CourceT	=@CourceT,
      WindDirectionT	=@WindDirectionT,
      WindForce	=@WindForce,
      SeaDirection	=@SeaDirection,
      SeaState	=@SeaState,
      CurrentDirection	=@CurrentDirection,
      CurrentStrength	=@CurrentStrength,
      WeatherRemarks	=@WeatherRemarks,
      Lattitude1	=@Lattitude1,
      Lattitude2	=@Lattitude2,
      Lattitude3	=@Lattitude3,
      Longitude1	=@Longitude1,
      Longitud2	=@Longitud2,
      Longitud3	=@Longitud3,
      LocationDescription	=@LocationDescription,
   	
      ROBIFO45Fuel	=@ROBIFO45Fuel,
	  ROBIFO1Fuel	=	 @ROBIFO1Fuel,
	  ROBMGO5Fuel	=	 @ROBMGO5Fuel,
	  ROBMGO1Fuel	=	 @ROBMGO1Fuel,
	  ROBMDOFuel	=	 @ROBMDOFuel,
	
      ROBIFO45Lube	=@ROBIFO45Lube,
      ROBIFO1Lube	=@ROBIFO1Lube,
      ROBMGO5Lube	=@ROBMGO5Lube,
      ROBMGO1Lube	=@ROBMGO1Lube,
      
	  ROBIFO45FreshWater	=	 @ROBIFO45FreshWater,
      MEIFO45	=@MEIFO45,
      MEIFO1	=@MEIFO1,
      MEMGO5	=@MEMGO5,
      MEMGO1	=@MEMGO1,
      MEMDO	=@MEMDO,
      AEIFO45	=@AEIFO45,
      AEIFO1	=@AEIFO1,
      AEMGO5	=@AEMGO5,
      AEMGO1	=@AEMGO1,
      AEMDO	=@AEMDO,
      CargoHeatingIFO45	=@CargoHeatingIFO45,
      CargoHeatingIFO1	=@CargoHeatingIFO1,
      CargoHeatingMGO5	=@CargoHeatingMGO5,
      CargoHeatingMGO1	=@CargoHeatingMGO1,
      CargoHeatingMDO	=@CargoHeatingMDO,
      TankCleaningIFO45	=@TankCleaningIFO45,
      TankCleaningIFO1	=@TankCleaningIFO1,
      TankCleaningMGO5	=@TankCleaningMGO5,
      TankCleaningMGO1	=@TankCleaningMGO1,
      TankCleaningMDO	=@TankCleaningMDO,
      GasFreeingIFO45	=@GasFreeingIFO45,
      GasFreeingIFO1	=@GasFreeingIFO1,
      GasFreeingMGO5	=@GasFreeingMGO5,
      GasFreeingMGO1	=@GasFreeingMGO1,
      GasFreeingMDO	=@GasFreeingMDO,
      IGSIFO45	=@IGSIFO45,
      IGSIFO1	=@IGSIFO1,
      IGSMGO5	=@IGSMGO5,
      IGSMGO1	=@IGSMGO1,
      IGSMDO	=@IGSMDO,
	
	  Total_IFO45 	=	 @Total_IFO45,
	  Total_IFO1	=	 @Total_IFO1,
	  Total_MGO5	=	 @Total_MGO5,
	  Total_MGO1	=	 @Total_MGO1,
	  Total_MDO 	=	 @Total_MDO,
	
      MECCLube	=@MECCLube,
      MECYLLube	=@MECYLLube,
      AECCLube	=@AECCLube,
      HYDLube	=@HYDLube,
   	
      GeneratedFreshWater	=@GeneratedFreshWater,
      ConsumedFreshWater	=@ConsumedFreshWater,
      ExhTempMin	=@ExhTempMin,
      ExhTempMax	=@ExhTempMax,
      MERPM	=@MERPM,
      EngineDistance	=@EngineDistance,
      Slip	=@Slip,
      MEOutput	=@MEOutput,
      METhermalLoad	=@METhermalLoad,
   	  MELoadIndicator=@MELoadIndicator,
      METCNo1RPM	=@METCNo1RPM,
      METCNo2RPM	=@METCNo2RPM,
      MESCAVPressure	=@MESCAVPressure,
      SCAVTEMP	=@SCAVTEMP,
      LubeOilPressure	=@LubeOilPressure,
      SeaWaterTemp	=@SeaWaterTemp,
      EngRoomTemp	=@EngRoomTemp,
	  BligPump	=	 @BligPump,
      AUX1Load	=@AUX1Load,
      AUX2Load	=@AUX2Load,
      AUX3Load	=@AUX3Load,
      AUX4Load	=@AUX4Load,
      TotalAUXLoad	=@TotalAUXLoad,
      AENo1	=@AENo1,
      AENo2	=@AENo2,
      AENo3	=@AENo3,
      AENo4	=@AENo4,
	  AEFOInletTemp=@AEFOInletTemp,
	  TotalCargoWeight=@TotalCargoWeight,
      BallastWeight=@BallastWeight
  	  WHERE NoonID=@NoonID AND VESSELID=@VESSELID
END

SELECT @NoonID AS NoonID
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[SHIP_VPR_InsertUpdate_VPRPortBerthingReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHIP_VPR_InsertUpdate_VPRPortBerthingReport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[SHIP_VPR_InsertUpdate_VPRPortBerthingReport]
(
	@BerthingID bigint,
	@VESSELID varchar(3),
	@REPORTDATE smalldatetime,
	@VOYAGENO varchar(100),
	@ARRIVALPORT varchar(50),
	@BERTHTERMINALNAME varchar(100),
	@PLACEOFBERTH varchar(100),
	@FIRSTLINEDATE smalldatetime,
	@FIRSTLINEHH int,
	@FIRSTLINEMM int,
	@ALLFASTDATE smalldatetime,
	@ALLFASTHH int,
	@ALLFASTMM int,
	@NOOFTUGSUSED varchar(100),
	@ETBDT smalldatetime,
	@ETBHOURS int,
	@ETBMIN int,
	@ETDDT smalldatetime,
	@ETDHOURS int,
	@ETDMIN int,
	@COURCET decimal(18,2),
	@WINDDIRECTIONT decimal(18,2),
	@WINDFORCE int,
	@SEADIRECTION decimal(18,2),
	@SEASTATE int,
	@CURRENTDIRECTION decimal(18,2),
	@CURRENTSTRENGTH decimal(18,2),
	@WEATHERREMARKS varchar(max),
	@LATTITUDE1 int,
	@LATTITUDE2 int,
	@LATTITUDE3 int,
	@LONGITUDE1 int,
	@LONGITUD2 int,
	@LONGITUD3 int,
	@LOCATIONDESCRIPTION varchar(max),
	@MEIFO45 decimal(18,2),
	@MEIFO1 decimal(18,2),
	@MEMGO5 decimal(18,2),
	@MEMGO1 decimal(18,2),
	@MEMDO decimal(18,2),
	@AEIFO45 decimal(18,2),
	@AEIFO1 decimal(18,2),
	@AEMGO5 decimal(18,2),
	@AEMGO1 decimal(18,2),
	@AEMDO decimal(18,2),
	@CARGOHEATINGIFO45 decimal(18,2),
	@CARGOHEATINGIFO1 decimal(18,2),
	@CARGOHEATINGMGO5 decimal(18,2),
	@CARGOHEATINGMGO1 decimal(18,2),
	@CARGOHEATINGMDO decimal(18,2),
	@MECCLUBE decimal(18,2),
	@MECYLLUBE decimal(18,2),
	@AECCLUBE decimal(18,2),
	@HYDLUBE decimal(18,2),
	@MDOLUBE decimal(18,2),
	@GENERATEDFRESHWATER decimal(18,2),
	@CONSUMEDFRESHWATER decimal(18,2),
	@TCW varchar(50),
	@BW varchar(50),

	@ROBIFO45 decimal(18, 2) ,
	@ROBIFO1 decimal(18, 2) ,
	@ROBMGO5 decimal(18, 2) ,
	@ROBMGO1 decimal(18, 2) ,
	@ROBMDO decimal(18, 2) ,
	@ROBMECC decimal(18, 2) ,
	@ROBMECYL decimal(18, 2) ,
	@ROBAECC decimal(18, 2) ,
	@ROBHYD decimal(18, 2) ,
	@ROBMDOLube decimal(18, 2) ,
	@ROBFesshWater decimal(18, 2) 
)
AS
BEGIN
SET NOCOUNT ON

IF(@BerthingID <= 0)
BEGIN
	DECLARE @ReportsPK BIGINT
	SELECT @ReportsPK=ISNULL(MAX(ReportsPK),0)+1 FROM VW_VSL_VPR_ALLREPORTS WHERE VESSELID=@VESSELID

    SELECT @BerthingID= ISNULL(MAX(BerthingID), 0) + 1 FROM [dbo].[VSL_VPRPortBerthingReport] WHERE VESSELID=@VESSELID


	INSERT INTO [dbo].[VSL_VPRPortBerthingReport]	
	(
		ReportsPK,
	    BerthingID,
		VESSELID ,
		REPORTDATE ,
		VOYAGENO ,
		ARRIVALPORT ,
		BERTHTERMINALNAME ,
		PLACEOFBERTH ,
		FIRSTLINEDATE ,
		FIRSTLINEHH ,
		FIRSTLINEMM ,
		ALLFASTDATE ,
		ALLFASTHH ,
		ALLFASTMM ,
		NOOFTUGSUSED ,
		ETBDT ,
		ETBHOURS ,
		ETBMIN ,
		ETDDT ,
		ETDHOURS ,
		ETDMIN ,
		COURCET ,
		WINDDIRECTIONT ,
		WINDFORCE ,
		SEADIRECTION ,
		SEASTATE ,
		CURRENTDIRECTION ,
		CURRENTSTRENGTH ,
		WEATHERREMARKS ,
		LATTITUDE1 ,
		LATTITUDE2 ,
		LATTITUDE3 ,
		LONGITUDE1 ,
		LONGITUD2 ,
		LONGITUD3 ,
		LOCATIONDESCRIPTION ,
		MEIFO45 ,
		MEIFO1 ,
		MEMGO5 ,
		MEMGO1 ,
		MEMDO ,
		AEIFO45 ,
		AEIFO1 ,
		AEMGO5 ,
		AEMGO1 ,
		AEMDO ,
		CARGOHEATINGIFO45 ,
		CARGOHEATINGIFO1 ,
		CARGOHEATINGMGO5 ,
		CARGOHEATINGMGO1 ,
		CARGOHEATINGMDO ,
		MECCLUBE ,
		MECYLLUBE ,
		AECCLUBE ,
		HYDLUBE ,
		MDOLUBE ,
		GENERATEDFRESHWATER ,
		CONSUMEDFRESHWATER ,
		TCW ,
		BW ,
		ROBIFO45,
		ROBIFO1,
		ROBMGO5,
		ROBMGO1,
		ROBMDO,
		ROBMECC,
		ROBMECYL,
		ROBAECC,
		ROBHYD,
		ROBMDOLube,
		ROBFesshWater
	)
	Values
	(
		@ReportsPK,
		@BerthingID,
		@VESSELID,
		@REPORTDATE,
		@VOYAGENO,
		@ARRIVALPORT,
		@BERTHTERMINALNAME,
		@PLACEOFBERTH,
		@FIRSTLINEDATE,
		@FIRSTLINEHH,
		@FIRSTLINEMM,
		@ALLFASTDATE,
		@ALLFASTHH,
		@ALLFASTMM,
		@NOOFTUGSUSED,
		@ETBDT,
		@ETBHOURS,
		@ETBMIN,
		@ETDDT,
		@ETDHOURS,
		@ETDMIN,
		@COURCET,
		@WINDDIRECTIONT,
		@WINDFORCE,
		@SEADIRECTION,
		@SEASTATE,
		@CURRENTDIRECTION,
		@CURRENTSTRENGTH,
		@WEATHERREMARKS,
		@LATTITUDE1,
		@LATTITUDE2,
		@LATTITUDE3,
		@LONGITUDE1,
		@LONGITUD2,
		@LONGITUD3,
		@LOCATIONDESCRIPTION,
		@MEIFO45,
		@MEIFO1,
		@MEMGO5,
		@MEMGO1,
		@MEMDO,
		@AEIFO45,
		@AEIFO1,
		@AEMGO5,
		@AEMGO1,
		@AEMDO,
		@CARGOHEATINGIFO45,
		@CARGOHEATINGIFO1,
		@CARGOHEATINGMGO5,
		@CARGOHEATINGMGO1,
		@CARGOHEATINGMDO,
		@MECCLUBE,
		@MECYLLUBE,
		@AECCLUBE,
		@HYDLUBE,
		@MDOLUBE,
		@GENERATEDFRESHWATER,
		@CONSUMEDFRESHWATER,
		@TCW,
		@BW,
		@ROBIFO45,
		@ROBIFO1,
		@ROBMGO5,
		@ROBMGO1,
		@ROBMDO,
		@ROBMECC,
		@ROBMECYL,
		@ROBAECC,
		@ROBHYD,
		@ROBMDOLube,
		@ROBFesshWater
	)
END
ELSE
BEGIN
        UPDATE [dbo].[VSL_VPRPortBerthingReport]

		SET   ReportDate = @ReportDate, 
			  VoyageNo = @VoyageNo, 
			  ArrivalPort = @ArrivalPort, 
			  BerthTerminalName = @BerthTerminalName, 
			  PlaceOfBerth = @PlaceOfBerth, 
			  FirstLineDate = @FirstLineDate, 
			  FirstLineHH = @FirstLineHH, 
			  FirstLineMM = @FirstLineMM, 
			  AllFastDate = @AllFastDate, 
			  AllFastHH = @AllFastHH, 
			  AllFastMM = @AllFastMM, 
			  NoOfTUGSUSED = @NoOfTUGSUSED, 
			  ETBDT = @ETBDT, 
			  ETBHours = @ETBHours, 
			  ETBMin = @ETBMin, 
			  ETDDT = @ETDDT, 
			  ETDHours = @ETDHours, 
			  ETDMin = @ETDMin, 
			  CourceT = @CourceT, 
			  WindDirectionT = @WindDirectionT, 
			  WindForce = @WindForce, 
			  SeaDirection = @SeaDirection, 
			  SeaState = @SeaState, 
			  CurrentDirection = @CurrentDirection, 
			  CurrentStrength = @CurrentStrength, 
			  WeatherRemarks = @WeatherRemarks, 
			  Lattitude1 = @Lattitude1, 
			  Lattitude2 = @Lattitude2, 
			  Lattitude3 = @Lattitude3, 
			  Longitude1 = @Longitude1, 
			  Longitud2 = @Longitud2, 
			  Longitud3 = @Longitud3, 
			  LocationDescription = @LocationDescription, 
			  MEIFO45 = @MEIFO45, 
			  MEIFO1 = @MEIFO1, 
			  MEMGO5 = @MEMGO5, 
			  MEMGO1 = @MEMGO1, 
			  MEMDO = @MEMDO, 
			  AEIFO45 = @AEIFO45, 
			  AEIFO1 = @AEIFO1, 
			  AEMGO5 = @AEMGO5, 
			  AEMGO1 = @AEMGO1, 
			  AEMDO = @AEMDO, 
			  CargoHeatingIFO45 = @CargoHeatingIFO45, 
			  CargoHeatingIFO1 = @CargoHeatingIFO1, 
			  CargoHeatingMGO5 = @CargoHeatingMGO5, 
			  CargoHeatingMGO1 = @CargoHeatingMGO1, 
			  CargoHeatingMDO = @CargoHeatingMDO, 
			  MECCLube = @MECCLube, 
			  MECYLLube = @MECYLLube, 
			  AECCLube = @AECCLube, 
			  HYDLube = @HYDLube, 
			  MDOLube = @MDOLube, 
			  GeneratedFreshWater = @GeneratedFreshWater, 
			  ConsumedFreshWater = @ConsumedFreshWater, 
			  TCW = @TCW, 
			  BW = @BW ,
			  ROBIFO45=@ROBIFO45,
				ROBIFO1=@ROBIFO1,
				ROBMGO5=@ROBMGO5,
				ROBMGO1=@ROBMGO1,
				ROBMDO=@ROBMDO,
				ROBMECC=@ROBMECC,
				ROBMECYL=@ROBMECYL,
				ROBAECC=@ROBAECC,
				ROBHYD=@ROBHYD,
				ROBMDOLube=@ROBMDOLube,
				ROBFesshWater=@ROBFesshWater
			 
		WHERE BerthingID=@BerthingID AND VESSELID=@VESSELID
END
    SELECT @BerthingID AS BerthingID
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_AddEditManualSection]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_AddEditManualSection]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE proc [dbo].[SMS_AddEditManualSection]
(
@ManualId BigInt,
@CurrentSectionId varchar(100),
@ParentSectionId varchar(100),
@Heading nvarchar(max),
@SearchTags varchar(500),
@FileExt varchar(100),
@FileContent Image,
@SVersion varchar(50),
@ModifiedBy varchar(50)
)
as
BEGIN
	DECLARE @FileName Varchar(200)
	SET @FileName=''''
	IF(LTRIM(RTRIM(@FileExt))<>'''')
		SET @FileName=''Attachment_''+CONVERT(VARCHAR(10),@ManualId)+''_''+CONVERT(VARCHAR(10),@CurrentSectionId)+@FileExt

	IF NOT EXISTS(SELECT * FROM SMS_MANUALDETAILS WHERE MANUALID=@ManualId AND LTRIM(RTRIM(SECTIONID))=LTRIM(RTRIM(@CurrentSectionId)))
	BEGIN
		INSERT INTO SMS_MANUALDETAILS(MANUALID,SECTIONID,PARENTSECTIONID,Heading,SearchTags,Approved,Status,SVersion,[FileName],FileContent,ModifiedBy,ModifiedOn,ReqRemarks,AppRemarks,RejRemarks) 
		VALUES(@ManualId,@CurrentSectionId,@ParentSectionId,@Heading,@SearchTags,'''',''A'',@SVersion,@FileName,@FileContent,@ModifiedBy,getdate(),'''','''','''')
	END
	ELSE
	BEGIN
		IF(LTRIM(RTRIM(@FileName))='''')
		BEGIN
			UPDATE SMS_MANUALDETAILS SET Heading=@Heading,SearchTags=@SearchTags,Approved='''',ModifiedBy=@ModifiedBy,ModifiedOn=getdate(),SVersion=@SVersion,REQREMARKS='''',APPREMARKS='''',REJREMARKS=''''
			WHERE MANUALID=@ManualId AND LTRIM(RTRIM(SECTIONID))=LTRIM(RTRIM(@CurrentSectionId))
		END
		ELSE
		BEGIN
			UPDATE SMS_MANUALDETAILS SET Heading=@Heading,SearchTags=@SearchTags,Approved='''',[FileName]=@FileName,FileContent=@FileContent,ModifiedBy=@ModifiedBy,ModifiedOn=getdate(),SVersion=@SVersion,REQREMARKS='''',APPREMARKS='''',REJREMARKS=''''
			WHERE MANUALID=@ManualId AND LTRIM(RTRIM(SECTIONID))=LTRIM(RTRIM(@CurrentSectionId))
		END
	END
	SELECT @CurrentSectionId
END












' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_AddEditManualSectionImage]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_AddEditManualSectionImage]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE proc [dbo].[SMS_AddEditManualSectionImage]
(
@ManualId BigInt,
@SectionId varchar(100),
@ImageName varchar(100),
@Description varchar(1000)
)
as
BEGIN
	DECLARE @IMGID BIGINT
	SELECT @IMGID=ISNULL(MAX(IMAGEID),0)+1 FROM SMS_ManualDetails_Images 

	INSERT INTO SMS_ManualDetails_Images(IMAGEID,MANUALID,SECTIONID,IMAGENAME,Description) 
	VALUES(@IMGID,@ManualId,@SectionId,@ImageName,@Description)
END









' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_AddSectionComments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_AddSectionComments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE proc [dbo].[SMS_AddSectionComments]
(
@ManualId bigint,
@SectionId varchar(100),
@Mversion varchar(50),
@Sversion varchar(50),
@Comments nvarchar(max),
@UserType char(1),
@LoginId varchar(50)
)
as
BEGIN
	DECLARE @CommentId BIGINT
	SELECT @CommentId=ISNULL(MAX(CommentId),0)+1 FROM [SMS_ManualDetails_Comments]
	INSERT INTO SMS_ManualDetails_Comments
           ([CommentId]
           ,[ManualId]
           ,[SectionId]
		   ,[ManualVersion]
		   ,[Sversion]
           ,[Comments]
		   ,[UserType]
           ,[EnteredBy]
           ,[EnteredOn]
		   ,[Status])
     VALUES
           (
			@CommentId,	
			@ManualId,
			@SectionId,
			@Mversion,
			@Sversion,
			@Comments,
			@UserType,
			@LoginId,
			GETDATE(),
			''O'')
END














' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_AddUpdateForm]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_AddUpdateForm]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-------------------------------------------------

CREATE proc [dbo].[SMS_AddUpdateForm]
(
@FormName varchar(100),
@FormNo varchar(50),
@VersionNo varchar(50),
@FileNameExt varchar(4),
@FileContent Image,
@OnDate varchar(15)
)
as
BEGIN
	Declare @FileName Varchar(200)
	DECLARE @FormId BigInt

	SELECT @FormId=ISNULL(MAX(FORMID),0)+1 FROM SMS_Forms
	DECLARE @DT SMALLDATETIME
	SET @DT=dbo.getDatePart(GETDATE())
	IF(LTRIM(RTRIM(@OnDate))<>'''')
	SET @DT=@OnDate
	SET @FileName=''''

	IF EXISTS(SELECT * FROM SMS_Forms WHERE FORMNO=@FormNo AND dbo.getDatePart(CREATEDON)=dbo.getDatePart(@DT))
	BEGIN
		SELECT @FormId=FORMID FROM SMS_Forms WHERE FORMNO=@FormNo AND dbo.getDatePart(CREATEDON)=dbo.getDatePart(@DT)
		IF(LTRIM(RTRIM(@FileNameExt))<>'''')
			SET @FileName=''FORM_''+CONVERT(VARCHAR(10),@FormId)+@FileNameExt
			UPDATE SMS_Forms SET FORMNAME=@FORMNAME,VERSIONNO=@VersionNo,[FILENAME]=@FileName,FILECONTENT=@FileContent,UPDATED=1,UPDATEDON=GETDATE() WHERE FORMNO=@FormNo AND dbo.getDatePart(CREATEDON)=dbo.getDatePart(@DT)
	END
	ELSE
	BEGIN
		IF(LTRIM(RTRIM(@FileNameExt))<>'''')
			SET @FileName=''FORM_''+CONVERT(VARCHAR(10),@FormId)+@FileNameExt
		INSERT INTO SMS_Forms(FORMID,FORMNAME,FORMNO,VERSIONNO,[FILENAME],FILECONTENT,CREATEDON,UPDATED,UPDATEDON) VALUES(@FormId,@FormName,@FormNo,@VersionNo,@FileName,@FileContent,@DT,1,GETDATE())
	END
	--------------------------------
	-- INSERT VESSEL WISE FORMS LIST
	INSERT INTO SMS_APP_COM_Forms(VESSELID,FORMNO,FORMID,SCHEDULED,SCHEDULEDON,ACK_RECD,ACK_RECDON)
	SELECT VESSELID,@FORMNO,@FORMID,1,GETDATE(),0,NULL FROM DBO.VESSEL 
	WHERE VESSELSTATUSID<>2 AND VESSELID NOT IN (41,43,44) AND VESSELID NOT IN (SELECT VESSELID FROM SMS_APP_COM_Forms WHERE LTRIM(RTRIM(FORMNO))=@FORMNO)

	-- UPDATE FLAG
	UPDATE SMS_APP_COM_Forms SET FORMID=@FormId,SCHEDULED=1,SCHEDULEDON=GETDATE(),ACK_RECD=0,ACK_RECDON=NULL WHERE LTRIM(RTRIM(FORMNO))=@FORMNO
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_Approve_Request_Headings]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Approve_Request_Headings]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

-- EXEC [dbo].[SMS_Approve_Request_Headings] 10,''1'',''A'',''''
CREATE PROCEDURE [dbo].[SMS_Approve_Request_Headings]
	@ManualId bigint,
	@SectionId varchar(100),
	@Mode Char(1),
	@Comments varchar(1000)	
AS
BEGIN
	Declare @ManualVersion VARCHAR(50)
	DECLARE @PREV_REV VARCHAR(50)

	IF(@Mode=''R'')
		UPDATE dbo.SMS_ManualDetails SET Approved=''R'',ReqRemarks=@Comments WHERE ManualId=@ManualId AND SectionId=@SectionId

	IF(@Mode=''A'')
	BEGIN
		UPDATE dbo.SMS_ManualDetails SET Approved=''A'',ApprovedOn=GETDATE(),AppRemarks=@Comments WHERE ManualId=@ManualId AND SectionId=@SectionId
		
		DECLARE @HistoryId bigint
		SELECT @HistoryId=ISNULL(MAX(HistoryId),0)+1 FROM SMS_ManualDetails_History 
		----------------------------------
		DECLARE @LASTREVISION VARCHAR(50)
		SET @LASTREVISION=NULL
		SELECT @LASTREVISION=SVERSION FROM SMS_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId
		IF NOT EXISTS(SELECT * FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId)
		BEGIN
			SET @ManualVersion=''0.0''
			SET @LASTREVISION=''0.0''
	
		END
		ELSE
		BEGIN
			SET @PREV_REV=@LASTREVISION
			SELECT @ManualVersion=VERSIONNO FROM SMS_MANUALMASTER WHERE ManualId=@ManualId 
			SET @LASTREVISION=CAST(CAST(@LASTREVISION AS FLOAT)+1 AS NUMERIC(5,1))
			---- UPDATING COMMENTS VERSIONS LINKING TO NEW VERSION
			UPDATE dbo.SMS_ManualDetails_Comments SET SVERSION=@LASTREVISION,STATUS=''C'' WHERE ManualId=@ManualId AND SectionId=@SectionId AND SVERSION=@PREV_REV AND STATUS=''O''
		END
		---- ADDING DISCUSSION AS COMMENTS TO NEW VERSION
		DECLARE @REQREMARKS VARCHAR(1000)
		DECLARE @APPREMARKS VARCHAR(1000)
		DECLARE @REJREMARKS VARCHAR(1000)
		SELECT @REQREMARKS=ISNULL(REQREMARKS,''''),@APPREMARKS=ISNULL(APPREMARKS,''''),@REJREMARKS=ISNULL(REJREMARKS,'''') FROM dbo.SMS_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId
		
		DECLARE @CommentId BIGINT

		IF(LTRIM(RTRIM(@REJREMARKS))<>'''')
		BEGIN
			SELECT @CommentId=ISNULL(MAX(CommentId),0)+1 FROM [SMS_ManualDetails_Comments]
			INSERT INTO SMS_ManualDetails_Comments([CommentId],[ManualId],[SectionId],[ManualVersion],[Sversion],[Comments],[UserType],[EnteredBy],[EnteredOn],STATUS)
			VALUES(@CommentId,@ManualId,@SectionId,@ManualVersion,@LASTREVISION,@REJREMARKS,''J'','''',GETDATE(),''C'')
		END
		IF(LTRIM(RTRIM(@REQREMARKS))<>'''')
		BEGIN
			SELECT @CommentId=ISNULL(MAX(CommentId),0)+1 FROM [SMS_ManualDetails_Comments]
			INSERT INTO SMS_ManualDetails_Comments([CommentId],[ManualId],[SectionId],[ManualVersion],[Sversion],[Comments],[UserType],[EnteredBy],[EnteredOn],STATUS)
			VALUES(@CommentId,@ManualId,@SectionId,@ManualVersion,@LASTREVISION,@REQREMARKS,''R'','''',GETDATE(),''C'')
		END
		IF(LTRIM(RTRIM(@APPREMARKS))<>'''')
		BEGIN
			SELECT @CommentId=ISNULL(MAX(CommentId),0)+1 FROM [SMS_ManualDetails_Comments]
			INSERT INTO SMS_ManualDetails_Comments([CommentId],[ManualId],[SectionId],[ManualVersion],[Sversion],[Comments],[UserType],[EnteredBy],[EnteredOn],STATUS)
			VALUES(@CommentId,@ManualId,@SectionId,@ManualVersion,@LASTREVISION,@APPREMARKS,''A'','''',GETDATE(),''C'')
		END
		----------------------------------
		INSERT INTO SMS_ManualDetails_History SELECT @HistoryId,*,@ManualVersion,GETDATE() FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId
		INSERT INTO SMS_ManualDetailsForms_History SELECT @HistoryId,*,GETDATE() FROM SMS_APP_ManualDetailsForms WHERE ManualId=@ManualId AND SectionId=@SectionId
		----------------------------------

		DELETE FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId
		DELETE FROM SMS_APP_ManualDetailsForms WHERE ManualId=@ManualId AND SectionId=@SectionId
		----------------------------------
		INSERT INTO SMS_APP_ManualDetails 
		SELECT 
		ManualId,
		SectionId,
		ParentSectionId,
		Heading,
		SearchTags,
		FileName,
		FileContent,
		Approved,
		ApprovedOn,
		Status,
		@LASTREVISION,
		ModifiedBy,
		ModifiedOn,
		ReqRemarks,
		AppRemarks,
		RejRemarks,
		NULL,
		NULL,
		NULL,
		NULL,
		NULL
		FROM SMS_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId
		
		INSERT INTO SMS_APP_ManualDetailsForms 
		SELECT 
		ManualId,
		SectionId,
		FormID
		FROM SMS_ManualDetailsForms WHERE ManualId=@ManualId AND SectionId=@SectionId

		UPDATE SMS_ManualDetails SET SVERSION=@LASTREVISION WHERE ManualId=@ManualId AND SectionId=@SectionId
		----------------------------------
		IF NOT EXISTS(SELECT * FROM SMS_APP_MANUALMASTER WHERE ManualId=@ManualId)
			INSERT INTO SMS_APP_MANUALMASTER SELECT * FROM SMS_MANUALMASTER WHERE ManualId=@ManualId

		UPDATE  DBO.SMS_APP_COM_ManualDetails 
		SET SNO=0
		,Scheduled=0
		,SENTDATE=NULL
		,SENDBY=NULL
		,AckStatus=''P''
		,ACKBY=NULL
		,ACKON=NULL
		WHERE  ManualId=@ManualId AND SectionId=@SectionId

     	PRINT @LASTREVISION
	END
END
















' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_Approve_Request_Manual]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Approve_Request_Manual]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
-- EXEC [dbo].[SMS_Approve_Request_Manual] 10,''A''
CREATE PROCEDURE [dbo].[SMS_Approve_Request_Manual]
	@ManualId bigint,
	@Mode Char(1)
AS
BEGIN
	Declare @ManualVersion VARCHAR(50)

	IF(@Mode=''R'')
		UPDATE dbo.SMS_MANUALMASTER SET MApproved=''R'' WHERE ManualId=@ManualId

	IF(@Mode=''A'')
	BEGIN
		UPDATE dbo.SMS_MANUALMASTER SET MApproved=''A'',MApprovedOn=GETDATE() WHERE ManualId=@ManualId

		DECLARE @SECTIONID VARCHAR(50)
		SET @SECTIONID=''''
		DECLARE @HistoryId bigint
		------------ MASTER DATA 
		DECLARE @LASTVERSION VARCHAR(50)
		SET @LASTVERSION=NULL
		SELECT @LASTVERSION=VERSIONNO FROM SMS_MANUALMASTER WHERE ManualId=@ManualId
		IF NOT EXISTS(SELECT * FROM SMS_APP_MANUALMASTER WHERE ManualId=@ManualId)
		BEGIN
			SET @ManualVersion=''''
			SET @LASTVERSION=''0.0''
		END
		ELSE
		BEGIN
			SET @ManualVersion=@LASTVERSION
			SET @LASTVERSION=CAST(CAST(@LASTVERSION AS FLOAT)+1 AS NUMERIC(5,1))
		END
		UPDATE SMS_MANUALMASTER SET VERSIONNO=@LASTVERSION WHERE ManualId=@ManualId

		DELETE FROM SMS_APP_MANUALMASTER WHERE ManualId=@ManualId
		INSERT INTO SMS_APP_MANUALMASTER SELECT * FROM SMS_MANUALMASTER WHERE ManualId=@ManualId

		------------ DETAILS DATA 
		UPDATE dbo.SMS_ManualDetails SET Approved=''A'',ApprovedOn=GETDATE() WHERE ManualId=@ManualId

		DECLARE CS CURSOR FOR SELECT SECTIONID FROM SMS_ManualDetails WHERE ManualId=@ManualId
		OPEN CS
		FETCH NEXT FROM CS INTO @SECTIONID
		WHILE (@@FETCH_STATUS=0)
		BEGIN
			--------------------------------------------
			SELECT @HistoryId=ISNULL(MAX(HistoryId),0)+1 FROM SMS_ManualDetails_History 

			INSERT INTO SMS_ManualDetails_History SELECT @HistoryId,*,@ManualVersion,GETDATE() FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SECTIONID
			INSERT INTO SMS_ManualDetailsForms_History SELECT @HistoryId,*,GETDATE() FROM SMS_APP_ManualDetailsForms WHERE ManualId=@ManualId AND SectionId=@SECTIONID

			DELETE FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SECTIONID
			DELETE FROM SMS_APP_ManualDetailsForms WHERE ManualId=@ManualId AND SectionId=@SECTIONID
			
			INSERT INTO SMS_APP_ManualDetails 
			SELECT 
			ManualId,
			SectionId,
			ParentSectionId,
			Heading,
			SearchTags,
			FileName,
			FileContent,
			Approved,
			ApprovedOn,
			Status,
			''0.0'',
			ModifiedBy,
			ModifiedOn,
			ReqRemarks,
			AppRemarks,
			RejRemarks,
			NULL,
			NULL,
			NULL,
			NULL,
			NULL
			FROM SMS_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SECTIONID
			
			INSERT INTO SMS_APP_ManualDetailsForms 
			SELECT 
			ManualId,
			SectionId,
			FormID
			FROM SMS_ManualDetailsForms WHERE ManualId=@ManualId AND SectionId=@SECTIONID
	
			UPDATE SMS_ManualDetails SET SVERSION=''0.0'' WHERE ManualId=@ManualId AND SectionId=@SectionId
			
			UPDATE  DBO.SMS_APP_COM_ManualDetails 
			SET SNO=0
			,Scheduled=0
			,SENTDATE=NULL
			,SENDBY=NULL
			,AckStatus=''P''
			,ACKBY=NULL
			,ACKON=NULL
			WHERE  ManualId=@ManualId AND SectionId=@SectionId
			--------------------------------------------
		FETCH NEXT FROM CS INTO @SECTIONID
		END
		CLOSE CS
		DEALLOCATE CS
	END
END










' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_Cancel_Reject_Approval_Request]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Cancel_Reject_Approval_Request]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

-- EXEC [dbo].SMS_Cancel_Reject_Approval_Request 14,''1.3'',''c'',''REDFD''
CREATE PROCEDURE [dbo].[SMS_Cancel_Reject_Approval_Request]
	@ManualId bigint,
	@SectionId varchar(100),
	@Mode Char(1),
	@Remarks varchar(1000)
AS
BEGIN
	IF(@Mode=''C'') ------- CANCELLATION BY USER SELF
	BEGIN
		IF EXISTS(SELECT SECTIONID FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId)
		BEGIN
			UPDATE SMS_ManualDetails
			SET 
			HEADING=(SELECT HEADING FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId),
			[FILENAME]=(SELECT [FILENAME] FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId),
			FILECONTENT=(SELECT FILECONTENT FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId),
			APPROVED=(SELECT APPROVED FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId),
			APPROVEDON=(SELECT APPROVEDON FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId),
			STATUS=(SELECT STATUS FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId),
			SVERSION=(SELECT SVERSION FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId),
			MODIFIEDBY=(SELECT MODIFIEDBY FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId),
			MODIFIEDON=(SELECT MODIFIEDON FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId),
			ReqRemarks=(SELECT ReqRemarks FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId),
			AppRemarks=(SELECT AppRemarks FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId),
			RejRemarks=(SELECT RejRemarks FROM SMS_APP_ManualDetails WHERE ManualId=@ManualId AND SectionId=@SectionId)
			WHERE ManualId=@ManualId AND SectionId=@SectionId
			---------------------
			DELETE FROM SMS_ManualDetailsForms WHERE ManualId=@ManualId AND SectionId=@SectionId
			INSERT INTO SMS_ManualDetailsForms SELECT * FROM SMS_APP_ManualDetailsForms WHERE ManualId=@ManualId AND SectionId=@SectionId
		END
	END
	IF(@Mode=''R'') ------- REJECTION BY MD
	BEGIN
		UPDATE SMS_ManualDetails SET APPROVED=''J'',RejRemarks=@Remarks WHERE ManualId=@ManualId AND SectionId=@SectionId
	END
END












' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_Get_CommunicationData]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Get_CommunicationData]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
-- EXEC SMS_Get_CommunicationData ''''LIG''''
CREATE Proc [dbo].[SMS_Get_CommunicationData]
(
	@VesselCode Varchar(3)
)
AS
BEGIN
	DECLARE @VesselID INT
	SELECT @VesselID=VesselID FROM DBO.VESSEL WHERE VESSELCODE=@VesselCode
		

	Select * from dbo.SMS_APP_COM_ManualDetails Where Scheduled=1 And VesselID =@VesselID 
	Select * from dbo.SMS_APP_ManualMaster Where ManualID in (Select DISTINCT ManualID from dbo.SMS_APP_COM_ManualDetails Where Scheduled=1 And VesselID =@VesselID )

	Select MD.* from dbo.SMS_APP_ManualDetails MD Inner Join dbo.SMS_APP_COM_ManualDetails CMD 
	On CMD.ManualId=MD.ManualId And CMD.SectionID=MD.SectionID Where CMD.Scheduled=1 And CMD.VesselID =@VesselID 

	Select MF.* from SMS_APP_ManualDetailsForms MF Inner Join dbo.SMS_APP_COM_ManualDetails CMD 
	On CMD.ManualId=MF.ManualId And CMD.SectionID=MF.SectionID Where CMD.Scheduled=1 And CMD.VesselID =@VesselID 

	--Select * from dbo.SMS_Forms Where FormID in (
	--Select Distinct MF.FormID from SMS_APP_ManualDetailsForms MF Inner Join dbo.SMS_APP_COM_ManualDetails CMD 
	--On CMD.ManualId=MF.ManualId And CMD.SectionID=MF.SectionID Where CMD.Scheduled=1 And CMD.VesselID =@VesselID
	--)

	Select * from dbo.SMS_Forms Where FormID in (
		SELECT FORMID FROM [dbo].[SMS_APP_COM_Forms] WHERE VESSELID=@VesselID AND SCHEDULED=1 AND ACK_RECD=0
	)

	Select @VesselCode as VesselCode,ISNULL(Max(TableID),0)+1 as PacketID, 1 as Version from SMS_PacketSent Where VesselCode=@VesselCode

	SELECT ISNULL(MAX(CommentId), 0 ) As MaxCommentId FROM [dbo].[SMS_ShipComments]  Where VesselCode=@VesselCode

END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_Get_CommunicationData_VSL_SECTION]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Get_CommunicationData_VSL_SECTION]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



-- EXEC SMS_Get_CommunicationData_VSL_SECTION ''LIG'',1,''1.1''
CREATE Proc [dbo].[SMS_Get_CommunicationData_VSL_SECTION]
(
	@VesselCode Varchar(3),
	@ManualId bigint,
	@SectionId varchar(100)

)
AS
BEGIN
	DECLARE @VesselID INT
	SELECT @VesselID=VesselID FROM DBO.VESSEL WHERE VESSELCODE=@VesselCode
		

	Select * from dbo.SMS_APP_COM_ManualDetails Where VesselID =@VesselID AND ManualId=@ManualId AND LTRIM(RTRIM(SectionId))=LTRIM(RTRIM(@SectionId))
	Select * from dbo.SMS_APP_ManualMaster Where ManualID in (Select DISTINCT ManualID from dbo.SMS_APP_COM_ManualDetails Where ManualId=@ManualId AND LTRIM(RTRIM(SectionId))=LTRIM(RTRIM(@SectionId)))

	Select MD.* from dbo.SMS_APP_ManualDetails MD Inner Join dbo.SMS_APP_COM_ManualDetails CMD 
	On CMD.ManualId=MD.ManualId And CMD.SectionID=MD.SectionID Where CMD.VesselID =@VesselID AND MD.ManualId=@ManualId AND LTRIM(RTRIM(MD.SectionId))=LTRIM(RTRIM(@SectionId))

	Select MF.* from SMS_APP_ManualDetailsForms MF Inner Join dbo.SMS_APP_COM_ManualDetails CMD 
	On CMD.ManualId=MF.ManualId And CMD.SectionID=MF.SectionID Where CMD.VesselID =@VesselID AND MF.ManualId=@ManualId AND LTRIM(RTRIM(MF.SectionId))=LTRIM(RTRIM(@SectionId))

	Select * from dbo.SMS_Forms Where FormID=-9999

	Select @VesselCode as VesselCode,ISNULL(Max(TableID),0)+1 as PacketID, 1 as Version from SMS_PacketSent Where VesselCode=@VesselCode



	--Select * from dbo.SMS_APP_COM_ManualDetails Where Scheduled=1 And VesselID =@VesselID AND ManualId=@ManualId AND LTRIM(RTRIM(SectionId))=LTRIM(RTRIM(@SectionId))
	--Select * from dbo.SMS_APP_ManualMaster Where ManualID in (Select DISTINCT ManualID from dbo.SMS_APP_COM_ManualDetails Where Scheduled=1 AND ManualId=@ManualId AND LTRIM(RTRIM(SectionId))=LTRIM(RTRIM(@SectionId)))

	--Select MD.* from dbo.SMS_APP_ManualDetails MD Inner Join dbo.SMS_APP_COM_ManualDetails CMD 
	--On CMD.ManualId=MD.ManualId And CMD.SectionID=MD.SectionID Where CMD.Scheduled=1 And CMD.VesselID =@VesselID AND MD.ManualId=@ManualId AND LTRIM(RTRIM(MD.SectionId))=LTRIM(RTRIM(@SectionId))

	--Select MF.* from SMS_APP_ManualDetailsForms MF Inner Join dbo.SMS_APP_COM_ManualDetails CMD 
	--On CMD.ManualId=MF.ManualId And CMD.SectionID=MF.SectionID Where CMD.Scheduled=1 And CMD.VesselID =@VesselID AND MF.ManualId=@ManualId AND LTRIM(RTRIM(MF.SectionId))=LTRIM(RTRIM(@SectionId))

	--Select @VesselCode as VesselCode,ISNULL(Max(TableID),0)+1 as PacketID, 1 as Version from SMS_PacketSent Where VesselCode=@VesselCode


	SELECT ISNULL(MAX(CommentId), 0 ) As MaxCommentId FROM [dbo].[SMS_ShipComments]  Where VesselCode=@VesselCode

END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_ImportPublication]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ImportPublication]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

-- EXEC [dbo].[SMS_ImportPublication] ''ALC'',9,2013,2,''TESTPUBLICATION 2'',''COMMON'', ''MEDIA'', '''', ''Ship'', 2013, ''789+-546-13648646'', ''13-09-2013 00:00:00''

CREATE proc [dbo].[SMS_ImportPublication]
(
	@VESSELCODE char(3),
	@PUBMONTH int,
	@PUBYEAR int, 
	@PUBLICATIONID int,
	@PUBLICATIONNAME varchar(100) ,
	@TYPENAME varchar(50) ,
	@MODENAME varchar(50) ,
	@PUBLISHERNAME varchar(50) ,
	@OFFICESHIP varchar(50) ,
	@EDITIONYEAR int ,
	@EDITIONNO varchar(50) ,
	@VALIDITYDATE smalldatetime
)
as
BEGIN

	INSERT INTO [PB_VSL_Publication]
           ([VESSELCODE]
           ,[PUBMONTH]
           ,[PUBYEAR]
           ,[PUBLICATIONID]
           ,[PUBLICATIONNAME]
           ,[TYPENAME]
           ,[MODENAME]
           ,[PUBLISHERNAME]
           ,[OFFICESHIP]
           ,[EDITIONYEAR]
           ,[EDITIONNO]
           ,[VALIDITYDATE])
     VALUES
           (
		     @VESSELCODE,
			 @PUBMONTH,
			 @PUBYEAR, 
			 @PUBLICATIONID,
			 @PUBLICATIONNAME,
			 @TYPENAME,
			 @MODENAME,
			 @PUBLISHERNAME,
			 @OFFICESHIP,
			 @EDITIONYEAR,
			 @EDITIONNO,
			 @VALIDITYDATE
		   )
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_INSERT_ManualDetailsForms]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_INSERT_ManualDetailsForms]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[SMS_INSERT_ManualDetailsForms]
(
	@MANUALID bigint,
	@SECTIONID varchar(100),
	@FORMID bigint
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM SMS_ManualDetailsForms WHERE MANUALID=@MANUALID AND SECTIONID=@SECTIONID AND FORMID=@FORMID)
BEGIN
	INSERT INTO SMS_ManualDetailsForms
	(
		MANUALID ,
		SECTIONID ,
		FORMID 
	)
	Values
	(
		@MANUALID,
		@SECTIONID,
		@FORMID
	)
	END

	UPDATE SMS_MANUALDETAILS SET Approved='''' WHERE MANUALID=@ManualId AND LTRIM(RTRIM(SECTIONID))=LTRIM(RTRIM(@SECTIONID))
END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_INSERT_OfficeComments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_INSERT_OfficeComments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SMS_INSERT_OfficeComments]
(
	@ManualId bigint,
	@SectionId Varchar(100),
	@CommentText Varchar(5000),
	@CommentBy int,
	@ChangeRequested Char(1)
)
AS
BEGIN
SET NOCOUNT ON
     
	 DECLARE @CommentId bigint;
     SELECT @CommentId = ISNULL(MAX(CommentId),0) + 1 FROM [SMS_OfficeComments]
	  
	 DECLARE @MV Varchar(50)
	 DECLARE @SV Varchar(50)

	 SELECT @MV=VersionNo FROM SMS_APP_ManualMaster WHERE [ManualId] = @ManualId
	 SELECT @SV=SVersion FROM SMS_APP_ManualDetails WHERE [ManualId] = @ManualId AND [SectionId] = @SectionId

	 DECLARE @PositionId int
	 DECLARE @OfficeId int

	 SELECT @PositionId = [Position], @OfficeId = [Office] FROM [dbo].[Emtm_Hr_PersonalDetails] WHERE [UserId] = @CommentBy 

    
	INSERT INTO [SMS_OfficeComments]
	(
		[CommentId],
		[ManualId],
		[SectionId],
		[MVersion],
		[SVersion],
		[CommentText],
		[CommentBy],
		[CommentOn],
		[PositionId],
		[OfficeId],
		[ChangeRequested],
		[Status],
		[Stage],
		[ReqDate],
		[Updated],
		[UpdatedOn]
	)
	Values
	(
		@CommentId,
		@ManualId,
		@SectionId,
		@MV,
		@SV,
		@CommentText,
		@CommentBy,
		getdate(),
		@PositionId,
		@OfficeId,
		@ChangeRequested,
		''O'',
		''P'',
		getdate(),
		1,
		getdate()
	)
	
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_INSERT_ShipComments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_INSERT_ShipComments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SMS_INSERT_ShipComments]
(
	@VesselCode Char(3),	
	@ManualId bigint,
	@SectionId Varchar(100),
	@CommentText Varchar(5000),
	@CommentBy Varchar(50),
	@ComentByRank Varchar(50),
	@ChangeRequested Char(1)
)
AS
BEGIN
SET NOCOUNT ON
     
	 DECLARE @CommentId bigint;
     SELECT @CommentId = ISNULL(MAX(CommentId),0) + 1 FROM [SMS_ShipComments] WHERE  [VesselCode] = @VesselCode
	 DECLARE @MV Varchar(50)
	 DECLARE @SV Varchar(50)

	 SELECT @MV=VersionNo FROM SMS_APP_ManualMaster WHERE [ManualId] = @ManualId
	  SELECT @SV=SVersion FROM SMS_APP_ManualDetails WHERE [ManualId] = @ManualId AND [SectionId] = @SectionId
    
	INSERT INTO [SMS_ShipComments]
	(
		[VesselCode],
		[CommentId],
		[ManualId],
		[SectionId],
		[MVersion],
		[SVersion],
		[CommentText],
		[CommentBy],
		[CommentOn],
		[ReceivedInOffice],
		[ComentByRank],
		[ChangeRequested],
		[Status],
		[Stage],
		[ReqDate],
		[Updated],
		[UpdatedOn]
	)
	Values
	(
		@VesselCode,
		@CommentId,
		@ManualId,
		@SectionId,
		@MV,
		@SV,
		@CommentText,
		@CommentBy,
		getdate(),
		''N'',
		@ComentByRank,
		@ChangeRequested,
		''O'',
		''P'',
		getdate(),
		1,
		getdate()
	)
	
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_ReceiveAck]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ReceiveAck]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE Proc [dbo].[SMS_ReceiveAck]
(
	@VesselCode Varchar(3),
	@ManualID int ,
	@SectionID Varchar(50),
	@AckBy Varchar(200)
)
AS
BEGIN
	DECLARE @VESSELID INT
	SELECT 	@VESSELID =VESSELID FROM DBO.VESSEL WHERE VesselCode=@VesselCode
	
	Update dbo.SMS_APP_COM_ManualDetails set AckStatus=''R'',Ackon=Getdate(),AckBy=@AckBy
	Where 
	VesselID=@VESSELID And ManualID=@ManualID And SectionID=@SectionID AND ISNULL(Scheduled,0)=0

	--AckStatus=''S'' 

END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_ReceiveAck_Forms]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ReceiveAck_Forms]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE Proc [dbo].[SMS_ReceiveAck_Forms]
(
	@VESSELCODE CHAR(3),
	@FormNO Varchar(50),
	@FormID int 
)
AS
BEGIN
	DECLARE @VESSELID INT
	SELECT @VESSELID=VESSELID FROM DBO.VESSEL WHERE VESSELCODE=@VESSELCODE

	UPDATE SMS_APP_COM_Forms SET SCHEDULED=0,SCHEDULEDON=NULL,ACK_RECD=1,Ack_RecdOn=GETDATE() WHERE VESSELID=@VESSELID AND LTRIM(RTRIM(FormNO))=LTRIM(RTRIM(@FormNO)) AND FORMID<=@FormID
END


-------------------------------------------------





' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_ReceiveAck_ShipComments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ReceiveAck_ShipComments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE Proc [dbo].[SMS_ReceiveAck_ShipComments]
(
	@VesselCode Char(3),
	@CommentId bigint,
	@ManualId bigint,
	@SectionId varchar(100),
	@MVersion varchar(50),
	@SVersion varchar(50),
	@CommentText varchar(5000),
	@CommentBy varchar(50),
	@CommentOn smalldatetime,
	@ReceivedInOffice char(1)
)
AS
BEGIN
   
   IF NOT EXISTS (SELECT * FROM [SMS_ShipComments] WHERE [VesselCode] = @VesselCode AND [CommentId] = @CommentId)
   BEGIN	
	INSERT INTO [SMS_ShipComments]
		(
			[VesselCode],
			[CommentId],
			[ManualId],
			[SectionId],
			[MVersion],
			[SVersion],
			[CommentText],
			[CommentBy],
			[CommentOn],
			[ReceivedInOffice]
		)
		Values
		(
			@VesselCode,
			@CommentId,
			@ManualId,
			@SectionId,
			@MVersion,
			@SVersion,
			@CommentText,
			@CommentBy,
			@CommentOn,
			@ReceivedInOffice
		)

		END
	--ELSE
	--BEGIN
	--      UPDATE [SMS_ShipComments]
	--	     SET
			 
	--	  WHERE [VesselCode] = @VesselCode AND [CommentId] = @CommentId

	--END

END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_Review_ImportOfficeData]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Review_ImportOfficeData]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE Proc [dbo].[SMS_Review_ImportOfficeData]
(	
	@OfficeShip char(1),
	@VesselCode Varchar(3),
	@CommentId bigint,
	@ManualId bigint,
	@SectionId Varchar(100),
	@MVersion Varchar(50),
	@SVersion Varchar(50),
	@CommentText Varchar(5000),
	@CommentBy Varchar(50),
	@CommentOn Smalldatetime,
	@ReceivedInOffice char(1),
	@ComentByRank Varchar(50),
	@ChangeRequested char(1),
	@Status char(1),
	@Stage char(1),
	@ReqDate smalldatetime,
	@Updated bit,
	@UpdatedOn smalldatetime,
	@ClosedBy Varchar(50),
	@ClosedOn smalldatetime,
	@ClosureRemarks Varchar(1000) 

)
AS
BEGIN
	if(@OfficeShip=''S'')
	BEGIN
			IF NOT EXISTS (SELECT * FROM SMS_ShipComments WHERE [VesselCode]=@VesselCode  AND [CommentId]=@CommentId AND [ManualId]=@ManualId AND [SectionId]=@SectionId)
			BEGIN
				  INSERT INTO SMS_ShipComments
				  (
					VesselCode,
					CommentId,
					ManualId,
					SectionId,
					MVersion,
					SVersion,
					CommentText,
					CommentBy ,
					CommentOn ,
					ReceivedInOffice ,
					ComentByRank ,
					ChangeRequested ,
					Status ,
					Stage ,
					ReqDate ,
					Updated ,
					UpdatedOn ,
					ClosedBy ,
					ClosedOn ,
					ClosureRemarks 
				  )
				  VALUES
				  (
					@VesselCode,
					@CommentId,
					@ManualId,
					@SectionId,
					@MVersion,
					@SVersion,
					@CommentText,
					@CommentBy ,
					@CommentOn ,
					@ReceivedInOffice ,
					@ComentByRank ,
					@ChangeRequested ,
					@Status ,
					@Stage ,
					@ReqDate ,
					@Updated ,
					@UpdatedOn ,
					@ClosedBy ,
					@ClosedOn ,
					@ClosureRemarks
				  )

			END
			ELSE
			BEGIN
				   UPDATE SMS_ShipComments
					  SET   Status=@Status ,
							Stage=@Stage ,					
							ClosedBy=@ClosedBy ,
							ClosedOn=@ClosedOn ,
							ClosureRemarks=@ClosureRemarks  
					WHERE [VesselCode]=@VesselCode  AND [CommentId]=@CommentId AND [ManualId]=@ManualId AND [SectionId]=@SectionId
			END
	END
	ELSE
	BEGIN
			IF NOT EXISTS (SELECT * FROM SMS_ShipComments WHERE [VesselCode]=@VesselCode  AND [CommentId]=@CommentId AND [ManualId]=@ManualId AND [SectionId]=@SectionId)
			BEGIN
			INSERT INTO SMS_ShipComments
				  (
					VesselCode,
					CommentId,
					ManualId,
					SectionId,
					MVersion,
					SVersion,
					CommentText,
					CommentBy ,
					CommentOn ,
					ReceivedInOffice ,
					ComentByRank ,
					ChangeRequested ,
					Status ,
					Stage ,
					ReqDate ,
					Updated ,
					UpdatedOn ,
					ClosedBy ,
					ClosedOn ,
					ClosureRemarks 
				  )
				  VALUES
				  (
					@VesselCode,
					@CommentId,
					@ManualId,
					@SectionId,
					@MVersion,
					@SVersion,
					@CommentText,
					@CommentBy ,
					@CommentOn ,
					@ReceivedInOffice ,
					@ComentByRank ,
					@ChangeRequested ,
					@Status ,
					@Stage ,
					@ReqDate ,
					@Updated ,
					@UpdatedOn ,
					@ClosedBy ,
					@ClosedOn ,
					@ClosureRemarks
				  )

			END
			ELSE
			BEGIN
				IF EXISTS (SELECT * FROM SMS_ShipComments WHERE [VesselCode]=@VesselCode  AND [CommentId]=@CommentId AND [ManualId]=@ManualId AND [SectionId]=@SectionId AND ISNULL(STATUS,''O'')=''O'')
				BEGIN
					UPDATE SMS_ShipComments
					SET CommentText=@CommentText,
					CommentBy=@CommentBy ,					
					CommentOn=@CommentOn ,
					ComentByRank=@ComentByRank 
					WHERE [VesselCode]=@VesselCode  AND [CommentId]=@CommentId AND [ManualId]=@ManualId AND [SectionId]=@SectionId
				END
			END
	END
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_SCHEDULE_WHOLE_MANUAL]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_SCHEDULE_WHOLE_MANUAL]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROC [dbo].[SMS_SCHEDULE_WHOLE_MANUAL]
(
@VesselId Int,
@ManualId Int,
@UserName varchar(50)
)
AS
BEGIN
DECLARE @SECTIONID varchar(100)

DECLARE CS CURSOR FOR SELECT MD.SECTIONID FROM dbo.SMS_ManualDetails MD 
					  INNER JOIN dbo.SMS_ManualMaster MM ON MM.MANUALID=MD.MANUALID where MD.APPROVED=''A'' AND MD.MANUALID=@ManualId
					  ORDER BY MD.MANUALID,MD.SECTIONID
OPEN CS
FETCH NEXT FROM CS INTO @SECTIONID
WHILE(@@FETCH_STATUS=0)
BEGIN
----------------------------
IF NOT EXISTS(SELECT VESSELID FROM SMS_APP_COM_ManualDetails WHERE VESSELID=@VesselId AND ManualID=@ManualId AND LTRIM(RTRIM(SECTIONID))=LTRIM(RTRIM(@SECTIONID)))
BEGIN
	INSERT INTO DBO.SMS_APP_COM_ManualDetails(VesselID,ManualID,SectionID,SNO,Scheduled,AckStatus) 
	VALUES(@VesselId,@ManualId,@SECTIONID,0,0,''P'')
    --Select VesselTypeID,@ManualId,@SECTIONID,0,0,''P'' from DBO.SMS_ManualVesselType Where ManualID=@ManualId
    --And VesselTypeID not in (Select VesselID from DBO.SMS_APP_COM_ManualDetails Where ManualID=@ManualId And SectionID=@SECTIONID)
END

Update DBO.SMS_APP_COM_ManualDetails Set Scheduled=1,SendBy=@UserName,SentDate=null,AckOn=null,AckBy='''' Where VesselID=@VesselId And ManualID=@ManualId And LTRIM(RTRIM(SECTIONID))=LTRIM(RTRIM(@SECTIONID))
  
----------------------------
FETCH NEXT FROM CS INTO @SECTIONID
END
CLOSE CS
DEALLOCATE CS
END
 ' 
END
GO
/****** Object:  StoredProcedure [dbo].[SMS_Update_SearchTages]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Update_SearchTages]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE Proc [dbo].[SMS_Update_SearchTages]
(
	@MANUALID INT,
	@SECTIONID VARCHAR(100),
	@SEARCHTAGS VARCHAR(500)
)
AS
BEGIN
	Update Dbo.SMS_MANUALDETAILS set SEARCHTAGS=@SEARCHTAGS Where ManualID=@MANUALID And SectionID=@SECTIONID
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_ActiveInactive_Admin_Office_Components]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ActiveInactive_Admin_Office_Components]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



CREATE PROCEDURE [dbo].[sp_ActiveInactive_Admin_Office_Components]	
	@ComponentCode CHAR(12),
	@Mode CHAR(1)
AS
BEGIN
       -- Apply flagging and update status in Ship Tables                   
       UPDATE VSL_ComponentMasterForVessel
            SET Status = @Mode,
                Updated = 1,
                UpdatedOn = getdate()
       WHERE ComponentId IN ( SELECT ComponentId FROM ComponentMaster WHERE LEFT(ComponentCode, LEN(LTRIM(RTRIM(@ComponentCode)))) = @ComponentCode )
       
       IF (@Mode = ''I'')
       BEGIN  
       -- Delete permanently from setup tables
       
		   DELETE FROM VesselSpareMaster WHERE ComponentId IN ( SELECT ComponentId FROM ComponentMaster WHERE LEFT(ComponentCode, LEN(LTRIM(RTRIM(@ComponentCode)))) = @ComponentCode )
		   DELETE FROM VesselRunningHourMaster WHERE ComponentId IN ( SELECT ComponentId FROM ComponentMaster WHERE LEFT(ComponentCode, LEN(LTRIM(RTRIM(@ComponentCode)))) = @ComponentCode )
		   DELETE FROM VesselComponentJobMaster WHERE ComponentId IN ( SELECT ComponentId FROM ComponentMaster WHERE LEFT(ComponentCode, LEN(LTRIM(RTRIM(@ComponentCode)))) = @ComponentCode )
		   DELETE FROM ComponentMasterForVessel WHERE ComponentId IN ( SELECT ComponentId FROM ComponentMaster WHERE LEFT(ComponentCode, LEN(LTRIM(RTRIM(@ComponentCode)))) = @ComponentCode )
	       
       END
END    



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_ActiveInactive_Admin_Office_Jobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ActiveInactive_Admin_Office_Jobs]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


						
Create PROCEDURE [dbo].[sp_ActiveInactive_Admin_Office_Jobs]	
	@CompJobId INT,
	@Mode CHAR(1)
AS
BEGIN
       -- Apply flagging and update status in Ship Tables  
                        
       UPDATE VSL_VesselComponentJobMaster
            SET Status = @Mode,
                Updated = 1,
                UpdatedOn = getdate()
       WHERE CompJobId = @CompJobId
       
       IF (@Mode = ''I'')
       BEGIN  
       -- Delete permanently from setup tables
       		
		   DELETE FROM VesselRunningHourMaster WHERE ComponentId IN ( SELECT DISTINCT ComponentId FROM VesselComponentJobMaster WHERE CompJobId = @CompJobId AND IntervalId = 1)
		   DELETE FROM VesselComponentJobMaster WHERE CompJobId = @CompJobId
		   
	       
       END
END    



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_ActiveInactive_Admin_Ship_Components]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ActiveInactive_Admin_Ship_Components]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


-- EXEC [sp_ActiveInactive_Admin_Ship_Components] ''AGE'',45,''A''

CREATE PROCEDURE [dbo].[sp_ActiveInactive_Admin_Ship_Components]	
	@VesselCode CHAR(3),
	@ComponentCode  CHAR(12),
	@Mode CHAR(1)
AS
BEGIN 

       UPDATE VSL_ComponentMasterForVessel
            SET Status = @Mode,
                Updated = 1,
                UpdatedOn = getdate()
                
       WHERE VesselCode = @VesselCode  AND ComponentId IN ( SELECT ComponentId FROM ComponentMaster WHERE LEFT(ComponentCode, LEN(LTRIM(RTRIM(@ComponentCode)))) = @ComponentCode )
       
END    



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_ActiveInactive_Admin_Ship_Jobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ActiveInactive_Admin_Ship_Jobs]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

					   
Create PROCEDURE [dbo].[sp_ActiveInactive_Admin_Ship_Jobs]	
	@VesselCode CHAR(3),
	@CompJobId  INT,
	@Mode CHAR(1)
AS
BEGIN 

       UPDATE VSL_VesselComponentJobMaster
            SET Status = @Mode,
                Updated = 1,
                UpdatedOn = getdate()
                
       WHERE VesselCode = @VesselCode  AND CompJobId = @CompJobId
       
END    



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_ApproveCriticalShutdown]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ApproveCriticalShutdown]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROC [dbo].[sp_ApproveCriticalShutdown]
(
    @VesselCode CHAR(3),
    @ShutdownApproveId BigInt,
	@ShutdownId BigInt,
    @Approver_Name VARCHAR(50),
    @Approver_Position VARCHAR(50),
    @Approver_Remarks VARCHAR(5000)
)
AS 
BEGIN

    SELECT @ShutdownApproveId = ISNULL(MAX(ShutdownApproveId),0)+1 FROM VSL_CriticalShutdownApproval WHERE VesselCode = @VesselCode
    
        INSERT INTO VSL_CriticalShutdownApproval
          (
             ShutdownApproveId,
             VesselCode,
			 ShutdownId,
			 Approver_Name,
			 Approver_Position,
			 Approver_Remarks,
			 ApprovedOn,
			 Updated,
			 UpdatedOn
		   )
		 VALUES
		  (
		     @ShutdownApproveId,
		     @VesselCode,
			 @ShutdownId,
			 @Approver_Name,
			 @Approver_Position,
			 @Approver_Remarks,
			 getdate(),
			 1,
			 getdate()
		  
		  )
   
     

		
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_ApproveCriticalShutdownExtensions]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ApproveCriticalShutdownExtensions]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROC [dbo].[sp_ApproveCriticalShutdownExtensions]
(
    @VesselCode CHAR(3),
    @ExtensionApproveId BigInt,
	@ExtensionId BigInt,
    @Approver_Name VARCHAR(50),
    @Approver_Position VARCHAR(50),
    @Approver_Remarks VARCHAR(5000)
)
AS 
BEGIN

    SELECT @ExtensionApproveId = ISNULL(MAX(ExtensionApproveId),0)+1 FROM VSL_CriticalShutdownExtensionApproval WHERE VesselCode = @VesselCode
    
        INSERT INTO VSL_CriticalShutdownExtensionApproval
          (
             ExtensionApproveId,
             VesselCode,
			 ExtensionId,
			 Approver_Name,
			 Approver_Position,
			 Approver_Remarks,
			 ApprovedOn,
			 Updated,
			 UpdatedOn
		   )
		 VALUES
		  (
		     @ExtensionApproveId,
		     @VesselCode,
			 @ExtensionId,
			 @Approver_Name,
			 @Approver_Position,
			 @Approver_Remarks,
			 getdate(),
			 1,
			 getdate()
		  
		  )
  
  
		
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_CancelPlannedJob]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CancelPlannedJob]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


				  	
CREATE Proc [dbo].[sp_CancelPlannedJob]
(
@VesselCode CHAR(3),
@ComponentId INT,
@CompjobId INT,
@CancellationReason VARCHAR(500),
@ModifiedBy INT,
@C_DoneBy INT,
@C_DoneBy_Code VARCHAR(10),
@C_DoneBy_Name VARCHAR(50)

)
AS
BEGIN

       UPDATE VSL_PlanMaster 
	   SET CancellationReason = @CancellationReason,
	   CancellationDate = getdate(),
	   C_DoneBy = @C_DoneBy, 
	   C_DoneBy_Code = @C_DoneBy_Code,
	   C_DoneBy_Name = @C_DoneBy_Name,
	   Status = 4,
	   AssignedTo=0,
	   PlanDate=null,
	   ModifiedBy= @ModifiedBy,
	   ModifiedOn=getdate()  
       WHERE VesselCode = @VesselCode AND ComponentId = @ComponentId AND CompjobId = @CompjobId

       DECLARE @HistoryId INT
	   SELECT @HistoryId = ISNULL(MAX(HistoryId),0)+1 FROM VSL_VesselJobUpdateHistory    
	   INSERT INTO VSL_VesselJobUpdateHistory (HistoryId,VesselCode,CompJobId,ComponentId,jobId,Status,AssignedTo,PlanDate,LastDueDate,LastDueHours,NextDueDate,NextDueHours,LastRunningHourDate,LastRunningHour,DoneBy,DoneBy_Code,DoneBy_Name,DoneDate,DoneHour,ServiceReport,ConditionBefore,ConditionAfter,UpdateRemarks,Specify,[FileName],FileImage,ModifiedBy,ModifiedOn,PostPoneReason,PostPoneRemarks,P_DoneBy,P_DoneBy_Code,P_DoneBy_Name,PostPoneDate,CancellationReason,CancellationDate,C_DoneBy,C_DoneBy_Code,C_DoneBy_Name,Action)
       SELECT @HistoryId,VesselCode,CompJobId,ComponentId,jobId,Status,AssignedTo,PlanDate,LastDueDate,LastDueHours,NextDueDate,NextDueHours,LastRunningHourDate,LastRunningHour,DoneBy,DoneBy_Code,DoneBy_Name,DoneDate,DoneHour,ServiceReport,ConditionBefore,ConditionAfter,UpdateRemarks,Specify,[FileName],FileImage,ModifiedBy,ModifiedOn,PostPoneReason,PostPoneRemarks,P_DoneBy,P_DoneBy_Code,P_DoneBy_Name,PostPoneDate,CancellationReason,CancellationDate,C_DoneBy,C_DoneBy_Code,C_DoneBy_Name,''C'' FROM VSL_PlanMaster WHERE VesselCode=@VesselCode AND ComponentId=@ComponentId AND CompjobId=@CompjobId
       
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_CheckMaintenanceKPIData]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CheckMaintenanceKPIData]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

-- EXEC [sp_CheckMaintenanceKPIData] '''', 2013 ,2

CREATE PROC [dbo].[sp_CheckMaintenanceKPIData]
(
	@VesselCode char(3),
	@Year int,
	@Mnth int
)
AS
BEGIN
	declare @months table(Id int ,MonthName varchar(20))
	insert into @months values(1,''Jan'')
	insert into @months values(2,''Feb'')
	insert into @months values(3,''Mar'')
	insert into @months values(4,''Apr'')
	insert into @months values(5,''May'')
	insert into @months values(6,''Jun'')
	insert into @months values(7,''Jul'')
	insert into @months values(8,''Aug'')
	insert into @months values(9,''Sep'')
	insert into @months values(10,''Oct'')
	insert into @months values(11,''Nov'')
	insert into @months values(12,''Dec'')

	IF(LTRIM(RTRIM(@VesselCode))='''')
	BEGIN
		SELECT *,DueJobs+OverDueJobs as TotalJobs, LEFT(ROUND(((Convert(float,(OutstandingJobs)) * 100)/ Convert(float,(DueJobs+OverdueJobs))), 2),5) AS OutstandingPer ,(select monthname from @months where id=[month]) as MonthName FROM VSL_MaintenanceKPI WHERE [YEAR]=@Year AND [MONTH]<=@Mnth
	END
	ELSE
	BEGIN
		SELECT *,DueJobs+OverDueJobs as TotalJobs, LEFT(ROUND(((Convert(float,(OutstandingJobs)) * 100)/ Convert(float,(DueJobs+OverdueJobs))), 2),5) AS OutstandingPer ,(select monthname from @months where id=[month]) as MonthName FROM VSL_MaintenanceKPI WHERE VESSELCODE=@VesselCode AND [YEAR]=@Year AND [MONTH]<=@Mnth
	END

--DECLARE @month int
--SET @month = 1
--
--WHILE(@month < 13)
--BEGIN
--    IF NOT EXISTS(SELECT * FROM VSL_MaintenanceKPI WHERE VesselCode = @VesselCode AND [Year]=@Year AND [Month]=@Month )
--	BEGIN
--		 INSERT INTO VSL_MaintenanceKPI 
--		 (
--		   VesselCode,
--		   [Year],
--		   [Month]
--		 )
--		 VALUES
--		 (
--			@VesselCode,
--			@Year,
--			@Month
--		 )
--
--
--	END 
-- SET @month = @month + 1
--END


--SELECT VesselCode,[Year],[Month],SubString(datename(month,dateadd(month, [Month] - 1, 0)),0,4) AS Month1,DueJobs,OverDueJobs,Postponed_Other,Postponed_Docking,JobsDone,TotalSystemJobs,OD1Week,OD2Week,ODMorethan2week,JobsDone_DueinSameMonth,PublishedByOn,
--(DueJobs+OverDueJobs-Postponed_Other-Postponed_Docking) AS TotalJobs,((DueJobs+OverDueJobs-Postponed_Other-Postponed_Docking)-JobsDone) AS OutstandingJobs,
--SubString(convert(varchar, (Convert(float,((DueJobs+OverDueJobs-Postponed_Other-Postponed_Docking)-JobsDone)) * 100)/ Convert(float,(DueJobs+OverDueJobs-Postponed_Other-Postponed_Docking))),0,6) AS OutstandingPercent,
--SubString(convert(varchar, (Convert(float,((DueJobs+OverDueJobs-Postponed_Other-Postponed_Docking)-JobsDone)) * 100)/Convert(float,TotalSystemJobs)),0,6) AS KPIPercent
--FROM (
--		SELECT M.VesselCode,M.[Year],M.[Month],M.DueJobs,M.OverDueJobs,M.Postponed_Other,M.Postponed_Docking,M.JobsDone,M.TotalSystemJobs,OD1Week,OD2Week,ODMorethan2week,JobsDone_DueinSameMonth,
--		((SELECT ul.FirstName + '' '' + ul.LastName FROM dbo.userlogin ul WHERE loginid=M.PublishedBy)+ ''/ '' + REPLACE(CONVERT(VARCHAR(11), PublishedOn,106),'' '',''-'')) AS PublishedByOn
--		FROM VSL_MaintenanceKPI M WHERE VesselCode=@VesselCode AND [Year]= @Year
--	 )a
		
END

 

 ' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_CheckMaintenanceKPIData_ShipData]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CheckMaintenanceKPIData_ShipData]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


-- EXEC [sp_CheckMaintenanceKPIData_ShipData] ''LIG'', 2013 ,2

create PROC [dbo].[sp_CheckMaintenanceKPIData_ShipData]
(
	@VesselCode char(3),
	@Year int,
	@Mnth int
)
AS
BEGIN
	declare @months table(Id int ,MonthName varchar(20))
	insert into @months values(1,''Jan'')
	insert into @months values(2,''Feb'')
	insert into @months values(3,''Mar'')
	insert into @months values(4,''Apr'')
	insert into @months values(5,''May'')
	insert into @months values(6,''Jun'')
	insert into @months values(7,''Jul'')
	insert into @months values(8,''Aug'')
	insert into @months values(9,''Sep'')
	insert into @months values(10,''Oct'')
	insert into @months values(11,''Nov'')
	insert into @months values(12,''Dec'')

	IF(LTRIM(RTRIM(@VesselCode))='''')
	BEGIN
		SELECT *,DueJobs+OverDueJobs as TotalJobs,(select monthname from @months where id=[month]) as MonthName FROM SHIP_MaintenanceKPI WHERE [YEAR]=@Year AND [MONTH]<=@Mnth
	END
	ELSE
	BEGIN
		SELECT *,DueJobs+OverDueJobs as TotalJobs,(select monthname from @months where id=[month]) as MonthName FROM SHIP_MaintenanceKPI WHERE VESSELCODE=@VesselCode AND [YEAR]=@Year AND [MONTH]<=@Mnth
	END

		
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_CopyComponent]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CopyComponent]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

-- EXEC [sp_CopyComponent] ''102.07'', ''890.01''
CREATE PROC [dbo].[sp_CopyComponent]
(
	@CopyingComponent CHAR(12),
	@NewCode CHAR(12)
)
AS
BEGIN
	
     DECLARE @MAXLENGTH INT; 
     SET @MAXLENGTH = 0;
         
	 SELECT @MAXLENGTH = MAX(LEN(LTRIM(RTRIM(REPLACE(ComponentCode,@CopyingComponent,@NewCode))))) FROM ComponentMaster WHERE LEFT(ComponentCode,len(@CopyingComponent))= RTRIM(LTRIM(@CopyingComponent))
     PRINT 	@MAXLENGTH
     IF(@MAXLENGTH>12)
     BEGIN
		SELECT 1 -- MOVING COMPONENT GOING MORE THAN 4 LEVEL
	 END
	 ELSE
	 BEGIN
		 IF(EXISTS(SELECT * FROM COMPONENTMASTER WHERE LTRIM(RTRIM(COMPONENTCODE))=LTRIM(RTRIM(@NewCode))))
		 BEGIN
			SELECT 2 -- COMPONENT WITH SAME CODE ALREADY EXISTS
		 END
		 ELSE
		 BEGIN
		 
		    DECLARE @COMPCODE varchar(12)
		    DECLARE @COMPNAME varchar(100)
		    DECLARE @Descr   varchar(500)
		    DECLARE @ClassEquip bit
		    DECLARE @CriticalEquip bit
		    DECLARE @Inactive bit
		
   	  
	DECLARE Component_cursor CURSOR FOR
	SELECT ComponentCode=REPLACE(ComponentCode,RTRIM(LTRIM(@CopyingComponent)),@NewCode),ComponentName,Descr,ClassEquip,CriticalEquip,Inactive
	FROM ComponentMaster
	WHERE LEFT(ComponentCode,len(@CopyingComponent))= RTRIM(LTRIM(@CopyingComponent))

	OPEN Component_cursor	
	FETCH NEXT FROM Component_cursor into @COMPCODE,@COMPNAME,@Descr,@ClassEquip,@CriticalEquip,@Inactive
	WHILE @@FETCH_STATUS = 0
	BEGIN
	        DECLARE @ComponentId INT
		    SELECT  @ComponentId = ISNULL(MAX(ComponentId),0)+1 FROM ComponentMaster
	
	        INSERT INTO ComponentMaster (ComponentId,ComponentCode,ComponentName,Descr,ClassEquip,CriticalEquip,Inactive) Values (@ComponentId,@COMPCODE,@COMPNAME,@Descr,@ClassEquip,@CriticalEquip,@Inactive)
	        
	 
	 Declare @JobId INT
     Declare @AssignTo INT
     Declare @DeptId INT
     Declare @IntervalId INT
     Declare @IsFixed INT
	 Declare @DescrSh varchar(250)
	 Declare @DescrM varchar(5000)
	 Declare @AttachmentForm varchar(50)
	 Declare @RiskAssessment varchar(50)
   	  
	DECLARE ComponentJob_cursor CURSOR FOR
	SELECT JobId,AssignTo,DeptId,IntervalId,IsFixed,DescrSh,DescrM,AttachmentForm,RiskAssessment FROM ComponentsJobMapping WHERE ComponentId = (SELECT ComponentId FROM ComponentMaster WHERE ComponentCode = REPLACE(@COMPCODE,LEFT(@COMPCODE,LEN(@CopyingComponent)),@CopyingComponent))

	OPEN ComponentJob_cursor	
	FETCH NEXT FROM ComponentJob_cursor into @JobId,@AssignTo,@DeptId,@IntervalId,@IsFixed,@DescrSh,@DescrM,@AttachmentForm,@RiskAssessment
	WHILE @@FETCH_STATUS = 0
	BEGIN
	 	        DECLARE @CompJobId INT
	 	        SELECT @CompJobId = ISNULL(MAX(CompJobId),0)+1 FROM ComponentsJobMapping 
	 	        
				INSERT INTO ComponentsJobMapping
				(      ComponentId,
					   JobId,
					   CompJobId,
					   AssignTo,  
					   DeptId,           
					   IntervalId,
					   IsFixed,
					   DescrSh,
					   DescrM,
					   AttachmentForm,
					   RiskAssessment
			            
				)
				 VALUES
				(
					  @ComponentId,
					  @JobId,
					  @CompJobId,
					  @AssignTo,                 
					  @DeptId,          
					  @IntervalId,
					  @IsFixed,
					  @DescrSh,
					  @DescrM,
					  @AttachmentForm,
					  @RiskAssessment
				)
	  
	FETCH NEXT FROM ComponentJob_cursor into @JobId,@AssignTo,@DeptId,@IntervalId,@IsFixed,@DescrSh,@DescrM,@AttachmentForm,@RiskAssessment	
	END
	CLOSE ComponentJob_cursor
	DEALLOCATE ComponentJob_cursor
	        
	  
	FETCH NEXT FROM Component_cursor into @COMPCODE,@COMPNAME,@Descr,@ClassEquip,@CriticalEquip,@Inactive
	END
	CLOSE Component_cursor
	DEALLOCATE Component_cursor
	  SELECT 0
		 END		
	 END
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_CopyComponentJob]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CopyComponentJob]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROC [dbo].[sp_CopyComponentJob]
(
	@TreeSelectedCompCode CHAR(12),
	@ToCompCode CHAR(12),
	@Copy_CompJobId bigint
)
AS
BEGIN
	-- exec  [dbo].[sp_CopyComponentJob] ''200.02.01'',''200.03''
	DECLARE @COPYLIST table (SORUCEFILE VARCHAR(50),DESTFILE VARCHAR(50))
    Declare @JobId INT
    Declare @AssignTo INT
    Declare @DeptId INT
    Declare @IntervalId INT
    Declare @IsFixed INT
	Declare @DescrSh varchar(250)
	Declare @DescrM varchar(5000)
	Declare @AttachmentForm varchar(50)
	Declare @RiskAssessment varchar(50)
	Declare @SCompJobId BigInt
   	  
	DECLARE @VT TABLE (SNO BIGINT,DESCR VARCHAR(500),DOCUMENTTYPE VARCHAR(5),STATUS CHAR(1),SFILE VARCHAR(50)) 
    DECLARE @MaxTableId BIGINT
	SET @MaxTableId=0
	
	Declare @SelectedComponentId INT
	SELECT @SelectedComponentId=COMPONENTID FROM COMPONENTMASTER CM WHERE LTRIM(RTRIM(CM.COMPONENTCODE))=LTRIM(RTRIM(@ToCompCode))

	IF(@Copy_CompJobId>0)
		DECLARE ComponentJob_cursor CURSOR FOR SELECT JobId,AssignTo,DeptId,IntervalId,IsFixed,DescrSh,DescrM,AttachmentForm,RiskAssessment,CompJobId FROM ComponentsJobMapping WHERE ComponentId = (SELECT ComponentId FROM ComponentMaster WHERE ComponentCode = @TreeSelectedCompCode ) AND CompJobId=@Copy_CompJobId
	ELSE
		DECLARE ComponentJob_cursor CURSOR FOR SELECT JobId,AssignTo,DeptId,IntervalId,IsFixed,DescrSh,DescrM,AttachmentForm,RiskAssessment,CompJobId FROM ComponentsJobMapping WHERE ComponentId = (SELECT ComponentId FROM ComponentMaster WHERE ComponentCode = @TreeSelectedCompCode )

	OPEN ComponentJob_cursor	
	FETCH NEXT FROM ComponentJob_cursor into @JobId,@AssignTo,@DeptId,@IntervalId,@IsFixed,@DescrSh,@DescrM,@AttachmentForm,@RiskAssessment,@SCompJobId	
	WHILE @@FETCH_STATUS = 0
	BEGIN
	     IF NOT EXISTS (SELECT * FROM ComponentsJobMapping WHERE ComponentId = @SelectedComponentId AND JobId = @JobId  AND LTRIM(RTRIM(LOWER(DescrSh))) = LTRIM(RTRIM(LOWER(@DescrSh))) )
	 	   BEGIN
	 	        DECLARE @CompJobId INT
	 	        SELECT @CompJobId = ISNULL(MAX(CompJobId),0)+1 FROM ComponentsJobMapping 
				INSERT INTO ComponentsJobMapping
				(      ComponentId,
					   JobId,
					   CompJobId,
					   AssignTo,  
					   DeptId,           
					   IntervalId,
					   IsFixed,
					   DescrSh,
					   DescrM,
					   AttachmentForm,
					   RiskAssessment
			            
				)
				 VALUES
				(
					  @SelectedComponentId,
					  @JobId,
					  @CompJobId,
					  @AssignTo,                 
					  @DeptId,          
					  @IntervalId,
					  @IsFixed,
					  @DescrSh,
					  @DescrM,
					  @AttachmentForm,
					  @RiskAssessment
				)
		
	 		   DELETE FROM @VT
			   INSERT INTO @VT SELECT ROW_NUMBER() OVER(ORDER BY TABLEID),Descr,DocumentType,Status, ''OfficeDoc_'' + convert(varchar,Compjobid) + ''_'' + convert(varchar,TABLEID) + ''.'' + DocumentType FROM dbo.ComponentsJobMapping_Attachments WHERE COMPJOBID=@SCompJobId
			   SELECT @MaxTableId =ISNULL(MAX(TableId),0)+1 FROM dbo.ComponentsJobMapping_Attachments
		
			   INSERT INTO @COPYLIST
			   SELECT SFILE,''OfficeDoc_'' + convert(varchar,@CompJobId) + ''_'' + convert(varchar,@MaxTableId+SNO) + ''.'' + DocumentType FROM @VT 

			   INSERT INTO ComponentsJobMapping_Attachments
			   SELECT @MaxTableId+SNO,@CompJobId,Descr,DocumentType,Status FROM @VT

		   END

	FETCH NEXT FROM ComponentJob_cursor into @JobId,@AssignTo,@DeptId,@IntervalId,@IsFixed,@DescrSh,@DescrM,@AttachmentForm,@RiskAssessment,@SCompJobId
	END
	CLOSE ComponentJob_cursor
	DEALLOCATE ComponentJob_cursor

	SELECT * FROM @COPYLIST
END

--




' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_CopyVessel]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CopyVessel]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
				  				  
CREATE PROC [dbo].[sp_CopyVessel]
(
	@VesselCodeTo CHAR(3),
	@VesselCodeFrom  CHAR(3)
)
AS
BEGIN
    --------------- DETETE ALL DATA IF EXISTS ----------------------------
	 
    DELETE FROM ComponentMasterForVessel WHERE VesselCode = @VesselCodeTo
	DELETE FROM VesselComponentJobMaster_Attachments WHERE VesselCode = @VesselCodeTo
    DELETE FROM VesselComponentJobMaster WHERE VesselCode = @VesselCodeTo
    DELETE FROM VesselRunningHourMaster WHERE VesselCode = @VesselCodeTo
    DELETE FROM VesselSpareMaster WHERE VesselCode = @VesselCodeTo
     

	DECLARE @ComponentId BIGINT
    DECLARE @Maker VARCHAR(50)
    DECLARE @MakerType VARCHAR(50)
    DECLARE @ClassEquipCode VARCHAR(30)
	DECLARE @CLASSEQUIP BIT
	DECLARE @ACCOUNTCODES VARCHAR(30)
     
	--------------- Copy Vessel FOR RUNNING VESSEL DATA ----------------------------
   	  
	--INSERT INTO ComponentMasterForVessel SELECT VESSELCODE,COMPONENTID,MAKER,MAKERTYPE,CLASSEQUIPCODE,DESCR FROM [dbo].[VSL_ComponentMasterForVessel] WHERE VesselCode = @VesselCodeFrom and Status=''''A''''


	DECLARE CopyVesselComp_cursor CURSOR FOR
	SELECT COMPONENTID,MAKER,MAKERTYPE,CLASSEQUIPCODE,CLASSEQUIP,ACCOUNTCODES FROM [dbo].[VSL_ComponentMasterForVessel] WHERE VesselCode = @VesselCodeFrom and Status=''A''
	-------SELECT ComponentId,Maker,MakerType,ClassEquipCode FROM ComponentMasterForVessel WHERE VesselCode = @VesselCodeFrom

	OPEN CopyVesselComp_cursor	
	FETCH NEXT FROM CopyVesselComp_cursor INTO @ComponentId,@Maker,@MakerType,@ClassEquipCode,@CLASSEQUIP,@ACCOUNTCODES	
	WHILE @@FETCH_STATUS = 0
	BEGIN
	 	        
	INSERT INTO ComponentMasterForVessel
    (    
         VesselCode,
         ComponentId,
         Maker,
         MakerType,
         ClassEquipCode,
		 CLASSEQUIP,
		 ACCOUNTCODES
	)
     VALUES
	(
	      @VesselCodeTo,
	      @ComponentId,
          @Maker,
          @MakerType,
          @ClassEquipCode,
		  @CLASSEQUIP,
		  @ACCOUNTCODES
	)

	--- COPY SPARES
	INSERT INTO VesselSpareMaster(VesselCode,ComponentId,Office_Ship,SpareId,SpareName,Maker,MakerType,PartNo,AltPartNo,Location,MinQty,MaxQty,StatutoryQty,Weight,Stock,Specification,DrawingNo,Attachment)
	SELECT @VesselCodeTo,ComponentId,Office_Ship,SpareId,SpareName,Maker,MakerType,PartNo,AltPartNo,Location,MinQty,MaxQty,StatutoryQty,Weight,Stock,Specification,DrawingNo,Attachment FROM VSL_VesselSpareMaster WHERE VesselCode=@VesselCodeFrom AND ComponentId=@ComponentId

	FETCH NEXT FROM CopyVesselComp_cursor INTO @ComponentId,@Maker,@MakerType,@ClassEquipCode,@CLASSEQUIP,@ACCOUNTCODES	
	END
	CLOSE CopyVesselComp_cursor
	DEALLOCATE CopyVesselComp_cursor
	
	DECLARE @CompJobId BIGINT
	DECLARE @JobId BIGINT
	DECLARE @AssignTo INT
	DECLARE @IntervalId INT
	DECLARE @Interval FLOAT
	DECLARE @IsFixed SMALLINT
	DECLARE @StartDate SMALLDATETIME
	DECLARE @DescrM VARCHAR(5000)
	DECLARE @IntervalId_H INT
	DECLARE @Interval_H FLOAT
	
	
	DECLARE CopyVesselCompJob_cursor CURSOR FOR
	SELECT CompJobId,ComponentId,JobId,AssignTo,IntervalId,Interval,IsFixed,StartDate,DescrM,IntervalId_H,Interval_H FROM VSL_VesselComponentJobMaster WHERE VesselCode = @VesselCodeFrom AND STATUS=''A''
	-------SELECT CompJobId,ComponentId,JobId,AssignTo,IntervalId,Interval,IsFixed,StartDate,DescrM,IntervalId_H,Interval_H FROM VesselComponentJobMaster WHERE VesselCode = @VesselCodeFrom

	OPEN CopyVesselCompJob_cursor	
	FETCH NEXT FROM CopyVesselCompJob_cursor INTO @CompJobId,@ComponentId,@JobId,@AssignTo,@IntervalId,@Interval,@IsFixed,@StartDate,@DescrM,@IntervalId_H,@Interval_H
	WHILE @@FETCH_STATUS = 0
	BEGIN
	 	       
	 	        
	INSERT INTO VesselComponentJobMaster
    (    
         VesselCode,
         CompJobId,
         ComponentId,
         JobId,
         AssignTo,
         IntervalId,
         Interval,
         IsFixed,
         StartDate,
         DescrM,
         IntervalId_H,
         Interval_H
         
	)
     VALUES
	(
	      @VesselCodeTo,
	      @CompJobId,
	      @ComponentId,
          @JobId,
          @AssignTo,
          @IntervalId,
          @Interval,
          @IsFixed,
          @StartDate,
          @DescrM,
          @IntervalId_H,
          @Interval_H
	)
	--- COPY ATTCHMENTS
	INSERT INTO	VesselComponentJobMaster_Attachments(VESSELCODE,TABLEID,COMPJOBID,DESCR,DOCUMENTTYPE) 
	SELECT @VesselCodeTo,TABLEID,COMPJOBID,DESCR,DOCUMENTTYPE FROM VSL_VesselComponentJobMaster_Attachments WHERE VESSELCODE=@VesselCodeFrom AND COMPJOBID=@CompJobId
	-------SELECT @VesselCodeTo,TABLEID,COMPJOBID,DESCR,DOCUMENTTYPE FROM VesselComponentJobMaster_Attachments WHERE VESSELCODE=@VesselCodeFrom AND COMPJOBID=@CompJobId
    
	FETCH NEXT FROM CopyVesselCompJob_cursor INTO @CompJobId,@ComponentId,@JobId,@AssignTo,@IntervalId,@Interval,@IsFixed,@StartDate,@DescrM,@IntervalId_H,@Interval_H	
	END
	CLOSE CopyVesselCompJob_cursor
	DEALLOCATE CopyVesselCompJob_cursor
        
    --------------- Copy Vessel FOR OLD SHIP VESSEL SETUP ----------------------------
     
 ----    DECLARE @ComponentId BIGINT
 ----    DECLARE @Maker VARCHAR(50)
 ----    DECLARE @MakerType VARCHAR(50)
 ----    DECLARE @ClassEquipCode VARCHAR(30)
     
   	  
	----DECLARE CopyVesselComp_cursor CURSOR FOR
	----SELECT ComponentId,Maker,MakerType,ClassEquipCode FROM ComponentMasterForVessel WHERE VesselCode = @VesselCodeFrom


	----OPEN CopyVesselComp_cursor	
	----FETCH NEXT FROM CopyVesselComp_cursor INTO @ComponentId,@Maker,@MakerType,@ClassEquipCode	
	----WHILE @@FETCH_STATUS = 0
	----BEGIN
	 	       
	 	        
	----INSERT INTO ComponentMasterForVessel
 ----   (    
 ----        VesselCode,
 ----        ComponentId,
 ----        Maker,
 ----        MakerType,
 ----        ClassEquipCode
	----)
 ----    VALUES
	----(
	----      @VesselCodeTo,
	----      @ComponentId,
 ----         @Maker,
 ----         @MakerType,
 ----         @ClassEquipCode
	----)

	----FETCH NEXT FROM CopyVesselComp_cursor INTO @ComponentId,@Maker,@MakerType,@ClassEquipCode	
	----END
	----CLOSE CopyVesselComp_cursor
	----DEALLOCATE CopyVesselComp_cursor
	
	----DECLARE @CompJobId BIGINT
	----DECLARE @JobId BIGINT
	----DECLARE @AssignTo INT
	----DECLARE @IntervalId INT
	----DECLARE @Interval FLOAT
	----DECLARE @IsFixed SMALLINT
	----DECLARE @StartDate SMALLDATETIME
	----DECLARE @DescrM VARCHAR(5000)
	----DECLARE @IntervalId_H INT
	----DECLARE @Interval_H FLOAT
	
	
	----DECLARE CopyVesselCompJob_cursor CURSOR FOR
	----SELECT CompJobId,ComponentId,JobId,AssignTo,IntervalId,Interval,IsFixed,StartDate,DescrM,IntervalId_H,Interval_H FROM VesselComponentJobMaster WHERE VesselCode = @VesselCodeFrom


	----OPEN CopyVesselCompJob_cursor	
	----FETCH NEXT FROM CopyVesselCompJob_cursor INTO @CompJobId,@ComponentId,@JobId,@AssignTo,@IntervalId,@Interval,@IsFixed,@StartDate,@DescrM,@IntervalId_H,@Interval_H
	----WHILE @@FETCH_STATUS = 0
	----BEGIN
	 	       
	 	        
	----INSERT INTO VesselComponentJobMaster
 ----   (    
 ----        VesselCode,
 ----        CompJobId,
 ----        ComponentId,
 ----        JobId,
 ----        AssignTo,
 ----        IntervalId,
 ----        Interval,
 ----        IsFixed,
 ----        StartDate,
 ----        DescrM,
 ----        IntervalId_H,
 ----        Interval_H
         
	----)
 ----    VALUES
	----(
	----      @VesselCodeTo,
	----      @CompJobId,
	----      @ComponentId,
 ----         @JobId,
 ----         @AssignTo,
 ----         @IntervalId,
 ----         @Interval,
 ----         @IsFixed,
 ----         @StartDate,
 ----         @DescrM,
 ----         @IntervalId_H,
 ----         @Interval_H
	----)
	------- COPY ATTCHMENTS
	----INSERT INTO	VesselComponentJobMaster_Attachments(VESSELCODE,TABLEID,COMPJOBID,DESCR,DOCUMENTTYPE) 
	----SELECT @VesselCodeTo,TABLEID,COMPJOBID,DESCR,DOCUMENTTYPE FROM VesselComponentJobMaster_Attachments WHERE VESSELCODE=@VesselCodeFrom AND COMPJOBID=@CompJobId
  
	----FETCH NEXT FROM CopyVesselCompJob_cursor INTO @CompJobId,@ComponentId,@JobId,@AssignTo,@IntervalId,@Interval,@IsFixed,@StartDate,@DescrM,@IntervalId_H,@Interval_H	
	----END
	----CLOSE CopyVesselCompJob_cursor
	----DEALLOCATE CopyVesselCompJob_cursor
	
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_CriticalShutdownClosure]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_CriticalShutdownClosure]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'  
  
  
CREATE PROC [dbo].[sp_CriticalShutdownClosure]  
(  
    @VesselCode CHAR(3),  
 @ShutdownId BigInt,  
    @Ma_CommencedDateTime SMALLDATETIME,  
    @Ma_CompletedDateTime SMALLDATETIME,  
    @Maintenence_Remarks VARCHAR(5000)  
)  
AS   
BEGIN  
        UPDATE VSL_CriticalEquipShutdownRequest  
           SET  Ma_CommencedDateTime = @Ma_CommencedDateTime,  
    Ma_CompletedDateTime = @Ma_CompletedDateTime,  
    Maintenence_Remarks = @Maintenence_Remarks,  
    Closed = 1,  
       Updated = 1,  
       UpdatedOn = getdate()  
    WHERE VesselCode = @VesselCode AND ShutdownId = @ShutdownId   
     
    
    
END  
  
  
  
  ' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Delete_Office_Components]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Delete_Office_Components]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

					   
CREATE PROCEDURE [dbo].[sp_Delete_Office_Components]
	@ComponentCode CHAR(12)
AS
BEGIN
DECLARE @VesselCode CHAR(3)
    IF Exists (SELECT CV.* FROM ComponentMasterForVessel CV INNER JOIN ComponentMaster CM ON CM.ComponentId = CV.ComponentId WHERE LTRIM(RTRIM(CM.ComponentCode)) = LTRIM(RTRIM(@ComponentCode)))
		BEGIN
		     SELECT TOP 1 @VesselCode=VesselCode FROM ComponentMasterForVessel CV  INNER JOIN ComponentMaster CM ON CM.ComponentId = CV.ComponentId WHERE LTRIM(RTRIM(CM.ComponentCode)) = LTRIM(RTRIM(@ComponentCode))
	         --SELECT ''Can not delete. Component is being used in vessel '' + CAST(@VesselCode AS VARCHAR) + ''.''
	         SELECT ''Can not delete this record due to references.Ask admin  to do the same.''
		END
    ELSE
        BEGIN
			 IF EXISTS (SELECT * FROM ComponentMasterForVessel WHERE ComponentId IN (SELECT ComponentId FROM ComponentMaster WHERE ComponentCode <> @ComponentCode  AND LEFT(ComponentCode, LEN(LTRIM(RTRIM(@ComponentCode)))) = LTRIM(RTRIM(@ComponentCode))))
			   BEGIN
					 --SELECT ''Can not delete. Child components are being used in Vessel.''
					 SELECT ''Can not delete this record due to references.Ask admin  to do the same.''
			   END
			 ELSE
			   BEGIN
			      IF EXISTS (SELECT CV.* FROM  VSL_ComponentMasterForVessel CV INNER JOIN ComponentMaster CM ON CM.ComponentId = CV.ComponentId WHERE LTRIM(RTRIM(CM.ComponentCode)) = LTRIM(RTRIM(@ComponentCode)))
					 BEGIN
						  SELECT TOP 1 @VesselCode=VesselCode FROM VSL_ComponentMasterForVessel CV INNER JOIN ComponentMaster CM ON CM.ComponentId = CV.ComponentId WHERE LTRIM(RTRIM(CM.ComponentCode)) = LTRIM(RTRIM(@ComponentCode))
						  --SELECT ''Can not delete. Component is being used in vessel '' + CAST(@VesselCode AS VARCHAR) + ''.''
						  SELECT ''Can not delete this record due to references.Ask admin  to do the same.''
					 END
				  ELSE
					 BEGIN
					    IF EXISTS (SELECT * FROM VSL_ComponentMasterForVessel WHERE ComponentId IN (SELECT ComponentId FROM ComponentMaster WHERE LTRIM(RTRIM(ComponentCode)) <> LTRIM(RTRIM(@ComponentCode)) AND LEFT(ComponentCode, LEN(LTRIM(RTRIM(@ComponentCode)))) = LTRIM(RTRIM(@ComponentCode))))
						  BEGIN
						      --SELECT ''Can not delete. Child components are being used in Ship.'' 
						      SELECT ''Can not delete this record due to references.Ask admin  to do the same.''
						  END
						ELSE
						  BEGIN
						     DELETE FROM ComponentsJobMapping WHERE ComponentId IN (SELECT ComponentId FROM ComponentMaster WHERE LTRIM(RTRIM(LEFT(ComponentCode, LEN(@ComponentCode)))) = LTRIM(RTRIM(@ComponentCode)) )
						     DELETE FROM ComponentMaster WHERE ComponentId IN (SELECT ComponentId FROM ComponentMaster WHERE LTRIM(RTRIM(LEFT(ComponentCode, LEN(@ComponentCode)))) = LTRIM(RTRIM(@ComponentCode)) )
						     SELECT ''Component deleted successfully.''  
						  END
					 END
			   END
            
        END
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Delete_Office_Jobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Delete_Office_Jobs]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

					   
CREATE PROCEDURE [dbo].[sp_Delete_Office_Jobs]
	@CompJobId bigint
AS
BEGIN
--DECLARE @VesselCode CHAR(3)
--    IF Exists (SELECT * FROM  VesselComponentJobMaster WHERE CompJobId = @CompJobId)
--		BEGIN
--		     SELECT TOP 1 @VesselCode=VesselCode FROM VesselComponentJobMaster WHERE CompJobId = @CompJobId 
	         
--	         SELECT ''cant  delete this job due to references.ASK admin to do the same.''
--		END
--    ELSE
--		BEGIN
--		     IF EXISTS (SELECT * FROM  VSL_VesselComponentJobMaster WHERE CompJobId = @CompJobId)
--				 BEGIN
--					  SELECT TOP 1 @VesselCode=VesselCode FROM VSL_VesselComponentJobMaster WHERE CompJobId = @CompJobId 
				      
--				      SELECT ''cant  delete this job due to references.ASK admin to do the same.''

--				 END
--			 ELSE
--			     BEGIN
					  DELETE FROM VSL_VesselJobUpdateHistoryAttachments WHERE HistoryId IN (SELECT HISTORYID FROM VSL_VesselJobUpdateHistory WHERE CompJobId = @CompJobId )
					  DELETE FROM VSL_VesselJobUpdateHistorySpareDetails WHERE HistoryId IN (SELECT HISTORYID FROM VSL_VesselJobUpdateHistory WHERE CompJobId = @CompJobId )
					  DELETE FROM VSL_PlanMaster WHERE CompJobId = @CompJobId
					  DELETE FROM VSL_DefectSpareDetails WHERE DEFECTNO IN (SELECT DEFECTNO FROM VSL_DefectDetailsMaster WHERE HistoryId IN (SELECT HISTORYID FROM VSL_VesselJobUpdateHistory WHERE CompJobId = @CompJobId))
					  
					  DELETE FROM VSL_DefectDetailsMaster WHERE HistoryId IN (SELECT HISTORYID FROM VSL_VesselJobUpdateHistory WHERE CompJobId = @CompJobId)
					  
					  DELETE FROM VSL_VesselJobUpdateHistory WHERE CompJobId = @CompJobId
					  DELETE FROM VSL_VesselComponentJobMaster_Updates WHERE CompJobId=@CompJobId
					  DELETE FROM VSL_VesselComponentJobMaster WHERE CompJobId=@CompJobId
					  DELETE FROM VesselComponentJobMaster WHERE CompJobId=@CompJobId
			          DELETE FROM ComponentsJobMapping WHERE CompJobId=@CompJobId
					  DELETE FROM ComponentsJobMapping_Attachments WHERE CompJobId=@CompJobId
			          SELECT ''Job deleted successfully.''
		--	     END
		--END

END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Delete_Vessel_Components]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Delete_Vessel_Components]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

-- EXEC sp_Delete_Vessel_Components ''AGE'',''200.01.01''
					  
CREATE PROCEDURE [dbo].[sp_Delete_Vessel_Components]
	@VesselCode CHAR(3),
	@ComponentCode CHAR(12)
AS
BEGIN
    
  --  IF (LEN(LTRIM(RTRIM(@ComponentCode))) <> 3)
  --    BEGIN
        

		--DELETE FROM ComponentMasterForVessel WHERE ComponentId IN ( SELECT CMV.ComponentId FROM ComponentMasterForVessel CMV INNER JOIN ComponentMaster CM ON CM.ComponentId = CMV.ComponentId 
		--WHERE CMV.VesselCode =@VesselCode AND CM.ComponentCode LIKE ''%'' + @ComponentCode + ''%'') AND VesselCode =@VesselCode
    
  --    END
  --  ELSE
  --    BEGIN
       
		DELETE FROM VesselRunningHourMaster WHERE ComponentId IN ( SELECT CMV.ComponentId FROM ComponentMasterForVessel CMV INNER JOIN ComponentMaster CM ON CM.ComponentId = CMV.ComponentId 
		WHERE CMV.VesselCode =@VesselCode AND LTRIM(RTRIM(CM.ComponentCode)) LIKE ''%'' + LTRIM(RTRIM(@ComponentCode)) + ''%'') AND VesselCode =@VesselCode
		
		DELETE FROM VesselSpareMaster WHERE ComponentId IN ( SELECT CMV.ComponentId FROM ComponentMasterForVessel CMV INNER JOIN ComponentMaster CM ON CM.ComponentId = CMV.ComponentId 
		WHERE CMV.VesselCode =@VesselCode AND LTRIM(RTRIM(CM.ComponentCode)) LIKE ''%'' + LTRIM(RTRIM(@ComponentCode)) + ''%'') AND VesselCode =@VesselCode 
		
		DELETE FROM VesselComponentJobMaster WHERE ComponentId IN ( SELECT CMV.ComponentId FROM ComponentMasterForVessel CMV INNER JOIN ComponentMaster CM ON CM.ComponentId = CMV.ComponentId 
		WHERE CMV.VesselCode =@VesselCode AND LTRIM(RTRIM(CM.ComponentCode)) LIKE ''%'' + LTRIM(RTRIM(@ComponentCode)) + ''%'') AND VesselCode =@VesselCode
		
		DELETE FROM ComponentMasterForVessel WHERE ComponentId IN ( SELECT CMV.ComponentId FROM ComponentMasterForVessel CMV INNER JOIN ComponentMaster CM ON CM.ComponentId = CMV.ComponentId 
		WHERE CMV.VesselCode =@VesselCode AND LTRIM(RTRIM(CM.ComponentCode)) LIKE ''%'' + LTRIM(RTRIM(@ComponentCode)) + ''%'') AND VesselCode =@VesselCode
      
      --END

END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Delete_Vessel_Jobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Delete_Vessel_Jobs]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

					   
CREATE PROCEDURE [dbo].[sp_Delete_Vessel_Jobs]
	@VesselCode CHAR(3),
	@ComponentId INT,
	@CompJobId INT
AS
BEGIN

     DELETE FROM VesselComponentJobMaster 
     WHERE VesselCode=@VesselCode  AND ComponentId = @ComponentId AND CompJobId=@CompJobId 
    
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Delete_Vessel_Spares]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Delete_Vessel_Spares]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROCEDURE [dbo].[sp_Delete_Vessel_Spares]
	@VesselCode CHAR(3),
	@ComponentId INT,
	@Office_Ship CHAR(1),
	@SpareId INT
AS
BEGIN

    DELETE FROM VesselSpareMaster 
    WHERE VesselCode = @VesselCode AND ComponentId = @ComponentId AND Office_Ship = @Office_Ship AND SpareId = @SpareId  
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_DeleteComponentsJobMapping_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_DeleteComponentsJobMapping_Attachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE Proc [dbo].[sp_DeleteComponentsJobMapping_Attachments]
(
	 @TableID BIGINT
	,@CompJobId BIGINT
)
AS
BEGIN
	UPDATE ComponentsJobMapping_Attachments SET STATUS=''D'' WHERE TableID =@TableID 

	UPDATE VSL_VesselComponentJobMaster
		SET Updated = 1,
		UpdatedOn = getdate()
		WHERE CompJobId = @CompJobId

END

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_DeleteDefectsAttachment]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_DeleteDefectsAttachment]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[sp_DeleteDefectsAttachment]
(
    @VesselCode CHAR(3),
	@AttachmentId bigint,
	@Mode char(1)
)
AS
BEGIN
	DECLARE @FNAME VARCHAR(50)
	SET @FNAME='''' 
	IF(@Mode=''P'')
	BEGIN
		SELECT @FNAME=[FILENAME] FROM VSL_Defects_Attachments WHERE VesselCode = @VesselCode AND AttachmentId=@AttachmentId 
		DELETE FROM VSL_Defects_Attachments WHERE VesselCode = @VesselCode AND AttachmentId=@AttachmentId
	END
	ELSE
	BEGIN
		UPDATE VSL_Defects_Attachments SET STATUS=''D'',UPDATED=1,UPDATEDON=GETDATE() WHERE VesselCode = @VesselCode AND AttachmentId=@AttachmentId
		--- LOG ENTRY
		UPDATE VSL_DefectDetailsMaster SET UPDATED=1,UPDATEDON=GETDATE() 
		WHERE VesselCode = @VesselCode AND DefectNo = (SELECT DefectNo FROM VSL_Defects_Attachments WHERE AttachmentId=@AttachmentId)
	END
	SELECT @FNAME
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_DeleteExecuteAttachment]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_DeleteExecuteAttachment]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[sp_DeleteExecuteAttachment]
(
	@VesselCode char(3),
	@TableId bigint,
	@Mode char(1)
)
AS
BEGIN
	DECLARE @FNAME VARCHAR(50)
	SET @FNAME=''''
	IF(@Mode=''P'')
	BEGIN
		SELECT @FNAME=[FILENAME] FROM VSL_VesselJobUpdateHistoryAttachments WHERE VESSELCODE=@VESSELCODE AND TABLEID=@TableId
		DELETE FROM VSL_VesselJobUpdateHistoryAttachments WHERE VESSELCODE=@VESSELCODE AND TABLEID=@TableId
	END
	ELSE
	BEGIN
		UPDATE VSL_VesselJobUpdateHistoryAttachments SET STATUS=''D''	WHERE VESSELCODE=@VESSELCODE AND TABLEID=@TableId
		--- LOG ENTRY
		UPDATE VSL_VesselJobUpdateHistory SET UPDATED=1,UPDATEDON=GETDATE() 
		WHERE VESSELCODE=@VESSELCODE 
		AND HISTORYID in (SELECT HISTORYID FROM VSL_VesselJobUpdateHistoryAttachments WHERE VESSELCODE=@VESSELCODE AND TABLEID=@TableId)
	END
	SELECT @FNAME
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_DeleteUPAttachment]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_DeleteUPAttachment]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[sp_DeleteUPAttachment]
(
	@VesselCode char(3),
	@TableId bigint,
	@Mode char(1)
)
AS
BEGIN
	DECLARE @FNAME VARCHAR(50)
	SET @FNAME=''''
	IF(@Mode=''P'')
	BEGIN
		SELECT @FNAME=[FILENAME] FROM VSL_UnPlannedJobs_Attachments WHERE VESSELCODE=@VESSELCODE AND TableId=@TableId
		DELETE FROM VSL_UnPlannedJobs_Attachments WHERE VESSELCODE=@VESSELCODE AND TableId=@TableId
	END
	ELSE
	BEGIN
		UPDATE VSL_UnPlannedJobs_Attachments SET STATUS=''D''	WHERE VESSELCODE=@VESSELCODE AND TableId=@TableId
		--- LOG ENTRY
		UPDATE VSL_UnPlannedJobs SET UPDATED=1,UPDATEDON=GETDATE() 
		WHERE VESSELCODE=@VESSELCODE 
		AND UPId in (SELECT UPId FROM VSL_UnPlannedJobs_Attachments WHERE VESSELCODE=@VESSELCODE AND TableId=@TableId)
	END
	SELECT @FNAME
END







' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_DeleteUPPlanJobsSpares]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_DeleteUPPlanJobsSpares]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE proc [dbo].[sp_DeleteUPPlanJobsSpares]
(
@VesselCode char(3),
@ComponentId bigint,
@Office_Ship char(1),
@SpareId bigint,
@UPId bigint
)
as 
begin

	UPDATE dbo.VSL_UnPlannedJobs_SpareDetails 
	set Status=''D''
	where vesselcode=@VesselCode and ComponentId=@ComponentId and Office_Ship=@Office_Ship and SpareId=@SpareId and UPId=@UPId

	update dbo.VSL_UnPlannedJobs 
	set updated=1,updatedon=getdate() 
	where vesselcode=@VesselCode and UPId=@UPId
end	
	



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_DeleteVSL_VesselComponentJobMaster_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_DeleteVSL_VesselComponentJobMaster_Attachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[sp_DeleteVSL_VesselComponentJobMaster_Attachments]
(
	@TABLEID BIGINT
	,@VESSELCODE VARCHAR(3)
	,@CompjobId BIGINT
)
AS
BEGIN
	UPDATE VSL_VesselComponentJobMaster_Attachments SET STATUS=''D'' WHERE TABLEID =@TABLEID AND VESSELCODE =@VESSELCODE 

	UPDATE VSL_VesselComponentJobMaster 
         SET Updated  = 1,
         UpdatedOn = getdate() WHERE VesselCode=@VesselCode AND CompJobId = @CompjobId

END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_ExportVessel]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_ExportVessel]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[sp_ExportVessel]
(
	@VesselCode CHAR(3)
)
AS
BEGIN
    
     DELETE FROM VSL_ComponentMasterForVessel WHERE VesselCode=@VesselCode
     DELETE FROM VSL_DefectDetailsMaster WHERE VesselCode=@VesselCode
     DELETE FROM VSL_DefectSpareDetails WHERE VesselCode=@VesselCode
     DELETE FROM VSL_PlanMaster WHERE VesselCode=@VesselCode
     DELETE FROM VSL_StockInventory WHERE VesselCode=@VesselCode
     DELETE FROM VSL_VesselComponentJobMaster WHERE VesselCode=@VesselCode 
     DELETE FROM VSL_VesselComponentJobMaster_Updates WHERE VesselCode=@VesselCode
     DELETE FROM VSL_VesselJobUpdateHistory WHERE VesselCode=@VesselCode 
     DELETE FROM VSL_VesselJobUpdateHistoryAttachments WHERE VesselCode=@VesselCode 
     DELETE FROM VSL_VesselJobUpdateHistorySpareDetails WHERE VesselCode=@VesselCode
     DELETE FROM VSL_VesselSpareMaster WHERE VesselCode=@VesselCode 
     DELETE FROM VSL_VesselRunningHourMaster WHERE VesselCode=@VesselCode 
	 DELETE FROM VSL_VesselComponentJobMaster_Attachments WHERE VesselCode=@VesselCode 
     -----------------------------------------------------------------
     INSERT INTO VSL_ComponentMasterForVessel SELECT [VesselCode],[ComponentId],[Maker],[MakerType],[ClassEquipCode],''A'',0,getdate(),[Descr],CLASSEQUIP,ACCOUNTCODES FROM ComponentMasterForVessel WHERE VesselCode=@VesselCode
     -----------------------------------------------------------------
     INSERT INTO VSL_VesselComponentJobMaster 
     SELECT jm.VesselCode,jm.CompJobId,jm.ComponentId,jm.JobId,jm.AssignTo,jm.IntervalId,jm.Interval,jm.IsFixed,jm.StartDate,
     jm.DescrM,Interval_H,IntervalId_H,Guidelines,''A'',0,getdate() FROM VesselComponentJobMaster JM WHERE jm.VesselCode=@VesselCode 
     -----------------------------------------------------------------
     INSERT INTO VSL_VesselComponentJobMaster_Updates
     SELECT jm.VesselCode,jm.CompJobId,jm.ComponentId,rh.startdate AS LastDone,StartupHour AS LastHour,
     CASE 
		WHEN rh.startdate IS NULL THEN NULL
		WHEN AvgRunningHrPerDay=0 THEN NULL -- DIVIDE BY 0 DERROR
		WHEN IntervalId_H <> 0 THEN 
			CASE 
				WHEN dateadd(dd,ceiling(interval/isnull(AvgRunningHrPerDay,1)),rh.startdate) <  
						 (
						 CASE IntervalId_H 
						 WHEN 2 THEN dateadd(dd,interval_H,rh.startdate) 
						 WHEN 3 THEN dateadd(ww,interval_H,rh.startdate)
						 WHEN 4 THEN dateadd(mm,interval_H,rh.startdate)
						 WHEN 5 THEN dateadd(yy,interval_H,rh.startdate)
						 END
						 )
				THEN  dateadd(dd,ceiling(interval/isnull(AvgRunningHrPerDay,1)),rh.startdate)
				ELSE 
					CASE IntervalId_H 
					 WHEN 2 THEN dateadd(dd,interval_H,rh.startdate) 
					 WHEN 3 THEN dateadd(ww,interval_H,rh.startdate)
					 WHEN 4 THEN dateadd(mm,interval_H,rh.startdate)
					 WHEN 5 THEN dateadd(yy,interval_H,rh.startdate)
					 END
				END    
		ELSE 
			dateadd(dd,ceiling(interval/isnull(AvgRunningHrPerDay,1)),rh.startdate)
		END
		AS NextDueDate,StartupHour + interval as NextHour,0,getdate() FROM VesselComponentJobMaster jm 
		LEFT JOIN VesselRunningHourMaster rh on jm.vesselcode=rh.vesselcode AND jm.componentid=rh.componentid WHERE jm.VesselCode=@VesselCode AND jm.IntervalId = 1
       -----------------------------------------------------------------
     
  --   INSERT INTO VSL_VesselComponentJobMaster 
  --   SELECT jm.VesselCode,jm.CompJobId,jm.ComponentId,jm.JobId,jm.AssignTo,jm.IntervalId,jm.Interval,jm.IsFixed,jm.StartDate,rh.startdate AS LastDone,StartupHour AS LastHour,
  --   CASE 
		--WHEN rh.startdate IS NULL THEN NULL
		--WHEN IntervalId_H <> 0 THEN 
		--	CASE 
		--		WHEN dateadd(dd,ceiling(interval/isnull(AvgRunningHrPerDay,1)),rh.startdate) <  
		--				 (
		--				 CASE IntervalId_H 
		--				 WHEN 2 THEN dateadd(dd,interval_H,rh.startdate) 
		--				 WHEN 3 THEN dateadd(ww,interval_H,rh.startdate)
		--				 WHEN 4 THEN dateadd(mm,interval_H,rh.startdate)
		--				 WHEN 5 THEN dateadd(yy,interval_H,rh.startdate)
		--				 END
		--				 )
		--		THEN  dateadd(dd,ceiling(interval/isnull(AvgRunningHrPerDay,1)),rh.startdate)
		--		ELSE 
		--			CASE IntervalId_H 
		--			 WHEN 2 THEN dateadd(dd,interval_H,rh.startdate) 
		--			 WHEN 3 THEN dateadd(ww,interval_H,rh.startdate)
		--			 WHEN 4 THEN dateadd(mm,interval_H,rh.startdate)
		--			 WHEN 5 THEN dateadd(yy,interval_H,rh.startdate)
		--			 END
		--		END    
		--ELSE 
		--	dateadd(dd,ceiling(interval/isnull(AvgRunningHrPerDay,1)),rh.startdate)
		--END
		--AS NextDueDate,StartupHour + interval as NextHour,jm.DescrM,''A'',0,getdate(),IntervalId_H,Interval_H FROM VesselComponentJobMaster jm 
  --   LEFT JOIN VesselRunningHourMaster rh on jm.vesselcode=rh.vesselcode AND jm.componentid=rh.componentid WHERE jm.VesselCode=@VesselCode AND jm.IntervalId = 1
     -----------------------------------------------------------------
     INSERT INTO VSL_VesselSpareMaster SELECT *,''A'',0,getdate() FROM VesselSpareMaster WHERE VesselCode=@VesselCode
     INSERT INTO VSL_VesselRunningHourMaster SELECT *,0 FROM VesselRunningHourMaster WHERE VesselCode=@VesselCode
     -----------------------------------------------------------------
     INSERT INTO VSL_VesselComponentJobMaster_Updates 
     SELECT VesselCode,CompJobId,ComponentId,startdate AS LastDone,0 AS LastHour,
     CASE IntervalId 
     WHEN 2 THEN dateadd(dd,interval,startdate)
     WHEN 3 THEN dateadd(ww,interval,startdate)
     WHEN 4 THEN dateadd(mm,interval,startdate)
     WHEN 5 THEN dateadd(yy,interval,startdate)
     END
     AS NextDueDate,0 as NextHour,0,getdate()
     FROM VesselComponentJobMaster     
     WHERE VesselCode=@VesselCode AND IntervalId <> 1
     -----------------------------------------------------------------
     IF NOT EXISTS (SELECT * FROM Settings WHERE ShipCode=@VesselCode )
     BEGIN
		INSERT INTO Settings SELECT VesselCode,VesselName FROM Vessel WHERE VesselCode = @VesselCode 
     END
	 -----------------------------------------------------------------
	 INSERT INTO VSL_VesselComponentJobMaster_Attachments SELECT *,''A'' FROM VesselComponentJobMaster_Attachments WHERE VesselCode = @VesselCode 
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_GetDataForClassComponentJobStatus]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_GetDataForClassComponentJobStatus]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'----------------------------------------------------------

CREATE PROC [dbo].[sp_GetDataForClassComponentJobStatus] 
(
	@VesselCode char(3)
)
AS
BEGIN
SELECT     VCM.VesselCode, 
VSL.ShipName, CM.ComponentCode, CM.ComponentName, VCM.ClassEquipCode,CJM.DescrSh AS JobDesacription, JH1.LastDueDate, JH1.DoneDate,JH1.NextDueDate
,CM.CriticalType
FROM         
dbo.VSL_ComponentMasterForVessel AS VCM  
INNER JOIN dbo.ComponentMaster AS CM ON CM.ComponentId = VCM.ComponentId AND VCM.ClassEquip = 1 AND  vcm.VesselCode=@VesselCode
INNER JOIN dbo.Settings AS VSL ON VSL.ShipCode = vcm.VesselCode
INNER JOIN dbo.ComponentsJobMapping AS CJM ON CJM.ComponentId = CM.ComponentId 
INNER JOIN dbo.VSL_VesselComponentJobMaster AS VCJM ON VCJM.ComponentId = CM.ComponentId AND VCJM.VesselCode=@VesselCode AND CJM.COMPJOBID=VCJM.CompJobId
LEFT JOIN 
(
(SELECT VESSELCODE,COMPONENTID,COMPJOBID,MAX(HistoryId) AS HistoryId FROM VSL_VesselJobUpdateHistory WHERE VesselCode =@VesselCode GROUP BY VESSELCODE,COMPONENTID,COMPJOBID) jh
INNER JOIN VSL_VesselJobUpdateHistory jh1 on jh.vesselcode = jh1.vesselcode AND jh.HistoryId = jh1.HistoryId
)
on jh1.ComponentId = VCM.ComponentId AND JH1.VesselCode = VCM.VesselCode AND jh1.COMPJOBID=VCJM.CompJobId

ORDER BY ComponentCode
	
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_getInventorySummary]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_getInventorySummary]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE procedure [dbo].[sp_getInventorySummary]
(
	@VesselCode char(3),
	@ComponentId bigint,
	@Office_Ship char,
	@SpareId bigint,
	@OnDate smalldatetime
)
as
begin
	declare @rec float
	declare @cons float
	declare @rob float

	select @cons=isnull(sum(QtyCons),0) from dbo.VSL_VesselJobUpdateHistorySpareDetails Where VesselCode=@VesselCode And ComponentId=@ComponentId And Office_Ship=@Office_Ship And SpareId=@SpareId And Status=''A'' And HistoryId in(SELECT HISTORYID FROM dbo.VSL_VesselJobUpdateHistory WHERE VESSELCODE=@VesselCode AND DONEDATE<=@OnDate)
	select @cons=@cons+isnull(sum(QtyCons),0) from dbo.VSL_DefectSpareDetails Where VesselCode=@VesselCode And ComponentId=@ComponentId And Office_Ship=@Office_Ship And SpareId=@SpareId And Status=''A'' And DefectNo in(SELECT DefectNo FROM dbo.VSL_DefectDetailsMaster WHERE VESSELCODE=@VesselCode AND ReportDt<=@OnDate)
	select @cons=@cons+isnull(sum(QtyCons),0) from dbo.VSL_UnPlannedJobs_SpareDetails Where VesselCode=@VesselCode And ComponentId=@ComponentId And Office_Ship=@Office_Ship And SpareId=@SpareId And Status=''A'' And UPId in(SELECT UPId FROM dbo.VSL_UnPlannedJobs WHERE VESSELCODE=@VesselCode AND DONEDATE<=@OnDate)

	select @rec=isnull(sum(QtyRecd),0) from dbo.VSL_StockInventory WHERE  VESSELCODE=@VesselCode And ComponentId=@ComponentId And Office_Ship=@Office_Ship And SpareId=@SpareId And Status=''A'' AND RecdDate <=@OnDate
	
	set @rob=@rec-@cons
	select @rec as Receiveed,@cons as Consumed,@rob as ROB
end




' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_GETJOBPLANNING]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_GETJOBPLANNING]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_GETJOBPLANNING]
(
	@VSLLIST VARCHAR(500),
	@COMPCODE VARCHAR(20),
	@COMPNAME VARCHAR(50),
	@JOBCAT VARCHAR(100),
	@JOBTYPES VARCHAR(100),
	@CRIT BIT,
	@CLASS BIT,
	@CLASSCODE VARCHAR(50),
	@ASSIGNEDTO VARCHAR(50),
	@PLANSTATUS VARCHAR(50),
	@DUEDAYS VARCHAR(5),
	@OD BIT,
	@SMODE INT
)
AS
BEGIN
    -- EXEC DBO.sp_GETJOBPLANNING ''LIG'',''%'',''%%'',''1,2,14,8,3,4,9,11,5,7,13,10,12,6'',''1,2,3,4,5'',0,0,''%%'',''1,2,4,6,34,12,15,16,17,25,42,0'',''1,3,0'',''30'',1,0
	--EXEC DBO.sp_GETJOBPLANNING ''LIG'',''%'',''%%'',''1,2,14,8,3,4,9,11,5,7,13,10,12,6'',''2,3,4,5'',0,0,''%%'',''0,1,2,4,6,34,12,15,16,17,25,42'',''1,3,0'','''',1
	--===============================
	--DECLARE @VSLLIST VARCHAR(500)
	--DECLARE @COMPCODE VARCHAR(20)
	--DECLARE @COMPNAME VARCHAR(50)
	--DECLARE @JOBCAT VARCHAR(100)
	--DECLARE @JOBTYPES VARCHAR(100)
	--DECLARE @CRIT BIT
	--DECLARE @CLASS BIT
	--DECLARE @CLASSCODE VARCHAR(50)
	--DECLARE @ASSIGNEDTO VARCHAR(50)
	--DECLARE @PLANSTATUS VARCHAR(50)
	--DECLARE @DUEDAYS VARCHAR(5)
	--DECLARE @OD BIT
	--===============================
	--SET @VSLLIST=''LIG,AME''
	--SET @COMPCODE=''220.16%''
	--SET @COMPNAME=''%%''
	--SET @JOBCAT=''1,2,3,4,5,6,7,8,9,10,11,12,14,15''
	--SET @JOBTYPES=''1,2,3,4,5''
	--SET @CRIT=0
	--SET @CLASS=0
	--SET @CLASSCODE=''%%''
	--SET @ASSIGNEDTO=''0,1,2,3,4,5,6,7,8,9''
	--SET @PLANSTATUS=''1,3,0''
	--SET @DUEDAYS=''10000''
	--SET @OD=1
	--===============================
	DECLARE @TEMP TABLE
	(
	--[RowNumber] int,
	[VesselCode] [char](3) ,
	[ClassEquipCode] [varchar](50) ,
	[VesselName] [varchar](50) ,
	[ComponentId] [bigint] ,
	[ComponentCode] [char](20) ,
	[ComponentName] [varchar](500) ,
	[CriticalType] [char](1) ,
	[JobCode] [char](3) ,
	[JobType] [varchar](50) ,
	[JobName] [varchar](1000) ,
	[CompJobId] [bigint] ,
	[IntervalName] [varchar](1) ,
	[RankCode] [varchar](50) ,
	[Interval] [float] ,
	[NextDueDate] smalldatetime ,
	[DueStatus] [varchar](10)   ,
	[WorkOrderStatus] [varchar](50)   ,
	[NextHour] [int] ,
	[LastDone] smalldatetime,
	[LastHour] [int] ,
	[Difference] [int] ,
	[DiffHour] [int] ,
	[PlannedRank] [int] ,
	[PlanDate] smalldatetime,
	[Rank] [varchar](50)   ,
	[DefectNo] [varchar](15)   ,
	[ResultType] [varchar](1)   
	)
	--===============================
	DECLARE @TD SMALLDATETIME
	DECLARE @CD SMALLDATETIME

	SET @TD=CONVERT(SMALLDATETIME,CONVERT(VARCHAR,GETDATE()))
	IF(LTRIM(RTRIM(@DUEDAYS))<>'''')
		SET @CD=DATEADD(DAY,CAST(@DUEDAYS AS INT),@TD)
	
		IF(@SMODE=0)
		BEGIN
		
		
	        	
			INSERT INTO @TEMP
			SELECT VCJM.VesselCode,VCM.ClassEquipCode,(SELECT ShipName FROM Settings WHERE ShipCode = VCJM.VesselCode) AS VesselName,CM.ComponentId,CM.ComponentCode,CM.ComponentName ,CM.CriticalType,JM.JobCode,JM.JobName AS JobType,CASE WHEN LEN(CJM.DescrSh) > 100 THEN Substring(CJM.DescrSh,0,100) + ''...'' ELSE CJM.DescrSh END AS JobName,VCJM.CompJobId,JIM.IntervalName ,RM.RankCode,VCJM.Interval,replace(convert(varchar(15),VCJMU.NextDueDate,106),'' '',''-'') As NextDueDate,CASE WHEN VCJMU.NextDueDate > getdate() THEN ''DUE'' ELSE ''OVER DUE'' END AS DueStatus , CASE PM.Status WHEN 1 THEN ''Issued'' WHEN 2 THEN ''Completed'' WHEN 3 THEN ''Postponed'' WHEN 4 THEN ''Cancelled'' ELSE '''' END AS WorkOrderStatus,VCJMU.NextHour,REPLACE(CONVERT(VARCHAR(15),VCJMU.LastDone,106),'' '',''-'') AS LastDone,VCJMU.LastHour,CASE WHEN VCJMU.NextDueDate IS NULL THEN '''' ELSE datediff(day,getdate(),VCJMU.NextDueDate) END AS Difference,(ISNULL(PM.DoneHour,0) - ISNULL(PM.LastDueHours,0)) AS DiffHour,CASE PM.Status WHEN 4 THEN 0 ELSE ISNULL(coalesce( PM.AssignedTo,VCJM.AssignTo),0) END AS PlannedRank,CASE PM.Status WHEN 1 THEN CASE REPLACE(CONVERT(VARCHAR(11), ISNULL(PM.PlanDate,''''),106),'' '',''-'') WHEN ''01-Jan-1900'' THEN '''' ELSE REPLACE(CONVERT(VARCHAR(11), ISNULL(PM.PlanDate,''''),106),'' '',''-'') END WHEN 2 THEN CASE REPLACE(CONVERT(VARCHAR(11), ISNULL(PM.DoneDate,''''),106),'' '',''-'') WHEN ''01-Jan-1900'' THEN '''' ELSE REPLACE(CONVERT(VARCHAR(11), ISNULL(PM.DoneDate,''''),106),'' '',''-'') END WHEN 3 THEN CASE REPLACE(CONVERT(VARCHAR(11), ISNULL(PM.PlanDate,''''),106),'' '',''-'') WHEN ''01-Jan-1900'' THEN '''' ELSE REPLACE(CONVERT(VARCHAR(11), ISNULL(PM.PlanDate,''''),106),'' '',''-'') END ELSE NULL END AS PlanDate,CASE ISNULL(PM.Status,0) WHEN 4 THEN '''' ELSE ISNULL(coalesce(RM.RankCode,(select RankCode from Rank R where R.RankID=VCJM.AssignTo)),'''') END AS Rank,'''' as DefectNo ,''P'' as ResultType 
			FROM 
			VSL_VesselComponentJobMaster VCJM 
			INNER JOIN VSL_VesselComponentJobMaster_Updates VCJMU ON VCJM.VesselCode = VCJMU.VesselCode AND VCJM.ComponentId = VCJMU.ComponentId AND VCJM.CompJobId = VCJMU.CompJobId And VCJM.[Status]=''A''
			INNER JOIN VSL_ComponentMasterForVessel VCM ON VCJM.VesselCode = VCM.VesselCode AND VCJM.ComponentId = VCM.ComponentId And VCM.[Status]=''A''
			INNER JOIN ComponentsJobMapping CJM ON VCJM.CompjobId=CJM.CompjobId 
			INNER JOIN ComponentMaster CM ON CM.ComponentId = VCJM.ComponentId 
			INNER JOIN JobMaster JM  ON JM.JobId = VCJM.JobId 
			INNER JOIN JobIntervalMaster JIM ON JIM.IntervalId = VCJM.IntervalId 
			LEFT JOIN VSL_PlanMaster PM ON PM.VesselCode = VCJM.VesselCode AND PM.ComponentId = VCJM.ComponentId AND PM.CompJobId = VCJM.CompJobId 
			LEFT JOIN Rank RM ON RM.RankId = PM.AssignedTo
			WHERE
			VCJM.VESSELCODE IN (SELECT RESULT FROM dbo.CSVtoTableString(@VSLLIST,'','')) AND 
			CM.COMPONENTCODE LIKE @COMPCODE AND 
			CM.COMPONENTNAME LIKE @COMPNAME AND
			JM.JOBID IN (SELECT RESULT FROM dbo.CSVtoTable(@JOBCAT,'','')) AND
			CM.CRITICALEQUIP=(CASE WHEN @CRIT=1 THEN 1 ELSE CM.CRITICALEQUIP END) 
			AND JIM.IntervalId IN (SELECT RESULT FROM dbo.CSVtoTable(@JOBTYPES,'','')) AND
			CM.ClassEquip=(CASE WHEN @CLASS=1 THEN 1 ELSE CM.ClassEquip END) AND
			ISNULL(VCM.ClassEquipCode,'''') LIKE @CLASSCODE AND
			ISNULL(coalesce( PM.AssignedTo,VCJM.AssignTo),0) IN (SELECT RESULT FROM dbo.CSVtoTable(@ASSIGNEDTO,'','')) AND 
			ISNULL(PM.STATUS,0) IN (SELECT RESULT FROM dbo.CSVtoTable(@PLANSTATUS,'','')) AND
			(
				CASE WHEN LTRIM(RTRIM(@DUEDAYS))='''' THEN 
					CASE WHEN @OD=1 THEN 
						CASE WHEN VCJMU.NextDueDate IS NULL OR VCJMU.NextDueDate< @TD THEN 
							1 
						ELSE
							0
						END
					ELSE
						1
					END
				ELSE
					CASE WHEN @OD=1 THEN 
						CASE WHEN VCJMU.NextDueDate IS NULL OR VCJMU.NextDueDate <=@CD OR VCJMU.NextDueDate <@TD THEN
							1
						ELSE
							0
						END
					ELSE
						CASE WHEN VCJMU.NextDueDate >=@TD AND VCJMU.NextDueDate <=@CD THEN
							1
						ELSE
							0
						END
					END
				END
			)=1
		END
		--- DEFECT DATA
		IF(@SMODE=0 OR @SMODE=1 OR @SMODE=3)
		BEGIN
			INSERT INTO @TEMP
			SELECT DDM.VESSELCODE,VCM.CLASSEQUIPCODE,SS.SHIPNAME AS VESSELNAME,DDM.COMPONENTID,CM.COMPONENTCODE,CM.COMPONENTNAME,CM.CRITICALTYPE,''DFR'' AS JOBCODE,''Defect'',DefectDetails as JobName,0 as CompJobId,
			'''' as INTERVALNAME,'''' AS RANKCODE,0 AS INTERVAL,TARGETDT AS NEXTDUEDT,''DUE'' AS DUESTATUS,''Issued'' as WorkOrderStatus,0 as NextHour,'''' as LastDone,0 as LastHour
			,0 as [Difference],0 as DiffHour,0 as PlannedRank,TARGETDT AS PLANDATE,'''' AS RANK,DefectNo,''D'' as ResultType
			FROM VSL_DEFECTDETAILSMASTER DDM INNER JOIN VSL_ComponentMasterForVessel VCM ON DDM.VesselCode=VCM.VESSELCODE AND DDM.ComponentId = VCM.ComponentId and DDM.COMPLETIONDT IS NULL And VCM.[Status]=''A''
			INNER JOIN SETTINGS SS ON DDM.VESSELCODE=SS.SHIPCODE
			INNER JOIN ComponentMaster CM ON CM.ComponentId = DDM.ComponentId 
			WHERE DDM.VESSELCODE IN (SELECT RESULT FROM dbo.CSVtoTableString(@VSLLIST,'','')) AND	
			CM.COMPONENTCODE LIKE @COMPCODE AND 
			CM.COMPONENTNAME LIKE @COMPNAME AND 
			CM.CRITICALEQUIP=(CASE WHEN @CRIT=1 THEN 1 ELSE CM.CRITICALEQUIP END) AND
			CM.ClassEquip=(CASE WHEN @CLASS=1 THEN 1 ELSE CM.ClassEquip END) AND
			ISNULL(VCM.ClassEquipCode,'''') LIKE @CLASSCODE AND
			(
				CASE WHEN LTRIM(RTRIM(@DUEDAYS))='''' THEN 
					CASE WHEN @OD=1 THEN 
						CASE WHEN DDM.TARGETDT IS NULL OR DDM.TARGETDT< @TD THEN 
							1 
						ELSE
							0
						END
					ELSE
						1
					END
				ELSE
					CASE WHEN @OD=1 THEN 
						CASE WHEN DDM.TARGETDT IS NULL OR DDM.TARGETDT <=@CD OR DDM.TARGETDT <@TD THEN
							1
						ELSE
							0
						END
					ELSE
						CASE WHEN DDM.TARGETDT >=@TD AND DDM.TARGETDT <=@CD THEN
							1
						ELSE
							0
						END
					END
				END
			)=1
		END
		--- UN PLANNED JOB DATA
		IF(@SMODE=0 OR @SMODE=2 OR @SMODE=3)
		BEGIN
			INSERT INTO @TEMP
			SELECT DDM.VESSELCODE,VCM.CLASSEQUIPCODE,SS.SHIPNAME AS VESSELNAME,DDM.COMPONENTID,CM.COMPONENTCODE,CM.COMPONENTNAME,CM.CRITICALTYPE,''UPJ'' AS JOBCODE,''Defect'',SHORTDESCR as JobName,0 as CompJobId,
			'''' as INTERVALNAME,'''' AS RANKCODE,0 AS INTERVAL,DUEDATE AS NEXTDUEDT,''DUE'' AS DUESTATUS,''Issued'' as WorkOrderStatus,0 as NextHour,'''' as LastDone,0 as LastHour
			,0 as [Difference],0 as DiffHour,AssignedTo as PlannedRank,DUEDATE AS PLANDATE,'''' AS RANK,UPID AS DEFECTNO,''U'' as ResultType
			FROM VSL_UnPlannedJobs DDM INNER JOIN VSL_ComponentMasterForVessel VCM ON DDM.VesselCode=VCM.VESSELCODE AND DDM.ComponentId = VCM.ComponentId and DDM.DONEDATE IS NULL And VCM.[Status]=''A''
			INNER JOIN SETTINGS SS ON DDM.VESSELCODE=SS.SHIPCODE
			INNER JOIN ComponentMaster CM ON CM.ComponentId = DDM.ComponentId 
			WHERE DDM.VESSELCODE IN (SELECT RESULT FROM dbo.CSVtoTableString(@VSLLIST,'','')) AND	
			CM.COMPONENTCODE LIKE @COMPCODE AND 
			CM.COMPONENTNAME LIKE @COMPNAME AND 
			CM.CRITICALEQUIP=(CASE WHEN @CRIT=1 THEN 1 ELSE CM.CRITICALEQUIP END) AND
			CM.ClassEquip=(CASE WHEN @CLASS=1 THEN 1 ELSE CM.ClassEquip END) AND
			ISNULL(VCM.ClassEquipCode,'''') LIKE @CLASSCODE AND
			(
				CASE WHEN LTRIM(RTRIM(@DUEDAYS))='''' THEN 
					CASE WHEN @OD=1 THEN 
						CASE WHEN DDM.DUEDATE IS NULL OR DDM.DUEDATE< @TD THEN 
							1 
						ELSE
							0
						END
					ELSE
						1
					END
				ELSE
					CASE WHEN @OD=1 THEN 
						CASE WHEN DDM.DUEDATE IS NULL OR DDM.DUEDATE <=@CD OR DDM.DUEDATE <@TD THEN
							1
						ELSE
							0
						END
					ELSE
						CASE WHEN DDM.DUEDATE >=@TD AND DDM.DUEDATE <=@CD THEN
							1
						ELSE
							0
						END
					END
				END
			)=1
		END
	SELECT ROW_NUMBER() OVER(ORDER BY COMPONENTCODE)  AS ROWNUMBER,* FROM @TEMP
END












' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_GetShipMaintenanceKPIData]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_GetShipMaintenanceKPIData]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- EXEC [sp_GetShipMaintenanceKPIData] ''LIG'', 2014
CREATE PROC [dbo].[sp_GetShipMaintenanceKPIData]
(
	@VesselCode char(3),
	@Year int
)
AS
BEGIN
	declare @months table(Id int ,MonthName varchar(20))
	insert into @months values(1,''Jan'')
	insert into @months values(2,''Feb'')
	insert into @months values(3,''Mar'')
	insert into @months values(4,''Apr'')
	insert into @months values(5,''May'')
	insert into @months values(6,''Jun'')
	insert into @months values(7,''Jul'')
	insert into @months values(8,''Aug'')
	insert into @months values(9,''Sep'')
	insert into @months values(10,''Oct'')
	insert into @months values(11,''Nov'')
	insert into @months values(12,''Dec'')
	
	SELECT VesselCode,[Year],M1.Id as MOnth,TotalSystemJobs,DueJobs,OverDueJobs,OD1Week,OD2Week,ODMorethan2week,OutStandingJobs,DueJobs+OverDueJobs as TotalJobs,m1.MonthName 
	FROM @months m1 left JOIN Ship_MaintenanceKPI ON m1.Id=Ship_MaintenanceKPI.[Month] AND VESSELCODE=@VesselCode AND [YEAR]=@Year
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_ComponentMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_ComponentMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_ComponentMaster]
(
@COMPONENTID bigint,
@COMPONENTCODE char(12),
@COMPONENTNAME varchar(100),
@DESCR varchar(500),
@CLASSEQUIP bit,
@CRITICALEQUIP bit,
@INACTIVE bit,
@CriticalType Char(1)
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM ComponentMaster WHERE COMPONENTID = @COMPONENTID )
BEGIN 
	INSERT INTO ComponentMaster
	(
	COMPONENTID ,
	COMPONENTCODE ,
	COMPONENTNAME ,
	DESCR ,
	CLASSEQUIP ,
	CRITICALEQUIP ,
	INACTIVE ,
	CriticalType
	)
	Values
	(
	@COMPONENTID,
	@COMPONENTCODE,
	@COMPONENTNAME,
	@DESCR,
	@CLASSEQUIP,
	@CRITICALEQUIP,
	@INACTIVE,
	@CriticalType
	)
	END
ELSE 
BEGIN
	UPDATE ComponentMaster
	SET 
	COMPONENTID = @COMPONENTID,
	COMPONENTCODE =@COMPONENTCODE,
	COMPONENTNAME = @COMPONENTNAME,
	DESCR = @DESCR,
	CLASSEQUIP = @CLASSEQUIP,
	CRITICALEQUIP = @CRITICALEQUIP,
	INACTIVE = @INACTIVE ,
	CriticalType=@CriticalType
	WHERE COMPONENTID = @COMPONENTID
END
END






' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_ComponentsJobMapping]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_ComponentsJobMapping]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_ComponentsJobMapping]
(
	@COMPONENTID bigint,
	@JOBID bigint,
	@COMPJOBID bigint,
	@ASSIGNTO int,
	@DEPTID int,
	@INTERVALID int,
	@ISFIXED smallint,
	@DESCRSH varchar(250),
	@DESCRM varchar(5000),
	@AttachmentForm varchar(50),
	@RiskAssessment varchar(50),
	@RatingRequired bit
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM ComponentsJobMapping WHERE COMPJOBID = @COMPJOBID )
BEGIN 
	INSERT INTO ComponentsJobMapping
	(
		COMPONENTID ,
		JOBID ,
		COMPJOBID ,
		ASSIGNTO ,
		DEPTID ,
		INTERVALID ,
		ISFIXED ,
		DESCRSH ,
		DESCRM ,
		AttachmentForm ,
		RiskAssessment,
		RatingRequired 
	)
	Values
	(
		@COMPONENTID,
		@JOBID,
		@COMPJOBID,
		@ASSIGNTO,
		@DEPTID,
		@INTERVALID,
		@ISFIXED,
		@DESCRSH,
		@DESCRM ,
		@AttachmentForm ,
		@RiskAssessment,
		@RatingRequired 
	)
	END
ELSE 
BEGIN
	UPDATE ComponentsJobMapping
	SET
		COMPONENTID = @COMPONENTID,
		JOBID = @JOBID,		
		ASSIGNTO = @ASSIGNTO,
		DEPTID = @DEPTID,
		INTERVALID = @INTERVALID,
		ISFIXED = @ISFIXED,
		DESCRSH = @DESCRSH,
		DESCRM = @DESCRM,
		AttachmentForm=@AttachmentForm,
		RiskAssessment=@RiskAssessment,
		RatingRequired = @RatingRequired
	WHERE COMPJOBID = @COMPJOBID
END
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_ComponentsJobMapping_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_ComponentsJobMapping_Attachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_ComponentsJobMapping_Attachments]
(
	@TABLEID bigint,
	@COMPJOBID bigint,
	@DESCR varchar(500),
	@DOCUMENTTYPE varchar(5),
	@STATUS CHAR(1)
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM ComponentsJobMapping_Attachments WHERE COMPJOBID = @COMPJOBID AND TABLEID=@TABLEID)
BEGIN 
	INSERT INTO ComponentsJobMapping_Attachments
	(
		TABLEID ,
		COMPJOBID ,
		DESCR ,
		DOCUMENTTYPE ,
		STATUS	
	)
	Values
	(
		@TABLEID ,
		@COMPJOBID ,
		@DESCR ,
		@DOCUMENTTYPE ,
		@STATUS
	)
	END
ELSE 
BEGIN
	UPDATE ComponentsJobMapping_Attachments
	SET
		DESCR=@DESCR ,
		DOCUMENTTYPE=@DOCUMENTTYPE,
		STATUS=@STATUS
	WHERE COMPJOBID = @COMPJOBID AND TABLEID=@TABLEID
END
END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_CreatePacket]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_CreatePacket]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'  
-- EXEC [dbo].[sp_IE_CreatePacket] ''O'',''CKP''  
  
CREATE PROCEDURE [dbo].[sp_IE_CreatePacket]  
(  
 @Location char(1),  
 @VesselCode char(3)  
)  
AS  
BEGIN  
  BEGIN TRY  
  BEGIN TRANSACTION  
  --SET @Location=''O''  
  --SET @VesselCode=''AGE''  
  ----------------  
  DECLARE @Max int  
  DECLARE @PacketName VARCHAR(50)  
  DECLARE @LastUpdated VARCHAR(50)  
  ------------------  
  SELECT @Max=ISNULL(MAX(ROWID),0)+1 FROM IE_PACKETCREATED WHERE VESSELCODE=@VesselCode  
  SET @PacketName=@VesselCode+''_''+@Location+''_''+CONVERT(VARCHAR,year(getdate()))+''_''+ REPLACE(STR(month(getdate()),2),'' '',''0'') + ''_'' + REPLACE(STR(CONVERT(VARCHAR,@Max),5),'' '',''0'')  
  SELECT TOP 1 @LastUpdated=PACKETNAME FROM IE_PacketReceived WHERE VESSELCODE=@VesselCode ORDER BY CAST( SUBSTRING(PacketName,15,5) AS INT) DESC  
  ------------------  
  INSERT INTO IE_PACKETCREATED(VESSELCODE,ROWID,PACKETNAME,PACKETDATE) VALUES(@VesselCode,@Max,@PacketName,GETDATE())  
  DECLARE @TEMP_TABLE TABLE(TABLID VARCHAR(50),PKSTRING VARCHAR(50),UPDATEDON SMALLDATETIME)   
  INSERT INTO @TEMP_TABLE EXEC dbo.sp_IE_getDataForExport_2 @Location,@VesselCode,''L''  
  INSERT INTO IE_PACKETCREATEDDETAILS SELECT @VesselCode,@Max,* FROM @TEMP_TABLE  
  ------------------  
  EXEC dbo.sp_IE_getDataForExport_2 @Location,@VesselCode,''D''  
  SELECT @PacketName AS PACKETNAME,@LastUpdated AS LASTPACKETACK, 2 AS [Version]  
 COMMIT TRANSACTION  
 END TRY  
 BEGIN CATCH  
     ROLLBACK TRANSACTION  
 END CATCH  
END  
  
  
  
  
  
  ' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_FlushPacketLog]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_FlushPacketLog]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_FlushPacketLog]
(
	@VesselCode CHAR(3),
	@PacketName VARCHAR(50)
)
AS
BEGIN

DECLARE @ROWID INT

SELECT @ROWID = RowId FROM IE_PacketCreated WHERE VesselCode = @VesselCode AND LTRIM(RTRIM(PacketName)) = LTRIM(RTRIM(@PacketName))

-- MAKE QUERY FROM dbo.IE_PacketCreatedDetails

    DECLARE @TABLEID VARCHAR(50)
	DECLARE @PKSTRING VARCHAR(50)
	DECLARE @UPDATEDON SMALLDATETIME	
   	  
	DECLARE FLUSHPACKET_CURSOR CURSOR FOR
	SELECT TableID,PKString,UpdatedOn  FROM IE_PacketCreatedDetails WHERE VesselCode = @VesselCode AND RowId = @ROWID

	OPEN FLUSHPACKET_CURSOR	
	FETCH NEXT FROM FLUSHPACKET_CURSOR into @TABLEID,@PKSTRING,@UPDATEDON
	WHILE @@FETCH_STATUS = 0
	BEGIN
	     ------------- INIT SECTION (INSIDE LOOP)
			DECLARE @IN_PARAM VARCHAR(7000)
			DECLARE @SEPRATOR CHAR(1)
			SET @SEPRATOR=''#''
			SET @IN_PARAM= LTRIM(RTRIM(@PKSTRING))
			DECLARE @LIS INT
			DECLARE @LIE INT
			SET @LIS=0
			SET @LIE=0
			
			IF(@TABLEID = ''O1'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_O1 CHAR(3)
				DECLARE @PART2_O1 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O1=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_O1=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_ComponentMasterForVessel				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode = @PART1_O1 AND ComponentId = @PART2_O1 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''O2'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_O2 CHAR(3)
				DECLARE @PART2_O2 BIGINT
				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O2=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_O2=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE VSL_VesselComponentJobMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_O2 AND CompJobId = @PART2_O2 AND UpdatedOn <= @UPDATEDON			
			
			END
			IF(@TABLEID = ''O3'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_O3 CHAR(3)
				DECLARE @PART2_O3 BIGINT
				DECLARE @PART3_O3 CHAR(1)
				DECLARE @PART4_O3 BIGINT
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O3=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS+1)
				SET @PART2_O3=CAST(SUBSTRING(@IN_PARAM,@LIS+1,@LIE-@LIS-1) AS BIGINT)
				SET @LIS=@LIE

				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS+1)
				SET @PART3_O3=SUBSTRING(@IN_PARAM,@LIS+1,@LIE-@LIS-1)
				SET @LIS=@LIE
				
				---- LAST LINE
				SET @PART4_O3=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE VSL_VesselSpareMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_O3 AND ComponentId = @PART2_O3 AND Office_Ship = @PART3_O3 AND SpareId= @PART4_O3 AND UpdatedOn <= @UPDATEDON			
			
			END
			IF(@TABLEID = ''O4'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_O4 CHAR(3)
				DECLARE @PART2_O4 BIGINT
								
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O4=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_O4=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE VSL_VesselComponentJobMaster_Updates				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_O4 AND ComponentId = @PART2_O4 AND UpdatedOn <= @UPDATEDON			
			
			END
			IF(@TABLEID = ''O5'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_O5 CHAR(3)
				DECLARE @PART2_O5 BIGINT
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O5=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_O5=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)

				UPDATE VSL_VesselJobUpdateHistory_OfficeComments				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_O5 AND HISTORYID = @PART2_O5 AND UpdatedOn <= @UPDATEDON

			END
			IF(@TABLEID = ''S1'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S1 CHAR(3)
				DECLARE @PART2_S1 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S1=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S1=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_PlanMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S1 AND CompJobId = @PART2_S1 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''S2'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S2 CHAR(3)
				DECLARE @PART2_S2 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S2=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S2=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_VesselRunningHourMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S2 AND ComponentId = @PART2_S2 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''S3'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S3 CHAR(3)
				DECLARE @PART2_S3 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S3=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S3=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_VesselJobUpdateHistory				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S3 AND HistoryId = @PART2_S3 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''S4'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S4 VARCHAR(15)
				
				---- SINGLE LINE
				SET @PART1_S4=LTRIM(RTRIM(@IN_PARAM))
				
				     UPDATE Vsl_DefectDetailsMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	LTRIM(RTRIM(DefectNo)) = LTRIM(RTRIM(@PART1_S4)) AND UpdatedOn <= @UPDATEDON
			
			END
			IF(@TABLEID = ''S5'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_S5 CHAR(3)
				DECLARE @PART2_S5 BIGINT
				DECLARE @PART3_S5 CHAR(1)
				DECLARE @PART4_S5 BIGINT
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S5=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS+1)
				SET @PART2_S5=CAST(SUBSTRING(@IN_PARAM,@LIS+1,@LIE-@LIS-1) AS BIGINT)
				SET @LIS=@LIE

				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS+1)
				SET @PART3_S5=SUBSTRING(@IN_PARAM,@LIS+1,@LIE-@LIS-1)
				SET @LIS=@LIE
				
				---- LAST LINE
				SET @PART4_S5=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE VSL_VesselSpareMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_S5 AND ComponentId = @PART2_S5 AND Office_Ship = @PART3_S5 AND SpareId= @PART4_S5 AND UpdatedOn <= @UPDATEDON			
			
			END
			IF(@TABLEID = ''S6'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_S6 CHAR(3)
				DECLARE @PART2_S6 BIGINT
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S6=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S6=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE VSL_VesselComponentJobMaster_Updates				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_S6 AND CompJobId = @PART2_S6 AND UpdatedOn <= @UPDATEDON			
			
			END
			IF(@TABLEID = ''S7'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_S7 CHAR(3)
				DECLARE @PART2_S7 BIGINT
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S7=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S7=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE VSL_StockInventory				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_S7 AND PkId = @PART2_S7 AND UpdatedOn <= @UPDATEDON			
			
			END
			IF(@TABLEID = ''S8'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S8 CHAR(3)
				DECLARE @PART2_S8 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S8=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S8=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_UnPlannedJobs				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S8 AND UPId = @PART2_S8 AND UpdatedOn	<= 	@UPDATEDON
			
			END
	-------------------------- 
	FETCH NEXT FROM FLUSHPACKET_CURSOR into @TABLEID,@PKSTRING,@UPDATEDON
	END
	CLOSE FLUSHPACKET_CURSOR
	DEALLOCATE FLUSHPACKET_CURSOR
END










' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_FlushPacketLog_2]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_FlushPacketLog_2]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_FlushPacketLog_2]
(
	@VesselCode CHAR(3),
	@PacketName VARCHAR(50)
)
AS
BEGIN

DECLARE @ROWID INT

SELECT @ROWID = RowId FROM IE_PacketCreated WHERE VesselCode = @VesselCode AND LTRIM(RTRIM(PacketName)) = LTRIM(RTRIM(@PacketName))

-- MAKE QUERY FROM dbo.IE_PacketCreatedDetails

    DECLARE @TABLEID VARCHAR(50)
	DECLARE @PKSTRING VARCHAR(50)
	DECLARE @UPDATEDON SMALLDATETIME	
   	  
	DECLARE FLUSHPACKET_CURSOR CURSOR FOR
	SELECT TableID,PKString,UpdatedOn  FROM IE_PacketCreatedDetails WHERE VesselCode = @VesselCode AND RowId = @ROWID

	OPEN FLUSHPACKET_CURSOR	
	FETCH NEXT FROM FLUSHPACKET_CURSOR into @TABLEID,@PKSTRING,@UPDATEDON
	WHILE @@FETCH_STATUS = 0
	BEGIN
	     ------------- INIT SECTION (INSIDE LOOP)
			DECLARE @IN_PARAM VARCHAR(7000)
			DECLARE @SEPRATOR CHAR(1)
			SET @SEPRATOR=''#''
			SET @IN_PARAM= LTRIM(RTRIM(@PKSTRING))
			DECLARE @LIS INT
			DECLARE @LIE INT
			SET @LIS=0
			SET @LIE=0
			
			IF(@TABLEID = ''O1'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_O1 CHAR(3)
				DECLARE @PART2_O1 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O1=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_O1=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_ComponentMasterForVessel				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode = @PART1_O1 AND ComponentId = @PART2_O1 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''O2'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_O2 CHAR(3)
				DECLARE @PART2_O2 BIGINT
				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O2=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_O2=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE VSL_VesselComponentJobMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_O2 AND CompJobId = @PART2_O2 AND UpdatedOn <= @UPDATEDON			
			
			END
			IF(@TABLEID = ''O3'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_O3 CHAR(3)
				DECLARE @PART2_O3 BIGINT
				DECLARE @PART3_O3 CHAR(1)
				DECLARE @PART4_O3 BIGINT
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O3=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS+1)
				SET @PART2_O3=CAST(SUBSTRING(@IN_PARAM,@LIS+1,@LIE-@LIS-1) AS BIGINT)
				SET @LIS=@LIE

				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS+1)
				SET @PART3_O3=SUBSTRING(@IN_PARAM,@LIS+1,@LIE-@LIS-1)
				SET @LIS=@LIE
				
				---- LAST LINE
				SET @PART4_O3=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE VSL_VesselSpareMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_O3 AND ComponentId = @PART2_O3 AND Office_Ship = @PART3_O3 AND SpareId= @PART4_O3 AND UpdatedOn <= @UPDATEDON			
			
			END
			IF(@TABLEID = ''O4'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_O4 CHAR(3)
				DECLARE @PART2_O4 BIGINT
								
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O4=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_O4=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE VSL_VesselComponentJobMaster_Updates				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_O4 AND ComponentId = @PART2_O4 AND UpdatedOn <= @UPDATEDON			
			
			END
			IF(@TABLEID = ''O5'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_O5 CHAR(3)
				DECLARE @PART2_O5 BIGINT
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O5=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_O5=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)

				UPDATE VSL_VesselJobUpdateHistory_OfficeComments				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_O5 AND HISTORYID = @PART2_O5 AND UpdatedOn <= @UPDATEDON

			END
			
			------------------ DEFECT REMARKS/ SHUT DOWN SECTION ----------------------------
			
			IF(@TABLEID = ''O6'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_O6 CHAR(3)
				DECLARE @PART2_O6 BIGINT
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O6=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_O6=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)

				UPDATE VSL_DefectRemarks				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_O6 AND DefectRemarkId = @PART2_O6 AND UpdatedOn <= @UPDATEDON

			END
			IF(@TABLEID = ''O7'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_O7 CHAR(3)
				DECLARE @PART2_O7 BIGINT
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O7=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_O7=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)

				UPDATE VSL_CriticalShutdownApproval				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_O7 AND ShutdownApproveId = @PART2_O7 AND UpdatedOn <= @UPDATEDON

			END
			IF(@TABLEID = ''O8'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_O8 CHAR(3)
				DECLARE @PART2_O8 BIGINT
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O8=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_O8=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)

				UPDATE VSL_CriticalShutdownExtensionApproval				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_O8 AND ExtensionApproveId = @PART2_O8 AND UpdatedOn <= @UPDATEDON

			END
			
			
			IF(@TABLEID = ''S1'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S1 CHAR(3)
				DECLARE @PART2_S1 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S1=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S1=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_PlanMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S1 AND CompJobId = @PART2_S1 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''S2'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S2 CHAR(3)
				DECLARE @PART2_S2 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S2=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S2=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_VesselRunningHourMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S2 AND ComponentId = @PART2_S2 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''S3'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S3 CHAR(3)
				DECLARE @PART2_S3 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S3=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S3=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_VesselJobUpdateHistory				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S3 AND HistoryId = @PART2_S3 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''S4'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S4 VARCHAR(15)
				
				---- SINGLE LINE
				SET @PART1_S4=LTRIM(RTRIM(@IN_PARAM))
				
				     UPDATE Vsl_DefectDetailsMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	LTRIM(RTRIM(DefectNo)) = LTRIM(RTRIM(@PART1_S4)) AND UpdatedOn <= @UPDATEDON
			
			END
			IF(@TABLEID = ''S5'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_S5 CHAR(3)
				DECLARE @PART2_S5 BIGINT
				DECLARE @PART3_S5 CHAR(1)
				DECLARE @PART4_S5 BIGINT
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S5=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS+1)
				SET @PART2_S5=CAST(SUBSTRING(@IN_PARAM,@LIS+1,@LIE-@LIS-1) AS BIGINT)
				SET @LIS=@LIE

				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS+1)
				SET @PART3_S5=SUBSTRING(@IN_PARAM,@LIS+1,@LIE-@LIS-1)
				SET @LIS=@LIE
				
				---- LAST LINE
				SET @PART4_S5=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE VSL_VesselSpareMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_S5 AND ComponentId = @PART2_S5 AND Office_Ship = @PART3_S5 AND SpareId= @PART4_S5 AND UpdatedOn <= @UPDATEDON			
			
			END
			IF(@TABLEID = ''S6'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_S6 CHAR(3)
				DECLARE @PART2_S6 BIGINT
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S6=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S6=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE VSL_VesselComponentJobMaster_Updates				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_S6 AND CompJobId = @PART2_S6 AND UpdatedOn <= @UPDATEDON			
			
			END
			IF(@TABLEID = ''S7'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_S7 CHAR(3)
				DECLARE @PART2_S7 BIGINT
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S7=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S7=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE VSL_StockInventory				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				WHERE VesselCode = @PART1_S7 AND PkId = @PART2_S7 AND UpdatedOn <= @UPDATEDON			
			
			END
			IF(@TABLEID = ''S8'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S8 CHAR(3)
				DECLARE @PART2_S8 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S8=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S8=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_UnPlannedJobs				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S8 AND UPId = @PART2_S8 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			
			------------------ DEFECT REMARKS/ SHUT DOWN SECTION ----------------------------
						
			IF(@TABLEID = ''S9'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S9 CHAR(3)
				DECLARE @PART2_S9 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S9=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S9=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_CriticalEquipShutdownRequest				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S9 AND ShutdownId = @PART2_S9 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''S10'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S10 CHAR(3)
				DECLARE @PART2_S10 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S10=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S10=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_CriticalShutdownExtensions				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S10 AND ExtensionId = @PART2_S10 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''S11'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S11 CHAR(3)
				DECLARE @PART2_S11 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S11=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S11=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_Defects_Attachments				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S11 AND AttachmentId = @PART2_S11 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			
			
	-------------------------- 
	FETCH NEXT FROM FLUSHPACKET_CURSOR into @TABLEID,@PKSTRING,@UPDATEDON
	END
	CLOSE FLUSHPACKET_CURSOR
	DEALLOCATE FLUSHPACKET_CURSOR
END










' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_getDataForExport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_getDataForExport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE procedure [dbo].[sp_IE_getDataForExport]
(
	@Location char(1),
	@VesselCode char(3),
	@DataType char(1) -- D- Data, L-Log
)
AS
BEGIN
	-- check database exists
	-- check database is same for selected ship
	-- ===============================================================================
	-- 1- DATA
	IF (@DataType=''D'') -- DATA 
	BEGIN
		IF (@Location=''O'')
		BEGIN
		-- 1-1 COMPONENT MASTER DATA
			SELECT * FROM dbo.VSL_ComponentMasterForVessel WHERE VESSELCODE = @VesselCode AND Updated = 1 
			SELECT * FROM dbo.ComponentMaster WHERE COMPONENTID IN (SELECT COMPONENTID FROM dbo.VSL_ComponentMasterForVessel WHERE VESSELCODE = @VesselCode AND Updated = 1)
		-- 1-2 JOB MASTER DATA	
			SELECT * FROM dbo.VSL_VesselComponentJobMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 
			SELECT * FROM dbo.ComponentsJobMapping WHERE COMPJOBID IN (SELECT COMPJOBID FROM dbo.VSL_VesselComponentJobMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 ) 
			SELECT * FROM dbo.JobMaster WHERE JOBID IN (SELECT DISTINCT JOBID FROM dbo.VSL_VesselComponentJobMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 ) 
		-- 1-3 JOB MASTER DATA UPDATES	
			SELECT * FROM dbo.VSL_VesselComponentJobMaster_Updates WHERE VESSELCODE = @VesselCode AND Updated = 1 
		-- 1-4 ATTACHMENTS ( JOB MAPPING & VESSEL SPECIFIC )
			SELECT * FROM dbo.VSL_VesselComponentJobMaster_Attachments WHERE COMPJOBID IN (SELECT COMPJOBID FROM dbo.VSL_VesselComponentJobMaster WHERE VESSELCODE = @VesselCode AND Updated = 1)
			SELECT * FROM dbo.ComponentsJobMapping_Attachments WHERE COMPJOBID IN (SELECT COMPJOBID FROM dbo.VSL_VesselComponentJobMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 )
		-- 1-5 HISTORY COMMENTS
			SELECT * FROM dbo.VSL_VesselJobUpdateHistory_OfficeComments WHERE VESSELCODE = @VesselCode AND Updated = 1
		END
		IF (@Location=''S'')
		BEGIN
		-- 1-3 PLANNING DATA (HAVING ERROR BECAUSE TABLE STRUCTURE IS INSERT ONCE AND UPDATE FOREEVER)
			SELECT * FROM dbo.VSL_PlanMaster WHERE VESSELCODE = @VesselCode AND Updated = 1  
		-- 1-4 RUNNING HOUR DATA (MAY HAVE ERROR - BECAUSE NOT CLEAR COLUMNS CONTINS USER DATA OR MAINTAINANCE DATA)
			SELECT * FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE = @VesselCode AND Updated = 1   
		-- 1-5 JOB UPDATE HISTORY ( EXECUTE / CANCEL / POSTPONE / BREAK DOWN DATA )	(NOT CLEAR MAY RECORD UPDATED OR NOT NEEDED TO UPDATE)
			SELECT * FROM dbo.VSL_VesselJobUpdateHistory WHERE VESSELCODE = @VesselCode AND Updated = 1   
		-- 1-6 DEFECT REPORTING DATA ( MAY HAVE ERROR - BECAUSE NOT CLEAR COLUMNS CONTAINS USER DATA OR MAINTAINANCE DATA )
			SELECT * FROM dbo.VSL_DefectSpareDetails WHERE DEFECTNO IN (SELECT DEFECTNO FROM dbo.Vsl_DefectDetailsMaster WHERE VESSELCODE = @VesselCode AND Updated = 1)
			SELECT * FROM dbo.VSL_DefectDetailsMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 
		-- 1-7 JOB UPDATE DATA 
			SELECT * FROM dbo.VSL_VesselComponentJobMaster_Updates WHERE VESSELCODE = @VesselCode AND Updated = 1
		-- 1-8 HISTORY DATA (DETAILS ATTACHMENTS)
			SELECT * FROM dbo.VSL_VesselJobUpdateHistoryAttachments WHERE VESSELCODE = @VesselCode AND HistoryId In (SELECT HistoryId FROM dbo.VSL_VesselJobUpdateHistory WHERE VESSELCODE = @VesselCode AND Updated = 1)
		-- 1-9 HISTORY DATA (DETAILS SPARES)
			SELECT * FROM dbo.VSL_VesselJobUpdateHistorySpareDetails WHERE VESSELCODE = @VesselCode AND HistoryId In (SELECT HistoryId FROM dbo.VSL_VesselJobUpdateHistory WHERE VESSELCODE = @VesselCode AND Updated = 1) 
		-- 1-10 SPARE STOCK RECEIVED
			SELECT * FROM dbo.VSL_StockInventory WHERE VESSELCODE = @VesselCode AND Updated = 1   

		-- 1-11 UNPLANNED JOB UPDATE DATA 
			SELECT * FROM dbo.VSL_UnPlannedJobs WHERE VESSELCODE = @VesselCode AND Updated = 1
		-- 1-12 UNPLANNED JOB (DETAILS ATTACHMENTS)
			SELECT * FROM dbo.VSL_UnPlannedJobs_Attachments WHERE VESSELCODE = @VesselCode AND UPId In (SELECT UPId FROM dbo.VSL_UnPlannedJobs WHERE VESSELCODE = @VesselCode AND Updated = 1)
		-- 1-13 UNPLANNED JOB (DETAILS SPARES)
			SELECT * FROM dbo.VSL_UnPlannedJobs_SpareDetails WHERE VESSELCODE = @VesselCode AND UPId In (SELECT UPId FROM dbo.VSL_UnPlannedJobs WHERE VESSELCODE = @VesselCode AND Updated = 1) 
		
		END
		-- 1-7 SPARE DATA (2 WAY DATA CHANGES AT BOTH LOCATION)
		SELECT * FROM VSL_VesselSpareMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 
		-- ===============================================================================
	END
	ELSE -- LOG
	BEGIN
		IF (@Location=''O'')
		BEGIN
		-- 1-1 COMPONENT MASTER LOG
			SELECT ''O1'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPONENTID)AS PKString,UPDATEDON FROM dbo.VSL_ComponentMasterForVessel WHERE VESSELCODE = @VesselCode AND Updated = 1 
			UNION
		-- 1-2 JOB MASTER LOG	
			SELECT ''O2'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPJOBID)AS PKString,UPDATEDON FROM dbo.VSL_VesselComponentJobMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 
			UNION
		-- 1-3 SPARE DATA (2 WAY DATA CHANGES AT BOTH LOCATION)
			SELECT ''O3'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPONENTID)+''#''+OFFICE_SHIP+''#''+CONVERT(VARCHAR,SPAREID)AS PKString,UPDATEDON FROM VSL_VesselSpareMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 
			UNION
		-- 1-4 JOB UPDATE DATA 
			SELECT ''O4'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPJOBID)AS PKString,UPDATEDON FROM dbo.VSL_VesselComponentJobMaster_Updates WHERE VESSELCODE = @VesselCode AND Updated = 1 
			UNION
		-- 1-5 HISTORY COMMENTS
			SELECT ''O5'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,HISTORYID)AS PKString,UPDATEDON FROM dbo.VSL_VesselJobUpdateHistory_OfficeComments WHERE VESSELCODE = @VesselCode AND Updated = 1 
		END
		IF (@Location=''S'')
		BEGIN
		-- 1-3 PLANNING DATA (HAVING ERROR BECAUSE TABLE STRUCTURE IS INSERT ONCE AND UPDATE FOREEVER)
			SELECT ''S1'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPJOBID)AS PKString,UPDATEDON FROM dbo.VSL_PlanMaster WHERE VESSELCODE = @VesselCode AND Updated = 1  
			UNION
		-- 1-4 RUNNING HOUR DATA (MAY HAVE ERROR - BECAUSE NOT CLEAR COLUMNS CONTINS USER DATA OR MAINTAINANCE DATA)
			SELECT ''S2'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPONENTID)AS PKString,UPDATEDON FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE = @VesselCode AND Updated = 1   
			UNION
		-- 1-5 JOB UPDATE HISTORY ( EXECUTE / CANCEL / POSTPONE / BREAK DOWN DATA )	(NOT CLEAR MAY RECORD UPDATED OR NOT NEEDED TO UPDATE)
			SELECT ''S3'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,HISTORYID)AS PKString,UPDATEDON FROM dbo.VSL_VesselJobUpdateHistory WHERE VESSELCODE = @VesselCode AND Updated = 1   
			UNION
		-- 1-6 DEFECT REPORTING DATA  (MAY HAVE ERROR - BECAUSE NOT CLEAR COLUMNS CONTINS USER DATA OR MAINTAINANCE DATA)
			SELECT ''S4'' AS TABLEID,DefectNo AS PKString,UPDATEDON FROM dbo.Vsl_DefectDetailsMaster WHERE VESSELCODE = @VesselCode AND Updated = 1   
			UNION
		-- 1-7 SPARE DATA (2 WAY DATA CHANGES AT BOTH LOCATION)
			SELECT ''S5'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPONENTID)+''#''+OFFICE_SHIP+''#''+CONVERT(VARCHAR,SPAREID)AS PKString,UPDATEDON FROM VSL_VesselSpareMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 
			UNION
		-- 1-8 JOB UPDATE DATA 
			SELECT ''S6'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPJOBID)AS PKString,UPDATEDON FROM dbo.VSL_VesselComponentJobMaster_Updates WHERE VESSELCODE = @VesselCode AND Updated = 1 
			UNION	
		-- 1-9 SPARE STOCK RECEIVED
			SELECT ''S7'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,PKID)AS PKString,UPDATEDON FROM dbo.VSL_StockInventory WHERE VESSELCODE = @VesselCode AND Updated = 1   
			UNION
		-- 1-10 SPARE STOCK RECEIVED
			SELECT ''S8'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,UPID)AS PKString,UPDATEDON FROM dbo.VSL_UnPlannedJobs WHERE VESSELCODE = @VesselCode AND Updated = 1   
		END
		-- ===============================================================================
	END
END











' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_getDataForExport_2]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_getDataForExport_2]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE procedure [dbo].[sp_IE_getDataForExport_2]
(
	@Location char(1),
	@VesselCode char(3),
	@DataType char(1) -- D- Data, L-Log
)
AS
BEGIN
	-- check database exists
	-- check database is same for selected ship
	-- ===============================================================================
	-- 1- DATA
	IF (@DataType=''D'') -- DATA 
	BEGIN
		IF (@Location=''O'')
		BEGIN
		-- 1-1 COMPONENT MASTER DATA
			SELECT * FROM dbo.VSL_ComponentMasterForVessel WHERE VESSELCODE = @VesselCode AND Updated = 1 
			SELECT * FROM dbo.ComponentMaster WHERE COMPONENTID IN (SELECT COMPONENTID FROM dbo.VSL_ComponentMasterForVessel WHERE VESSELCODE = @VesselCode AND Updated = 1)
		-- 1-2 JOB MASTER DATA	
			SELECT * FROM dbo.VSL_VesselComponentJobMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 
			SELECT * FROM dbo.ComponentsJobMapping WHERE COMPJOBID IN (SELECT COMPJOBID FROM dbo.VSL_VesselComponentJobMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 ) 
			SELECT * FROM dbo.JobMaster WHERE JOBID IN (SELECT DISTINCT JOBID FROM dbo.VSL_VesselComponentJobMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 ) 
		-- 1-3 JOB MASTER DATA UPDATES	
			SELECT * FROM dbo.VSL_VesselComponentJobMaster_Updates WHERE VESSELCODE = @VesselCode AND Updated = 1 
		-- 1-4 ATTACHMENTS ( JOB MAPPING & VESSEL SPECIFIC )
			SELECT * FROM dbo.VSL_VesselComponentJobMaster_Attachments WHERE COMPJOBID IN (SELECT COMPJOBID FROM dbo.VSL_VesselComponentJobMaster WHERE VESSELCODE = @VesselCode AND Updated = 1)
			SELECT * FROM dbo.ComponentsJobMapping_Attachments WHERE COMPJOBID IN (SELECT COMPJOBID FROM dbo.VSL_VesselComponentJobMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 )
		-- 1-5 HISTORY COMMENTS
			SELECT * FROM dbo.VSL_VesselJobUpdateHistory_OfficeComments WHERE VESSELCODE = @VesselCode AND Updated = 1
		-- 1-6 DEFECT REMARKS
			SELECT * FROM dbo.VSL_DefectRemarks WHERE VESSELCODE = @VesselCode AND DEFECTNO IN (SELECT DEFECTNO FROM dbo.Vsl_DefectDetailsMaster WHERE VESSELCODE = @VesselCode) AND Updated = 1
		-- 1-7 SHUT DOWN APPROVAL
			SELECT * FROM dbo.VSL_CriticalShutdownApproval WHERE VESSELCODE = @VesselCode AND ShutdownId IN (SELECT ShutdownId FROM dbo.VSL_CriticalEquipShutdownRequest WHERE VESSELCODE = @VesselCode ) AND Updated = 1
		-- 1-8 SHUT DOWN EXTENSION APPROVAL
			SELECT * FROM dbo.VSL_CriticalShutdownExtensionApproval WHERE VESSELCODE = @VesselCode AND ExtensionId IN (SELECT ExtensionId FROM dbo.VSL_CriticalShutdownExtensions WHERE ShutdownId IN (SELECT ShutdownId FROM dbo.VSL_CriticalEquipShutdownRequest WHERE VESSELCODE = @VesselCode )) AND Updated = 1  
		
		-- Added New Table
			SELECT * FROM dbo.ComponentJobMapping_OtherRanks WHERE COMPJOBID IN (SELECT COMPJOBID FROM dbo.VSL_VesselComponentJobMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 ) 

		END
		IF (@Location=''S'')
		BEGIN
		-- 1-3 PLANNING DATA (HAVING ERROR BECAUSE TABLE STRUCTURE IS INSERT ONCE AND UPDATE FOREEVER)
			SELECT * FROM dbo.VSL_PlanMaster WHERE VESSELCODE = @VesselCode AND Updated = 1  
		-- 1-4 RUNNING HOUR DATA (MAY HAVE ERROR - BECAUSE NOT CLEAR COLUMNS CONTINS USER DATA OR MAINTAINANCE DATA)
			SELECT * FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE = @VesselCode AND Updated = 1   
		-- 1-5 JOB UPDATE HISTORY ( EXECUTE / CANCEL / POSTPONE / BREAK DOWN DATA )	(NOT CLEAR MAY RECORD UPDATED OR NOT NEEDED TO UPDATE)
			SELECT * FROM dbo.VSL_VesselJobUpdateHistory WHERE VESSELCODE = @VesselCode AND Updated = 1   
		-- 1-6 DEFECT REPORTING DATA ( MAY HAVE ERROR - BECAUSE NOT CLEAR COLUMNS CONTAINS USER DATA OR MAINTAINANCE DATA )
			SELECT * FROM dbo.VSL_DefectSpareDetails WHERE DEFECTNO IN (SELECT DEFECTNO FROM dbo.Vsl_DefectDetailsMaster WHERE VESSELCODE = @VesselCode AND Updated = 1)
			SELECT * FROM dbo.VSL_DefectDetailsMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 
		-- 1-7 JOB UPDATE DATA 
			SELECT * FROM dbo.VSL_VesselComponentJobMaster_Updates WHERE VESSELCODE = @VesselCode AND Updated = 1
		-- 1-8 HISTORY DATA (DETAILS ATTACHMENTS)
			SELECT * FROM dbo.VSL_VesselJobUpdateHistoryAttachments WHERE VESSELCODE = @VesselCode AND HistoryId In (SELECT HistoryId FROM dbo.VSL_VesselJobUpdateHistory WHERE VESSELCODE = @VesselCode AND Updated = 1)
		-- 1-9 HISTORY DATA (DETAILS SPARES)
			SELECT * FROM dbo.VSL_VesselJobUpdateHistorySpareDetails WHERE VESSELCODE = @VesselCode AND HistoryId In (SELECT HistoryId FROM dbo.VSL_VesselJobUpdateHistory WHERE VESSELCODE = @VesselCode AND Updated = 1) 
		-- 1-10 SPARE STOCK RECEIVED
			SELECT * FROM dbo.VSL_StockInventory WHERE VESSELCODE = @VesselCode AND Updated = 1   

		-- 1-11 UNPLANNED JOB UPDATE DATA 
			SELECT * FROM dbo.VSL_UnPlannedJobs WHERE VESSELCODE = @VesselCode AND Updated = 1
		-- 1-12 UNPLANNED JOB (DETAILS ATTACHMENTS)
			SELECT * FROM dbo.VSL_UnPlannedJobs_Attachments WHERE VESSELCODE = @VesselCode AND UPId In (SELECT UPId FROM dbo.VSL_UnPlannedJobs WHERE VESSELCODE = @VesselCode AND Updated = 1)
		-- 1-13 UNPLANNED JOB (DETAILS SPARES)
			SELECT * FROM dbo.VSL_UnPlannedJobs_SpareDetails WHERE VESSELCODE = @VesselCode AND UPId In (SELECT UPId FROM dbo.VSL_UnPlannedJobs WHERE VESSELCODE = @VesselCode AND Updated = 1) 
		-- 1-14 SHUT DOWN REQUEST
			SELECT * FROM dbo.VSL_CriticalEquipShutdownRequest WHERE VESSELCODE = @VesselCode AND Updated = 1
		-- 1-15 SHUT DOWN EXTENSION
			SELECT * FROM dbo.VSL_CriticalShutdownExtensions WHERE VESSELCODE = @VesselCode AND ShutdownId IN (SELECT ShutdownId FROM dbo.VSL_CriticalEquipShutdownRequest WHERE VESSELCODE = @VesselCode) AND Updated = 1
		-- 1-16 DEFECT ATTACHMENT
			SELECT * FROM dbo.VSL_Defects_Attachments WHERE VESSELCODE = @VesselCode AND DEFECTNO IN (SELECT DEFECTNO FROM dbo.Vsl_DefectDetailsMaster WHERE VESSELCODE = @VesselCode) AND Updated = 1				
		
		END
		-- 1-7 SPARE DATA (2 WAY DATA CHANGES AT BOTH LOCATION)
		SELECT * FROM VSL_VesselSpareMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 
		-- ===============================================================================
	END
	ELSE -- LOG
	BEGIN
		IF (@Location=''O'')
		BEGIN
		-- 1-1 COMPONENT MASTER LOG
			SELECT ''O1'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPONENTID)AS PKString,UPDATEDON FROM dbo.VSL_ComponentMasterForVessel WHERE VESSELCODE = @VesselCode AND Updated = 1 
			UNION
		-- 1-2 JOB MASTER LOG	
			SELECT ''O2'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPJOBID)AS PKString,UPDATEDON FROM dbo.VSL_VesselComponentJobMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 
			UNION
		-- 1-3 SPARE DATA (2 WAY DATA CHANGES AT BOTH LOCATION)
			SELECT ''O3'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPONENTID)+''#''+OFFICE_SHIP+''#''+CONVERT(VARCHAR,SPAREID)AS PKString,UPDATEDON FROM VSL_VesselSpareMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 
			UNION
		-- 1-4 JOB UPDATE DATA 
			SELECT ''O4'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPJOBID)AS PKString,UPDATEDON FROM dbo.VSL_VesselComponentJobMaster_Updates WHERE VESSELCODE = @VesselCode AND Updated = 1 
			UNION
		-- 1-5 HISTORY COMMENTS
			SELECT ''O5'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,HISTORYID)AS PKString,UPDATEDON FROM dbo.VSL_VesselJobUpdateHistory_OfficeComments WHERE VESSELCODE = @VesselCode AND Updated = 1 
			UNION
		-- 1-6 DEFECT REMARKS
			SELECT ''O6'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,DefectRemarkId)AS PKString,UPDATEDON FROM dbo.VSL_DefectRemarks WHERE VESSELCODE = @VesselCode AND DEFECTNO IN (SELECT DEFECTNO FROM dbo.Vsl_DefectDetailsMaster WHERE VESSELCODE = @VesselCode) AND Updated = 1
			UNION
		-- 1-7 SHUT DOWN APPROVAL
			SELECT ''O7'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,ShutdownApproveId)AS PKString,UPDATEDON FROM dbo.VSL_CriticalShutdownApproval WHERE VESSELCODE = @VesselCode AND ShutdownId IN (SELECT ShutdownId FROM dbo.VSL_CriticalEquipShutdownRequest WHERE VESSELCODE = @VesselCode ) AND Updated = 1
			UNION
		-- 1-8 SHUT DOWN EXTENSION APPROVAL			
			SELECT ''O8'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,ExtensionApproveId)AS PKString,UPDATEDON FROM dbo.VSL_CriticalShutdownExtensionApproval WHERE VESSELCODE = @VesselCode AND ExtensionId IN (SELECT ExtensionId FROM dbo.VSL_CriticalShutdownExtensions WHERE ShutdownId IN (SELECT ShutdownId FROM dbo.VSL_CriticalEquipShutdownRequest WHERE VESSELCODE = @VesselCode )) AND Updated = 1   
		END
		IF (@Location=''S'')
		BEGIN
		-- 1-3 PLANNING DATA (HAVING ERROR BECAUSE TABLE STRUCTURE IS INSERT ONCE AND UPDATE FOREEVER)
			SELECT ''S1'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPJOBID)AS PKString,UPDATEDON FROM dbo.VSL_PlanMaster WHERE VESSELCODE = @VesselCode AND Updated = 1  
			UNION
		-- 1-4 RUNNING HOUR DATA (MAY HAVE ERROR - BECAUSE NOT CLEAR COLUMNS CONTINS USER DATA OR MAINTAINANCE DATA)
			SELECT ''S2'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPONENTID)AS PKString,UPDATEDON FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE = @VesselCode AND Updated = 1   
			UNION
		-- 1-5 JOB UPDATE HISTORY ( EXECUTE / CANCEL / POSTPONE / BREAK DOWN DATA )	(NOT CLEAR MAY RECORD UPDATED OR NOT NEEDED TO UPDATE)
			SELECT ''S3'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,HISTORYID)AS PKString,UPDATEDON FROM dbo.VSL_VesselJobUpdateHistory WHERE VESSELCODE = @VesselCode AND Updated = 1   
			UNION
		-- 1-6 DEFECT REPORTING DATA  (MAY HAVE ERROR - BECAUSE NOT CLEAR COLUMNS CONTINS USER DATA OR MAINTAINANCE DATA)
			SELECT ''S4'' AS TABLEID,DefectNo AS PKString,UPDATEDON FROM dbo.Vsl_DefectDetailsMaster WHERE VESSELCODE = @VesselCode AND Updated = 1   
			UNION
		-- 1-7 SPARE DATA (2 WAY DATA CHANGES AT BOTH LOCATION)
			SELECT ''S5'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPONENTID)+''#''+OFFICE_SHIP+''#''+CONVERT(VARCHAR,SPAREID)AS PKString,UPDATEDON FROM VSL_VesselSpareMaster WHERE VESSELCODE = @VesselCode AND Updated = 1 
			UNION
		-- 1-8 JOB UPDATE DATA 
			SELECT ''S6'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,COMPJOBID)AS PKString,UPDATEDON FROM dbo.VSL_VesselComponentJobMaster_Updates WHERE VESSELCODE = @VesselCode AND Updated = 1 
			UNION	
		-- 1-9 SPARE STOCK RECEIVED
			SELECT ''S7'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,PKID)AS PKString,UPDATEDON FROM dbo.VSL_StockInventory WHERE VESSELCODE = @VesselCode AND Updated = 1   
			UNION
		-- 1-10 SPARE STOCK RECEIVED
			SELECT ''S8'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,UPID)AS PKString,UPDATEDON FROM dbo.VSL_UnPlannedJobs WHERE VESSELCODE = @VesselCode AND Updated = 1   
		    UNION
		-- 1-11 SHUT DOWN REQUEST
			SELECT ''S9'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,ShutdownId)AS PKString,UPDATEDON FROM dbo.VSL_CriticalEquipShutdownRequest WHERE VESSELCODE = @VesselCode AND Updated = 1
			UNION
		-- 1-12 SHUT DOWN EXTENSION
			SELECT ''S10'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,ExtensionId)AS PKString,UPDATEDON FROM dbo.VSL_CriticalShutdownExtensions WHERE VESSELCODE = @VesselCode AND ShutdownId IN (SELECT ShutdownId FROM dbo.VSL_CriticalEquipShutdownRequest WHERE VESSELCODE = @VesselCode ) AND Updated = 1
			UNION
		-- 1-13 DEFECT ATTACHMENT
			SELECT ''S11'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,AttachmentId)AS PKString,UPDATEDON FROM dbo.VSL_Defects_Attachments WHERE VESSELCODE = @VesselCode AND DEFECTNO IN (SELECT DEFECTNO FROM dbo.Vsl_DefectDetailsMaster WHERE VESSELCODE = @VesselCode) AND Updated = 1				
		END
		-- ===============================================================================
	END
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_JobMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_JobMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_JobMaster]
(
	@JOBID bigint,
	@JOBCODE char(3),
	@JOBNAME varchar(50)
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM JobMaster WHERE JOBID = @JOBID )
BEGIN 
	INSERT INTO JobMaster
	(
		JOBID ,
		JOBCODE ,
		JOBNAME 
	)
	Values
	(
		@JOBID,
		@JOBCODE,
		@JOBNAME
	)
	END
ELSE 
BEGIN
	UPDATE JobMaster
	SET
		JOBCODE = @JOBCODE,
		JOBNAME = @JOBNAME
	WHERE JOBID = @JOBID
END
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_ReceivePacket]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_ReceivePacket]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_ReceivePacket]
(
	@VesselCode char(3),
	@PacketName VARCHAR(50)
)
AS
BEGIN
	----------------
	DECLARE @Max int
	SELECT @Max=ISNULL(MAX(PacketId),0)+1 FROM IE_PacketReceived
	INSERT INTO IE_PacketReceived SELECT @Max,@VesselCode,@PacketName,getdate()
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_AllRank]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_AllRank]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_AllRank]
(
	@RANKID int,
	@RANKCODE varchar(10),
	@RANKNAME varchar(50)
)
AS
BEGIN
	SET NOCOUNT ON
	INSERT INTO MP_AllRank
	(
	RANKID ,
	RANKCODE ,
	RANKNAME 
	)
	Values
	(
	@RANKID,
	@RANKCODE,
	@RANKNAME
	)
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_CreatePacket]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_CreatePacket]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_V1_MP_CreatePacket]
(
	@Location char(1),
	@VesselCode char(3),
	@Version int
)
AS
BEGIN
  BEGIN TRY
  BEGIN TRANSACTION
		--SET @Location=''O''
		--SET @VesselCode=''AGE''
		----------------
		DECLARE @Max int
		DECLARE @PacketName VARCHAR(50)
		DECLARE @LastUpdatedPacketId int
		------------------
		SELECT @Max=ISNULL(MAX(ROWID),0)+1 FROM IE_PACKETCREATED_MNP WHERE VESSELCODE=@VesselCode
		SET @PacketName=''MNPPACKET_'' + @VesselCode+''_''+@Location+''_''+CONVERT(VARCHAR,year(getdate()))+''_''+ REPLACE(STR(month(getdate()),2),'' '',''0'') + ''_'' + REPLACE(STR(CONVERT(VARCHAR,@Max),5),'' '',''0'')
		SELECT TOP 1 @LastUpdatedPacketId=MAX(PACKETID) FROM IE_PacketReceived_MNP WHERE VESSELCODE=@VesselCode
		------------------
		INSERT INTO IE_PACKETCREATED_MNP(VESSELCODE,ROWID,PACKETNAME,PACKETDATE) VALUES(@VesselCode,@Max,@PacketName,GETDATE())
		DECLARE @TEMP_TABLE TABLE(TABLID VARCHAR(50),PKSTRING VARCHAR(50),UPDATEDON SMALLDATETIME) 
		IF (@Version=1)
		BEGIN
			INSERT INTO @TEMP_TABLE EXEC dbo.sp_IE_V1_MP_getDataForExport @Location,@VesselCode,''L''
		END
		INSERT INTO IE_PACKETCREATEDDETAILS_MNP SELECT @VesselCode,@Max,* FROM @TEMP_TABLE
		------------------
		SELECT @Max as PacketId,@VesselCode As VesselCode,@PacketName AS PACKETNAME,@LastUpdatedPacketId AS LastUpdatedPacketId, 1 AS [Version]
		IF (@Version=1)
		BEGIN
			EXEC dbo.sp_IE_V1_MP_getDataForExport @Location,@VesselCode,''D''
		END
		
	COMMIT TRANSACTION
	END TRY
	BEGIN CATCH
	    ROLLBACK TRANSACTION
	END CATCH
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_CrewComplementDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_CrewComplementDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_CrewComplementDetails]
(
    @CCId bigint,
	@VesselCode char(3),
	@RankId int,
	@BudgetManning int,
	@BudgetNationality int
)
AS
BEGIN
SET NOCOUNT ON
	INSERT INTO MP_CrewComplementDetails
	(
		CCId,
		VesselCode,
		RankId,
		BudgetManning,
		BudgetNationality
	)
	Values
	(
		@CCId,
		@VesselCode,
		@RankId,
		@BudgetManning,
		@BudgetNationality
	)
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_CrewComplementMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_CrewComplementMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_CrewComplementMaster]
(
    @CCId bigint,
	@VesselCode char(3),
	@EffectiveFrom datetime,
	@Updated bit,
	@UpdatedOn smalldatetime,
	@AckRecd bit,
	@AckRecdOn smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM [dbo].[MP_CrewComplementMaster] WHERE VesselCode=@VesselCode AND [CCId] = @CCId)
	BEGIN 
		INSERT INTO MP_CrewComplementMaster
		(
			CCId,
			VesselCode,
			EffectiveFrom,
			Updated,
			UpdatedOn,
			AckRecd,
			AckRecdOn
		)
		Values
		(
			@CCId,
			@VesselCode,
			@EffectiveFrom,
			@Updated,
			@UpdatedOn,
			@AckRecd,
			@AckRecdOn
		)
	END	
	ELSE 
	BEGIN
		UPDATE MP_CrewComplementMaster
		SET
			CCId=@CCId,
			VesselCode=@VesselCode,
			EffectiveFrom=@EffectiveFrom,
			Updated=@Updated,
			UpdatedOn=@UpdatedOn,
			AckRecd=@AckRecd,
			AckRecdOn=@AckRecdOn
		WHERE VesselCode=@VesselCode AND [CCId] = @CCId
	END
	DELETE FROM [MP_CrewComplementDetails] WHERE VesselCode=@VesselCode AND [CCId] = @CCId
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_FlushPacketLog]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_FlushPacketLog]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_V1_MP_FlushPacketLog]
(
	@VesselCode CHAR(3),
	@PacketID int
)
AS
BEGIN

DECLARE @ROWID INT

SELECT @ROWID = @PacketID

-- MAKE QUERY FROM dbo.IE_PACKETCREATEDDETAILS_MNP

    DECLARE @TABLEID VARCHAR(50)
	DECLARE @PKSTRING VARCHAR(50)
	DECLARE @UPDATEDON SMALLDATETIME	
   	  
	DECLARE FLUSHPACKET_CURSOR CURSOR FOR
	SELECT TableID,PKString,UpdatedOn  FROM IE_PACKETCREATEDDETAILS_MNP WHERE VesselCode = @VesselCode AND RowId = @ROWID

	OPEN FLUSHPACKET_CURSOR	
	FETCH NEXT FROM FLUSHPACKET_CURSOR into @TABLEID,@PKSTRING,@UPDATEDON
	WHILE @@FETCH_STATUS = 0
	BEGIN
	     ------------- INIT SECTION (INSIDE LOOP)
			DECLARE @IN_PARAM VARCHAR(7000)
			DECLARE @SEPRATOR CHAR(1)
			SET @SEPRATOR=''#''
			SET @IN_PARAM= LTRIM(RTRIM(@PKSTRING))
			DECLARE @LIS INT
			DECLARE @LIE INT
			SET @LIS=0
			SET @LIE=0
			
			IF(@TABLEID = ''O1'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_O1 CHAR(3)
				DECLARE @PART2_O1 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O1=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_O1=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE VSL_MP_Products				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode = @PART1_O1 AND ProductId = @PART2_O1 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''O2'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_O2 CHAR(3)
				DECLARE @PART2_O2 BIGINT
				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O2=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_O2=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE MP_CrewComplementMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL,
						 [AckRecd]	= 1,
						 [AckRecdOn] = getdate()			     
				WHERE VesselCode = @PART1_O2 AND CCId = @PART2_O2 AND UpdatedOn <= @UPDATEDON			
			
			END
			IF(@TABLEID = ''O3'')
			BEGIN
			     ---------------- USER SECTION
				DECLARE @PART1_O3 CHAR(3)
				DECLARE @PART2_O3 BIGINT

								
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_O3=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE			
			
				
				---- LAST LINE
				SET @PART2_O3=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				UPDATE VSL_MP_MealConsumptionMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL,
						 [AckRecd] = 1,
						 [AckRecdOn] = getdate()		     
				WHERE VesselCode = @PART1_O3 AND [MealConsumptionId] = @PART2_O3 AND UpdatedOn <= @UPDATEDON			
			
			END
					
			
			IF(@TABLEID = ''S1'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S1 CHAR(3)
				DECLARE @PART2_S1 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S1=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S1=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE MP_VSL_InventoryMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S1 AND INVENTORYID = @PART2_S1 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''S2'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S2 CHAR(3)
				DECLARE @PART2_S2 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S2=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S2=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE MP_VSL_SupplyMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S2 AND SUPPLYID = @PART2_S2 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''S3'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S3 CHAR(3)
				DECLARE @PART2_S3 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S3=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S3=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE MP_VSL_ShipStaffMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S3 AND SHIPSTAFFID = @PART2_S3 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''S4'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S4 CHAR(3)
				DECLARE @PART2_S4 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S4=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S4=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE MP_VSL_AccountMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S4 AND ACCOUNTID = @PART2_S4 AND UpdatedOn	<= 	@UPDATEDON
			
			END
			IF(@TABLEID = ''S5'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S5 CHAR(3)
				DECLARE @PART2_S5 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S5=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S5=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE MP_VSL_ProvisionMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S5 AND PROVISIONID = @PART2_S5 AND UpdatedOn	<= 	@UPDATEDON
			
			END		
			IF(@TABLEID = ''S6'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S6 CHAR(3)
				DECLARE @PART2_S6 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S6=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S6=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE MP_VSL_SparesReqMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S6 AND SPAREREQID = @PART2_S6 AND UpdatedOn <= @UPDATEDON
			
			END
			IF(@TABLEID = ''S7'')
			BEGIN
			
			 ---------------- USER SECTION
				DECLARE @PART1_S7 CHAR(3)
				DECLARE @PART2_S7 BIGINT				
				
				---- FIRST LINE
				SET @LIE=CHARINDEX(@SEPRATOR,@IN_PARAM,@LIS)
				SET @PART1_S7=SUBSTRING(@IN_PARAM,@LIS,@LIE-@LIS)
				SET @LIS=@LIE
				---- LAST LINE
				SET @PART2_S7=CAST(SUBSTRING(@IN_PARAM,@LIS+1,LEN(@IN_PARAM)-@LIS) AS BIGINT)
				
				     UPDATE MP_VSL_StoreReqMaster				     
				     SET Updated = 0,
						 UpdatedOn = NULL				     
				     WHERE 	VesselCode  = @PART1_S7 AND STOREREQID = @PART2_S7 AND UpdatedOn <= @UPDATEDON
			
			END

	-------------------------- 
	FETCH NEXT FROM FLUSHPACKET_CURSOR into @TABLEID,@PKSTRING,@UPDATEDON
	END
	CLOSE FLUSHPACKET_CURSOR
	DEALLOCATE FLUSHPACKET_CURSOR
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_getDataForExport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_getDataForExport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE procedure [dbo].[sp_IE_V1_MP_getDataForExport]
(
	@Location char(1),
	@VesselCode char(3),
	@DataType char(1) -- D- Data, L-Log
)
AS
BEGIN
	-- check database exists
	-- check database is same for selected ship
	-- ===============================================================================
	-- 1- DATA
	IF (@DataType=''D'') -- DATA 
	BEGIN
		IF (@Location=''O'')
		BEGIN

		    SELECT * FROM [dbo].[MP_AllRank] -- LOG NOT NEEDED ( FULL TRANSFER )
			SELECT * FROM [dbo].[MP_MainCategory] -- LOG NOT NEEDED ( FULL TRANSFER ) 
			SELECT * FROM [dbo].[MP_MealsTypeMaster] -- LOG NOT NEEDED ( FULL TRANSFER ) 
			SELECT * FROM [dbo].[MP_NationalityMaster] -- LOG NOT NEEDED ( FULL TRANSFER ) 
			SELECT * FROM [dbo].[MP_UnitMaster] -- LOG NOT NEEDED ( FULL TRANSFER ) 
			select * from [dbo].[MP_VictualingMaster] WHERE VESSELCODE = @VesselCode -- LOG NOT NEEDED ( FULL TRANSFER ) 

			SELECT * FROM [dbo].[MP_Products] -- WHERE PRODUCTID IN (SELECT PRODUCTID FROM [dbo].[VSL_MP_Products] WHERE VESSELCODE=@VesselCode AND UPDATED=1)
			SELECT * FROM [dbo].[MP_Products_Packaging] -- WHERE PRODUCTID IN (SELECT PRODUCTID FROM [dbo].[VSL_MP_Products] WHERE VESSELCODE=@VesselCode AND UPDATED=1)
           
			SELECT * FROM [dbo].[MP_CrewComplementMaster] WHERE VESSELCODE = @VesselCode AND Updated = 1 
			SELECT * FROM [dbo].[MP_CrewComplementDetails] WHERE CCId IN (SELECT CCId FROM [dbo].[MP_CrewComplementMaster] WHERE VESSELCODE = @VesselCode AND Updated = 1 )

			SELECT * FROM [dbo].[MP_MealConsumptionMaster] WHERE MEALCONSUMPTIONID IN (SELECT MEALCONSUMPTIONID FROM  [dbo].[VSL_MP_MealConsumptionMaster] WHERE VESSELCODE=@VesselCode AND UPDATED=1)
			SELECT * FROM [dbo].[MP_MealConsumptionDetails] WHERE MEALCONSUMPTIONID IN (SELECT MEALCONSUMPTIONID FROM  [dbo].[VSL_MP_MealConsumptionMaster] WHERE VESSELCODE=@VesselCode AND UPDATED=1)
			
				
		END
		IF (@Location=''S'')
		BEGIN
		    
			UPDATE [dbo].[MP_VSL_ProvisionMaster] SET [SentOn]= getdate() WHERE VESSELCODE=@VesselCode AND UPDATED=1
			UPDATE [dbo].[MP_VSL_SparesReqMaster] SET [SentOn]= getdate() WHERE VESSELCODE=@VesselCode AND UPDATED=1
			UPDATE [dbo].[MP_VSL_StoreReqMaster] SET [SentOn]= getdate() WHERE VESSELCODE=@VesselCode AND UPDATED=1
			 
			select * from [dbo].[MP_VSL_InventoryMaster] WHERE VESSELCODE=@VesselCode AND UPDATED=1
			select * from [dbo].[MP_VSL_InventoryDetails] WHERE INVENTORYID IN (select INVENTORYID from [dbo].[MP_VSL_InventoryMaster] WHERE VESSELCODE=@VesselCode AND UPDATED=1)

			select * from [dbo].[MP_VSL_SupplyMaster] WHERE VESSELCODE=@VesselCode AND UPDATED=1
			select * from [dbo].[MP_VSL_SupplyDetails] SD WHERE SD.SUPPLYID IN (select SM.SUPPLYID from [dbo].[MP_VSL_SupplyMaster] SM WHERE VESSELCODE=@VesselCode AND UPDATED=1)

			select * from [dbo].[MP_VSL_ShipStaffMaster] WHERE VESSELCODE=@VesselCode AND UPDATED=1
			select * from [dbo].[MP_VSL_ShipStaffDetails] SSD WHERE SSD.SHIPSTAFFID IN (select SSM.SHIPSTAFFID from [dbo].[MP_VSL_ShipStaffMaster] SSM WHERE VESSELCODE=@VesselCode AND UPDATED=1)

			select * from [dbo].[MP_VSL_AccountMaster] WHERE VESSELCODE=@VesselCode AND UPDATED=1
			select * from [dbo].[MP_VSL_AccountDetails] AD WHERE AD.ACCOUNTID IN (select AM.ACCOUNTID from [dbo].[MP_VSL_AccountMaster] AM WHERE VESSELCODE=@VesselCode AND UPDATED=1)

		
		END
	END
	ELSE -- LOG
	BEGIN
		IF (@Location=''O'')
		BEGIN
			SELECT ''O1'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,PRODUCTID)AS PKString,UPDATEDON FROM [dbo].[VSL_MP_Products] WHERE VESSELCODE=@VesselCode AND UPDATED=1

			SELECT ''O2'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,CCID)AS PKString,UPDATEDON FROM [dbo].[MP_CrewComplementMaster] WHERE VESSELCODE=@VesselCode AND UPDATED=1

			SELECT ''O3'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,MEALCONSUMPTIONID)AS PKString,UPDATEDON FROM  [dbo].[VSL_MP_MealConsumptionMaster] WHERE VESSELCODE=@VesselCode AND UPDATED=1

		END
		IF (@Location=''S'')
		BEGIN
			SELECT ''S1'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,INVENTORYID)AS PKString,UPDATEDON FROM [dbo].[MP_VSL_InventoryMaster] WHERE VESSELCODE=@VesselCode AND UPDATED=1

			SELECT ''S2'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,SUPPLYID)AS PKString,UPDATEDON FROM [dbo].[MP_VSL_SupplyMaster] WHERE VESSELCODE=@VesselCode AND UPDATED=1

			SELECT ''S3'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,SHIPSTAFFID)AS PKString,UPDATEDON FROM [dbo].[MP_VSL_ShipStaffMaster] WHERE VESSELCODE=@VesselCode AND UPDATED=1

			SELECT ''S4'' AS TABLEID,VESSELCODE+''#''+CONVERT(VARCHAR,ACCOUNTID)AS PKString,UPDATEDON FROM [dbo].[MP_VSL_AccountMaster] WHERE VESSELCODE=@VesselCode AND UPDATED=1

		END
		-- ===============================================================================
	END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_MainCategory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_MainCategory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_V1_MP_MainCategory]
(
	@CATEGORYID bigint,
	@CATEGORYNAME varchar(50),
	@CATEGORYCODE char(5),
	@PARENTCATEGORYID bigint,
	@ORDERUNITID int,
	@CONSUMPTIONUNITID int,
	@CONVERSIONFACTOR float,
	@LEVEL char(1),
	@INACTIVE bit
)
AS
BEGIN
	SET NOCOUNT ON
	INSERT INTO MP_MainCategory
	(
	CATEGORYID ,
	CATEGORYNAME ,
	CATEGORYCODE ,
	PARENTCATEGORYID ,
	ORDERUNITID ,
	CONSUMPTIONUNITID ,
	CONVERSIONFACTOR ,
	LEVEL ,
	INACTIVE 
	)
	Values
	(
	@CATEGORYID,
	@CATEGORYNAME,
	@CATEGORYCODE,
	@PARENTCATEGORYID,
	@ORDERUNITID,
	@CONSUMPTIONUNITID,
	@CONVERSIONFACTOR,
	@LEVEL,
	@INACTIVE
	)
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_MealConsumptionDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_MealConsumptionDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_MealConsumptionDetails]
(
	@MealConsumptionDetailId bigint,
    @MealConsumptionId bigint,
	@CategoryId bigint,
	@UnitId bigint,
	@StdConsumption float
)
AS
BEGIN
SET NOCOUNT ON
		INSERT INTO MP_MealConsumptionDetails
		(
			MealConsumptionDetailId ,
			MealConsumptionId ,
			CategoryId ,
			UnitId ,
			StdConsumption 
		)
		Values
		(
			@MealConsumptionDetailId ,
			@MealConsumptionId ,
			@CategoryId ,
			@UnitId ,
			@StdConsumption 
		)
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_MealConsumptionMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_MealConsumptionMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_MealConsumptionMaster]
(
    @MealConsumptionId bigint,
	@NationalityId bigint,
	@MealId bigint,
	@Version varchar(50),
	@EffectiveFrom datetime
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM [dbo].[MP_MealConsumptionMaster] WHERE [MealConsumptionId] = @MealConsumptionId)
	BEGIN 
		INSERT INTO MP_MealConsumptionMaster
		(
			MealConsumptionId,
			NationalityId,
			MealId,
			[Version],
			EffectiveFrom
		)
		Values
		(
			@MealConsumptionId,
			@NationalityId,
			@MealId,
			@Version,
			@EffectiveFrom
		)
	END	
	ELSE 
	BEGIN
		UPDATE MP_MealConsumptionMaster
		SET
			MealConsumptionId=@MealConsumptionId,
			NationalityId=@NationalityId,
			MealId=@MealId,
			[Version]=@Version,
			EffectiveFrom=@EffectiveFrom
		WHERE [MealConsumptionId] = @MealConsumptionId
	END
	DELETE FROM [MP_MealConsumptionDetails] WHERE [MealConsumptionId] = @MealConsumptionId
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_MealsTypeMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_MealsTypeMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_V1_MP_MealsTypeMaster]
(
	 @MEALID bigint,
	 @MEALTYPE varchar(100)
)
AS
BEGIN
	INSERT INTO MP_MealsTypeMaster
	(
	MEALID ,
	MEALTYPE 
	)
	Values
	(
	@MEALID,
	@MEALTYPE
	)
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_NationalityMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_NationalityMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_V1_MP_NationalityMaster]
(
	 @NATIONALITYID bigint,
	 @NATIONALITYNAME varchar(100)
)
AS
BEGIN
	SET NOCOUNT ON
	INSERT INTO MP_NationalityMaster
	(
	NATIONALITYID,
	NATIONALITYNAME 
	)
	Values
	(
	@NATIONALITYID,
	@NATIONALITYNAME
	)
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_Pro_Rec_Ack]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_Pro_Rec_Ack]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[sp_IE_V1_MP_Pro_Rec_Ack]
(
	 @ProvisionId bigint,
	 @ReceivedOn smalldatetime,
	 @ActiveInactive char(1),
	 @OfficeRemarks varchar(1000),
	 @OfficeRemarksBy varchar(50),
	 @OfficeRemarksOn smalldatetime
)
AS
BEGIN
	SET NOCOUNT ON
	UPDATE [MP_VSL_ProvisionMaster]
	       SET 
		   [ReceivedOn] = @ReceivedOn,
		   ActiveInactive=@ActiveInactive,
		   OfficeRemarks=@OfficeRemarks,
		   OfficeRemarksBy=@OfficeRemarksBy,
		   OfficeRemarksOn=@OfficeRemarksOn
	WHERE [ProvisionId] = @ProvisionId
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_Products]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_Products]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_Products]
(
    @CategoryId bigint,
	@ProductId bigint,
	@ProductCode char(9),
	@ProductName varchar(50),
	@SupplyUnitId int,
	@IMPACode varchar(50),
	@Inactive bit
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM [dbo].[MP_Products] WHERE [CategoryId] = @CategoryId AND  [ProductId] = @ProductId)
	BEGIN 
		INSERT INTO MP_Products
		(
			[CategoryId],
			[ProductId],
			[ProductCode],
			[ProductName],
			[SupplyUnitId],
			[IMPACode],
			[Inactive]
		)
		Values
		(
			@CategoryId,
			@ProductId,
			@ProductCode,
			@ProductName,
			@SupplyUnitId,
			@IMPACode,
			@Inactive
		)
	END	
	ELSE 
	BEGIN
		UPDATE MP_Products
		SET
			[ProductCode] = @ProductCode,
			[ProductName] = @ProductName,
			[SupplyUnitId] = @SupplyUnitId,
			[IMPACode] = @IMPACode,
			[Inactive] = @Inactive
		WHERE [CategoryId] = @CategoryId AND [ProductId] = @ProductId
	END
	DELETE FROM [MP_Products_Packaging] WHERE [ProductId] = @ProductId
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_Products_Packaging]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_Products_Packaging]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

create PROCEDURE [dbo].[sp_IE_V1_MP_Products_Packaging]
(
    @ProductId bigint,
	@Qty int,
	@UnitId int,
	@OrderQty float
)
AS
BEGIN
SET NOCOUNT ON
	INSERT INTO MP_Products_Packaging
	(
	ProductId,
	Qty,
	UnitId,
	OrderQty
	)
	Values
	(
	@ProductId,
	@Qty,
	@UnitId,
	@OrderQty
	)
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_Spare_Rec_Ack]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_Spare_Rec_Ack]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[sp_IE_V1_MP_Spare_Rec_Ack]
(
	 @SpareReqId bigint,
	 @ReceivedOn smalldatetime,
	 @ActiveInactive char(1),
	 @OfficeRemarks varchar(1000),
	 @OfficeRemarksBy varchar(50),
	 @OfficeRemarksOn smalldatetime
)
AS
BEGIN
	SET NOCOUNT ON

	UPDATE [MP_VSL_SparesReqMaster]
	       SET 
		   [ReceivedOn] = @ReceivedOn,
		   ActiveInactive=@ActiveInactive,
		   OfficeRemarks=@OfficeRemarks,
		   OfficeRemarksBy=@OfficeRemarksBy,
		   OfficeRemarksOn=@OfficeRemarksOn
	WHERE [SpareReqId] = @SpareReqId
	
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_Store_Rec_Ack]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_Store_Rec_Ack]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_V1_MP_Store_Rec_Ack]
(
	 @StoreReqId bigint,
	 @ReceivedOn smalldatetime,
	 @ActiveInactive char(1),
	 @OfficeRemarks varchar(1000),
	 @OfficeRemarksBy varchar(50),
	 @OfficeRemarksOn smalldatetime
)
AS
BEGIN
	SET NOCOUNT ON

	UPDATE [MP_VSL_StoreReqMaster]
	       SET 
		   [ReceivedOn] = @ReceivedOn,
		   ActiveInactive=@ActiveInactive,
		   OfficeRemarks=@OfficeRemarks,
		   OfficeRemarksBy=@OfficeRemarksBy,
		   OfficeRemarksOn=@OfficeRemarksOn
	WHERE [StoreReqId] = @StoreReqId
	
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_UnitMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_UnitMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_V1_MP_UnitMaster]
(
	 @UNITID bigint,
	 @UNITNAME varchar(100)
)
AS
BEGIN
	SET NOCOUNT ON
	INSERT INTO MP_UnitMaster
	(
		UNITID,
		UNITNAME 
	)
	Values
	(
		@UNITID,
		@UNITNAME
	)
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VictualingMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VictualingMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VictualingMaster]
(
	@VID bigint,
	@VESSELCODE char(3),
	@EFFECTIVEDATE smalldatetime,
	@VESSELACCOUNT float,
	@OWNERACCOUNT float,
	@CHARTERACCOUNT float
)
AS
BEGIN
	SET NOCOUNT ON
		INSERT INTO MP_VictualingMaster
		(
			VID ,
			VESSELCODE ,
			EFFECTIVEDATE ,
			VESSELACCOUNT ,
			OWNERACCOUNT ,
			CHARTERACCOUNT 
		)
		Values
		(
			@VID,
			@VESSELCODE,
			@EFFECTIVEDATE,
			@VESSELACCOUNT,
			@OWNERACCOUNT,
			@CHARTERACCOUNT
		)
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_AccountDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_AccountDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_AccountDetails] 
(
	@AccountDetailId bigint,
    @AccountId bigint,
	@VesselCode char(3),
	@Name varchar(50),
	@Rank varchar(50),
	@Company varchar(50),	
	@FromDay int,
	@ToDay int,
	@NoOfMealsServed int,
	@Remarks  varchar(5000)
)
AS
BEGIN
SET NOCOUNT ON
		INSERT INTO MP_VSL_AccountDetails
		(
			AccountDetailId,
			AccountId,
			VesselCode,
			Name,
			[Rank],
			Company,	
			FromDay,
			ToDay,
			NoOfMealsServed,
			Remarks
		)
		Values
		(
			@AccountDetailId,
			@AccountId,
			@VesselCode,
			@Name,
			@Rank,
			@Company,	
			@FromDay,
			@ToDay,
			@NoOfMealsServed,
			@Remarks
		)
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_AccountMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_AccountMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_AccountMaster]  
(
    @AccountId bigint,
	@AccountType char(1),
	@VesselCode char(3),
	@Month int,
	@Year int,
	@UpdatedBy varchar(50),
	@UpdatedOn smalldatetime,
	@Updated bit
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM [dbo].[MP_VSL_AccountMaster] WHERE [VesselCode] = @VesselCode AND [AccountId] = @AccountId)
	BEGIN 
		INSERT INTO MP_VSL_AccountMaster
		(
			AccountId,
			AccountType,
			VesselCode,
			[Month],
			[Year],
			UpdatedBy,
			UpdatedOn,
			Updated
		)
		Values
		(
			@AccountId,
			@AccountType,
			@VesselCode,
			@Month,
			@Year,
			@UpdatedBy,
			@UpdatedOn,
			@Updated
		)
	END	
	ELSE 
	BEGIN
		UPDATE MP_VSL_AccountMaster
		SET AccountType = @AccountType,
		    [Month] = @Month,
			[Year] = @Year,
			UpdatedBy = @UpdatedBy,
			UpdatedOn = @UpdatedOn,
			Updated = @Updated 
		  
			
		WHERE [VesselCode] = @VesselCode AND [AccountId] = @AccountId
	END
	DELETE FROM [MP_VSL_AccountDetails] WHERE [VesselCode] = @VesselCode AND [AccountId] = @AccountId
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_InventoryDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_InventoryDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_InventoryDetails]
(
	@VesselCode char(3),
    @InventoryId bigint,
	@ProductId bigint,
	@Quantity float,
	@Spoilage float
)
AS
BEGIN
SET NOCOUNT ON
		INSERT INTO MP_VSL_InventoryDetails
		(
			VesselCode,
			InventoryId,
			ProductId,
			Quantity,
			Spoilage
		)
		Values
		(
			@VesselCode,
			@InventoryId,
			@ProductId,
			@Quantity,
			@Spoilage
		)
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_InventoryMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_InventoryMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_InventoryMaster]
(
    @InventoryId bigint,
	@VesselCode char(3),
	@InventoryDate smalldatetime,
	@UpdatedBy varchar(50),
	@UpdatedOn smalldatetime,
	@Updated bit
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM [dbo].[MP_VSL_InventoryMaster] WHERE VesselCode=@VesselCode AND [InventoryId] = @InventoryId)
	BEGIN 
		INSERT INTO MP_VSL_InventoryMaster
		(
			InventoryId,
			VesselCode,
			InventoryDate,
			UpdatedBy,
			UpdatedOn,
			Updated
		)
		Values
		(
			@InventoryId,
			@VesselCode,
			@InventoryDate,
			@UpdatedBy,
			@UpdatedOn,
			@Updated
		)
	END	
	ELSE 
	BEGIN
		UPDATE MP_VSL_InventoryMaster
		SET
			InventoryId = @InventoryId,
			VesselCode = @VesselCode,
			InventoryDate = @InventoryDate,
			UpdatedBy = @UpdatedBy,
			UpdatedOn = @UpdatedOn,
			Updated = @Updated
		WHERE VesselCode=@VesselCode AND [InventoryId] = @InventoryId
	END
	DELETE FROM [MP_VSL_InventoryDetails] WHERE VesselCode=@VesselCode AND [InventoryId] = @InventoryId
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_ProvisionDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_ProvisionDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_ProvisionDetails] 
(
	@VesselCode char(3),
	@ProvisionId bigint,
	@ProductId bigint,
	@ROBQty float,
	@ReqQty float,
	@ReqQty_Office float,
	@OrderQtyPerUnit float,
	@PackagingName Varchar(50),
	@UnitName Varchar(50)
)
AS
BEGIN
SET NOCOUNT ON
		INSERT INTO MP_VSL_ProvisionDetails
		(
			VesselCode,
			ProvisionId,
			ProductId,
			ROBQty,
			ReqQty,
			ReqQty_Office,
			OrderQtyPerUnit,
			PackagingName,
			UnitName     
		)
		Values
		(
			@VesselCode,
			@ProvisionId,
			@ProductId,
			@ROBQty,
			@ReqQty,
			@ReqQty,
		    @OrderQtyPerUnit,
		    @PackagingName,
		    @UnitName
		)
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_ProvisionMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_ProvisionMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_ProvisionMaster]  
(
    @ProvisionId bigint,
	@VesselCode char(3),
	@Department varchar(50),
	@AcctCode varchar(50),
	@RequisitionNo varchar(50),
	@PortOfSupply varchar(50),
	@ETA SmallDateTime,
	@Remarks varchar(5000),
	@UpdatedBy varchar(50),
	@UpdatedOn smalldatetime,
	@Updated bit,
	@ApprovedBy varchar(50),
	@ApprovedOn smalldatetime,
	@Status Char(1),
	@SentOn smalldatetime,
	@ReceivedOn smalldatetime,
	@ActiveInactive CHAR(1),
	@OfficeRemarks varchar(1000),
	@OfficeRemarksBy varchar(50),
	@OfficeRemarksOn smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM [dbo].[MP_VSL_ProvisionMaster] WHERE [VesselCode] = @VesselCode AND [ProvisionId] = @ProvisionId)
	BEGIN 
		INSERT INTO MP_VSL_ProvisionMaster
		(
			ProvisionId,
			VesselCode,
			Department,
			AcctCode,
			RequisitionNo,
			PortOfSupply,
			ETA,
			Remarks,
			UpdatedBy,
			UpdatedOn,
			Updated,
			ApprovedBy,
			ApprovedOn,
			[Status],
			[SentOn],
			[ReceivedOn],
			ActiveInactive,
			OfficeRemarks,
			OfficeRemarksBy,
			OfficeRemarksOn
		)
		Values
		(
			@ProvisionId,
			@VesselCode,
			@Department,
			@AcctCode,
			@RequisitionNo,
			@PortOfSupply,
			@ETA,
			@Remarks,
			@UpdatedBy,
			@UpdatedOn,
			@Updated,
			@ApprovedBy,
			@ApprovedOn,
			@Status,
			@SentOn,
			getdate(),
			@ActiveInactive,
			@OfficeRemarks,
			@OfficeRemarksBy,
			@OfficeRemarksOn
		)
	END	
	ELSE 
	BEGIN
		UPDATE MP_VSL_ProvisionMaster
		SET [Department] = @Department,
		    [AcctCode] = @AcctCode,
			[RequisitionNo] = @RequisitionNo,
			[PortOfSupply] = @PortOfSupply,
			[ETA] = @ETA,
			[Remarks] = @Remarks,
			[UpdatedBy] = @UpdatedBy,
			[UpdatedOn] = @UpdatedOn,
			[ApprovedBy] = @ApprovedBy,
			[ApprovedOn] = @ApprovedOn,
			[Updated] = @Updated,
			[Status] = @Status
		  			
		WHERE [VesselCode] = @VesselCode AND [ProvisionId] = @ProvisionId
	END
	DELETE FROM [MP_VSL_ProvisionDetails] WHERE [VesselCode] = @VesselCode AND [ProvisionId] = @ProvisionId
	DELETE FROM [MP_VSL_ProvisionNationalityWise] WHERE [ProvisionId] = @ProvisionId
	DELETE FROM [MP_VSL_ProvisionOtherItems] WHERE [ProvisionId] = @ProvisionId

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_ProvisionNationalityWise]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_ProvisionNationalityWise]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_ProvisionNationalityWise] 
(
    @VesselCode Char(3),
	@ProvisionId bigint,
	@NationalityId int,
	@NoOfCrew int,
	@NoOfDays int
)
AS
BEGIN
SET NOCOUNT ON
		INSERT INTO MP_VSL_ProvisionNationalityWise
		(
			VesselCode,
			ProvisionId,
			NationalityId,
			NoOfCrew,
			NoOfDays
		)
		Values
		(
			@VesselCode,
			@ProvisionId,
			@NationalityId,
			@NoOfCrew,
			@NoOfDays
		)
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_ProvisionOtherItems]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_ProvisionOtherItems]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_ProvisionOtherItems] 
(
	@VesselCode char(3),
	@ProvisionId bigint,
	@OtherItemId bigint,
	@ProductName varchar(50),
	@Packaging varchar(50),
	@ROBQty float,
	@ReqQty float,
	@UnitId int,
	@ReqQty_Office float
)
AS
BEGIN
SET NOCOUNT ON
		INSERT INTO MP_VSL_ProvisionOtherItems
		(
		    VesselCode,
			ProvisionId,
			OtherItemId,
			ProductName,
			Packaging,
			ROBQty,
			ReqQty,
			UnitId,
			ReqQty_Office
		)
		Values
		(
		    @VesselCode,
			@ProvisionId,
			@OtherItemId,
			@ProductName,
			@Packaging,
			@ROBQty,
			@ReqQty,
			@UnitId,
			@ReqQty
		)
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_ShipStaffDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_ShipStaffDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_ShipStaffDetails] 
(
	@ShipStaffDetailId bigint,
    @ShipStaffId bigint,
	@VesselCode char(3),
	@Name varchar(50),
	@Rank int,
	@Nationality int,
	@FromDay int,
	@ToDay int
)
AS
BEGIN
SET NOCOUNT ON
		INSERT INTO MP_VSL_ShipStaffDetails
		(
			ShipStaffDetailId,
			ShipStaffId,
			VesselCode,
			Name,
			[Rank],
			Nationality,
			FromDay,
			ToDay
		)
		Values
		(
			@ShipStaffDetailId,
			@ShipStaffId,
			@VesselCode,
			@Name,
			@Rank,
			@Nationality,
			@FromDay,
			@ToDay
		)
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_ShipStaffMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_ShipStaffMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_ShipStaffMaster] 
(
    @ShipStaffId bigint,
	@VesselCode char(3),
	@Month int,
	@Year int,
	@UpdatedBy varchar(50),
	@UpdatedOn smalldatetime,
	@Updated bit
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM [dbo].[MP_VSL_ShipStaffMaster] WHERE [VesselCode] = @VesselCode AND [ShipStaffId] = @ShipStaffId)
	BEGIN 
		INSERT INTO MP_VSL_ShipStaffMaster
		(
			ShipStaffId,
			VesselCode,
			[Month],
			[Year],
			UpdatedBy,
			UpdatedOn,
			Updated
		)
		Values
		(
			@ShipStaffId,
			@VesselCode,
			@Month,
			@Year,
			@UpdatedBy,
			@UpdatedOn,
			@Updated
		)
	END	
	ELSE 
	BEGIN
		UPDATE MP_VSL_ShipStaffMaster
		SET [Month] = @Month,
			[Year] = @Year,
			UpdatedBy = @UpdatedBy,
			UpdatedOn = @UpdatedOn,
			Updated = @Updated 
		  
			
		WHERE [VesselCode] = @VesselCode AND [ShipStaffId] = @ShipStaffId
	END
	DELETE FROM [MP_VSL_ShipStaffDetails] WHERE [VesselCode] = @VesselCode AND [ShipStaffId] = @ShipStaffId
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_SparesReqDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_SparesReqDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_SparesReqDetails] 
(
	@SpareReqId bigint,
	@VesselCode char(3),
	@ComponentId bigint,
	@Office_Ship char(1),
	@SpareId bigint,
	@QTY float,
	@ROB float,
	@UOM varchar(50)
)
AS
BEGIN
SET NOCOUNT ON
		INSERT INTO MP_VSL_SparesReqDetails
		(
			SpareReqId,
			VesselCode,
			ComponentId,
			Office_Ship,
			SpareId,
			QTY,
			ROB,
			UOM,
			OfficeQty,
			OfficeUOM
		)
		Values
		(
			@SpareReqId,
			@VesselCode,
			@ComponentId,
			@Office_Ship,
			@SpareId,
			@QTY,
			@ROB,
			@UOM,
			@QTY,
			@UOM
		)
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_SparesReqMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_SparesReqMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_SparesReqMaster]  
(
    @VesselCode char(3),
	@SpareReqId bigint,
	@ReqnNo varchar(50),
	@AccountCode INT,
	@Port varchar(50),
	@ETA SmallDateTime,
	@Remarks varchar(5000),
	@UpdatedBy varchar(50),
	@UpdatedOn smalldatetime,
	@Updated bit,
	@ApprovedBy varchar(50),
	@ApprovedOn smalldatetime,
	@Status Char(1),
	@SentOn smalldatetime,
	@ReceivedOn smalldatetime,
	@ActiveInactive CHAR(1),
	@OfficeRemarks varchar(1000),
	@OfficeRemarksBy varchar(50),
	@OfficeRemarksOn smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM [dbo].[MP_VSL_SparesReqMaster] WHERE [VesselCode] = @VesselCode AND SpareReqId = @SpareReqId)
	BEGIN 
		INSERT INTO MP_VSL_SparesReqMaster
		(
			VesselCode ,
			SpareReqId ,
			ReqnNo ,
			AccountCode ,
			Port ,
			ETA ,
			Remarks ,
			UpdatedBy ,
			UpdatedOn ,
			Updated ,
			ApprovedBy ,
			ApprovedOn ,
			[Status] ,
			SentOn ,
			ReceivedOn ,
			ActiveInactive,
			OfficeRemarks,
			OfficeRemarksBy,
			OfficeRemarksOn
		)
		Values
		(
			@VesselCode ,
			@SpareReqId ,
			@ReqnNo ,
			@AccountCode ,
			@Port ,
			@ETA ,
			@Remarks ,
			@UpdatedBy ,
			@UpdatedOn ,
			@Updated ,
			@ApprovedBy ,
			@ApprovedOn ,
			@Status ,
			@SentOn ,
			getdate(),
			@ActiveInactive,
			@OfficeRemarks,
			@OfficeRemarksBy,
			@OfficeRemarksOn 
		)
	END	
	ELSE 
	BEGIN
		UPDATE MP_VSL_SparesReqMaster
		SET ReqnNo=@ReqnNo ,
			AccountCode=@AccountCode ,
			Port=@Port ,
			ETA=@ETA ,
			Remarks=@Remarks ,
			UpdatedBy=@UpdatedBy ,
			UpdatedOn=@UpdatedOn ,
			Updated=@Updated ,
			ApprovedBy=@ApprovedBy ,
			ApprovedOn=@ApprovedOn ,
			[Status]=@Status 
		WHERE [VesselCode] = @VesselCode AND SpareReqId = @SpareReqId
	END
	DELETE FROM [MP_VSL_SparesReqDetails] WHERE [VesselCode] = @VesselCode AND SpareReqId = @SpareReqId

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_StoreItemMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_StoreItemMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_StoreItemMaster] 
(
	@VesselCode char(3),
	@ItemId bigint,
	@ItemName varchar(1000),
	@Description varchar(1000),
	@ISSA_IMPA varchar(100),
	@UOM varchar(50),
	@AccountCode int
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM MP_VSL_StoreItemMaster WHERE VESSELCODE=@VesselCode AND ITEMID=@ItemId)
BEGIN
		INSERT INTO MP_VSL_StoreItemMaster
		(
			VesselCode,
			ItemId,
			ItemName,
			[Description],
			ISSA_IMPA,
			UOM,
			AccountCode
		)
		Values
		(
			@VesselCode,
			@ItemId,
			@ItemName,
			@Description,
			@ISSA_IMPA,
			@UOM,
			@AccountCode
		)
END
ELSE
BEGIN
		UPDATE 
		MP_VSL_StoreItemMaster
		SET ItemName=@ItemName,
			[Description]=@Description,
			ISSA_IMPA=@ISSA_IMPA,
			UOM=@UOM,
			AccountCode=@AccountCode
		 WHERE VESSELCODE=@VesselCode AND ITEMID=@ItemId
END
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_StoreReqDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_StoreReqDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_StoreReqDetails] 

(

	@StoreReqId bigint,

	@VesselCode char(3),

	@ItemId bigint,
	@Qty FLOAT,
	@ROB float

)

AS

BEGIN

SET NOCOUNT ON

		INSERT INTO MP_VSL_StoreReqDetails

		(

			StoreReqId,

			VesselCode,

			ItemId,
			Qty,
			ROB,
			OfficeQty

		)

		Values

		(

			@StoreReqId,

			@VesselCode,

			@ItemId,
			@Qty,
			@ROB,
			@Qty

		)

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_StoreReqMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_StoreReqMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_StoreReqMaster]  
(
    @VesselCode char(3),
	@StoreReqId bigint,
	@ReqnNo varchar(50),
	@AccountCode INT,
	@Port varchar(50),
	@ETA SmallDateTime,
	@Remarks varchar(5000),
	@UpdatedBy varchar(50),
	@UpdatedOn smalldatetime,
	@Updated bit,
	@ApprovedBy varchar(50),
	@ApprovedOn smalldatetime,
	@Status Char(1),
	@SentOn smalldatetime,
	@ReceivedOn smalldatetime,
	@ActiveInactive CHAR(1),
	@OfficeRemarks varchar(1000),
	@OfficeRemarksBy varchar(50),
	@OfficeRemarksOn smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM [dbo].[MP_VSL_StoreReqMaster] WHERE [VesselCode] = @VesselCode AND StoreReqId = @StoreReqId)
	BEGIN 
		INSERT INTO MP_VSL_StoreReqMaster
		(
			VesselCode ,
			StoreReqId ,
			ReqnNo ,
			AccountCode ,
			Port ,
			ETA ,
			Remarks ,
			UpdatedBy ,
			UpdatedOn ,
			Updated ,
			ApprovedBy ,
			ApprovedOn ,
			[Status] ,
			SentOn ,
			ReceivedOn ,
			ActiveInactive,
			OfficeRemarks,
			OfficeRemarksBy,
			OfficeRemarksOn
		)
		Values
		(
			@VesselCode ,
			@StoreReqId ,
			@ReqnNo ,
			@AccountCode ,
			@Port ,
			@ETA ,
			@Remarks ,
			@UpdatedBy ,
			@UpdatedOn ,
			@Updated ,
			@ApprovedBy ,
			@ApprovedOn ,
			@Status ,
			@SentOn ,
			getdate() ,
			@ActiveInactive,
			@OfficeRemarks ,
			@OfficeRemarksBy,
			@OfficeRemarksOn
		)
	END	
	ELSE 
	BEGIN
		UPDATE MP_VSL_StoreReqMaster
		SET ReqnNo=@ReqnNo ,
			AccountCode=@AccountCode ,
			Port=@Port ,
			ETA=@ETA ,
			Remarks=@Remarks ,
			UpdatedBy=@UpdatedBy ,
			UpdatedOn=@UpdatedOn ,
			Updated=@Updated ,
			ApprovedBy=@ApprovedBy ,
			ApprovedOn=@ApprovedOn ,
			[Status]=@Status 
		WHERE [VesselCode] = @VesselCode AND StoreReqId = @StoreReqId
	END
	DELETE FROM [MP_VSL_StoreReqDetails] WHERE [VesselCode] = @VesselCode AND StoreReqId = @StoreReqId

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_SupplyDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_SupplyDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_SupplyDetails] 
(
    @SupplyDetailId bigint,
	@VesselCode char(3),
    @SupplyId bigint,
	@ProductId bigint,
	@Quantity float,
	@PackagingQty float,
	@PackagingUnit int,
	@PackagingOrderQty float
)
AS
BEGIN
SET NOCOUNT ON
		INSERT INTO MP_VSL_SupplyDetails
		(
			SupplyDetailId,
			VesselCode,
			SupplyId,
			ProductId,
			Quantity,
			PackagingQty,
			PackagingUnit,
			PackagingOrderQty
		)
		Values
		(
			@SupplyDetailId,
			@VesselCode,
			@SupplyId,
			@ProductId,
			@Quantity,
			@PackagingQty,
			@PackagingUnit,
			@PackagingOrderQty
		)
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_V1_MP_VSL_SupplyMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_V1_MP_VSL_SupplyMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_V1_MP_VSL_SupplyMaster] 
(
    @SupplyId bigint,
	@VesselCode char(3),
	@Mode varchar(50),
	@PONumber varchar(50),
	@VenderName varchar(50),
	@Port varchar(50),
	@ReceivingDate smalldatetime,	
	@UpdatedBy varchar(50),
	@UpdatedOn smalldatetime,
	@Updated bit
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM [dbo].[MP_VSL_SupplyMaster] WHERE VesselCode=@VesselCode AND [SupplyId] = @SupplyId)
	BEGIN 
		INSERT INTO MP_VSL_SupplyMaster
		(
			SupplyId,
			VesselCode,
			Mode,
			PONumber,
			VenderName,
			Port,
			ReceivingDate,	
			UpdatedBy,
			UpdatedOn,
			Updated
		)
		Values
		(
			@SupplyId,
			@VesselCode,
			@Mode,
			@PONumber,
			@VenderName,
			@Port,
			@ReceivingDate,	
			@UpdatedBy,
			@UpdatedOn,
			@Updated
		)
	END	
	ELSE 
	BEGIN
		UPDATE MP_VSL_SupplyMaster
		SET
			SupplyId = @SupplyId,
			VesselCode = @VesselCode,
			Mode = @Mode,
			PONumber = @PONumber,
			VenderName = @VenderName,
			Port = @Port,
			ReceivingDate = @ReceivingDate,	
			UpdatedBy = @UpdatedBy,
			UpdatedOn = @UpdatedOn,
			Updated = @Updated
		WHERE VesselCode=@VesselCode AND [SupplyId] = @SupplyId
	END
	DELETE FROM [MP_VSL_SupplyDetails] WHERE VesselCode=@VesselCode AND [SupplyId] = @SupplyId
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_ComponentJobMapping_OtherRanks]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_ComponentJobMapping_OtherRanks]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[sp_IE_VSL_ComponentJobMapping_OtherRanks]
(
	@COMPJOBID bigint,
	@RankId bigint
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM ComponentJobMapping_OtherRanks WHERE COMPJOBID = @COMPJOBID AND RankId = @RankId )
BEGIN 
	INSERT INTO ComponentJobMapping_OtherRanks
	(
		COMPJOBID,
		RankId	
	)
	Values
	(
		@COMPJOBID,
		@RankId
	)
END
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_ComponentMasterForVessel]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_ComponentMasterForVessel]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'----------------------------------------------------------
CREATE PROCEDURE [dbo].[sp_IE_VSL_ComponentMasterForVessel]
(
@VESSELCODE char(3),
@COMPONENTID bigint,
@MAKER varchar(50),
@MAKERTYPE varchar(50),
@CLASSEQUIPCODE varchar(30),
@STATUS char(1),
@UPDATED bit,
@UPDATEDON smalldatetime,
@DESCR varchar(1000),
@CLASSEQUIP BIT,
@ACCOUNTCODES VARCHAR(50)
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_ComponentMasterForVessel WHERE VESSELCODE = @VESSELCODE AND COMPONENTID = @COMPONENTID )
BEGIN 
	INSERT INTO VSL_ComponentMasterForVessel
	(
		VESSELCODE ,
		COMPONENTID ,
		MAKER ,
		MAKERTYPE ,
		CLASSEQUIPCODE ,
		STATUS ,
		UPDATED ,
		UPDATEDON ,
		Descr ,
		CLASSEQUIP ,
		ACCOUNTCODES

	)
	Values
	(
		@VESSELCODE,
		@COMPONENTID,
		@MAKER,
		@MAKERTYPE,
		@CLASSEQUIPCODE,
		@STATUS,
		0,
		NULL ,
		@DESCR ,
		@CLASSEQUIP ,
		@ACCOUNTCODES
	)
	END
ELSE 
BEGIN
	UPDATE VSL_ComponentMasterForVessel
	SET
		MAKER = @MAKER,
		MAKERTYPE = @MAKERTYPE,
		CLASSEQUIPCODE = @CLASSEQUIPCODE,
		STATUS = @STATUS,
		UPDATED = 0,
		UPDATEDON = NULL,
		Descr=@DESCR,
		CLASSEQUIP=@CLASSEQUIP ,
		ACCOUNTCODES=@ACCOUNTCODES

	WHERE VESSELCODE = @VESSELCODE AND COMPONENTID = @COMPONENTID
END
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_CriticalEquipShutdownRequest]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_CriticalEquipShutdownRequest]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_CriticalEquipShutdownRequest]
(
    @ShutdownId bigint,
	@VesselCode char(3),
	@ComponentId bigint,
	@Occasion smallint,
	@DefectNo varchar(15),
	@FormNo varchar(50),
	@Version varchar(50), 
	@RequestDate smalldatetime,
	@MasterCEName varchar(50),
	@Job_Defect varchar(5000),
	@Pl_ShutDownTotalHrs int,
	@Pl_FromDateTime smalldatetime,
	@Pl_ToDateTime smalldatetime,
	@Ma_CommencedDateTime smalldatetime,
	@Ma_CompletedDateTime smalldatetime,
	@Maintenence_Remarks varchar(5000),
	@IssuedBy int,
	@IssueDate smalldatetime,
	@Updated bit,
	@UpdatedOn smalldatetime,
	@Closed bit
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_CriticalEquipShutdownRequest WHERE VesselCode = @VesselCode AND ShutdownId=@ShutdownId)
BEGIN 
	INSERT INTO VSL_CriticalEquipShutdownRequest
	(
		ShutdownId,
		VesselCode,
		ComponentId,
		Occasion,
		DefectNo,
		FormNo,
		[Version], 
		RequestDate,
		MasterCEName,
		Job_Defect,
		Pl_ShutDownTotalHrs,
		Pl_FromDateTime,
		Pl_ToDateTime,
		Ma_CommencedDateTime,
		Ma_CompletedDateTime,
		Maintenence_Remarks,
		IssuedBy,
		IssueDate,
		Updated,
		UpdatedOn,
		Closed 
	)
	Values
	(
		@ShutdownId,
		@VesselCode,
		@ComponentId,
		@Occasion,
		@DefectNo,
		@FormNo,
		@Version, 
		@RequestDate,
		@MasterCEName,
		@Job_Defect,
		@Pl_ShutDownTotalHrs,
		@Pl_FromDateTime,
		@Pl_ToDateTime,
		@Ma_CommencedDateTime,
		@Ma_CompletedDateTime,
		@Maintenence_Remarks,
		@IssuedBy,
		@IssueDate,
		0,
		NULL,
		@Closed 
	)
END	
ELSE 
BEGIN
	UPDATE VSL_CriticalEquipShutdownRequest
	SET
		VesselCode = @VesselCode,
		ComponentId = @ComponentId,
		Occasion = @Occasion,
		DefectNo = @DefectNo,
		FormNo = @FormNo,
		[Version] = @Version, 
		RequestDate = @RequestDate,
		MasterCEName = @MasterCEName,
		Job_Defect = @Job_Defect,
		Pl_ShutDownTotalHrs = @Pl_ShutDownTotalHrs,
		Pl_FromDateTime = @Pl_FromDateTime,
		Pl_ToDateTime = @Pl_ToDateTime,
		Ma_CommencedDateTime = @Ma_CommencedDateTime,
		Ma_CompletedDateTime = @Ma_CompletedDateTime,
		Maintenence_Remarks = @Maintenence_Remarks,
		IssuedBy = @IssuedBy,
		IssueDate = @IssueDate,
		Updated = 0,
		UpdatedOn = NULL,
		Closed = @Closed
	WHERE VesselCode = @VesselCode AND ShutdownId=@ShutdownId
END
END








' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_CriticalShutdownApproval]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_CriticalShutdownApproval]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_CriticalShutdownApproval]
(
    @VesselCode Char(3),
	@ShutdownApproveId bigint,
	@ShutdownId bigint,
	@Approver_Name varchar(50),
	@Approver_Position varchar(50),
	@Approver_Remarks varchar(5000),
	@ApprovedOn smalldatetime,
	@Updated bit,
	@UpdatedOn smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_CriticalShutdownApproval WHERE VesselCode = @VesselCode AND ShutdownApproveId = @ShutdownApproveId )
BEGIN 
	INSERT INTO VSL_CriticalShutdownApproval
	(
		ShutdownApproveId,
		VesselCode,
		ShutdownId,
		Approver_Name,
		Approver_Position,
		Approver_Remarks,
		ApprovedOn,
		Updated,
		UpdatedOn
	)
	Values
	(
		@ShutdownApproveId,
		@VesselCode,
		@ShutdownId,
		@Approver_Name,
		@Approver_Position,
		@Approver_Remarks,
		@ApprovedOn,
		0,
		Null
	)
END	
ELSE 
BEGIN
	UPDATE VSL_CriticalShutdownApproval
	SET
		ShutdownId = @ShutdownId,
		Approver_Name = @Approver_Name,
		Approver_Position = @Approver_Position,
		Approver_Remarks = @Approver_Remarks,
		ApprovedOn = @ApprovedOn,
		Updated  = 0,
		UpdatedOn = Null
	WHERE VesselCode = @VesselCode AND ShutdownApproveId = @ShutdownApproveId
END
END








' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_CriticalShutdownExtensionApproval]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_CriticalShutdownExtensionApproval]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_CriticalShutdownExtensionApproval]
(
    @VesselCode Char(3),
	@ExtensionApproveId bigint,
	@ExtensionId bigint,
	@Approver_Name varchar(50),
	@Approver_Position varchar(50),
	@Approver_Remarks varchar(5000),
	@ApprovedOn smalldatetime,
	@Updated bit,
	@UpdatedOn smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_CriticalShutdownExtensionApproval WHERE VesselCode = @VesselCode AND ExtensionApproveId = @ExtensionApproveId )
BEGIN 
	INSERT INTO VSL_CriticalShutdownExtensionApproval
	(
		ExtensionApproveId,
		VesselCode,
		ExtensionId,
		Approver_Name,
		Approver_Position,
		Approver_Remarks,
		ApprovedOn,
		Updated,
		UpdatedOn
	)
	Values
	(
		@ExtensionApproveId,
		@VesselCode,
		@ExtensionId,
		@Approver_Name,
		@Approver_Position,
		@Approver_Remarks,
		@ApprovedOn,
		0,
		Null
	)
END	
ELSE 
BEGIN
	UPDATE VSL_CriticalShutdownExtensionApproval
	SET
		ExtensionId = @ExtensionId,
		Approver_Name = @Approver_Name,
		Approver_Position = @Approver_Position,
		Approver_Remarks = @Approver_Remarks,
		ApprovedOn = @ApprovedOn,
		Updated  = 0,
		UpdatedOn = Null
	WHERE VesselCode = @VesselCode AND ExtensionApproveId = @ExtensionApproveId
END
END








' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_CriticalShutdownExtensions]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_CriticalShutdownExtensions]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_CriticalShutdownExtensions]
(
    @VesselCode Char(3),
	@ExtensionId bigint,
    @ShutdownId bigint,
    @Ext_ShutDownTotalHrs int,
    @Ext_FromDateTime smalldatetime,
    @Ext_ToDateTime smalldatetime,
    @Updated bit,
    @UpdatedOn smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_CriticalShutdownExtensions WHERE VesselCode = @VesselCode AND ExtensionId = @ExtensionId)
BEGIN 
	INSERT INTO VSL_CriticalShutdownExtensions
           ([ExtensionId]
           ,[VesselCode]
           ,[ShutdownId]
           ,[Ext_ShutDownTotalHrs]
           ,[Ext_FromDateTime]
           ,[Ext_ToDateTime]
           ,[Updated]
           ,[UpdatedOn])
     VALUES
           ( @ExtensionId,
			 @VesselCode,
             @ShutdownId,
             @Ext_ShutDownTotalHrs,
             @Ext_FromDateTime,
             @Ext_ToDateTime,
             0,
             Null
           )
END	
ELSE 
BEGIN
	UPDATE VSL_CriticalShutdownExtensions
	   SET	  [ShutdownId] = @ShutdownId,
			  [Ext_ShutDownTotalHrs] = @Ext_ShutDownTotalHrs,
			  [Ext_FromDateTime] = @Ext_FromDateTime,
			  [Ext_ToDateTime] = @Ext_ToDateTime,
			  [Updated] = 0,
			  [UpdatedOn] = Null
	 WHERE VesselCode = @VesselCode AND ExtensionId = @ExtensionId
END
END








' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSl_DefectDetailsMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSl_DefectDetailsMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSl_DefectDetailsMaster]
(
	@VESSELCODE char(3),
	@COMPONENTID bigint,
	@DEFECTNO varchar(15),
	@HISTORYID bigint,
	@REPORTDT smalldatetime,
	@TARGETDT smalldatetime,
	@COMPLETIONDT smalldatetime,
	@VESSEL char(1),
	@SPARES char(1),
	@SHOREASSIST char(1),
	@DRYDOCK char(1),
	@GUARENTEE char(1),
	@DEFECTDETAILS varchar(1000),
	@REPAIRSDETAILS varchar(1000),
	@SPARESONBOARD char(1),
	@RQNNO varchar(20),
	@SPARESORDERED char(1),
	@RQNDATE smalldatetime,
	@SPARESREQUIRED char(1),
	@SUPDT varchar(50),
	@CHIEFOFFICER varchar(50),
	@CHIEFENGG varchar(50),
	@STATUS char(1),
	@UPDATED char(1),
	@UPDATEDON smalldatetime,
	@COMPSTATUS char(1)
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM Vsl_DefectDetailsMaster WHERE DEFECTNO = @DEFECTNO )
BEGIN 
	INSERT INTO Vsl_DefectDetailsMaster
	(
		VESSELCODE ,
		COMPONENTID ,
		DEFECTNO ,
		HISTORYID ,
		REPORTDT ,
		TARGETDT ,
		COMPLETIONDT ,
		VESSEL ,
		SPARES ,
		SHOREASSIST ,
		DRYDOCK ,
		GUARENTEE ,
		DEFECTDETAILS ,
		REPAIRSDETAILS ,
		SPARESONBOARD ,
		RQNNO ,
		SPARESORDERED ,
		RQNDATE ,
		SPARESREQUIRED ,
		SUPDT ,
		CHIEFOFFICER ,
		CHIEFENGG ,
		STATUS ,
		UPDATED ,
		UPDATEDON ,
		COMPSTATUS 
	)
	Values
	(
		@VESSELCODE,
		@COMPONENTID,
		@DEFECTNO,
		@HISTORYID,
		@REPORTDT,
		@TARGETDT,
		@COMPLETIONDT,
		@VESSEL,
		@SPARES,
		@SHOREASSIST,
		@DRYDOCK,
		@GUARENTEE,
		@DEFECTDETAILS,
		@REPAIRSDETAILS,
		@SPARESONBOARD,
		@RQNNO,
		@SPARESORDERED,
		@RQNDATE,
		@SPARESREQUIRED,
		@SUPDT,
		@CHIEFOFFICER,
		@CHIEFENGG,
		@STATUS,
		0,
		NULL,
		@COMPSTATUS
	)
END	
ELSE 
BEGIN
	UPDATE Vsl_DefectDetailsMaster
	SET
		VESSELCODE = @VESSELCODE,
		COMPONENTID = @COMPONENTID,
		HISTORYID = @HISTORYID,
		REPORTDT = @REPORTDT,
		TARGETDT = @TARGETDT,
		COMPLETIONDT = @COMPLETIONDT,
		VESSEL = @VESSEL,
		SPARES = @SPARES,
		SHOREASSIST = @SHOREASSIST,
		DRYDOCK = @DRYDOCK,
		GUARENTEE = @GUARENTEE,
		DEFECTDETAILS = @DEFECTDETAILS,
		REPAIRSDETAILS = @REPAIRSDETAILS,
		SPARESONBOARD = @SPARESONBOARD,
		RQNNO = @RQNNO,
		SPARESORDERED = @SPARESORDERED,
		RQNDATE = @RQNDATE,
		SPARESREQUIRED = @SPARESREQUIRED,
		SUPDT = @SUPDT,
		CHIEFOFFICER = @CHIEFOFFICER,
		CHIEFENGG = @CHIEFENGG,
		STATUS = @STATUS,
		UPDATED = 0,
		UPDATEDON = NULL,
		COMPSTATUS = @COMPSTATUS
	WHERE DEFECTNO = @DEFECTNO 
END
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_DefectRemarks]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_DefectRemarks]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_DefectRemarks]
(
    @VesselCode Char(3),
	@DefectRemarkId bigint,
	@DefectNo varchar(15),
	@Remarks varchar(5000),
	@FileName varchar(50),
	@File Image,	
	@Updated bit,
	@UpdatedOn smalldatetime,
	@EnteredBy varchar(50),
	@EnteredOn smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_DefectRemarks WHERE VesselCode = @VesselCode AND DefectRemarkId = @DefectRemarkId)
BEGIN 
	INSERT INTO VSL_DefectRemarks
	(
		DefectRemarkId,
		VesselCode,
		DefectNo,
		Remarks,
		[FileName],
		[File],
		Updated,
		UpdatedOn,
		EnteredBy,
		EnteredOn
		
	)
	Values
	(
		@DefectRemarkId,
		@VesselCode,
		@DefectNo,
		@Remarks,
		@FileName,
		@File,
		0,
		Null,
		@EnteredBy,
		@EnteredOn
	)
END	
ELSE 
BEGIN
	UPDATE VSL_DefectRemarks
	SET
		DefectNo = @DefectNo,
		Remarks = @Remarks,
		[FileName] = @FileName,
		[File] = @File,
		Updated = 0,
		UpdatedOn = Null,
		EnteredBy = @EnteredBy,
		EnteredOn = @EnteredOn
	WHERE VesselCode = @VesselCode AND DefectRemarkId = @DefectRemarkId
END
END








' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_Defects_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_Defects_Attachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_Defects_Attachments]
(
    @VesselCode Char(3),
	@AttachmentId bigint,
	@DefectNo Varchar(15),
	@AttachmentText Varchar(500),
	@FileName Varchar(50),
	@Status Char(1),
	@Updated bit,
	@UpdatedOn smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_Defects_Attachments WHERE VesselCode = @VesselCode AND AttachmentId = @AttachmentId AND DefectNo = @DefectNo )
BEGIN 
	INSERT INTO VSL_Defects_Attachments
	(
	   AttachmentId,
	   VesselCode,
	   DefectNo,
	   AttachmentText,
	   [FileName],
	   [Status],
	   Updated,
	   UpdatedOn
		
	)
	Values
	(
	    @AttachmentId,
	    @VesselCode,
		@DefectNo,
		@AttachmentText,
		@FileName,
		@Status,		
		0,
		NULL
	)
	END
ELSE 
BEGIN
	UPDATE VSL_Defects_Attachments
	SET
		AttachmentText = @AttachmentText,
	    [FileName] = @FileName,
	    [Status] = @Status,
		UPDATED = 0,
		UPDATEDON = NULL
	WHERE VesselCode = @VesselCode AND AttachmentId = @AttachmentId AND DefectNo = @DefectNo
END
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_DefectSpareDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_DefectSpareDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_DefectSpareDetails]
(
	@VESSELCODE char(3),
	@COMPONENTID bigint,
	@OFFICE_SHIP char(1),
	@SPAREID bigint,
	@DEFECTNO varchar(15),
	@QTYCONS float,
	@QTYROB float,
	@STATUS char(1)
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_DefectSpareDetails WHERE VESSELCODE = @VESSELCODE AND COMPONENTID = @COMPONENTID AND OFFICE_SHIP = @OFFICE_SHIP AND SPAREID = @SPAREID AND DEFECTNO = @DEFECTNO )
BEGIN 
	INSERT INTO VSL_DefectSpareDetails
	(
		VESSELCODE ,
		COMPONENTID ,
		OFFICE_SHIP ,
		SPAREID ,
		DEFECTNO ,
		QTYCONS ,
		QTYROB ,
		STATUS
	)
	Values
	(
		@VESSELCODE,
		@COMPONENTID,
		@OFFICE_SHIP,
		@SPAREID,
		@DEFECTNO,
		@QTYCONS,
		@QTYROB,
		@STATUS
	)
END	
ELSE 
BEGIN
	UPDATE VSL_DefectSpareDetails
	SET
		QTYCONS = @QTYCONS,
		QTYROB = @QTYROB ,
		STATUS = @STATUS
	WHERE VESSELCODE = @VESSELCODE AND COMPONENTID = @COMPONENTID AND OFFICE_SHIP = @OFFICE_SHIP AND SPAREID = @SPAREID AND DEFECTNO = @DEFECTNO
END
END







' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_PlanMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_PlanMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_PlanMaster]
(
	@VESSELCODE char(3),
	@COMPJOBID bigint,
	@COMPONENTID bigint,
	@_ComponentCode char(20),
	@JOBID bigint,
	@STATUS int,
	@ASSIGNEDTO int,
	@PLANDATE smalldatetime,
	@LASTDUEDATE smalldatetime,
	@LASTDUEHOURS int,
	@NEXTDUEDATE smalldatetime,
	@NEXTDUEHOURS int,
	@LASTRUNNINGHOURDATE smalldatetime,
	@LASTRUNNINGHOUR int,
	@DONEBY int,
	@DONEBY_CODE varchar(10),
	@DONEBY_NAME varchar(50),
	@DONEDATE smalldatetime,
	@DONEHOUR int,
	@SERVICEREPORT varchar(500),
	@CONDITIONBEFORE varchar(50),
	@CONDITIONAFTER varchar(50),
	@UPDATEREMARKS int,
	@SPECIFY varchar(50),
	@FILENAME varchar(50),
	@FILEIMAGE image,
	@Coating smallint,
	@Corrosion smallint,
	@Deformation smallint,
	@Cracks smallint,
	@OverallRating smallint,
	@MODIFIEDBY int,
	@MODIFIEDON smalldatetime,
	@POSTPONEREASON int,
	@POSTPONEREMARKS varchar(500),
	@P_DONEBY int,
	@P_DONEBY_CODE varchar(10),
	@P_DONEBY_NAME varchar(50),
	@POSTPONEDATE smalldatetime,
	@CANCELLATIONREASON varchar(500),
	@CANCELLATIONDATE smalldatetime,
	@C_DONEBY int,
	@C_DONEBY_CODE varchar(10),
	@C_DONEBY_NAME varchar(50),
	@Verified bit,
	@VerifiedBy varchar(100),
	@VerifiedOn smalldatetime,
	@UPDATED bit,
	@UPDATEDON smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_PlanMaster WHERE VESSELCODE = @VESSELCODE AND COMPJOBID = @COMPJOBID )
BEGIN 
	INSERT INTO VSL_PlanMaster
	(
		VESSELCODE ,
		COMPJOBID ,
		COMPONENTID ,
		_ComponentCode,
		JOBID ,
		STATUS ,
		ASSIGNEDTO ,
		PLANDATE ,
		LASTDUEDATE ,
		LASTDUEHOURS ,
		NEXTDUEDATE ,
		NEXTDUEHOURS ,
		LASTRUNNINGHOURDATE ,
		LASTRUNNINGHOUR ,
		DONEBY ,
		DONEBY_CODE ,
		DONEBY_NAME ,
		DONEDATE ,
		DONEHOUR ,
		SERVICEREPORT ,
		CONDITIONBEFORE ,
		CONDITIONAFTER ,
		UPDATEREMARKS ,
		SPECIFY ,
		FILENAME ,
		FILEIMAGE ,
		Coating ,
		Corrosion ,
		Deformation ,
		Cracks ,
		OverallRating ,
		MODIFIEDBY ,
		MODIFIEDON ,
		POSTPONEREASON ,
		POSTPONEREMARKS ,
		P_DONEBY ,
		P_DONEBY_CODE ,
		P_DONEBY_NAME ,
		POSTPONEDATE ,
		CANCELLATIONREASON ,
		CANCELLATIONDATE ,
		C_DONEBY ,
		C_DONEBY_CODE ,
		C_DONEBY_NAME ,
		Verified ,
		VerifiedBy ,
		VerifiedOn ,
		UPDATED ,
		UPDATEDON 
	)
	Values
	(
		@VESSELCODE,
		@COMPJOBID,
		@COMPONENTID,
		@_ComponentCode,
		@JOBID,
		@STATUS,
		@ASSIGNEDTO,
		@PLANDATE,
		@LASTDUEDATE,
		@LASTDUEHOURS,
		@NEXTDUEDATE,
		@NEXTDUEHOURS,
		@LASTRUNNINGHOURDATE,
		@LASTRUNNINGHOUR,
		@DONEBY,
		@DONEBY_CODE,
		@DONEBY_NAME,
		@DONEDATE,
		@DONEHOUR,
		@SERVICEREPORT,
		@CONDITIONBEFORE,
		@CONDITIONAFTER,
		@UPDATEREMARKS,
		@SPECIFY,
		@FILENAME,
		@FILEIMAGE,
		@Coating,
		@Corrosion,
		@Deformation,
		@Cracks,
		@OverallRating,
		@MODIFIEDBY,
		@MODIFIEDON,
		@POSTPONEREASON,
		@POSTPONEREMARKS,
		@P_DONEBY,
		@P_DONEBY_CODE,
		@P_DONEBY_NAME,
		@POSTPONEDATE,
		@CANCELLATIONREASON,
		@CANCELLATIONDATE,
		@C_DONEBY,
		@C_DONEBY_CODE,
		@C_DONEBY_NAME,
		@Verified ,
		@VerifiedBy ,
		@VerifiedOn ,
		0,
		NULL
	)
	END
ELSE 
BEGIN
	UPDATE VSL_PlanMaster
	SET
		COMPONENTID = @COMPONENTID,
		_ComponentCode = @_ComponentCode,
		JOBID = @JOBID,
		STATUS = @STATUS,
		ASSIGNEDTO = @ASSIGNEDTO,
		PLANDATE = @PLANDATE,
		LASTDUEDATE = @LASTDUEDATE,
		LASTDUEHOURS = @LASTDUEHOURS,
		NEXTDUEDATE = @NEXTDUEDATE,
		NEXTDUEHOURS = @NEXTDUEHOURS,
		LASTRUNNINGHOURDATE = @LASTRUNNINGHOURDATE,
		LASTRUNNINGHOUR = @LASTRUNNINGHOUR,
		DONEBY = @DONEBY,
		DONEBY_CODE = @DONEBY_CODE,
		DONEBY_NAME = @DONEBY_NAME,
		DONEDATE = @DONEDATE,
		DONEHOUR = @DONEHOUR,
		SERVICEREPORT = @SERVICEREPORT,
		CONDITIONBEFORE = @CONDITIONBEFORE,
		CONDITIONAFTER = @CONDITIONAFTER,
		UPDATEREMARKS = @UPDATEREMARKS,
		SPECIFY = @SPECIFY,
		FILENAME = @FILENAME,
		FILEIMAGE = @FILEIMAGE,
		Coating  = @Coating,
		Corrosion  = @Corrosion,
		Deformation  = @Deformation,
		Cracks  = @Cracks,
		OverallRating  = @OverallRating,
		MODIFIEDBY = @MODIFIEDBY,
		MODIFIEDON = @MODIFIEDON,
		POSTPONEREASON = @POSTPONEREASON,
		POSTPONEREMARKS = @POSTPONEREMARKS,
		P_DONEBY = @P_DONEBY,
		P_DONEBY_CODE = @P_DONEBY_CODE,
		P_DONEBY_NAME = @P_DONEBY_NAME,
		POSTPONEDATE = @POSTPONEDATE,
		CANCELLATIONREASON = @CANCELLATIONREASON,
		CANCELLATIONDATE = @CANCELLATIONDATE,
		C_DONEBY = @C_DONEBY,
		C_DONEBY_CODE = @C_DONEBY_CODE,
		C_DONEBY_NAME = @C_DONEBY_NAME,
		Verified = @Verified,
		VerifiedBy = @VerifiedBy,
		VerifiedOn = @VerifiedOn,
		UPDATED = 0,
		UPDATEDON = NULL
	WHERE VESSELCODE = @VESSELCODE AND COMPJOBID = @COMPJOBID
END
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_StockInventory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_StockInventory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_StockInventory]
(
	@VESSELCODE char(3),
	@COMPONENTID bigint,
	@Office_Ship char(1),
	@SpareID bigint,
	@PKID bigint,
	@RecdDate smalldatetime,
	@QtyRecd float,
	@StockLocation varchar(50),
	@UPDATED bit,
	@UPDATEDON smalldatetime,
	@STATUS CHAR(1)
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_StockInventory WHERE VESSELCODE = @VESSELCODE AND PkId=@PkId)
BEGIN 
	INSERT INTO VSL_StockInventory
	(
		VESSELCODE ,
		COMPONENTID ,
		Office_Ship ,
		SpareID ,
		PKID  ,
		RecdDate ,
		QtyRecd ,
		StockLocation ,
		UPDATED ,
		UPDATEDON  ,
		STATUS
	)
	Values
	(
		@VESSELCODE ,
		@COMPONENTID ,
		@Office_Ship ,
		@SpareID ,
		@PKID  ,
		@RecdDate ,
		@QtyRecd ,
		@StockLocation ,
		@UPDATED ,
		@UPDATEDON ,
		@STATUS
	)
END	
ELSE 
BEGIN
	UPDATE VSL_StockInventory
	SET
		VESSELCODE = @VESSELCODE ,
		COMPONENTID = @COMPONENTID ,
		Office_Ship = @Office_Ship ,
		SpareID = @SpareID ,
		PKID = @PKID  ,
		RecdDate = @RecdDate ,
		QtyRecd = @QtyRecd ,
		StockLocation = @StockLocation ,
		UPDATED = @UPDATED ,
		UPDATEDON =@UPDATEDON  ,
		STATUS=@STATUS
	WHERE VESSELCODE = @VESSELCODE AND PkId=@PkId
END
END








' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_UnPlannedJobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_UnPlannedJobs]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_UnPlannedJobs]
(
	@VESSELCODE char(3),
	@UPID bigint,
	@COMPONENTID bigint,
	@SHORTDESCR varchar(500),
	@LONGDESCR varchar(2000),
	@DEPTID INT,
	@ASSIGNEDTO INT,
	@DUEDATE SMALLDATETIME,
	@STATUS CHAR(1),
	@DONEBY INT,
	@DONEBY_CODE varchar(15),
	@DONEBY_NAME varchar(50),
	@DONEDATE smalldatetime,
	@SERVICEREPORT varchar(5000),
	@CONDITIONBEFORE varchar(50),
	@CONDITIONAFTER varchar(50),
	@RQNNO varchar(50),
	@RQNDATE smalldatetime,
	@UPDATEDBY INT,
	@UPDATED bit,
	@UPDATEDON smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_UnPlannedJobs WHERE VESSELCODE = @VESSELCODE AND UPID = @UPID )
BEGIN 
	INSERT INTO VSL_UnPlannedJobs
	(
		VESSELCODE ,
		UPID ,
		COMPONENTID ,
		SHORTDESCR ,
		LONGDESCR ,
		DEPTID ,
		ASSIGNEDTO ,
		DUEDATE ,
		STATUS ,
		DONEBY ,
		DONEBY_CODE ,
		DONEBY_NAME ,
		DONEDATE ,
		SERVICEREPORT ,
		CONDITIONBEFORE ,
		CONDITIONAFTER ,
		RQNNO ,
		RQNDATE ,
		UPDATEDBY ,
		UPDATED ,
		UPDATEDON
	)
	Values
	(
		@VESSELCODE ,
		@UPID ,
		@COMPONENTID ,
		@SHORTDESCR ,
		@LONGDESCR ,
		@DEPTID ,
		@ASSIGNEDTO ,
		@DUEDATE ,
		@STATUS ,
		@DONEBY ,
		@DONEBY_CODE ,
		@DONEBY_NAME ,
		@DONEDATE ,
		@SERVICEREPORT ,
		@CONDITIONBEFORE ,
		@CONDITIONAFTER ,
		@RQNNO ,
		@RQNDATE ,
		@UPDATEDBY ,
		0,
		NULL
	)
END	
ELSE 
BEGIN
	UPDATE VSL_UnPlannedJobs
	SET
		COMPONENTID=@COMPONENTID ,
		SHORTDESCR=@SHORTDESCR ,
		LONGDESCR=@LONGDESCR ,
		DEPTID=@DEPTID ,
		ASSIGNEDTO=@ASSIGNEDTO ,
		DUEDATE=@DUEDATE ,
		STATUS=@STATUS ,
		DONEBY=@DONEBY ,
		DONEBY_CODE=@DONEBY_CODE ,
		DONEBY_NAME=@DONEBY_NAME ,
		DONEDATE=@DONEDATE ,
		SERVICEREPORT=@SERVICEREPORT ,
		CONDITIONBEFORE=@CONDITIONBEFORE ,
		CONDITIONAFTER=@CONDITIONAFTER ,
		RQNNO=@RQNNO ,
		RQNDATE=@RQNDATE ,
		UPDATEDBY=@UPDATEDBY ,
		UPDATED = 0,
		UPDATEDON = NULL
	WHERE VESSELCODE = @VESSELCODE AND UPID = @UPID
END
END






' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_UnPlannedJobs_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_UnPlannedJobs_Attachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_VSL_UnPlannedJobs_Attachments]
(
	@VESSELCODE char(3),
	@TableId bigint,
	@UPId bigint,
	@AttachmentText	varchar(500),
	@FileName varchar(50),
	@Status char(1)
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_UnPlannedJobs_Attachments WHERE VESSELCODE = @VESSELCODE AND UPId = @UPId AND TableId = @TableId)
BEGIN 
	INSERT INTO VSL_UnPlannedJobs_Attachments
	(
		VESSELCODE ,
		UPID ,
		TableId ,
		AttachmentText ,
		[FileName] ,
		Status
	)
	Values
	(
		@VESSELCODE ,
		@UPId ,
		@TableId ,
		@AttachmentText ,
		@FileName ,
		@Status
	)
END	
ELSE 
BEGIN
	UPDATE VSL_UnPlannedJobs_Attachments
	SET AttachmentText=@AttachmentText ,
		[FileName]=@FileName ,
		Status=@Status
	WHERE VESSELCODE = @VESSELCODE AND UPId = @UPId AND TableId = @TableId
END
END








' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_UnPlannedJobs_SpareDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_UnPlannedJobs_SpareDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_VSL_UnPlannedJobs_SpareDetails]
(
	@VESSELCODE char(3),
	@COMPONENTID bigint,
	@OFFICE_SHIP char(1),
	@SPAREID bigint,
	@UPID bigint,
	@QTYCONS float,
	@QTYROB float,
	@STATUS CHAR(1)
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_UnPlannedJobs_SpareDetails WHERE VESSELCODE = @VESSELCODE AND COMPONENTID = @COMPONENTID AND OFFICE_SHIP = @OFFICE_SHIP AND SPAREID = @SPAREID AND UPID = @UPID )
BEGIN 
	INSERT INTO VSL_UnPlannedJobs_SpareDetails
	(
		VESSELCODE ,
		COMPONENTID ,
		OFFICE_SHIP ,
		SPAREID ,
		UPID ,
		QTYCONS ,
		QTYROB ,
		STATUS
	)
	Values
	(
		@VESSELCODE,
		@COMPONENTID,
		@OFFICE_SHIP,
		@SPAREID,
		@UPID,
		@QTYCONS,
		@QTYROB,
		@STATUS
	)
END	
ELSE 
BEGIN
	UPDATE VSL_UnPlannedJobs_SpareDetails
	SET
		QTYCONS = @QTYCONS,
		QTYROB = @QTYROB,		
		STATUS = @STATUS
	WHERE VESSELCODE = @VESSELCODE AND COMPONENTID = @COMPONENTID AND OFFICE_SHIP = @OFFICE_SHIP AND SPAREID = @SPAREID AND UPID = @UPID
END
END







' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselComponentJobMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselComponentJobMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[sp_IE_VSL_VesselComponentJobMaster]
(
	@VESSELCODE char(3),
	@COMPJOBID bigint,
	@COMPONENTID bigint,
	@JOBID bigint,
	@ASSIGNTO int,
	@INTERVALID int,
	@INTERVAL float,
	@ISFIXED smallint,
	@STARTDATE smalldatetime,	
	@DESCRM varchar(5000),
	@INTERVAL_H float,
	@INTERVALID_H int,
	@Guidelines varchar(50), 
	@STATUS char(1),
	@UPDATED bit,
	@UPDATEDON smalldatetime	
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_VesselComponentJobMaster WHERE VESSELCODE = @VESSELCODE AND COMPJOBID = @COMPJOBID )
BEGIN 
	INSERT INTO VSL_VesselComponentJobMaster
	(
		VESSELCODE ,
		COMPJOBID ,
		COMPONENTID ,
		JOBID ,
		ASSIGNTO ,
		INTERVALID ,
		INTERVAL ,
		ISFIXED ,
		STARTDATE ,
		DESCRM ,
		INTERVAL_H ,
		INTERVALID_H ,
		Guidelines,
		STATUS ,
		UPDATED ,
		UPDATEDON 	
	)
	Values
	(
		@VESSELCODE,
		@COMPJOBID,
		@COMPONENTID,
		@JOBID,
		@ASSIGNTO,
		@INTERVALID,
		@INTERVAL,
		@ISFIXED,
		@STARTDATE,
		@DESCRM,
		@INTERVAL_H,
		@INTERVALID_H,
		@Guidelines,
		@STATUS,
		0,
		NULL
	)
	END
ELSE 
BEGIN
	DECLARE @OLDINTID INT
	DECLARE @OLDINT INT
	SELECT @OLDINTID=INTERVALID,@OLDINT=INTERVAL FROM VSL_VesselComponentJobMaster WHERE VESSELCODE = @VESSELCODE AND COMPJOBID = @COMPJOBID 
	----------------------------------
	UPDATE VSL_VesselComponentJobMaster
	SET
		COMPONENTID = @COMPONENTID,
		JOBID = @JOBID,
		ASSIGNTO = @ASSIGNTO,
		INTERVALID = @INTERVALID,
		INTERVAL = @INTERVAL,
		ISFIXED = @ISFIXED,
		STARTDATE = @STARTDATE,
		DESCRM = @DESCRM,
		INTERVAL_H = @INTERVAL_H,
		INTERVALID_H = @INTERVALID_H,
		Guidelines = @Guidelines,
		STATUS = @STATUS,
		UPDATED = 0,
		UPDATEDON = NULL
	WHERE VESSELCODE = @VESSELCODE AND COMPJOBID = @COMPJOBID 
	----------------------------------
	DECLARE @NEWDUEDATE SMALLDATETIME
	DECLARE @NEWDUEDATE_CALC SMALLDATETIME
	DECLARE @NEWDUEDATE_CALC_H SMALLDATETIME

	IF(@OLDINTID!=@INTERVALID OR @OLDINT!=@INTERVAL) -- IT MEANS INTERVALID IS UPDATED OR INTERVAL IS UPDATED
	BEGIN
		
		DECLARE @NEXTDUEDATE SMALLDATETIME
		DECLARE @DONEDATE SMALLDATETIME
		DECLARE @NEXTDUEHOURS INT
		
		DECLARE @AVGHRPDAY FLOAT
		
		DECLARE @H_INTTYPE INT
		DECLARE @H_INTERVAL FLOAT

		SELECT @NEXTDUEDATE=NEXTDUEDATE,@NEXTDUEHOURS=NEXTHOUR,@DONEDATE=LASTDONE FROM dbo.VSL_VesselComponentJobMaster_Updates VCJU WHERE 
		VCJU.VesselCode=@VESSELCODE 
		AND VCJU.ComponentId=@COMPONENTID
		AND VCJU.COMPJOBID =@COMPJOBID 
	
		DECLARE @StartDate_H SMALLDATETIME
		DECLARE @StartupHour_H INT

		IF (@INTERVALID=1) -- HOURLY JOB
		BEGIN
			
			SELECT TOP 1 @StartupHour_H=StartupHour,@StartDate_H=StartDate FROM VSL_VesselRunningHourMaster WHERE VESSELCODE=@VesselCode AND ComponentId=@ComponentId ORDER BY STARTDATE DESC,StartupHour DESC
			------------- H
			SET @NEWDUEDATE = NULL
			SET @NEWDUEDATE_CALC = NULL
			SET @NEWDUEDATE_CALC_H = NULL

			SET @AVGHRPDAY=0
			SET @INTERVAL=0
			SET @H_INTTYPE=0
			SET @H_INTERVAL=0

			SELECT TOP 1 @AVGHRPDAY=AvgRunningHrPerDay FROM VSL_VesselRunningHourMaster WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId ORDER BY UpdatedOn Desc
			IF @AVGHRPDAY>0
			BEGIN
				SELECT @INTERVAL=INTERVAL,@H_INTERVAL=INTERVAL_H,@H_INTTYPE=INTERVALID_H FROM VSL_VesselComponentJobMaster WHERE VESSELCODE=@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
				IF @H_INTTYPE=0 -- IF OR CONDITION IS NOT ENTERED
				BEGIN
					SET @NEWDUEDATE_CALC=DATEADD(day,CEILING((@NEXTDUEHOURS-@StartupHour_H)/@AVGHRPDAY),@StartDate_H)
					UPDATE dbo.VSL_PlanMaster SET NEXTDUEDATE=@NEWDUEDATE_CALC,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
					UPDATE dbo.VSL_VesselComponentJobMaster_Updates SET NEXTDUEDATE=@NEWDUEDATE_CALC,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
				END
				ELSE
				BEGIN
					SET @NEWDUEDATE_CALC=DATEADD(day,CEILING((@NEXTDUEHOURS-@StartupHour_H)/@AVGHRPDAY),@StartDate_H)
					SET @NEWDUEDATE_CALC_H=
						CASE WHEN @H_INTTYPE=2 THEN DATEADD(day,@H_INTERVAL,@DONEDATE)
							 WHEN @H_INTTYPE=3 THEN DATEADD(day,@H_INTERVAL * 7,@DONEDATE)
							 WHEN @H_INTTYPE=4 THEN DATEADD(month,@H_INTERVAL,@DONEDATE)
							 WHEN @H_INTTYPE=5 THEN DATEADD(year,@H_INTERVAL,@DONEDATE)
						ELSE @NEXTDUEDATE END
					IF @NEWDUEDATE_CALC	< @NEWDUEDATE_CALC_H
					BEGIN
						UPDATE dbo.VSL_PlanMaster SET NEXTDUEDATE=@NEWDUEDATE_CALC,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
						UPDATE dbo.VSL_VesselComponentJobMaster_Updates SET NEXTDUEDATE=@NEWDUEDATE_CALC,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
					END
					ELSE
					BEGIN
						UPDATE dbo.VSL_PlanMaster SET NEXTDUEDATE=@NEWDUEDATE_CALC_H,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
						UPDATE dbo.VSL_VesselComponentJobMaster_Updates SET NEXTDUEDATE=@NEWDUEDATE_CALC_H,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
					END
				END
			END 
			-------------H
		END
		ELSE
		BEGIN
			SELECT @INTERVAL=INTERVAL FROM VSL_VesselComponentJobMaster WHERE VESSELCODE=@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
			SELECT @DONEDATE=LastDone FROM VSL_VesselComponentJobMaster_Updates WHERE VESSELCODE=@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
			SET @NEWDUEDATE_CALC_H=
						CASE WHEN @INTERVALID=2 THEN DATEADD(day,@INTERVAL,@DONEDATE)
							 WHEN @INTERVALID=3 THEN DATEADD(day,@INTERVAL * 7,@DONEDATE)
							 WHEN @INTERVALID=4 THEN DATEADD(month,@INTERVAL,@DONEDATE)
							 WHEN @INTERVALID=5 THEN DATEADD(year,@INTERVAL,@DONEDATE)
						ELSE @NEXTDUEDATE END
			
			UPDATE dbo.VSL_PlanMaster SET NEXTDUEDATE=@NEWDUEDATE_CALC_H,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
			UPDATE dbo.VSL_VesselComponentJobMaster_Updates SET NEXTDUEDATE=@NEWDUEDATE_CALC_H,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
		END
	END


	DELETE FROM ComponentJobMapping_OtherRanks WHERE COMPJOBID=@COMPJOBID
END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselComponentJobMaster_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselComponentJobMaster_Attachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_IE_VSL_VesselComponentJobMaster_Attachments]
(
	@VESSELCODE char(3),
	@TABLEID bigint,
	@COMPJOBID bigint,
	@DESCR varchar(500),
	@DOCUMENTTYPE varchar(5),
	@STATUS CHAR(1)
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_VesselComponentJobMaster_Attachments WHERE VESSELCODE = @VESSELCODE AND COMPJOBID = @COMPJOBID AND TABLEID=@TABLEID)
BEGIN 
	INSERT INTO VSL_VesselComponentJobMaster_Attachments
	(
		VESSELCODE ,
		TABLEID ,
		COMPJOBID ,
		DESCR ,
		DOCUMENTTYPE ,
		STATUS	
	)
	Values
	(
		@VESSELCODE ,
		@TABLEID ,
		@COMPJOBID ,
		@DESCR ,
		@DOCUMENTTYPE ,
		@STATUS
	)
	END
ELSE 
BEGIN
	UPDATE VSL_VesselComponentJobMaster_Attachments
	SET
		DESCR=@DESCR ,
		DOCUMENTTYPE=@DOCUMENTTYPE,
		STATUS=@STATUS
	WHERE VESSELCODE = @VESSELCODE AND COMPJOBID = @COMPJOBID AND TABLEID=@TABLEID
END
END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselComponentJobMaster_Updates]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselComponentJobMaster_Updates]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_VesselComponentJobMaster_Updates]
(
    @LOCATION char(1),
	@VESSELCODE char(3),
	@COMPJOBID bigint,
	@COMPONENTID bigint,
	@LASTDONE smalldatetime,
	@LASTHOUR int,
	@NEXTDUEDATE smalldatetime,
	@NEXTHOUR int,
	@UPDATED bit,
	@UPDATEDON smalldatetime
)
AS
BEGIN
SET NOCOUNT ON

IF(@LOCATION = ''S'')
BEGIN
    IF NOT EXISTS(SELECT * FROM VSL_VesselComponentJobMaster_Updates WHERE VESSELCODE = @VESSELCODE AND COMPJOBID = @COMPJOBID AND  COMPONENTID = @COMPONENTID)
    BEGIN
        INSERT INTO VSL_VesselComponentJobMaster_Updates
		(
			VESSELCODE ,
			COMPJOBID ,
			COMPONENTID ,
			LASTDONE ,
			LASTHOUR ,
			NEXTDUEDATE ,
			NEXTHOUR ,
			UPDATED ,
			UPDATEDON 
		)
		Values
		(
			@VESSELCODE,
			@COMPJOBID,
			@COMPONENTID,
			@LASTDONE,
			@LASTHOUR,
			@NEXTDUEDATE,
			@NEXTHOUR,
			0,
			NULL
		)
    END
END
ELSE
BEGIN
    UPDATE VSL_VesselComponentJobMaster_Updates
	SET
		LASTDONE = @LASTDONE,
		LASTHOUR = @LASTHOUR,
		NEXTDUEDATE = @NEXTDUEDATE,
		NEXTHOUR = @NEXTHOUR,
		UPDATED = 0, -- THIS IS DIFERENT THAN OTHER PROC BECAUSE IF WE USE (UPDATED = @UPDATED) THEN IT WILL CREATE LOG AND OFFICE WILL ALWAYS PICK THIS TABLE DATA FOR PACKET WHICH HAS NO NEED TO GO TO SHIP (BECAUSE SHIP ONLY INSERT THE DATA NOT UPDATE)
		UPDATEDON = NULL
	WHERE VESSELCODE = @VESSELCODE AND COMPJOBID = @COMPJOBID AND  COMPONENTID = @COMPONENTID

END
END






' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselJobUpdateHistory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselJobUpdateHistory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_VesselJobUpdateHistory]
(
	@VESSELCODE char(3),
	@HISTORYID bigint,
	@COMPJOBID bigint,
	@COMPONENTID bigint,
	@_ComponentCode char(20),
	@JOBID bigint,
	@STATUS int,
	@ASSIGNEDTO int,
	@PLANDATE smalldatetime,
	@LASTDUEDATE smalldatetime,
	@LASTDUEHOURS int,
	@NEXTDUEDATE smalldatetime,
	@NEXTDUEHOURS int,
	@LASTRUNNINGHOURDATE smalldatetime,
	@LASTRUNNINGHOUR int,
	@DONEBY int,
	@DONEBY_CODE varchar(10),
	@DONEBY_NAME varchar(50),
	@DONEDATE smalldatetime,
	@DONEHOUR int,
	@SERVICEREPORT varchar(500),
	@CONDITIONBEFORE varchar(50),
	@CONDITIONAFTER varchar(50),
	@UPDATEREMARKS int,
	@SPECIFY varchar(50),
	@FILENAME varchar(50),
	@FILEIMAGE image,
	@Coating smallint,
	@Corrosion smallint,
	@Deformation smallint,
	@Cracks smallint,
	@OverallRating smallint,
	@MODIFIEDBY int,
	@MODIFIEDON smalldatetime,
	@POSTPONEREASON int,
	@POSTPONEREMARKS varchar(500),
	@P_DONEBY int,
	@P_DONEBY_CODE varchar(10),
	@P_DONEBY_NAME varchar(50),
	@POSTPONEDATE smalldatetime,
	@CANCELLATIONREASON varchar(500),
	@CANCELLATIONDATE smalldatetime,
	@C_DONEBY int,
	@C_DONEBY_CODE varchar(10),
	@C_DONEBY_NAME varchar(50),
	@ACTION char(1),
	@COMPSTATUS char(1),
	@Verified bit,
	@VerifiedBy varchar(100),
	@VerifiedOn smalldatetime,
	@UPDATED bit,
	@UPDATEDON smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_VesselJobUpdateHistory WHERE VESSELCODE = @VESSELCODE AND HISTORYID = @HISTORYID )
BEGIN 
	INSERT INTO VSL_VesselJobUpdateHistory
	(
		VESSELCODE ,
		HISTORYID ,
		COMPJOBID ,
		COMPONENTID ,
		_ComponentCode,
		JOBID ,
		STATUS ,
		ASSIGNEDTO ,
		PLANDATE ,
		LASTDUEDATE ,
		LASTDUEHOURS ,
		NEXTDUEDATE ,
		NEXTDUEHOURS ,
		LASTRUNNINGHOURDATE ,
		LASTRUNNINGHOUR ,
		DONEBY ,
		DONEBY_CODE ,
		DONEBY_NAME ,
		DONEDATE ,
		DONEHOUR ,
		SERVICEREPORT ,
		CONDITIONBEFORE ,
		CONDITIONAFTER ,
		UPDATEREMARKS ,
		SPECIFY ,
		FILENAME ,
		FILEIMAGE ,
		Coating ,
		Corrosion ,
		Deformation ,
		Cracks ,
		OverallRating ,
		MODIFIEDBY ,
		MODIFIEDON ,
		POSTPONEREASON ,
		POSTPONEREMARKS ,
		P_DONEBY ,
		P_DONEBY_CODE ,
		P_DONEBY_NAME ,
		POSTPONEDATE ,
		CANCELLATIONREASON ,
		CANCELLATIONDATE ,
		C_DONEBY ,
		C_DONEBY_CODE ,
		C_DONEBY_NAME ,
		ACTION ,
		COMPSTATUS ,
		Verified ,
		VerifiedBy ,
		VerifiedOn ,
		UPDATED ,
		UPDATEDON 
	)
	Values
	(
		@VESSELCODE,
		@HISTORYID,
		@COMPJOBID,
		@COMPONENTID,
		@_ComponentCode,
		@JOBID,
		@STATUS,
		@ASSIGNEDTO,
		@PLANDATE,
		@LASTDUEDATE,
		@LASTDUEHOURS,
		@NEXTDUEDATE,
		@NEXTDUEHOURS,
		@LASTRUNNINGHOURDATE,
		@LASTRUNNINGHOUR,
		@DONEBY,
		@DONEBY_CODE,
		@DONEBY_NAME,
		@DONEDATE,
		@DONEHOUR,
		@SERVICEREPORT,
		@CONDITIONBEFORE,
		@CONDITIONAFTER,
		@UPDATEREMARKS,
		@SPECIFY,
		@FILENAME,
		@FILEIMAGE,
		@Coating,
		@Corrosion,
		@Deformation,
		@Cracks,
		@OverallRating,
		@MODIFIEDBY,
		@MODIFIEDON,
		@POSTPONEREASON,
		@POSTPONEREMARKS,
		@P_DONEBY,
		@P_DONEBY_CODE,
		@P_DONEBY_NAME,
		@POSTPONEDATE,
		@CANCELLATIONREASON,
		@CANCELLATIONDATE,
		@C_DONEBY,
		@C_DONEBY_CODE,
		@C_DONEBY_NAME,
		@ACTION,
		@COMPSTATUS,
		@Verified ,
		@VerifiedBy ,
		@VerifiedOn ,
		0,
		NULL
	)
END	
ELSE 
BEGIN
	UPDATE VSL_VesselJobUpdateHistory
	SET
		COMPJOBID = @COMPJOBID,
		COMPONENTID = @COMPONENTID,
		_ComponentCode = @_ComponentCode,
		JOBID = @JOBID,
		STATUS = @STATUS,
		ASSIGNEDTO = @ASSIGNEDTO,
		PLANDATE = @PLANDATE,
		LASTDUEDATE = @LASTDUEDATE,
		LASTDUEHOURS = @LASTDUEHOURS,
		NEXTDUEDATE = @NEXTDUEDATE,
		NEXTDUEHOURS = @NEXTDUEHOURS,
		LASTRUNNINGHOURDATE = @LASTRUNNINGHOURDATE,
		LASTRUNNINGHOUR = @LASTRUNNINGHOUR,		
		DONEBY = @DONEBY,
		DONEBY_CODE = @DONEBY_CODE,
		DONEBY_NAME = @DONEBY_NAME,
		DONEDATE = @DONEDATE,
		DONEHOUR = @DONEHOUR,
		SERVICEREPORT = @SERVICEREPORT,
		CONDITIONBEFORE = @CONDITIONBEFORE,
		CONDITIONAFTER = @CONDITIONAFTER,
		UPDATEREMARKS = @UPDATEREMARKS,
		SPECIFY = @SPECIFY,
		FILENAME = @FILENAME,
		FILEIMAGE = @FILEIMAGE,
		Coating  = @Coating,
		Corrosion  = @Corrosion,
		Deformation  = @Deformation,
		Cracks  = @Cracks,
		OverallRating  = @OverallRating,
		MODIFIEDBY = @MODIFIEDBY,
		MODIFIEDON = @MODIFIEDON,
		POSTPONEREASON = @POSTPONEREASON,
		POSTPONEREMARKS = @POSTPONEREMARKS,
		P_DONEBY = @P_DONEBY,
		P_DONEBY_CODE = @P_DONEBY_CODE,
		P_DONEBY_NAME = @P_DONEBY_NAME,
		POSTPONEDATE = @POSTPONEDATE,
		CANCELLATIONREASON = @CANCELLATIONREASON,
		CANCELLATIONDATE = @CANCELLATIONDATE,
		C_DONEBY = @C_DONEBY,
		C_DONEBY_CODE = @C_DONEBY,
		C_DONEBY_NAME = @C_DONEBY_NAME,
		ACTION = @ACTION,
		COMPSTATUS = @COMPSTATUS,
		Verified = @Verified,
		VerifiedBy = @VerifiedBy,
		VerifiedOn = @VerifiedOn,
		UPDATED = 0,
		UPDATEDON = NULL
	WHERE VESSELCODE = @VESSELCODE AND HISTORYID = @HISTORYID
END
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselJobUpdateHistory_OfficeComments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselJobUpdateHistory_OfficeComments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_VesselJobUpdateHistory_OfficeComments]
(
	@VESSELCODE char(3),
	@HISTORYID bigint,
	@COMMENTS VARCHAR(4000),
	@Verified bit,
	@VerifiedBy varchar(100),
	@VerifiedOn smalldatetime,
	@UPDATED bit,
	@UPDATEDON smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_VesselJobUpdateHistory_OfficeComments WHERE VESSELCODE = @VESSELCODE AND HISTORYID = @HISTORYID )
BEGIN 
	INSERT INTO VSL_VesselJobUpdateHistory_OfficeComments
	(
		VESSELCODE ,
		HISTORYID ,
		COMMENTS,
		Verified ,
		VerifiedBy ,
		VerifiedOn ,
		UPDATED ,
		UPDATEDON 
	)
	Values
	(
		@VESSELCODE,
		@HISTORYID,
		@COMMENTS,
		@Verified ,
		@VerifiedBy ,
		@VerifiedOn ,
		0,
		NULL
	)
END	
ELSE 
BEGIN
	UPDATE VSL_VesselJobUpdateHistory_OfficeComments
	SET
		COMMENTS=@COMMENTS,
		Verified = @Verified,
		VerifiedBy = @VerifiedBy,
		VerifiedOn = @VerifiedOn,
		UPDATED = 0,
		UPDATEDON = NULL
	WHERE VESSELCODE = @VESSELCODE AND HISTORYID = @HISTORYID
END
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselJobUpdateHistoryAttachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselJobUpdateHistoryAttachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_VesselJobUpdateHistoryAttachments]
(
	@VESSELCODE char(3),
	@TableId bigint,
	@HistoryId bigint,
	@AttachmentText	varchar(500),
	@FileName varchar(50),
	@Status char(1)
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_VesselJobUpdateHistoryAttachments WHERE VESSELCODE = @VESSELCODE AND HistoryId = @HistoryId AND TableId = @TableId)
BEGIN 
	INSERT INTO VSL_VesselJobUpdateHistoryAttachments
	(
		VESSELCODE ,
		HistoryId ,
		TableId ,
		AttachmentText ,
		[FileName] ,
		Status
	)
	Values
	(
		@VESSELCODE ,
		@HistoryId ,
		@TableId ,
		@AttachmentText ,
		@FileName ,
		@Status
	)
END	
ELSE 
BEGIN
	UPDATE VSL_VesselJobUpdateHistoryAttachments
	SET AttachmentText=@AttachmentText ,
		[FileName]=@FileName ,
		Status=@Status
	WHERE VESSELCODE = @VESSELCODE AND HistoryId = @HistoryId AND TableId = @TableId
END
END






' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselJobUpdateHistorySpareDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselJobUpdateHistorySpareDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_VesselJobUpdateHistorySpareDetails]
(
	@VESSELCODE char(3),
	@COMPONENTID bigint,
	@OFFICE_SHIP char(1),
	@SPAREID bigint,
	@HistoryId bigint,
	@QTYCONS float,
	@QTYROB float,
	@STATUS CHAR(1)
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_VesselJobUpdateHistorySpareDetails WHERE VESSELCODE = @VESSELCODE AND COMPONENTID = @COMPONENTID AND OFFICE_SHIP = @OFFICE_SHIP AND SPAREID = @SPAREID AND HistoryId = @HistoryId )
BEGIN 
	INSERT INTO VSL_VesselJobUpdateHistorySpareDetails
	(
		VESSELCODE ,
		COMPONENTID ,
		OFFICE_SHIP ,
		SPAREID ,
		HistoryId ,
		QTYCONS ,
		QTYROB ,
		STATUS
	)
	Values
	(
		@VESSELCODE,
		@COMPONENTID,
		@OFFICE_SHIP,
		@SPAREID,
		@HistoryId,
		@QTYCONS,
		@QTYROB,
		@STATUS
	)
END	
ELSE 
BEGIN
	UPDATE VSL_VesselJobUpdateHistorySpareDetails
	SET
		QTYCONS = @QTYCONS,
		QTYROB = @QTYROB,		
		STATUS = @STATUS
	WHERE VESSELCODE = @VESSELCODE AND COMPONENTID = @COMPONENTID AND OFFICE_SHIP = @OFFICE_SHIP AND SPAREID = @SPAREID AND HistoryId = @HistoryId
END
END






' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselRunningHourMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselRunningHourMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_VesselRunningHourMaster]
(
	@VESSELCODE char(3),
	@COMPONENTID int,
	@STARTUPHOUR int,
	@AVGRUNNINGHRPERDAY int,
	@STARTDATE smalldatetime,
	@UPDATEDBY int,
	@UPDATEDON datetime,
	@UPDATED bit
)
AS
BEGIN
SET NOCOUNT ON
IF NOT EXISTS(SELECT * FROM VSL_VesselRunningHourMaster WHERE VESSELCODE = @VESSELCODE AND COMPONENTID = @COMPONENTID AND  UPDATEDON = @UPDATEDON)
BEGIN 
	INSERT INTO VSL_VesselRunningHourMaster
	(
		VESSELCODE ,
		COMPONENTID ,
		STARTUPHOUR ,
		AVGRUNNINGHRPERDAY ,
		STARTDATE ,
		UPDATEDBY ,
		UPDATEDON ,
		UPDATED 
	)
	Values
	(
		@VESSELCODE,
		@COMPONENTID,
		@STARTUPHOUR,
		@AVGRUNNINGHRPERDAY,
		@STARTDATE,
		@UPDATEDBY,
		0,
		NULL
	)
	END
ELSE 
BEGIN
	UPDATE VSL_VesselRunningHourMaster
	SET
		STARTUPHOUR = @STARTUPHOUR,
		AVGRUNNINGHRPERDAY = @AVGRUNNINGHRPERDAY,
		STARTDATE = @STARTDATE,
		UPDATEDBY = @UPDATEDBY,
		UPDATED = 0
	WHERE VESSELCODE = @VESSELCODE AND COMPONENTID = @COMPONENTID AND  UPDATEDON = @UPDATEDON
END
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_IE_VSL_VesselSpareMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_IE_VSL_VesselSpareMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[sp_IE_VSL_VesselSpareMaster]
(
@VESSELCODE char(3),
@COMPONENTID bigint,
@OFFICE_SHIP char(1),
@SPAREID bigint,
@SPARENAME varchar(50),
@MAKER varchar(50),
@MAKERTYPE varchar(50),
@PARTNO varchar(50),
@ALTPARTNO varchar(50),
@LOCATION varchar(50),
@MINQTY int,
@MAXQTY int,
@STATUTORYQTY int,
@WEIGHT float,
@STOCK int,
@SPECIFICATION varchar(500),
@DRAWINGNO varchar(50),
@Attachment varchar(50),
@STATUS char(1),
@UPDATED bit,
@UPDATEDON smalldatetime
)
AS
BEGIN
SET NOCOUNT ON

IF NOT EXISTS(SELECT * FROM VSL_VesselSpareMaster WHERE VESSELCODE = @VESSELCODE AND COMPONENTID = @COMPONENTID AND OFFICE_SHIP = @OFFICE_SHIP AND SPAREID = @SPAREID )
BEGIN 

INSERT INTO VSL_VesselSpareMaster
(
VESSELCODE ,
COMPONENTID ,
OFFICE_SHIP ,
SPAREID ,
SPARENAME ,
MAKER ,
MAKERTYPE ,
PARTNO ,
ALTPARTNO ,
LOCATION ,
MINQTY ,
MAXQTY ,
STATUTORYQTY ,
WEIGHT ,
STOCK ,
SPECIFICATION ,
DRAWINGNO ,
Attachment,
STATUS ,
UPDATED ,
UPDATEDON 
)
Values
(
@VESSELCODE,
@COMPONENTID,
@OFFICE_SHIP,
@SPAREID,
@SPARENAME,
@MAKER,
@MAKERTYPE,
@PARTNO,
@ALTPARTNO,
@LOCATION,
@MINQTY,
@MAXQTY,
@STATUTORYQTY,
@WEIGHT,
@STOCK,
@SPECIFICATION,
@DRAWINGNO,
@Attachment,
@STATUS,
0,
NULL
)
END
ELSE 
   BEGIN 
    
        DECLARE @ISUPDATED BIT
        DECLARE @UPDATED_ON DATETIME
        SELECT @ISUPDATED = UPDATED,@UPDATED_ON = UPDATEDON  FROM VSL_VesselSpareMaster WHERE VESSELCODE = @VESSELCODE AND COMPONENTID = @COMPONENTID AND OFFICE_SHIP = @OFFICE_SHIP AND SPAREID = @SPAREID

        IF(@ISUPDATED = 0)
        BEGIN
             UPDATE [VSL_VesselSpareMaster]
			 SET   [SpareName] = @SPARENAME
				  ,[Maker] = @MAKER 
				  ,[MakerType] = @MAKERTYPE
				  ,[PartNo] = @PARTNO
				  ,[AltPartNo] = @ALTPARTNO
				  ,[Location] = @LOCATION
				  ,[MinQty] = @MINQTY
				  ,[MaxQty] = @MAXQTY
				  ,[StatutoryQty] = @STATUTORYQTY 
				  ,[Weight] = @WEIGHT
				  ,[Stock] = @STOCK 
				  ,[Specification] = @SPECIFICATION 
				  ,[DrawingNo] = @DRAWINGNO
				  ,[Attachment] = @Attachment
				  ,[Status] = @STATUS 
				  ,[Updated] = 0 
				  ,[UpdatedOn] = NULL
		    WHERE [VesselCode] = @VESSELCODE AND [ComponentId] = @COMPONENTID AND [Office_Ship] = @OFFICE_SHIP AND [SpareId] = @SPAREID
        
        END
        ELSE
             IF (@UPDATED_ON < @UPDATEDON )				 
                 
                  BEGIN
                      UPDATE [VSL_VesselSpareMaster]
					  SET   [SpareName] = @SPARENAME
						   ,[Maker] = @MAKER 
						   ,[MakerType] = @MAKERTYPE
						   ,[PartNo] = @PARTNO
						   ,[AltPartNo] = @ALTPARTNO
						   ,[Location] = @LOCATION
						   ,[MinQty] = @MINQTY
						   ,[MaxQty] = @MAXQTY
						   ,[StatutoryQty] = @STATUTORYQTY 
						   ,[Weight] = @WEIGHT
						   ,[Stock] = @STOCK 
						   ,[Specification] = @SPECIFICATION 
						   ,[DrawingNo] = @DRAWINGNO
						   ,[Attachment] = @Attachment
						   ,[Status] = @STATUS 
						   ,[Updated] = 0 
						   ,[UpdatedOn] = NULL
					WHERE [VesselCode] = @VESSELCODE AND [ComponentId] = @COMPONENTID AND [Office_Ship] = @OFFICE_SHIP AND [SpareId] = @SPAREID
                 
				 END
        END
    

   END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Insert_Communication_Export]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Insert_Communication_Export]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_Insert_Communication_Export]
(
	@VesselCode char(3),	
	@RecordType varchar(50),
	@RecordId varchar(50),
	@RecordNo varchar(50),
	@CreatedBy varchar(50)
)
AS
BEGIN

IF NOT EXISTS (SELECT TableId FROM tbl_Vessel_Communication WHERE VesselCode=@VesselCode AND RecordType=@RecordType AND RecordId=@RecordId AND ExportedOn IS NULL )
BEGIN
        Declare @TableId bigint 
		SELECT @TableId=ISNULL(MAX(TableId),0)+1 FROM tbl_Vessel_Communication WHERE VesselCode=@VesselCode
		
		INSERT INTO tbl_Vessel_Communication
		(
		   VesselCode,
		   TableId,	
		   RecordType,
		   RecordId,
		   RecordNo,
		   CreatedOn,
		   CreatedBy
		)
		VALUES
		(
		   @VesselCode,
		   @TableId,	
		   @RecordType,
		   @RecordId,
		   @RecordNo,
		   getdate(),
		   @CreatedBy
		) 
END
ELSE
BEGIN
     
	 SELECT ''Already sent for export.'' 

END


END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Insert_Ship_Component_Jobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Insert_Ship_Component_Jobs]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

                				  
CREATE Proc [dbo].[sp_Insert_Ship_Component_Jobs]
(
@VesselCode CHAR(3),
@ComponentCode CHAR(12),
@CompJOBID INT,
@AssignTo INT,
@IntervalId INT,
@Interval FLOAT,
@IsFixed SMALLINT,
@StartDate SMALLDATETIME,
@DescrM VARCHAR(5000),
@IntervalId_H INT,
@Interval_H FLOAT,
@Guidelines VARCHAR(50)
)
AS
BEGIN

      
	  DECLARE @ComponentId INT	
	  DECLARE @JobId INT	
	  
	  SELECT @ComponentId = ComponentId FROM ComponentMaster WHERE ComponentCode = LTRIM(RTRIM(@ComponentCode))
	  SELECT @JobId = JobId FROM dbo.ComponentsJobMapping WHERE CompJOBID = @CompJOBID
	 
	  INSERT INTO VSL_VesselComponentJobMaster VALUES (@VesselCode,@CompJOBID,@ComponentId,@JobId,@AssignTo,@IntervalId,@Interval,@IsFixed,@StartDate,
		 @DescrM,@IntervalId_H,@Interval_H,@Guidelines,''A'',1,getdate())
		 
      INSERT INTO VSL_VesselComponentJobMaster_Updates VALUES (@VesselCode,@CompJOBID,@ComponentId,@StartDate,0,
		 CASE @IntervalId 
		 WHEN 1 THEN NULL
		 WHEN 2 THEN dateadd(dd,@Interval,@StartDate)
		 WHEN 3 THEN dateadd(ww,@Interval,@StartDate)
		 WHEN 4 THEN dateadd(mm,@Interval,@StartDate)
		 WHEN 5 THEN dateadd(yy,@Interval,@StartDate)
		 END,0,1,getdate())		
		  
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Insert_Ship_Components]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Insert_Ship_Components]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

				  
CREATE PROC [dbo].[sp_Insert_Ship_Components]
(
    @VesselCode CHAR(3),
	@ComponentCode CHAR(12)
)
AS
BEGIN

	DECLARE @ComponentId INT
    DECLARE @ParentId INT
    DECLARE @ParentParentId INT
    DECLARE @RootParentId INT

IF(LEN(LTRIM(RTRIM(@ComponentCode))) = 3)
BEGIN
    
    SELECT @ComponentId=ComponentId FROM ComponentMaster WHERE LTRIM(RTRIM(ComponentCode)) = LTRIM(RTRIM(@ComponentCode))
	
	INSERT INTO VSL_ComponentMasterForVessel
    (
           VesselCode,
           ComponentId,
           Status,
           Updated,
           UpdatedOn   
	)
     VALUES
	(
	       @VesselCode,
           @ComponentId ,
           ''A'' ,
           1,          
           getdate()
	)	
END

IF(LEN(LTRIM(RTRIM(@ComponentCode))) = 6)
BEGIN
    
    SELECT @ParentId=ComponentId FROM ComponentMaster WHERE LEN(LTRIM(RTRIM(ComponentCode))) = 3 AND LEFT(LTRIM(RTRIM(ComponentCode)), 3) = LEFT(LTRIM(RTRIM(@ComponentCode)),3) 
    SELECT @ComponentId=ComponentId FROM ComponentMaster WHERE LTRIM(RTRIM(ComponentCode)) = LTRIM(RTRIM(@ComponentCode))

    IF NOT EXISTS (SELECT * FROM  VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentId )
		BEGIN
		     INSERT INTO VSL_ComponentMasterForVessel
			  (
				   VesselCode,
				   ComponentId,
				   Status,
				   Updated,
				   UpdatedOn   
			  )
			 VALUES
			  (
				   @VesselCode,
				   @ParentId ,
				   ''A'' ,
				   1,          
				   getdate()
			  )			
		END
		
		INSERT INTO VSL_ComponentMasterForVessel
		(
			   VesselCode,
			   ComponentId,
			   Status,
			   Updated,
			   UpdatedOn   
		)
		 VALUES
		(
			   @VesselCode,
			   @ComponentId ,
			   ''A'' ,
			   1,          
			   getdate()
		)	
    
END	

IF(LEN(LTRIM(RTRIM(@ComponentCode))) = 9)
BEGIN
    
    SELECT @ComponentId=ComponentId FROM ComponentMaster WHERE LTRIM(RTRIM(ComponentCode)) = LTRIM(RTRIM(@ComponentCode))
    SELECT @ParentId=ComponentId FROM ComponentMaster WHERE LEN(LTRIM(RTRIM(ComponentCode))) = 6 AND LEFT(LTRIM(RTRIM(ComponentCode)), 6) = LEFT(LTRIM(RTRIM(@ComponentCode)),6)
    SELECT @ParentParentId=ComponentId FROM ComponentMaster WHERE LEN(LTRIM(RTRIM(ComponentCode))) = 3 AND LEFT(LTRIM(RTRIM(ComponentCode)), 3) = LEFT(LTRIM(RTRIM(@ComponentCode)),3)
        
    
    IF NOT EXISTS (SELECT * FROM  VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentParentId )
		BEGIN
		     
		     INSERT INTO VSL_ComponentMasterForVessel
			  (
				   VesselCode,
				   ComponentId,
				   Status,
				   Updated,
				   UpdatedOn   
			  )
			 VALUES
			  (
				   @VesselCode,
				   @ParentParentId ,
				   ''A'' ,
				   1,          
				   getdate()
			  )			
		END
	IF NOT EXISTS (SELECT * FROM  VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentId )
		BEGIN
		     
		     INSERT INTO VSL_ComponentMasterForVessel
			  (
				   VesselCode,
				   ComponentId,
				   Status,
				   Updated,
				   UpdatedOn   
			  )
			 VALUES
			  (
				   @VesselCode,
				   @ParentId ,
				   ''A'' ,
				   1,          
				   getdate()
			  )			
		END
		
		INSERT INTO VSL_ComponentMasterForVessel
		(
			   VesselCode,
			   ComponentId,
			   Status,
			   Updated,
			   UpdatedOn   
		)
		 VALUES
		(
			   @VesselCode,
			   @ComponentId ,
			   ''A'' ,
			   1,          
			   getdate()
		)	
    
END

IF(LEN(LTRIM(RTRIM(@ComponentCode))) = 12)
BEGIN
    
    SELECT @ComponentId=ComponentId FROM ComponentMaster WHERE LTRIM(RTRIM(ComponentCode)) = LTRIM(RTRIM(@ComponentCode))
    SELECT @ParentId=ComponentId FROM ComponentMaster WHERE LEN(LTRIM(RTRIM(ComponentCode))) = 9 AND LEFT(LTRIM(RTRIM(ComponentCode)), 9) = LEFT(LTRIM(RTRIM(@ComponentCode)),9)																								    
    SELECT @ParentParentId=ComponentId FROM ComponentMaster WHERE LEN(LTRIM(RTRIM(ComponentCode))) = 6 AND LEFT(LTRIM(RTRIM(ComponentCode)), 6) = LEFT(LTRIM(RTRIM(@ComponentCode)),6)																											
    SELECT @RootParentId=ComponentId FROM ComponentMaster WHERE LEN(LTRIM(RTRIM(ComponentCode))) = 3 AND LEFT(LTRIM(RTRIM(ComponentCode)), 3) = LEFT(LTRIM(RTRIM(@ComponentCode)),3)																				

    IF NOT EXISTS (SELECT * FROM  VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@RootParentId )
		BEGIN
		     INSERT INTO VSL_ComponentMasterForVessel
			  (
				   VesselCode,
				   ComponentId,
				   Status,
				   Updated,
				   UpdatedOn   
			  )
			 VALUES
			  (
				   @VesselCode,
				   @RootParentId ,
				   ''A'' ,
				   1,          
				   getdate()
			  )			
		END
	IF NOT EXISTS (SELECT * FROM  VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentParentId )
		BEGIN
		     INSERT INTO VSL_ComponentMasterForVessel
			  (
				   VesselCode,
				   ComponentId,
				   Status,
				   Updated,
				   UpdatedOn   
			  )
			 VALUES
			  (
				   @VesselCode,
				   @ParentParentId,
				   ''A'' ,
				   1,          
				   getdate()
			  )			
		END
	IF NOT EXISTS (SELECT * FROM  VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentId )
		BEGIN
		     INSERT INTO VSL_ComponentMasterForVessel
			  (
				   VesselCode,
				   ComponentId,
				   Status,
				   Updated,
				   UpdatedOn   
			  )
			 VALUES
			  (
				   @VesselCode,
				   @ParentId,
				   ''A'' ,
				   1,          
				   getdate()
			  )			
		END
		
		INSERT INTO VSL_ComponentMasterForVessel
		(
			   VesselCode,
			   ComponentId,
			   Status,
			   Updated,
			   UpdatedOn   
		)
		 VALUES
		(
			   @VesselCode,
			   @ComponentId ,
			   ''A'' ,
			   1,          
			   getdate()
		)	
    
END							
END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Insert_Ship_Components_AutoSpecFromParent]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Insert_Ship_Components_AutoSpecFromParent]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

				  
CREATE PROC [dbo].[sp_Insert_Ship_Components_AutoSpecFromParent]
(
    @VesselCode CHAR(3),
	@ComponentCode CHAR(12)
)
AS
BEGIN

	DECLARE @ComponentId INT
    DECLARE @ParentId INT
    DECLARE @ParentParentId INT
    DECLARE @RootParentId INT

	DECLARE @Maker VARCHAR(50)
	DECLARE @MakerType VARCHAR(50)
	DECLARE @ClassEquipCode VARCHAR(30)
	DECLARE @Descr VARCHAR(1000)

IF(LEN(LTRIM(RTRIM(@ComponentCode))) = 3)
BEGIN
    
    SELECT @ComponentId=ComponentId FROM ComponentMaster WHERE LTRIM(RTRIM(ComponentCode)) = LTRIM(RTRIM(@ComponentCode))
	
	INSERT INTO VSL_ComponentMasterForVessel
    (
           VesselCode,
           ComponentId,
           Status,
           Updated,
           UpdatedOn   
	)
     VALUES
	(
	       @VesselCode,
           @ComponentId ,
           ''A'' ,
           1,          
           getdate()
	)	
END

IF(LEN(LTRIM(RTRIM(@ComponentCode))) = 6)
BEGIN
    
    SELECT @ParentId=ComponentId FROM ComponentMaster WHERE LEN(LTRIM(RTRIM(ComponentCode))) = 3 AND LEFT(LTRIM(RTRIM(ComponentCode)), 3) = LEFT(LTRIM(RTRIM(@ComponentCode)),3) 
    SELECT @ComponentId=ComponentId FROM ComponentMaster WHERE LTRIM(RTRIM(ComponentCode)) = LTRIM(RTRIM(@ComponentCode))

    IF NOT EXISTS (SELECT * FROM  VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentId )
		BEGIN
		     INSERT INTO VSL_ComponentMasterForVessel
			  (
				   VesselCode,
				   ComponentId,
				   Status,
				   Updated,
				   UpdatedOn   
			  )
			 VALUES
			  (
				   @VesselCode,
				   @ParentId ,
				   ''A'' ,
				   1,          
				   getdate()
			  )	
		END
		
		INSERT INTO VSL_ComponentMasterForVessel
		(
			   VesselCode,
			   ComponentId,
			   Status,
			   Updated,
			   UpdatedOn   
		)
		 VALUES
		(
			   @VesselCode,
			   @ComponentId ,
			   ''A'' ,
			   1,          
			   getdate()
		)
				
		SELECT @Maker= [Maker],@MakerType=[MakerType],@ClassEquipCode=[ClassEquipCode],@Descr=[Descr] FROM VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentId

		UPDATE VSL_ComponentMasterForVessel
		       SET [Maker] = @Maker,
			       [MakerType] = @MakerType,
				   [ClassEquipCode] = @ClassEquipCode,
				   [Descr] = @Descr
        WHERE VesselCode =@VesselCode AND ComponentId =@ComponentId
		
    
END	

IF(LEN(LTRIM(RTRIM(@ComponentCode))) = 9)
BEGIN
    
    SELECT @ComponentId=ComponentId FROM ComponentMaster WHERE LTRIM(RTRIM(ComponentCode)) = LTRIM(RTRIM(@ComponentCode))
    SELECT @ParentId=ComponentId FROM ComponentMaster WHERE LEN(LTRIM(RTRIM(ComponentCode))) = 6 AND LEFT(LTRIM(RTRIM(ComponentCode)), 6) = LEFT(LTRIM(RTRIM(@ComponentCode)),6)
    SELECT @ParentParentId=ComponentId FROM ComponentMaster WHERE LEN(LTRIM(RTRIM(ComponentCode))) = 3 AND LEFT(LTRIM(RTRIM(ComponentCode)), 3) = LEFT(LTRIM(RTRIM(@ComponentCode)),3)
        
    
    IF NOT EXISTS (SELECT * FROM  VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentParentId )
		BEGIN
		     
		     INSERT INTO VSL_ComponentMasterForVessel
			  (
				   VesselCode,
				   ComponentId,
				   Status,
				   Updated,
				   UpdatedOn   
			  )
			 VALUES
			  (
				   @VesselCode,
				   @ParentParentId ,
				   ''A'' ,
				   1,          
				   getdate()
			  )				  
			  		
		END
	IF NOT EXISTS (SELECT * FROM  VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentId )
		BEGIN
		     
		     INSERT INTO VSL_ComponentMasterForVessel
			  (
				   VesselCode,
				   ComponentId,
				   Status,
				   Updated,
				   UpdatedOn   
			  )
			 VALUES
			  (
				   @VesselCode,
				   @ParentId ,
				   ''A'' ,
				   1,          
				   getdate()
			  )	
			  
			SELECT @Maker= [Maker],@MakerType=[MakerType],@ClassEquipCode=[ClassEquipCode],@Descr=[Descr] FROM VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentParentId

				UPDATE VSL_ComponentMasterForVessel
					   SET [Maker] = @Maker,
						   [MakerType] = @MakerType,
						   [ClassEquipCode] = @ClassEquipCode,
						   [Descr] = @Descr
				WHERE VesselCode =@VesselCode AND ComponentId =@ParentId		
		END
		
		INSERT INTO VSL_ComponentMasterForVessel
		(
			   VesselCode,
			   ComponentId,
			   Status,
			   Updated,
			   UpdatedOn   
		)
		 VALUES
		(
			   @VesselCode,
			   @ComponentId ,
			   ''A'' ,
			   1,          
			   getdate()
		)	

		SELECT @Maker= [Maker],@MakerType=[MakerType],@ClassEquipCode=[ClassEquipCode],@Descr=[Descr] FROM VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentId

		UPDATE VSL_ComponentMasterForVessel
		       SET [Maker] = @Maker,
			       [MakerType] = @MakerType,
				   [ClassEquipCode] = @ClassEquipCode,
				   [Descr] = @Descr
        WHERE VesselCode =@VesselCode AND ComponentId =@ComponentId
    
END

IF(LEN(LTRIM(RTRIM(@ComponentCode))) = 12)
BEGIN
    
    SELECT @ComponentId=ComponentId FROM ComponentMaster WHERE LTRIM(RTRIM(ComponentCode)) = LTRIM(RTRIM(@ComponentCode))
    SELECT @ParentId=ComponentId FROM ComponentMaster WHERE LEN(LTRIM(RTRIM(ComponentCode))) = 9 AND LEFT(LTRIM(RTRIM(ComponentCode)), 9) = LEFT(LTRIM(RTRIM(@ComponentCode)),9)																								    
    SELECT @ParentParentId=ComponentId FROM ComponentMaster WHERE LEN(LTRIM(RTRIM(ComponentCode))) = 6 AND LEFT(LTRIM(RTRIM(ComponentCode)), 6) = LEFT(LTRIM(RTRIM(@ComponentCode)),6)																											
    SELECT @RootParentId=ComponentId FROM ComponentMaster WHERE LEN(LTRIM(RTRIM(ComponentCode))) = 3 AND LEFT(LTRIM(RTRIM(ComponentCode)), 3) = LEFT(LTRIM(RTRIM(@ComponentCode)),3)																				

    IF NOT EXISTS (SELECT * FROM  VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@RootParentId )
		BEGIN
		     INSERT INTO VSL_ComponentMasterForVessel
			  (
				   VesselCode,
				   ComponentId,
				   Status,
				   Updated,
				   UpdatedOn   
			  )
			 VALUES
			  (
				   @VesselCode,
				   @RootParentId ,
				   ''A'' ,
				   1,          
				   getdate()
			  )			
		END
	IF NOT EXISTS (SELECT * FROM  VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentParentId )
		BEGIN
		     INSERT INTO VSL_ComponentMasterForVessel
			  (
				   VesselCode,
				   ComponentId,
				   Status,
				   Updated,
				   UpdatedOn   
			  )
			 VALUES
			  (
				   @VesselCode,
				   @ParentParentId,
				   ''A'' ,
				   1,          
				   getdate()
			  )	
			  SELECT @Maker= [Maker],@MakerType=[MakerType],@ClassEquipCode=[ClassEquipCode],@Descr=[Descr] FROM VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@RootParentId

				UPDATE VSL_ComponentMasterForVessel
					   SET [Maker] = @Maker,
						   [MakerType] = @MakerType,
						   [ClassEquipCode] = @ClassEquipCode,
						   [Descr] = @Descr
				WHERE VesselCode =@VesselCode AND ComponentId =@ParentParentId		
		END
	IF NOT EXISTS (SELECT * FROM  VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentId )
		BEGIN
		     INSERT INTO VSL_ComponentMasterForVessel
			  (
				   VesselCode,
				   ComponentId,
				   Status,
				   Updated,
				   UpdatedOn   
			  )
			 VALUES
			  (
				   @VesselCode,
				   @ParentId,
				   ''A'' ,
				   1,          
				   getdate()
			  )	
			  
			  SELECT @Maker= [Maker],@MakerType=[MakerType],@ClassEquipCode=[ClassEquipCode],@Descr=[Descr] FROM VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentParentId

				UPDATE VSL_ComponentMasterForVessel
					   SET [Maker] = @Maker,
						   [MakerType] = @MakerType,
						   [ClassEquipCode] = @ClassEquipCode,
						   [Descr] = @Descr
				WHERE VesselCode =@VesselCode AND ComponentId =@ParentId		
		END
		
		INSERT INTO VSL_ComponentMasterForVessel
		(
			   VesselCode,
			   ComponentId,
			   Status,
			   Updated,
			   UpdatedOn   
		)
		 VALUES
		(
			   @VesselCode,
			   @ComponentId ,
			   ''A'' ,
			   1,          
			   getdate()
		)	

		SELECT @Maker= [Maker],@MakerType=[MakerType],@ClassEquipCode=[ClassEquipCode],@Descr=[Descr] FROM VSL_ComponentMasterForVessel WHERE VesselCode =@VesselCode AND ComponentId =@ParentId

		UPDATE VSL_ComponentMasterForVessel
		       SET [Maker] = @Maker,
			       [MakerType] = @MakerType,
				   [ClassEquipCode] = @ClassEquipCode,
				   [Descr] = @Descr
        WHERE VesselCode =@VesselCode AND ComponentId =@ComponentId
    
END							
END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertComponentsForVessel]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertComponentsForVessel]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[sp_InsertComponentsForVessel]
(
	@VesselCode char(3),
	@ComponentId int
)
AS
BEGIN
declare @Descr varchar(1000)
	IF(NOT EXISTS(SELECT ComponentId FROM ComponentMasterForVessel WHERE VesselCode= @VesselCode AND ComponentId = @ComponentId ))
	BEGIN
		INSERT INTO ComponentMasterForVessel(
			   VesselCode,
			   ComponentId,
			   Descr,
			   CLASSEQUIP                               
		)
		SELECT @VesselCode,ComponentId,Descr,CLASSEQUIP FROM COMPONENTMASTER WHERE COMPONENTID=@ComponentId
	END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertComponentsForVessel_AutoSpecFromParent]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertComponentsForVessel_AutoSpecFromParent]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
-- EXEC [sp_InsertComponentsForVessel_AutoSpecFromParent] ''''AME'''',1736,1733

CREATE PROC [dbo].[sp_InsertComponentsForVessel_AutoSpecFromParent]
(
	@VesselCode char(3),
	@ComponentId int,
	@ParentComponentId int
)
AS
BEGIN
    
	IF(NOT EXISTS(SELECT ComponentId FROM ComponentMasterForVessel WHERE VesselCode= @VesselCode AND ComponentId = @ComponentId ))
	BEGIN
		INSERT INTO ComponentMasterForVessel(
			   VesselCode,
			   ComponentId,
			   Descr,              
			   CLASSEQUIP
		)
		SELECT @VesselCode,ComponentId,Descr,CLASSEQUIP FROM COMPONENTMASTER WHERE COMPONENTID=@ComponentId

		IF(@ParentComponentId > 0)
		BEGIN

		DECLARE @Maker Varchar(50)
		DECLARE @MakerType Varchar(50)
		DECLARE @ClassEquipCode Varchar(30)
		DECLARE @Descr Varchar(1000)
		DECLARE @CLASSEQUIP bit
		DECLARE @ACCOUNTCODES varchar(50)

		SELECT @Maker=[Maker],@MakerType=[MakerType],@ClassEquipCode=[ClassEquipCode],@Descr=[Descr],@CLASSEQUIP=CLASSEQUIP,@ACCOUNTCODES=ACCOUNTCODES FROM [ComponentMasterForVessel] WHERE VesselCode= @VesselCode AND ComponentId = @ParentComponentId

		UPDATE [ComponentMasterForVessel] 
		       SET [Maker]= @Maker,
			       [MakerType]=@MakerType,
				   [ClassEquipCode]=@ClassEquipCode,
				   [Descr]=@Descr,
				   CLASSEQUIP=@CLASSEQUIP,
				   ACCOUNTCODES=@ACCOUNTCODES
		WHERE VesselCode= @VesselCode AND ComponentId = @ComponentId

		END

	END
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertDefectRemarks]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertDefectRemarks]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'




CREATE PROC [dbo].[sp_InsertDefectRemarks]
(
	@VesselCode CHAR(3),
    @DefectRemarkId BIGINT,
	@DefectNo VARCHAR(15),
	@Remarks VARCHAR(5000),
	@FileName VARCHAR(50),
	@File Image,
	@EnteredBy VARCHAR(50)
)
AS
BEGIN

  SELECT @DefectRemarkId = ISNULL(MAX(DefectRemarkId),0)+1 FROM VSL_DefectRemarks WHERE VesselCode = @VesselCode

  INSERT INTO [VSL_DefectRemarks]
           (
             DefectRemarkId,
             VesselCode,
             DefectNo,
			 Remarks,
			 [FileName],
			 [File],
			 Updated,
			 UpdatedOn,
			 EnteredBy,
			 EnteredOn
			 
           )
           
     VALUES
           (
             @DefectRemarkId,
             @VesselCode,
             @DefectNo,
			 @Remarks,
			 @FileName,
			 @File,            
			 1,
             getdate(),
             @EnteredBy,
             getdate()
             
           )


	
		
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertDefects]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertDefects]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'




CREATE PROC [dbo].[sp_InsertDefects]
(
	@VesselCode char(3),
	@ComponentId BigInt,
	@DefectNo VARCHAR(15),
	@HistoryId BigInt,
    @ReportDt SMALLDATETIME,
    @TargetDt SMALLDATETIME,
    @CompletionDt SMALLDATETIME,
    @Vessel CHAR(1),
    @Spares CHAR(1),
    @ShoreAssist CHAR(1),
    @Drydock CHAR(1),
    @Guarentee CHAR(1),
    @DefectDetails VARCHAR(1000),
    @RepairsDetails VARCHAR(1000),
    @SparesOnBoard CHAR(1),
    @RqnNo VARCHAR(20),
    @RqnDate SMALLDATETIME,
    @SparesRequired CHAR(1),
    @Supdt VARCHAR(50),
    @ChiefOfficer VARCHAR(50),
    @ChiefEngg VARCHAR(50),
    @CompStatus CHAR(1)
)
AS
BEGIN

IF (NOT EXISTS (SELECT * FROM Vsl_DefectDetailsMaster WHERE [VesselCode] = @VesselCode AND [ComponentId]= @ComponentId AND [DefectNo]= @DefectNo AND [HistoryId] = @HistoryId))
 BEGIN
  INSERT INTO [Vsl_DefectDetailsMaster]
           ([VesselCode]
           ,[ComponentId]
           ,[DefectNo]
           ,[HistoryId]
           ,[ReportDt]
           ,[TargetDt]
           ,[CompletionDt]
           ,[Vessel]
           ,[Spares]
           ,[ShoreAssist]
           ,[Drydock]
           ,[Guarentee]
           ,[DefectDetails]
           ,[RepairsDetails]
           ,[SparesOnBoard]
           ,[RqnNo]
           ,[SparesOrdered]
           ,[RqnDate]
           ,[SparesRequired]
           ,[Supdt]
           ,[ChiefOfficer]
           ,[ChiefEngg]
           ,[Status]
           ,[Updated]
           ,[UpdatedOn]
           ,[CompStatus])
           
     VALUES
           (@VesselCode
           ,@ComponentId
           ,@DefectNo
           ,@HistoryId
           ,@ReportDt
           ,@TargetDt
           ,@CompletionDt
           ,@Vessel
           ,@Spares
           ,@ShoreAssist
           ,@Drydock
           ,@Guarentee
           ,@DefectDetails
           ,@RepairsDetails
           ,@SparesOnBoard
           ,@RqnNo
           ,''''
           ,@RqnDate
           ,@SparesRequired
           ,@Supdt
           ,@ChiefOfficer
           ,@ChiefEngg
           ,''A''
           ,1
           ,getdate()
           ,@CompStatus)
   
   END
   ELSE
   BEGIN
        UPDATE Vsl_DefectDetailsMaster
           SET [ReportDt] =  @ReportDt,
			   [TargetDt] = @TargetDt,
			   [CompletionDt] = @CompletionDt ,
			   [Vessel] = @Vessel,
			   [Spares] = @Spares,
			   [ShoreAssist] = @ShoreAssist,
			   [Drydock] = @Drydock,
			   [Guarentee] = @Guarentee,
			   [DefectDetails] = @DefectDetails,
			   [RepairsDetails] = @RepairsDetails,
			   [SparesOnBoard] = @SparesOnBoard,
			   [RqnNo] = @RqnNo,
			   [RqnDate] = @RqnDate,
			   [SparesRequired] = @SparesRequired,
			   [Supdt] = @Supdt,
			   [ChiefOfficer] = @ChiefOfficer,
			   [ChiefEngg] = @ChiefEngg,
			   [Updated] = 1,
			   [UpdatedOn] = getdate(),
			   [CompStatus] = @CompStatus
		  WHERE [VesselCode] = @VesselCode AND [ComponentId]= @ComponentId AND [DefectNo]= @DefectNo AND [HistoryId] = @HistoryId
   
   END
		
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertDefectsAttachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertDefectsAttachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[sp_InsertDefectsAttachments]
(
    @VesselCode CHAR(3),
	@DefectNo varchar(15),	
	@AttachmentText Varchar(500),
	@FileName Varchar(50)
)
AS
BEGIN
		declare @AttachmentId bigint 
		select @AttachmentId=isnull(max(AttachmentId),0)+1 from VSL_Defects_Attachments WHERE VesselCode = @VesselCode
		INSERT INTO VSL_Defects_Attachments
		(
		   AttachmentId,
		   VesselCode,
		   DefectNo,
		   AttachmentText,
		   [FileName],
		   Updated,
		   UpdatedOn  
		)
		 VALUES
		(
		   @AttachmentId,
		   @VesselCode,
		   @DefectNo,
		   @AttachmentText, 
		   @FileName,
		   1,
		   getdate()
		)
		
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertDeleteComponentJobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertDeleteComponentJobs]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


				  				  				  
CREATE PROC [dbo].[sp_InsertDeleteComponentJobs]
(
	@ComponentId BIGINT,
	@JobId  BIGINT,
	@CompJobId	BIGINT,
	@AssignTo INT,	
	@DeptId INT,
	@IntervalId INT,
	@IsFixed SMALLINT,
	@DescrSh VARCHAR(250),
	@DescrM VARCHAR(5000),
	@Type VARCHAR(10),
	@AttachmentForm VARCHAR(50),
	@RiskAssessment VARCHAR(50),
	@RatingRequired BIT
)
AS
BEGIN
	IF(@Type = ''ADD'')
	BEGIN
	SELECT @CompJobId = ISNULL(MAX(CompJobId),0)+1 FROM ComponentsJobMapping 
	INSERT INTO ComponentsJobMapping
    (      ComponentId,
           JobId,
           CompJobId,
           AssignTo,  
           DeptId,           
           IntervalId,
           IsFixed,
           DescrSh,
           DescrM,
           AttachmentForm,
           RiskAssessment,
           RatingRequired
            
	)
     VALUES
	(
	      @ComponentId,
          @JobId,
          @CompJobId,
          @AssignTo,                 
          @DeptId,          
          @IntervalId,
          @IsFixed,
          @DescrSh,
          @DescrM,
          @AttachmentForm,
          @RiskAssessment,
          @RatingRequired
	)
	SELECT @CompJobId 

	END
	IF (@Type = ''EDIT'')
	BEGIN
	        UPDATE ComponentsJobMapping
            SET DeptId = @DeptId,
                AssignTo = @AssignTo,
                IntervalId = @IntervalId,
	            IsFixed = @IsFixed,
	            DescrSh = @DescrSh,
	            DescrM = @DescrM,
	            AttachmentForm = @AttachmentForm,
	            RiskAssessment = @RiskAssessment,
	            RatingRequired = @RatingRequired
            WHERE ComponentId = @ComponentId AND JobId = @JobId AND CompJobId = @CompJobId
            
            UPDATE VSL_VesselComponentJobMaster
			SET Updated = 1,
				UpdatedOn = getdate()
			WHERE CompJobId = @CompJobId
	END
	IF (@Type = ''DELETE'')
	BEGIN
	
	DELETE FROM  ComponentsJobMapping WHERE ComponentId = @ComponentId AND JobId = @JobId AND CompJobId = @CompJobId
	
	END	
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertExecuteAttachment]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertExecuteAttachment]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[sp_InsertExecuteAttachment]
(
	@VesselCode char(3),
	@HistoryId bigint,
	@AttachmentText Varchar(500),
	@FileName Varchar(50)
)
AS
BEGIN
		declare @TableId bigint
		select @TableId=isnull(max(tableid),0)+1 from VSL_VesselJobUpdateHistoryAttachments
		INSERT INTO VSL_VesselJobUpdateHistoryAttachments
		(
		   VesselCode,
		   TableId,
		   HistoryId,
		   AttachmentText,
		   [FileName],
		   Status	       
		)
		 VALUES
		(
		   @VesselCode,
		   @TableId,
		   @HistoryId,
		   @AttachmentText,
		   @FileName,''A''
		)
		UPDATE VSL_VesselJobUpdateHistory SET UPDATED=1,UPDATEDON=GETDATE() WHERE VESSELCODE=@VESSELCODE AND HISTORYID=@HISTORYID
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertSpares_BreakDown]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertSpares_BreakDown]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



CREATE PROC [dbo].[sp_InsertSpares_BreakDown]
(
	@VesselCode CHAR(3),
	@ComponentId INT,
    @Office_Ship CHAR(1),
    @SpareId INT,
    @DefectNo VARCHAR(15),
    @QtyCons float,
    @QtyRob float
)
AS
BEGIN
	IF(NOT EXISTS(SELECT * FROM VSL_DefectSpareDetails WHERE VesselCode= @VesselCode AND ComponentId = @ComponentId AND Office_Ship = @Office_Ship AND SpareId = @SpareId AND DefectNo = @DefectNo))
	BEGIN
		INSERT INTO VSL_DefectSpareDetails
		(
			   VesselCode,
			   ComponentId,             
			   Office_Ship,
			   SpareId,
			   DefectNo,
			   QtyCons,
			   QtyRob,
			   Status 
	           
		)
		 VALUES
		(
			   @VesselCode,
			   @ComponentId,             
			   @Office_Ship,
			   @SpareId,
			   @DefectNo,
			   @QtyCons,
			   @QtyRob,''A''
		)
	END
	ELSE
	BEGIN
		  UPDATE VSL_DefectSpareDetails
			  SET QtyCons = @QtyCons,
				  QtyRob = @QtyRob
		  WHERE VesselCode= @VesselCode AND ComponentId = @ComponentId AND Office_Ship = @Office_Ship AND SpareId = @SpareId AND DefectNo = @DefectNo
	END

	UPDATE 	VSL_DefectDetailsMaster set Updated=1,UpdatedOn=getdate() where VESSELCODE=@VesselCode AND DEFECTNO=@DefectNo
END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertSpares_Execute]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertSpares_Execute]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
		  
CREATE PROC [dbo].[sp_InsertSpares_Execute]
(
	@VesselCode CHAR(3),
	@ComponentId BIGINT,
    @Office_Ship CHAR(1),
    @SpareId BIGINT,
    @HistoryId BIGINT,
    @QtyCons float,
    @QtyRob float 
)
AS
BEGIN
	IF(NOT EXISTS(SELECT * FROM VSL_VesselJobUpdateHistorySpareDetails WHERE VesselCode= @VesselCode AND ComponentId = @ComponentId AND Office_Ship = @Office_Ship AND SpareId = @SpareId AND HistoryId = @HistoryId))
	BEGIN
		INSERT INTO VSL_VesselJobUpdateHistorySpareDetails
		(
			   VesselCode,
			   ComponentId,             
			   Office_Ship,
			   SpareId,
			   HistoryId,
			   QtyCons,
			   QtyRob,
				Status
	           
		)
		 VALUES
		(
			   @VesselCode,
			   @ComponentId,             
			   @Office_Ship,
			   @SpareId,
			   @HistoryId,
			   @QtyCons,
			   @QtyRob,''A''
		)
	END	
	ELSE
	BEGIN
		UPDATE VSL_VesselJobUpdateHistorySpareDetails	
		SET QtyCons = @QtyCons,
			QtyRob = @QtyRob	
		WHERE VesselCode= @VesselCode AND ComponentId = @ComponentId AND Office_Ship = @Office_Ship AND SpareId = @SpareId AND HistoryId = @HistoryId
	END

	UPDATE VSL_VesselJobUpdateHistory set Updated=1,UpdatedOn=getdate() where VESSELCODE=@VesselCode AND HistoryId=@HistoryId	

END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertSparesInventory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertSparesInventory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROC [dbo].[sp_InsertSparesInventory]
(
	@VesselCode char(3),
	@ComponentId bigint,
	@Office_Ship char(1),
	@SpareId bigint,
	@PkId bigint,
	@RecdDate SmallDateTime,
	@QtyRecd Int,
	@StockLocation Varchar(50)
)
AS
BEGIN
    
    IF @PkId = 0
    BEGIN
		DECLARE @MAXPKID BIGINT
	    
		SELECT @MAXPKID=isnull(MAX(pkid),0)+1 from VSL_StockInventory where VesselCode=@VesselCode
	    
		INSERT INTO VSL_StockInventory
		(
		   VesselCode,
		   ComponentId,
		   Office_Ship,
		   SpareId,
		   PkId,
		   RecdDate,
		   QtyRecd,
		   StockLocation, 
		   Updated,
		   UpdatedOn,
		   Status           
		)
		 VALUES
		(
		   @VesselCode,
		   @ComponentId,
		   @Office_Ship,
		   @SpareId,
		   @MAXPKID,
		   @RecdDate,
		   @QtyRecd,
		   @StockLocation,
		   1,
		   getdate(),''A''
		)
	END
	ELSE
	BEGIN
	     
	     UPDATE VSL_StockInventory
	        SET RecdDate = @RecdDate,
			    QtyRecd = @QtyRecd,
			    StockLocation = @StockLocation, 
			    Updated = 1,
			    UpdatedOn = getdate()
			WHERE PkId = @PkId
	END
END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUnPlannedJob]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUnPlannedJob]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_InsertUnPlannedJob]
(
	@VesselCode char(3),
	@UPId bigint,
	@ComponentId Bigint,
	@ShortDescr varchar(500),
	@LongDescr varchar(2000),
	@DeptId Int,
	@AssignedTo Int,
	@DueDate smalldatetime,	
	@UpdatedBy int
)
AS
BEGIN
	
	IF(@UPId <= 0)
	BEGIN	
		SELECT @UPId=ISNULL(MAX(UPID),0)+1 FROM VSL_UnPlannedJobs WHERE VESSELCODE=@VesselCode
		INSERT INTO VSL_UnPlannedJobs(VESSELCODE,UPID,COMPONENTID,SHORTDESCR,LONGDESCR,DEPTID,ASSIGNEDTO,DUEDATE,STATUS,UPDATEDBY,[UPDATED],UPDATEDON)
		VALUES(@VesselCode,@UPId,@ComponentId,@ShortDescr,@LongDescr,@DeptId,@AssignedTo,@DueDate,''A'',@UpdatedBy,1,GETDATE()) 
	END
	ELSE
	BEGIN
		UPDATE VSL_UnPlannedJobs
		SET SHORTDESCR=@ShortDescr,
			LONGDESCR=@LongDescr,
			DEPTID=@DEPTID,
			ASSIGNEDTO=@ASSIGNEDTO,
			DUEDATE=@DUEDATE,
			UpdatedBy=@UpdatedBy,
			UpdatedOn=getdate()
		WHERE VESSELCODE=@VESSELCODE AND UPID=@UPID
	END
	SELECT @UPID
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUPAttachment]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUPAttachment]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[sp_InsertUPAttachment]
(
	@VesselCode char(3),
	@UPId bigint,
	@AttachmentText Varchar(500),
	@FileName Varchar(50)
)
AS
BEGIN
		declare @TableId bigint
		select @TableId=isnull(max(tableid),0)+1 from VSL_UnPlannedJobs_Attachments
		INSERT INTO VSL_UnPlannedJobs_Attachments
		(
		   VesselCode,
		   TableId,
		   UPId,
		   AttachmentText,
		   [FileName],
		   Status	       
		)
		 VALUES
		(
		   @VesselCode,
		   @TableId,
		   @UPId,
		   @AttachmentText,
		   @FileName,''A''
		)
		UPDATE VSL_UnPlannedJobs SET UPDATED=1,UPDATEDON=GETDATE() WHERE VESSELCODE=@VESSELCODE AND UPId=@UPId
END






' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdate_Ship_MaintenanceKPI]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdate_Ship_MaintenanceKPI]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



CREATE PROC [dbo].[sp_InsertUpdate_Ship_MaintenanceKPI]
(
	@VesselCode char(3),
	@Year int,
	@Month int,
	@TotalSystemJobs int,
	@DueJobs int,
	@OD1Week int,
	@OD2Week int,
	@ODMorethan2week int,
	@OutStandingJobs int
	
)
AS
BEGIN

DECLARE @ODJobs int
SET @ODJobs = (@OD1Week + @OD2Week + @ODMorethan2week)

IF NOT EXISTS(SELECT * FROM Ship_MaintenanceKPI WHERE VesselCode = @VesselCode AND [Year]=@Year AND [Month]=@Month )
BEGIN
     INSERT INTO Ship_MaintenanceKPI 
     (
       VesselCode,
       [Year],
       [Month],
       TotalSystemJobs,
       DueJobs,
       OverDueJobs,
       OD1Week,
       OD2Week,
       ODMorethan2week,
       OutStandingJobs
     )
     VALUES
     (
        @VesselCode,
		@Year,
		@Month,
		@TotalSystemJobs,
		@DueJobs,
		@ODJobs,
		@OD1Week,
		@OD2Week,
		@ODMorethan2week,
		@OutStandingJobs
     )


END
ELSE
BEGIN 
      UPDATE Ship_MaintenanceKPI
        SET  TotalSystemJobs = @TotalSystemJobs,
             DueJobs = @DueJobs,
             OverDueJobs = @ODJobs,
             OD1Week = @OD1Week,
             OD2Week = @OD2Week,
             ODMorethan2week = @ODMorethan2week,
             OutStandingJobs = @OutStandingJobs
	 WHERE VesselCode = @VesselCode AND [Year]=@Year  AND [Month]=@Month
  
END
		
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateComponents]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateComponents]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
				  
CREATE PROC [dbo].[sp_InsertUpdateComponents]
(
	@ComponentCode char(12),
	@SelectedCompCode Char(12),
	@ComponentName Varchar(50),
	@Descr Varchar(500),
	@ClassEquip Bit,
	@CriticalEquip Bit,
	@Inactive Bit,
	@Mode CHAR(1),
	@CriticalType Char(1)
)
AS
BEGIN
IF(@Mode = ''A'')
BEGIN
    DECLARE @ComponentId INT
    SELECT @ComponentId = ISNULL(MAX(ComponentId),0)+1 FROM ComponentMaster
	INSERT INTO COMPONENTMASTER
    (
            ComponentId
           ,ComponentCode
           ,ComponentName
           ,Descr           
           ,ClassEquip
           ,CriticalEquip
		   ,Inactive
		   ,CriticalType
	)
     VALUES
	(
	       @ComponentId,
           @ComponentCode ,
           @ComponentName ,
           @Descr,          
           @ClassEquip,
           @CriticalEquip,
		   @Inactive,
		   @CriticalType
	)	
END
ELSE
BEGIN
    DECLARE @PreInactiveState Bit
    SELECT @PreInactiveState= Inactive FROM ComponentMaster WHERE LTRIM(RTRIM(ComponentCode))=LTRIM(RTRIM(@ComponentCode))
	
	IF(@ComponentCode = @SelectedCompCode)
	BEGIN
		UPDATE ComponentMaster   
		SET 
		ComponentName = @ComponentName,       
		Descr = @Descr,    
		ClassEquip = @ClassEquip,
		CriticalEquip = @CriticalEquip,
		Inactive = @Inactive,
		CriticalType=@CriticalType
		WHERE LTRIM(RTRIM(ComponentCode))=LTRIM(RTRIM(@ComponentCode))
	END
	ELSE
	BEGIN
		UPDATE ComponentMaster   
		SET
		ComponentCode = @ComponentCode, 
		ComponentName = @ComponentName,       
		Descr = @Descr,    
		ClassEquip = @ClassEquip,
		CriticalEquip = @CriticalEquip,
		Inactive = @Inactive,   
		CriticalType=@CriticalType
		WHERE LTRIM(RTRIM(ComponentCode))=LTRIM(RTRIM(@ComponentCode))
		
		UPDATE ComponentMaster   
		SET
		ComponentCode = RTRIM(LTRIM(@ComponentCode)) + RTRIM(LTRIM(RIGHT(RTRIM(LTRIM(ComponentCode)),LEN(ComponentCode)-len(@SelectedCompCode))))
		WHERE LEFT(ComponentCode,len(@SelectedCompCode))= RTRIM(LTRIM(@SelectedCompCode))
	END
        
    IF (LTRIM(RTRIM(LEN(@ComponentCode))) <> 9)
    BEGIN
    IF(@PreInactiveState <> @Inactive)
    BEGIN        
        UPDATE ComponentMaster   
		SET 	 
		Inactive = @Inactive    
		WHERE LEFT(ComponentCode,LTRIM(RTRIM(LEN(@ComponentCode))))= LTRIM(RTRIM(@ComponentCode))
    END
    END
    
    IF(@CriticalEquip = 1)
	BEGIN
	    UPDATE ComponentMaster   
		SET CriticalEquip = @CriticalEquip,CriticalType=@CriticalType
		WHERE LEN(ComponentCode) > LTRIM(RTRIM(LEN(@SelectedCompCode))) AND 
		LEFT(ComponentCode,LTRIM(RTRIM(LEN(@SelectedCompCode))))= LTRIM(RTRIM(@SelectedCompCode))
	END
	------------- FOR Applying Flag
	IF Exists(SELECT * FROM VSL_ComponentMasterForVessel WHERE ComponentId IN (SELECT ComponentId FROM ComponentMaster WHERE LTRIM(RTRIM(ComponentCode)) = LTRIM(RTRIM(@ComponentCode))))
	BEGIN
		UPDATE VSL_ComponentMasterForVessel   
		SET Updated = 1,
		UpdatedOn = getdate()
		WHERE ComponentId IN (SELECT ComponentId FROM ComponentMaster WHERE LTRIM(RTRIM(ComponentCode)) = LTRIM(RTRIM(@ComponentCode)) )
	END
END				
END









' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateComponentsJobMapping_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateComponentsJobMapping_Attachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE Proc [dbo].[sp_InsertUpdateComponentsJobMapping_Attachments]
(
	  @CompJobId BIGINT
      ,@Descr VARCHAR(500)
      ,@DocumentType VARCHAR(500)
)
AS
BEGIN
    DECLARE @TableId BIGINT
    SELECT @TableId =ISNULL(MAX(TableId),0)+1 FROM dbo.ComponentsJobMapping_Attachments

	INSERT INTO ComponentsJobMapping_Attachments(TableId ,CompJobId ,Descr ,DocumentType,Status )
	VALUES(@TableId ,@CompJobId ,@Descr ,@DocumentType,''A'' )

	 UPDATE VSL_VesselComponentJobMaster
		SET Updated = 1,
		UpdatedOn = getdate()
		WHERE CompJobId = @CompJobId

	SELECT @TableId 

END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateCriticalShutdownExtension]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateCriticalShutdownExtension]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROC [dbo].[sp_InsertUpdateCriticalShutdownExtension]
(
	@VesselCode CHAR(3),
    @ExtensionId BigInt,
	@ShutdownId BigInt,
    @Ext_ShutDownTotalHrs INT,
    @Ext_FromDateTime SMALLDATETIME,
    @Ext_ToDateTime SMALLDATETIME
)
AS 
BEGIN

IF (@ExtensionId <= 0)
 BEGIN
 
  SELECT @ExtensionId = ISNULL(MAX(ExtensionId),0)+1 FROM VSL_CriticalShutdownExtensions WHERE VesselCode = @VesselCode
 
  INSERT INTO [VSL_CriticalShutdownExtensions]
           (
            ExtensionId,
            VesselCode,
			ShutdownId,
			Ext_ShutDownTotalHrs,
			Ext_FromDateTime,
			Ext_ToDateTime,
			Updated,
			UpdatedOn
			)
           
     VALUES
           (
            @ExtensionId,
            @VesselCode,
			@ShutdownId,
			@Ext_ShutDownTotalHrs,
			@Ext_FromDateTime,
			@Ext_ToDateTime, 
			1,
			GETDATE())
   
   END
   ELSE
   BEGIN
        UPDATE VSL_CriticalShutdownExtensions
           SET  Ext_ShutDownTotalHrs = @Ext_ShutDownTotalHrs,
				Ext_FromDateTime = @Ext_FromDateTime,
				Ext_ToDateTime = @Ext_ToDateTime,
			    Updated = 1,
			    UpdatedOn = getdate()
		  WHERE VesselCode = @VesselCode AND ExtensionId = @ExtensionId 
   
   END
   
   

		
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateCriticalShutdownRequest]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateCriticalShutdownRequest]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROC [dbo].[sp_InsertUpdateCriticalShutdownRequest]
(
	@ShutdownId BigInt,
	@VesselCode char(3),
	@ComponentId BigInt,
	@Occasion SmallInt,
	@DefectNo VARCHAR(15),
	@FormNo VARCHAR(50),    
    @Version VARCHAR(50),
    @RequestDate SMALLDATETIME,
    @MasterCEName VARCHAR(50),
    @Job_Defect VARCHAR(5000),
    @Pl_ShutDownTotalHrs INT,
    @Pl_FromDateTime SMALLDATETIME,
    @Pl_ToDateTime SMALLDATETIME,    
    @IssuedBy INT
)
AS 
BEGIN

IF (@ShutdownId <= 0)
 BEGIN
 
  SELECT @ShutdownId = ISNULL(MAX(ShutdownId),0)+1 FROM VSL_CriticalEquipShutdownRequest WHERE VesselCode = @VesselCode
 
  INSERT INTO [VSL_CriticalEquipShutdownRequest]
           (ShutdownId,
			VesselCode,
			ComponentId,
			Occasion,
			DefectNo,
			FormNo,    
			[Version],
			RequestDate,
			MasterCEName,
			Job_Defect,
			Pl_ShutDownTotalHrs,
			Pl_FromDateTime,
			Pl_ToDateTime,
			IssuedBy,
			IssueDate,
			Updated,
			UpdatedOn
			)
           
     VALUES
           (@ShutdownId,
			@VesselCode,
			@ComponentId,
			@Occasion,
			@DefectNo,
			@FormNo,    
			@Version,
			@RequestDate,
			@MasterCEName,
			@Job_Defect,
			@Pl_ShutDownTotalHrs,
			@Pl_FromDateTime,
			@Pl_ToDateTime,
			@IssuedBy,
			GETDATE(),
			1,
			GETDATE())
   
   END
   ELSE
   BEGIN
        UPDATE VSL_CriticalEquipShutdownRequest
           SET
               Occasion = @Occasion,
               DefectNo = @DefectNo,
               RequestDate =  @RequestDate,
			   MasterCEName = @MasterCEName,
			   Job_Defect = @Job_Defect ,
			   Pl_ShutDownTotalHrs = @Pl_ShutDownTotalHrs,
			   Pl_FromDateTime = @Pl_FromDateTime,
			   Pl_ToDateTime = @Pl_ToDateTime,
			   Updated = 1,
			   UpdatedOn = getdate()
		  WHERE VesselCode = @VesselCode AND ShutdownId = @ShutdownId 
   
   END
   
   SELECT @ShutdownId
		
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateJobPlanning]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateJobPlanning]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
				  			  	
CREATE Proc [dbo].[sp_InsertUpdateJobPlanning]
(
@VesselCode CHAR(3),
@ComponentId INT,
@CompjobId INT,
@AssignedTo INT,
@Status INT,
@NextDueDate SMALLDATETIME,
@NextDueHours INT,
@LastDone SMALLDATETIME,
@LastHour INT,
@PlanDate SMALLDATETIME

)
AS
BEGIN
	  
	  IF NOT EXISTS (SELECT * FROM VSL_PlanMaster WHERE VesselCode = @VesselCode  AND ComponentId=@ComponentId AND CompjobId=@CompjobId)
	  BEGIN
	  	DECLARE @LastRunningHourDate SMALLDATETIME
	  	DECLARE @LastRunningHour INT
	  	DECLARE @jobId INT
	    
	    SELECT TOP 1 @LastRunningHourDate = StartDate, @LastRunningHour=StartupHour FROM VSL_VesselRunningHourMaster WHERE VesselCode= @VesselCode AND ComponentId = @ComponentId ORDER BY StartDate DESC
	    
	    SELECT @jobId = JobId FROM VSL_VesselComponentJobMaster WHERE VesselCode = @VesselCode  AND ComponentId=@ComponentId AND CompjobId=@CompjobId
	    
	    INSERT INTO VSL_PlanMaster (VesselCode,CompJobId,ComponentId,jobId,AssignedTo,Status,PlanDate,NextDueDate,NextDueHours,LastRunningHourDate,LastRunningHour,DoneDate,DoneHour,Updated,UpdatedOn) 
		VALUES (@VesselCode,@CompjobId,@ComponentId,@jobId,@AssignedTo,@Status,@PlanDate,@NextDueDate,@NextDueHours,@LastRunningHourDate,@LastRunningHour,@LastDone,@LastHour,1,getdate())
	  
	  END
	  ELSE
	  BEGIN
		UPDATE VSL_PlanMaster
	    SET AssignedTo = @AssignedTo,
		PlanDate = @PlanDate,
		Status = 1,
		Updated = 1,
		UpdatedOn = getdate()
			          
	    WHERE VesselCode=@VesselCode  AND ComponentId=@ComponentId AND CompjobId=@CompjobId
	  END
	  
	  
END






' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateJobTypes]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateJobTypes]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

			      
CREATE PROC [dbo].[sp_InsertUpdateJobTypes]
(
    @JobId int,
	@JobCode Varchar(10),
	@JobName Varchar(100)		
)
AS
BEGIN
IF(@JobId = '''') -- Insert JobType
BEGIN
    SELECT @JobId = ISNULL(MAX(JobId),0)+1	FROM JobMaster
	INSERT INTO JobMaster
    (
            JobId 
           ,JobCode          
           ,JobName                 
	)
     VALUES
	(
	       @JobId,
           @JobCode,           
           @JobName           
	)	
END
ELSE
BEGIN
	UPDATE JobMaster   
    SET
    JobCode = @JobCode,    
	JobName = @JobName	
    WHERE JobId = @JobId 
    
    UPDATE VSL_VesselComponentJobMaster
    SET Updated = 1,
        UpdatedOn = getdate()
    WHERE JobId =  @JobId
     
END				
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateMailSettings]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateMailSettings]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROC [dbo].[sp_InsertUpdateMailSettings]

(

    @Id int,
	@SenderAddress Varchar(50),
	@SenderUserName Varchar(50),
	@senderPass Varchar(50),
	@MailClient Varchar(50),
	@Port Varchar(50),
	@Mail_Encryption Varchar(10),
	@PacketMode char(1)
)

AS

BEGIN

IF NOT EXISTS(SELECT * FROM [MailSettings])

BEGIN

	INSERT INTO MailSettings

    (

        Id,
		SenderAddress,
		SenderUserName,

		senderPass,

		MailClient,

		Port, 

		Mail_Encryption,
		PacketMode

	)

     VALUES

	(

	    @Id,
		@SenderAddress,

		@SenderUserName,

		@senderPass,

		@MailClient,

		@Port,

		@Mail_Encryption,
		@PacketMode

	)	

END

ELSE

BEGIN

	UPDATE MailSettings   

    SET

		SenderAddress = @SenderAddress,
		SenderUserName = @SenderUserName,
		senderPass = @senderPass,
		MailClient = @MailClient,
		Port = @Port,
		Mail_Encryption=@Mail_Encryption,
		PacketMode=@PacketMode

END	



END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateMaintenanceKPI]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateMaintenanceKPI]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

-- EXEC [sp_MonthwiseMaintenanceKPI] ''LIG'', 2012,12

CREATE PROC [dbo].[sp_InsertUpdateMaintenanceKPI]
(
	@VesselCode char(3),
	@Year int,
	@Month int,
	@DueJobs int,
	@OverDueJobs int,
	@Postponed_Other int,
	@Postponed_Docking int,
	@TotalJobs int,
	@JobsDone int,
	@TotalSystemJobs int,
	@PublishedBy int
)
AS
BEGIN

IF NOT EXISTS(SELECT * FROM VSL_MaintenanceKPI WHERE VesselCode = @VesselCode AND [Year]=@Year AND [Month]=@Month )
BEGIN
     INSERT INTO VSL_MaintenanceKPI 
     (
       VesselCode,
       [Year],
       [Month],
       DueJobs,
       OverDueJobs,
       Postponed_Other,
       Postponed_Docking,
       TotalJobs,
       JobsDone,
       TotalSystemJobs,
       PublishedBy,
       PublishedOn
     )
     VALUES
     (
        @VesselCode,
		@Year,
		@Month,
		@DueJobs,
		@OverDueJobs,
		@Postponed_Other,
		@Postponed_Docking,
		@TotalJobs,
		@JobsDone,
		@TotalSystemJobs,
		@PublishedBy,
		getdate()
     )


END
ELSE
BEGIN 
      UPDATE VSL_MaintenanceKPI
        SET DueJobs = @DueJobs,
		    OverDueJobs = @OverDueJobs,
		    Postponed_Other =@Postponed_Other,
		    Postponed_Docking = @Postponed_Docking,
		    TotalJobs = @TotalJobs,
		    JobsDone = @JobsDone,
		    TotalSystemJobs = @TotalSystemJobs,
		    PublishedBy=@PublishedBy,
		    PublishedOn = getdate()
	 WHERE VesselCode = @VesselCode AND [Year]=@Year  AND [Month]=@Month
  
END
		
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateMonthwiseMaintenanceKPI]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateMonthwiseMaintenanceKPI]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- EXEC [sp_InsertUpdateMonthwiseMaintenanceKPI] 2014,9,1  
-- SELECT * FROM VSL_MaintenanceKPI WHERE  [Year]=YEAR(GETDATE()) AND [Month]=MONTH(GETDATE()) ORDER BY VESSELCODE,MONTH,YEAR  
  
CREATE PROC [dbo].[sp_InsertUpdateMonthwiseMaintenanceKPI]  
AS  
BEGIN  
--  
DECLARE @SHIPID CHAR(3)  
DECLARE @YEAR INT  
DECLARE @MONTH INT  
DECLARE @DAY INT  
  
DECLARE @LASTYEAR INT  
DECLARE @LASTMONTH INT  
  
DECLARE @TODAY SMALLDATETIME  
  
DECLARE @ROWUPDATED CHAR(1)   
SET @ROWUPDATED=''N''  
  
SET @TODAY=GETDATE()  
  
SET @YEAR=YEAR(@TODAY)  
SET @MONTH=MONTH(@TODAY)  
SET @DAY=DAY(@TODAY)  
  
IF(@MONTH=1)  
BEGIN  
 SET @LASTMONTH=12  
 SET @LASTYEAR=@YEAR-1  
END  
ELSE  
BEGIN  
 SET @LASTMONTH=@MONTH-1  
 SET @LASTYEAR=@YEAR  
END  
  
DECLARE CS_VSL CURSOR FOR SELECT VESSELCODE from dbo.Vessel WHERE ISEXPORTED=1 order by VESSELCODE  
OPEN CS_VSL  
FETCH NEXT FROM CS_VSL INTO @SHIPID  
WHILE(@@FETCH_STATUS=0)  
BEGIN  
 SET @ROWUPDATED=''N''  
-------------------- FOR EACH VESSEL   
 IF EXISTS(SELECT * FROM VSL_MaintenanceKPI WHERE VesselCode = @SHIPID AND [Year]=@YEAR  AND [Month]=@MONTH AND PublishedOn IS NOT NULL)  
 BEGIN  
  SET @ROWUPDATED=''Y''  
 END  
  
PRINT @ROWUPDATED  
  
 IF( @DAY<=4 OR @ROWUPDATED=''N'')  
 BEGIN  
  -----------------------------  
  IF NOT EXISTS(SELECT * FROM VSL_MaintenanceKPI WHERE VesselCode = @SHIPID AND [Year]=@YEAR  AND [Month]=@MONTH)  
  BEGIN  
    INSERT INTO VSL_MaintenanceKPI(VesselCode,[Year],[Month])   
    VALUES  
    (  
    @SHIPID,  
    @YEAR,  
    @MONTH  
    )  
  END  
  -----------------------------  
  UPDATE VSL_MaintenanceKPI  
  SET   
  TotalSystemJobs = (SELECT COUNT(*) FROM VSL_VesselComponentJobMaster WHERE VesselCode = @shipid AND STATUS=''A''),   
  DueJobs = DBO.getDueJobsForMonth(@shipid,@month,@year),  
  --OverDueJobs = (SELECT COUNT(*) FROM VSL_VesselComponentJobMaster_Updates WHERE VesselCode = @shipid AND ( (year(NextDueDate) < @year) OR ( year(NextDueDate)=@year AND month(NextDueDate) < @month ))),  
	OverDueJobs = (
SELECT COUNT(VCJM.CompJobId) FROM VSL_VesselComponentJobMaster VCJM 
    INNER JOIN VSL_VesselComponentJobMaster_Updates VCJMU ON VCJM.VesselCode = VCJMU.VesselCode AND VCJM.ComponentId = VCJMU.ComponentId AND VCJM.CompJobId = VCJMU.CompJobId AND VCJM.Status = ''A'' 
    INNER JOIN VSL_ComponentMasterForVessel VCM ON VCJM.VesselCode = VCM.VesselCode AND VCJM.ComponentId = VCM.ComponentId AND VCM.Status = ''A'' 
    INNER JOIN ComponentsJobMapping CJM ON VCJM.CompjobId=CJM.CompjobId 
    INNER JOIN ComponentMaster CM ON CM.ComponentId = VCJM.ComponentId
    INNER JOIN JobMaster JM  ON JM.JobId = VCJM.JobId 
    INNER JOIN JobIntervalMaster JIM ON JIM.IntervalId = VCJM.IntervalId 
    LEFT JOIN VSL_PlanMaster PM ON PM.VesselCode = VCJM.VesselCode AND PM.ComponentId = VCJM.ComponentId AND PM.CompJobId = VCJM.CompJobId 
    LEFT JOIN Rank RM ON RM.RankId = PM.AssignedTo 
    WHERE VCJM.VesselCode=@shipid AND (VCJMU.NextDueDate < CONVERT(SMALLDATETIME,CONVERT(VARCHAR,GETDATE())) OR VCJMU.NextDueDate IS NULL)
),

--  OD1Week = (SELECT COUNT(*) FROM VSL_VesselComponentJobMaster_Updates WHERE VesselCode = @shipid AND ( (year(NextDueDate) < @year) OR (year(NextDueDate)=@year AND month(NextDueDate) < @month) )  
--       and (datediff(day,nextduedate,cast( str(@year) + ''-''  + str(@month) + ''-15'' as datetime)) >= 7)   
--       and (datediff(day,nextduedate,cast( str(@year) + ''-''  + str(@month) + ''-15'' as datetime)) < 14) ) ,  
--  OD2Week = (SELECT COUNT(*) FROM VSL_VesselComponentJobMaster_Updates WHERE VesselCode = @shipid AND ( (year(NextDueDate) < @year) OR ( year(NextDueDate)=@year AND month(NextDueDate) < @month) )  
--       and (datediff(day,nextduedate,cast( str(@year) + ''-''  + str(@month) + ''-15'' as datetime)) >= 14)   
--       and (datediff(day,nextduedate,cast( str(@year) + ''-''  + str(@month) + ''-15'' as datetime)) < 21) ),  
--  ODMorethan2week = (SELECT COUNT(*) FROM VSL_VesselComponentJobMaster_Updates WHERE VesselCode = @shipid AND ( (year(NextDueDate) < @year) OR (year(NextDueDate)=@year AND month(NextDueDate) < @month ) )  
--       and (datediff(day,nextduedate,cast( str(@year) + ''-''  + str(@month) + ''-15'' as datetime)) >= 21) ) ,  
  OutStandingJobs=0,  
  PublishedBy=0,  
  PublishedOn = getdate()  
  WHERE VESSELCODE=@SHIPID AND [Year]=@YEAR  AND [Month]=@MONTH  
  -------------------------  
  UPDATE VSL_MaintenanceKPI  
  SET   
  OutStandingJobs=(


SELECT COUNT(VCJM.CompJobId) FROM VSL_VesselComponentJobMaster VCJM 
    INNER JOIN VSL_VesselComponentJobMaster_Updates VCJMU ON VCJM.VesselCode = VCJMU.VesselCode AND VCJM.ComponentId = VCJMU.ComponentId AND VCJM.CompJobId = VCJMU.CompJobId AND VCJM.Status = ''A'' 
    INNER JOIN VSL_ComponentMasterForVessel VCM ON VCJM.VesselCode = VCM.VesselCode AND VCJM.ComponentId = VCM.ComponentId AND VCM.Status = ''A'' 
    INNER JOIN ComponentsJobMapping CJM ON VCJM.CompjobId=CJM.CompjobId 
    INNER JOIN ComponentMaster CM ON CM.ComponentId = VCJM.ComponentId
    INNER JOIN JobMaster JM  ON JM.JobId = VCJM.JobId 
    INNER JOIN JobIntervalMaster JIM ON JIM.IntervalId = VCJM.IntervalId 
    LEFT JOIN VSL_PlanMaster PM ON PM.VesselCode = VCJM.VesselCode AND PM.ComponentId = VCJM.ComponentId AND PM.CompJobId = VCJM.CompJobId 
    LEFT JOIN Rank RM ON RM.RankId = PM.AssignedTo 
    WHERE VCJM.VesselCode=@shipid AND (VCJMU.NextDueDate < CONVERT(SMALLDATETIME,CONVERT(VARCHAR,GETDATE())) OR VCJMU.NextDueDate IS NULL)

)  
  WHERE VESSELCODE=@SHIPID AND [Year]=@LASTYEAR  AND [Month]=@LASTMONTH  
  -------------------------  
 END  
--------------------  
FETCH NEXT FROM CS_VSL INTO @SHIPID  
END  
CLOSE CS_VSL  
DEALLOCATE CS_VSL  
  
    
  
END  
  
  ' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateRunningHour]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateRunningHour]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROC [dbo].[sp_InsertUpdateRunningHour]
(
	@VesselCode CHAR(3),
	@ComponentId INT,	
	@StartupHour INT,
	@AvgRunningHrPerDay INT,
	@StartDate SMALLDATETIME,
	@UpdatedBy INT
)
AS
BEGIN
IF(NOT EXISTS(SELECT ComponentId FROM VesselRunningHourMaster WHERE VesselCode= @VesselCode AND ComponentId = @ComponentId))
BEGIN
    
	INSERT INTO VesselRunningHourMaster
    (
            VesselCode
           ,ComponentId
           ,StartupHour
           ,AvgRunningHrPerDay
           ,StartDate
           ,UpdatedBy
           ,UpdatedOn
	)
     VALUES
	(
	       @VesselCode,
           @ComponentId, 
           @StartupHour,          
           @AvgRunningHrPerDay,
           @StartDate,
           @UpdatedBy,
           getdate()
	)	
END
ELSE
BEGIN
       
	UPDATE VesselRunningHourMaster   
    SET 
	StartupHour = @StartupHour,       
    AvgRunningHrPerDay = @AvgRunningHrPerDay,    
    StartDate = @StartDate,
    UpdatedBy = @UpdatedBy,
    UpdatedOn = getdate() 
    WHERE VesselCode= @VesselCode  AND  ComponentId =  @ComponentId
    
    END
				
END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateSpares]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateSpares]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROC [dbo].[sp_InsertUpdateSpares]
(
	@VesselCode char(3),
	@ComponentId bigint,
	@Office_Ship char(1),
	@SpareId bigint, 
	@SpareName Varchar(50),
	@Maker Varchar(50),
	@MakerType Varchar(50),
	@PartNo Varchar(50),
	@AltPartNo Varchar(50),
	@MinQty Int,
	@MaxQty Int,
	@StatutoryQty Int,
	@Weight Float,
	@Specification Varchar(500),
	@DrawingNo Varchar(50),
	@Attachment Varchar(50)
)
AS
BEGIN
IF(@SpareId = '''')
BEGIN
    SELECT @SpareId = ISNULL(MAX(SpareId),0)+1 FROM VesselSpareMaster WHERE VesselCode = @VesselCode AND ComponentId = @ComponentId AND Office_Ship = @Office_Ship
    
	INSERT INTO VesselSpareMaster
    (
            VesselCode
           ,ComponentId
           ,Office_Ship
           ,SpareId 
           ,SpareName
           ,Maker
           ,MakerType
           ,PartNo
           ,AltPartNo
           ,Location
           ,MinQty
           ,MaxQty
           ,StatutoryQty
           ,Weight
           ,Stock
           ,Specification
           ,DrawingNo
           ,Attachment          
	)
     VALUES
	(
	   @VesselCode,
	   @ComponentId,
	   @Office_Ship,
	   @SpareId,
	   @SpareName,
	   @Maker,
           @MakerType ,
           @PartNo ,
           @AltPartNo,
           '''',
           @MinQty,
           @MaxQty,
           @StatutoryQty,
           @Weight,
           0,
           @Specification,
           @DrawingNo,
           @Attachment
	)
	
	SELECT @SpareId As SpareId;	
	
END
ELSE
BEGIN
	UPDATE VesselSpareMaster   
    SET
    SpareName = @SpareName, 
	Maker = @Maker,       
    MakerType = @MakerType,    
    PartNo = @PartNo,
    AltPartNo = @AltPartNo,
    MinQty = @MinQty,
    MaxQty = @MaxQty,
    StatutoryQty = @StatutoryQty,
    Weight = @Weight,
    Specification = @Specification,
    DrawingNo = @DrawingNo    
    WHERE VesselCode= @VesselCode AND ComponentId = @ComponentId AND Office_Ship = @Office_Ship AND SpareId = @SpareId
END				
END



' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateVesselComponentJobMaster_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateVesselComponentJobMaster_Attachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

--select * from VesselComponentJobMaster_Attachments

CREATE Proc [dbo].[sp_InsertUpdateVesselComponentJobMaster_Attachments]
(
	   @VesselCode varchar(3)
	  ,@CompJobId BIGINT
      ,@Descr VARCHAR(500)
      ,@DocumentType VARCHAR(500)
)
AS
BEGIN
    DECLARE @TableId BIGINT
    SELECT @TableId =ISNULL(MAX(TableId),0)+1 FROM dbo.VesselComponentJobMaster_Attachments where VesselCode=@VesselCode 

	INSERT INTO VesselComponentJobMaster_Attachments(VesselCode ,TableId ,CompJobId ,Descr ,DocumentType)
	VALUES(@VesselCode ,@TableId ,@CompJobId ,@Descr ,@DocumentType)

	SELECT @TableId 

END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUpdateVSL_VesselComponentJobMaster_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUpdateVSL_VesselComponentJobMaster_Attachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
--select * from VSL_VesselComponentJobMaster_Attachments

CREATE Proc [dbo].[sp_InsertUpdateVSL_VesselComponentJobMaster_Attachments]
(
	   @VesselCode varchar(3)
	  ,@CompJobId BIGINT
      ,@Descr VARCHAR(500)
      ,@DocumentType VARCHAR(500)
)
AS
BEGIN
    DECLARE @TableId BIGINT
    SELECT @TableId =ISNULL(MAX(TableId),0)+1 FROM dbo.VSL_VesselComponentJobMaster_Attachments where VesselCode=@VesselCode 

	INSERT INTO VSL_VesselComponentJobMaster_Attachments(VesselCode ,TableId ,CompJobId ,Descr ,DocumentType,Status )
	VALUES(@VesselCode ,@TableId ,@CompJobId ,@Descr ,@DocumentType,''A'' )

	UPDATE VSL_VesselComponentJobMaster 
         SET Updated  = 1,
         UpdatedOn = getdate() WHERE VesselCode=@VesselCode AND CompJobId = @CompjobId

	SELECT @TableId

END
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertUPPlanJobsSpares]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertUPPlanJobsSpares]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE proc [dbo].[sp_InsertUPPlanJobsSpares]
(
@VesselCode char(3),
@ComponentId bigint,
@Office_Ship char(1),
@SpareId bigint,
@UPId bigint,
@QtyCons float,
@QtyRob float
)
as 
begin
if exists(select * from dbo.VSL_UnPlannedJobs_SpareDetails where vesselcode=@VesselCode and ComponentId=@ComponentId and Office_Ship=@Office_Ship and SpareId=@SpareId and UPId=@UPId)
begin
	select -1;	
end
else
begin
	insert into dbo.VSL_UnPlannedJobs_SpareDetails(VesselCode,ComponentId,Office_Ship,SpareId,UPId,QtyCons,QtyRob)
	values (@VesselCode,@ComponentId,@Office_Ship,@SpareId,@UPId,@QtyCons,@QtyRob)
	
	update dbo.VSL_UnPlannedJobs 
	set updated=1,updatedon=getdate() 
	where vesselcode=@VesselCode and UPId=@UPId

	select 0
end
end	
	


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertVesselComponentsJobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_InsertVesselComponentsJobs]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

				                				  
CREATE Proc [dbo].[sp_InsertVesselComponentsJobs]
(
@VesselCode CHAR(3),
@ComponentCode CHAR(12),
@CompJOBID INT,
@AssignTo INT,
@IntervalId INT,
@Interval FLOAT,
@IsFixed SMALLINT,
@StartDate SMALLDATETIME,
@DescrM VARCHAR(5000),
@IntervalId_H INT,
@Interval_H FLOAT,
@Guidelines VARCHAR(50)
)
AS
BEGIN

      
	  DECLARE @ComponentId INT	
	  DECLARE @JobId INT	
	  
	  SELECT @ComponentId = ComponentId FROM ComponentMaster WHERE ComponentCode = LTRIM(RTRIM(@ComponentCode))
	  SELECT @JobId = JobId FROM dbo.ComponentsJobMapping WHERE CompJOBID = @CompJOBID
	  IF (@StartDate = '''')
	    BEGIN
			INSERT INTO VesselComponentJobMaster(VesselCode,CompJOBID,ComponentId,JobId,AssignTo,IntervalId,Interval,IsFixed,StartDate,DescrM,IntervalId_H,Interval_H,Guidelines)
			VALUES (@VesselCode,@CompJOBID,@ComponentId,@JOBID,@AssignTo,@IntervalId,@Interval,@IsFixed,NULL,@DescrM,@IntervalId_H,@Interval_H,@Guidelines)
		END
	  ELSE
		BEGIN
		  INSERT INTO VesselComponentJobMaster(VesselCode,CompJOBID,ComponentId,JobId,AssignTo,IntervalId,Interval,IsFixed,StartDate,DescrM,IntervalId_H,Interval_H,Guidelines)
		  VALUES (@VesselCode,@CompJOBID,@ComponentId,@JOBID,@AssignTo,@IntervalId,@Interval,@IsFixed,@StartDate,@DescrM,@IntervalId_H,@Interval_H,@Guidelines)
		END
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_MaintenanceKPI]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_MaintenanceKPI]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

-- EXEC [sp_MaintenanceKPI] '''', 2013,1,2
CREATE PROC [dbo].[sp_MaintenanceKPI]
(
	@shipid char(3),
	@year int,
	@month int,
	@month1 int
)
AS
BEGIN

IF(LTRIM(RTRIM(@shipid))='''')
		BEGIN
		     SELECT VesselCode,[Month],Period,DueJobs,OverdueJobs,PostponedOther,PostponedDocking,
			--JobsDone,TotalSystemJobs,Overdue1week,OverDue2week,Overduemore2week,
			(DueJobs+OverdueJobs-PostponedOther-PostponedDocking) AS TotalJobs,
			 OutstandingJobs,
			CASE WHEN DueJobs+OverdueJobs-PostponedOther-PostponedDocking=0 THEN 0
			ELSE (Convert(float,(OutstandingJobs)) * 100)/ Convert(float,(DueJobs+OverdueJobs-PostponedOther-PostponedDocking)) 
			END AS OutstandingPercent
			
--			CASE WHEN TotalSystemJobs=0 THEN 0
--			ELSE (Convert(float,(OutstandingJobs)) * 100)/Convert(float,TotalSystemJobs)
--			END AS KPIPercent

			FROM (
		    
			SELECT (SELECT VM.VesselName FROM Vessel VM WHERE VM.VesselCode = M.VesselCode )AS VesselCode,[Month],datename(month,dateadd(month, [Month] - 1, 0)) AS Period,
			DueJobs,
			OverDueJobs AS OverdueJobs,
	
			PostponedOther =(SELECT COUNT(*) FROM VSL_VesselJobUpdateHistory WHERE VesselCode = M.[VesselCode] AND year(PostPoneDate) = M.[year] AND month(PostPoneDate) = M.[Month] AND ISNULL(PostPoneReason,0) <> 3),
			PostponedDocking =(SELECT COUNT(*) FROM VSL_VesselJobUpdateHistory WHERE VesselCode = M.[VesselCode] AND year(PostPoneDate) = M.[year] AND month(PostPoneDate) = M.[Month] AND ISNULL(PostPoneReason,0) = 3),
			--JobsDone = (SELECT COUNT(*) FROM VSL_VesselJobUpdateHistory WHERE VesselCode = M.[VesselCode] AND year(DoneDate) = M.[year] AND month(DoneDate) = M.[Month] AND  year(LastDueDate) = M.[year] AND month(LastDueDate) = M.[Month] ),
			--TotalSystemJobs
			--,OD1Week AS Overdue1week
			--,OD2Week AS OverDue2week
			--,ODMorethan2week AS Overduemore2week
			OutStandingJobs 
		    
			FROM VSL_MaintenanceKPI M
			WHERE [Year]= @year AND ([Month] BETWEEN @month AND @month1) 
		    
			)a ORDER BY VesselCode
		
		END
	ELSE
	   BEGIN
	        SELECT VesselCode,[Month],Period,DueJobs,OverdueJobs,PostponedOther,PostponedDocking,
			--JobsDone,TotalSystemJobs,Overdue1week,OverDue2week,Overduemore2week,
			(DueJobs+OverdueJobs-PostponedOther-PostponedDocking) AS TotalJobs,
			 OutstandingJobs,
			CASE WHEN DueJobs+OverdueJobs-PostponedOther-PostponedDocking=0 THEN 0
			ELSE (Convert(float,(OutstandingJobs)) * 100)/ Convert(float,(DueJobs+OverdueJobs-PostponedOther-PostponedDocking)) 
			END AS OutstandingPercent
			
--			CASE WHEN TotalSystemJobs=0 THEN 0
--			ELSE (Convert(float,(OutstandingJobs)) * 100)/Convert(float,TotalSystemJobs) 
--			END AS KPIPercent
			FROM (
		    
			SELECT (SELECT VM.VesselName FROM Vessel VM WHERE VM.VesselCode = M.VesselCode )AS VesselCode,[Month],datename(month,dateadd(month, [Month] - 1, 0)) AS Period,
			DueJobs,OverDueJobs AS OverdueJobs,
			PostponedOther =(SELECT COUNT(*) FROM VSL_VesselJobUpdateHistory WHERE VesselCode = M.[VesselCode] AND year(PostPoneDate) = M.[year] AND month(PostPoneDate) = M.[Month] AND ISNULL(PostPoneReason,0) <> 3),
			PostponedDocking =(SELECT COUNT(*) FROM VSL_VesselJobUpdateHistory WHERE VesselCode = M.[VesselCode] AND year(PostPoneDate) = M.[year] AND month(PostPoneDate) = M.[Month] AND ISNULL(PostPoneReason,0) = 3),
			--JobsDone = (SELECT COUNT(*) FROM VSL_VesselJobUpdateHistory WHERE VesselCode = M.[VesselCode] AND year(DoneDate) = M.[year] AND month(DoneDate) = M.[Month] AND  year(LastDueDate) = M.[year] AND month(LastDueDate) = M.[Month]),
			--TotalSystemJobs,
			--OD1Week AS Overdue1week,OD2Week AS OverDue2week,ODMorethan2week AS Overduemore2week,
			OutStandingJobs 
		    
			FROM VSL_MaintenanceKPI M
			WHERE VesselCode = @shipid AND [Year]= @year AND ([Month] BETWEEN @month AND @month1)
		    
			)a ORDER BY VesselCode
		
		END
  
		
END






' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_MOTOR_AUTOCREATE]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_MOTOR_AUTOCREATE]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE Proc [dbo].[sp_MOTOR_AUTOCREATE]
AS
BEGIN
	DECLARE @RYear int
	DECLARE @RMonth Int
	DECLARE @VesselID INT
	DECLARE @SUPTDNAME VARCHAR(50)
	DECLARE @FORDATE SMALLDATETIME	
	-----------------
	SET @FORDATE=GETDATE()
	SET @RYear =YEAR(@FORDATE)
	SET @RMonth =MONTH(@FORDATE)

	-----------------
	DECLARE CS CURSOR FOR SELECT VESSELID,(SELECT FIRSTNAME + '' ''+ LASTNAME FROM DBO.USERLOGIN UL WHERE UL.LOGINID=V.TECHSUPDT) AS SUPTDNAME FROM DBO.VESSEL V where V.VesselStatusid<>2 and V.vesselid not in (41,43,44) 
		OPEN CS
		FETCH NEXT FROM CS INTO @VesselID,@SUPTDNAME
		WHILE @@FETCH_STATUS=0
		BEGIN
			IF NOT EXISTS(SELECT MID FROM MortorMaster WHERE VESSELID=@VesselID AND RYear=@RYear AND RMonth=@RMonth)
			BEGIN
				INSERT INTO MortorMaster( VesselID,ReportNo, RYear ,Rmonth, ReportDate,SupTdName,Published)
				SELECT VESSELID, VESSELCODE + ''/MOTOR/'' + UPPER(LEFT(DATENAME(MONTH,@FORDATE),3)) + ''-'' + LTRIM(STR(@RYear)),@RYear,@Rmonth,@FORDATE,@SUPTDNAME,''N'' FROM DBO.VESSEL V WHERE V.VESSELID=@VesselID
			END
		FETCH NEXT FROM CS INTO @VesselID,@SUPTDNAME
		END
		CLOSE CS
	DEALLOCATE CS
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_MOTOR_PUBLISH]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_MOTOR_PUBLISH]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE Proc [dbo].[sp_MOTOR_PUBLISH]
(
@MID INT,
@REPORT IMAGE,
@Mode Char(1)
)
AS
BEGIN
   if(LTRIM(RTRIM(@Mode)) = ''A'')
   BEGIN
		UPDATE MortorMaster
		SET 
		Published=''Y'',
		Locked=''Y'',
		Report=@REPORT,
		PublishedOn = getdate()
		WHERE MID=@MID
	END
	ELSE
	BEGIN
		UPDATE MortorMaster
		SET 
		Published=''Y'',
		Report=@REPORT,
		PublishedOn = getdate()
		WHERE MID=@MID
	END
END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_MoveComponent]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_MoveComponent]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

-- exec [dbo].[sp_MoveComponent] '''',''''
CREATE PROC [dbo].[sp_MoveComponent]
(
	@MovingComponent CHAR(12),
	@NewCode CHAR(12)
)
AS
BEGIN
	--DECLARE @MovingComponent CHAR(12)
	--DECLARE @NewCode CHAR(12)
	
	--SET @MovingComponent=''351.10''
	--SET @NewCode=''173''
     DECLARE @MAXLENGTH INT; 
     SET @MAXLENGTH = 0;
         
	 SELECT @MAXLENGTH = MAX(LEN(LTRIM(RTRIM(REPLACE(ComponentCode,@MovingComponent,@NewCode))))) FROM ComponentMaster WHERE LEFT(ComponentCode,len(@MovingComponent))= RTRIM(LTRIM(@MovingComponent))
     PRINT 	@MAXLENGTH
     IF(@MAXLENGTH>12)
     BEGIN
		SELECT 1 -- MOVING COMPONENT GOING MORE THAN 4 LEVEL
	 END
	 ELSE
	 BEGIN
		 IF(EXISTS(SELECT * FROM COMPONENTMASTER WHERE LTRIM(RTRIM(COMPONENTCODE))=LTRIM(RTRIM(@NewCode))))
		 BEGIN
			SELECT 2 -- COMPONENT WITH SAME CODE ALREADY EXISTS
		 END
		 ELSE
		 BEGIN
			UPDATE ComponentMaster
			SET ComponentCode=@NewCode 
			WHERE ComponentCode= @MovingComponent
			
			UPDATE ComponentMaster
			SET ComponentCode=REPLACE(ComponentCode,RTRIM(LTRIM(@MovingComponent)),@NewCode)
			WHERE LEFT(ComponentCode,len(@MovingComponent))= RTRIM(LTRIM(@MovingComponent))
			
			-- Apply Flagging on Vessel component master table 
			UPDATE VSL_ComponentMasterForVessel 
				SET Updated = 1,
					UpdatedOn = getdate()
			WHERE ComponentId IN (SELECT  ComponentId FROM ComponentMaster WHERE LEFT(ComponentCode,len(LTRIM(RTRIM(@NewCode))))= LTRIM(RTRIM(@NewCode)))
			
			SELECT 0
		 END		
	 END
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_PostponePlannedJob]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_PostponePlannedJob]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

				  				  	
CREATE Proc [dbo].[sp_PostponePlannedJob]
(
@VesselCode CHAR(3),
@ComponentId INT,
@CompjobId INT,
@PostPoneReason INT,
@PostPoneRemarks VARCHAR(500),
@PlanDate SMALLDATETIME,
@ModifiedBy INT,
@P_DoneBy INT,
@P_DoneBy_Code VARCHAR(10),
@P_DoneBy_Name VARCHAR(50)

)
AS
BEGIN
       ------ UPDATE FIelds in PlanMaster
       UPDATE VSL_PlanMaster 
	   SET PostPoneReason = @PostPoneReason,
	   PostPoneRemarks = @PostPoneRemarks, 
	   P_DoneBy = @P_DoneBy,
	   P_DoneBy_Code = @P_DoneBy_Code,
	   P_DoneBy_Name = @P_DoneBy_Name,
	   PlanDate = @PlanDate, 
	   [Status] = 3, 
	   AssignedTo=0,
	   PostPoneDate=getdate(),
	   ModifiedBy= @ModifiedBy,
	   ModifiedOn=getdate(),
	   Updated = 1,
	   UpdatedOn = getdate() 
       WHERE VesselCode = @VesselCode AND ComponentId = @ComponentId AND CompjobId = @CompjobId

       ------ INSERT RECORD IN JobHistory Table
       DECLARE @HistoryId INT
	   SELECT @HistoryId = ISNULL(MAX(HistoryId),0)+1 FROM VSL_VesselJobUpdateHistory    
	   INSERT INTO VSL_VesselJobUpdateHistory (HistoryId,VesselCode,CompjobId,ComponentId,jobId,Status,AssignedTo,PlanDate,LastDueDate,LastDueHours,NextDueDate,NextDueHours,LastRunningHourDate,LastRunningHour,DoneBy,DoneBy_Code,DoneBy_Name,DoneDate,DoneHour,ServiceReport,ConditionBefore,ConditionAfter,UpdateRemarks,Specify,[FileName],FileImage,ModifiedBy,ModifiedOn,PostPoneReason,PostPoneRemarks,P_DoneBy,P_DoneBy_Code,P_DoneBy_Name,PostPoneDate,CancellationReason,CancellationDate,C_DoneBy,C_DoneBy_Code,C_DoneBy_Name,Action,Updated,UpdatedOn)
       SELECT @HistoryId,VesselCode,CompjobId,ComponentId,jobId,Status,AssignedTo,PlanDate,LastDueDate,LastDueHours,NextDueDate,NextDueHours,LastRunningHourDate,LastRunningHour,DoneBy,DoneBy_Code,DoneBy_Name,DoneDate,DoneHour,ServiceReport,ConditionBefore,ConditionAfter,UpdateRemarks,Specify,[FileName],FileImage,ModifiedBy,ModifiedOn,PostPoneReason,PostPoneRemarks,P_DoneBy,P_DoneBy_Code,P_DoneBy_Name,PostPoneDate,CancellationReason,CancellationDate,C_DoneBy,C_DoneBy_Code,C_DoneBy_Name,''P'',1,getdate() FROM VSL_PlanMaster WHERE VesselCode=@VesselCode AND ComponentId=@ComponentId AND CompjobId=@CompjobId
	  
	   
       
       
END






' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Ship_InsertRunningHour]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Ship_InsertRunningHour]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'  
CREATE PROC [dbo].[sp_Ship_InsertRunningHour]  
(  
 @VesselCode CHAR(3),  
 @ComponentId INT,   
 @StartupHour INT,  
 @AvgRunningHrPerDay INT,  
 @StartDate SMALLDATETIME,  
 @UpdatedBy INT  
)  
AS  
BEGIN  
       
    DECLARE @MainCode char(12)  
 SELECT @MainCode = [ComponentCode] FROM ComponentMaster WHERE ComponentId = @ComponentId  
 DECLARE @CID BIGINT  
   
 DECLARE CS_M CURSOR FOR SELECT DISTINCT CM.COMPONENTID FROM VSL_VesselComponentJobMaster VCJM  
 INNER JOIN COMPONENTMASTER CM ON CM.COMPONENTID=VCJM.COMPONENTID  
 WHERE IntervalId = 1 AND Status=''A'' AND VesselCode = @VesselCode AND LEFT(CM.COMPONENTCODE,LEN(LTRIM(RTRIM(@MainCode))))=@MainCode  
 OPEN CS_M  
 FETCH NEXT FROM CS_M INTO @CID  
 WHILE(@@FETCH_STATUS=0)  
 BEGIN  
   INSERT INTO VSL_VesselRunningHourMaster  
   (  
     VesselCode  
     ,ComponentId  
     ,StartupHour  
     ,AvgRunningHrPerDay  
     ,StartDate  
     ,UpdatedBy  
     ,UpdatedOn  
     ,Updated  
   )  
    VALUES  
   (  
     @VesselCode,  
     @CID,       
     @StartupHour,            
     @AvgRunningHrPerDay,  
     @StartDate,  
     @UpdatedBy,  
     getdate(),  
     1  
   )   
   --------------------  
   EXEC DBO.UPDATE_NEXTDUE_BYCOMPONENTID @VesselCode,@CID,@StartupHour,@AvgRunningHrPerDay,@StartDate,@UpdatedBy  
   --------------------  
  
  
 FETCH NEXT FROM CS_M INTO @CID  
 END  
 CLOSE CS_M  
 DEALLOCATE CS_M  
  
   
END  ' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Ship_InsertRunningHourByGroup]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Ship_InsertRunningHourByGroup]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'  
  
CREATE PROC [dbo].[sp_Ship_InsertRunningHourByGroup]  
(  
 @VesselCode CHAR(3),  
 @ComponentCode VARCHAR(12),   
 @StartupHour INT,  
 @AvgRunningHrPerDay INT,  
 @StartDate SMALLDATETIME,  
 @UpdatedBy INT  
)  
AS  
BEGIN  
 DECLARE @CID BIGINT  
 DECLARE @CCODE VARCHAR(12)  
 DECLARE CS_M CURSOR FOR SELECT DISTINCT CM.COMPONENTID,CM.COMPONENTCODE FROM VSL_VesselComponentJobMaster VCJM  
 INNER JOIN COMPONENTMASTER CM ON CM.COMPONENTID=VCJM.COMPONENTID  
 WHERE IntervalId = 1 AND Status=''A'' AND VesselCode = @VesselCode AND LEFT(CM.COMPONENTCODE,LEN(LTRIM(RTRIM(@ComponentCode))))=@ComponentCode  
 OPEN CS_M  
 FETCH NEXT FROM CS_M INTO @CID,@CCODE  
 WHILE(@@FETCH_STATUS=0)  
 BEGIN  
   EXEC [dbo].[sp_Ship_InsertRunningHour] @VesselCode,@CID,@StartupHour,@AvgRunningHrPerDay,@StartDate,@UpdatedBy  
 FETCH NEXT FROM CS_M INTO @CID,@CCODE  
 END  
 CLOSE CS_M  
 DEALLOCATE CS_M  
END  
  
  
  
  
  
  
  
  ' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Ship_InsertUpdateSpares]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Ship_InsertUpdateSpares]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE PROC [dbo].[sp_Ship_InsertUpdateSpares]
(
	@VesselCode char(3),
	@ComponentId bigint,
	@Office_Ship char(1),
	@SpareId bigint, 
	@SpareName Varchar(50),
	@Maker Varchar(50),
	@MakerType Varchar(50),
	@PartNo Varchar(50),
	@AltPartNo Varchar(50),
	@MinQty Int,
	@MaxQty Int,
	@StatutoryQty Int,
	@Weight Float,
	@Specification Varchar(500),
	@DrawingNo Varchar(50),
	@Attachment Varchar(50)
)
AS
BEGIN
IF(@SpareId = '''')
BEGIN
    SELECT @SpareId = ISNULL(MAX(SpareId),0)+1 FROM VSL_VesselSpareMaster WHERE VesselCode = @VesselCode AND ComponentId = @ComponentId AND Office_Ship = @Office_Ship
    
	INSERT INTO VSL_VesselSpareMaster
    (
            VesselCode
           ,ComponentId
           ,Office_Ship
           ,SpareId 
           ,SpareName
           ,Maker
           ,MakerType
           ,PartNo
           ,AltPartNo
           ,Location
           ,MinQty
           ,MaxQty
           ,StatutoryQty
           ,[Weight]
           ,Stock
           ,Specification
           ,DrawingNo
           ,[Status]
           ,Updated
           ,UpdatedOn
           ,Attachment         
	)
     VALUES
	(
	   @VesselCode,
	   @ComponentId,
	   @Office_Ship,
	   @SpareId,
	   @SpareName,
	   @Maker,
           @MakerType ,
           @PartNo ,
           @AltPartNo,
           '''',
           @MinQty,
           @MaxQty,
           @StatutoryQty,
           @Weight,
           0,
           @Specification,
           @DrawingNo,
           ''A'',
           1,
           getdate(),
           @Attachment
	)
	
	SELECT @SpareId As SpareId
		
END
ELSE
BEGIN
	UPDATE VSL_VesselSpareMaster   
    SET
    SpareName = @SpareName, 
	Maker = @Maker,       
    MakerType = @MakerType,    
    PartNo = @PartNo,
    AltPartNo = @AltPartNo,
    MinQty = @MinQty,
    MaxQty = @MaxQty,
    StatutoryQty = @StatutoryQty,
    Weight = @Weight,
    Specification = @Specification,
    DrawingNo = @DrawingNo,
    Status = ''A'',
    Updated = 1,
    UpdatedOn = getdate()
        
    WHERE VesselCode= @VesselCode AND ComponentId = @ComponentId AND Office_Ship = @Office_Ship AND SpareId = @SpareId

	SELECT @SpareId As SpareId
END				
END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Ship_UpdateRunningHour_History]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Ship_UpdateRunningHour_History]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- EXEC sp_Ship_UpdateRunningHour_History ''H'',''LIG'',''433'', 1300,GetDate()
CREATE Proc [dbo].[sp_Ship_UpdateRunningHour_History]
(
@Mode CHAR(1),
@VesselCode CHAR(3),
@ComponentCode CHAR(3),
@NewHrs INT,
@NewDate smalldatetime
)
AS
BEGIN
    --DECLARE @MaxHistoryId BIGINT
    --DECLARE @ComponentId BIGINT
    --DECLARE @CompJobId BIGINT 
IF(@Mode = ''H'') --- DUE TO HOURS
BEGIN
    UPDATE VSL_VesselJobUpdateHistory 
    SET  Verified = 0,
		 VerifiedBy = null,
		 VerifiedOn = null
     
     WHERE	VesselCode=@VesselCode	
     AND ComponentId IN 
	(	
		SELECT CM.ComponentId FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VesselCode AND LEFT(COMPONENTCODE,LEN(@ComponentCode))=@ComponentCode AND CMV.STATUS=''A''
		INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1
	)
    AND	DoneHour>@NewHrs AND DBO.getDatepart(DoneDate)<=@NewDate -- change
END
IF(@Mode = ''D'') --- DUE TO Date
BEGIN
    UPDATE VSL_VesselJobUpdateHistory 
    SET  Verified = 0,
		 VerifiedBy = null,
		 VerifiedOn = null
     
     WHERE	VesselCode=@VesselCode	
     AND ComponentId IN 
	(	
		SELECT CM.ComponentId FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VesselCode AND LEFT(COMPONENTCODE,LEN(@ComponentCode))=@ComponentCode AND CMV.STATUS=''A''
		INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1
	)
    AND	DoneDate>@NewDate
END
    --IF(@Mode = ''M'') --- DUE TO MAX ALLOWED HOURS
    --BEGIN
    --END
END










' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Update_MaintenanceKPI]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Update_MaintenanceKPI]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROC [dbo].[sp_Update_MaintenanceKPI]
(
	@VesselCode char(3),
	@Year int,
	@Month int,
	@TotalSystemJobs int,
	@DueJobs int,
	@OD1Week int,
	@OD2Week int,
	@ODMorethan2week int,
	@OutStandingJobs int
	
)
AS
BEGIN

 IF EXISTS(SELECT * FROM  VSL_MaintenanceKPI WHERE VesselCode=@VesselCode AND [Year]=@Year  AND [Month]=@Month )
 BEGIN
     
    -- DECLARE @ODJobs int
    -- SET @ODJobs = (@OD1Week + @OD2Week + @ODMorethan2week)
     
     UPDATE VSL_MaintenanceKPI
         SET TotalSystemJobs = @TotalSystemJobs,
             DueJobs = @DueJobs,
             --OverDueJobs = @ODJobs,
             OD1Week = @OD1Week,
             OD2Week = @OD2Week,
             ODMorethan2week = @ODMorethan2week,
             OutStandingJobs = @OutStandingJobs
     WHERE VesselCode=@VesselCode AND [Year]=@Year  AND [Month]=@Month


	 IF(@Month = 12)
	 BEGIN
	      SET @Month = 1
		  SET @Year = @Year+1  
	 END
	 ELSE
	 BEGIN
	       SET @Month = @Month+1
	 END

	 UPDATE VSL_MaintenanceKPI
         SET OverDueJobs = @OutStandingJobs
     WHERE VesselCode=@VesselCode AND [Year]=@Year  AND [Month]=@Month
 
 END

		
END






' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Update_Ship_ComponentJobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Update_Ship_ComponentJobs]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

					   					   
CREATE PROCEDURE [dbo].[sp_Update_Ship_ComponentJobs]
(
	@VesselCode CHAR(3),
	@ComponentId INT,
	@CompjobId INT,
	@AssignTo INT,
	@IntervalId INT,
	@Interval float,
	@IntervalId_H INT,
	@Interval_H float,
	@StartDate VARCHAR(20),
	@DescrM VARCHAR(5000),
	@Guidelines VARCHAR(50)
	) 
AS
BEGIN
    
    IF (@StartDate='''')
    BEGIN
		SET @StartDate=NULL
    END
	
		UPDATE VSL_VesselComponentJobMaster 
		       SET AssignTo =@AssignTo, 
		           IntervalId =@IntervalId, 
		           Interval =@Interval, 
		           StartDate = @StartDate, 
		           IntervalId_H = @IntervalId_H, 
		           Interval_H = @Interval_H,
		           DescrM = @DescrM,
		           Guidelines = @Guidelines,
		           Updated  = 1,
		           UpdatedOn = getdate()
		WHERE VesselCode=@VesselCode AND ComponentId = @ComponentId AND CompJobId = @CompjobId
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Update_Ship_SpareStatus]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Update_Ship_SpareStatus]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

					   
CREATE PROCEDURE [dbo].[sp_Update_Ship_SpareStatus]
	@VesselCode CHAR(3),
	@ComponentId BIGINT,
	@Office_Ship CHAR(1),
	@SpareId BIGINT,
	@Status CHAR(1)
AS
BEGIN

    UPDATE VSL_VesselSpareMaster
       SET Status = @Status,
           Updated = 1,
           UpdatedOn = getdate()    
    WHERE VesselCode = @VesselCode AND ComponentId = @ComponentId AND Office_Ship = @Office_Ship AND SpareId = @SpareId
   
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Update_Ship_Specifications]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Update_Ship_Specifications]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[sp_Update_Ship_Specifications]
	@VesselCode CHAR(3),
	@ComponentCode CHAR(12),
	@Maker VARCHAR(50),
	@MakerType VARCHAR(50),
	@ClassEquipCode VARCHAR(30),
	@Descr VARCHAR(1000),
	@CLASSEQUIP BIT,
	@ACCOUNTCODES VARCHAR(50)
AS
BEGIN

    UPDATE VSL_ComponentMasterForVessel 
       SET Maker = @Maker,
           MakerType=@MakerType,
           ClassEquipCode =@ClassEquipCode,
		   Updated = 1,
           UpdatedOn = getdate(),
		   Descr=@Descr,
		   CLASSEQUIP=@CLASSEQUIP,
		   ACCOUNTCODES=@ACCOUNTCODES

	WHERE VesselCode= @VesselCode 
    AND ComponentId IN (SELECT CMV.ComponentId FROM ComponentMaster CM INNER JOIN VSL_ComponentMasterForVessel CMV ON CM.ComponentId = CMV.ComponentId AND CMV.VesselCode = @VesselCode WHERE LEFT(CM.ComponentCode, LEN(@ComponentCode))= @ComponentCode)
   
    --WHERE VesselCode = @VesselCode 
    --AND ComponentId = (SELECT ComponentId FROM ComponentMaster WHERE ComponentCode= @ComponentCode)
   
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Update_Vessel_ComponentJobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Update_Vessel_ComponentJobs]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

					   
CREATE PROCEDURE [dbo].[sp_Update_Vessel_ComponentJobs]
(
	@VesselCode CHAR(3),
	@ComponentId INT,
	@CompjobId INT,
	@AssignTo INT,
	@IntervalId INT,
	@Interval float,
	@IntervalId_H INT,
	@Interval_H float,
	@StartDate VARCHAR(20),
	@DescrM VARCHAR(5000),
	@Guidelines VARCHAR(50)
	) 
AS
BEGIN
    
    IF (@StartDate='''')
    BEGIN
		SET @StartDate=NULL
    END
	
		UPDATE VesselComponentJobMaster 
		       SET AssignTo =@AssignTo, 
		           IntervalId =@IntervalId, 
		           Interval =@Interval, 
		           StartDate = @StartDate, 
		           IntervalId_H = @IntervalId_H, 
		           Interval_H = @Interval_H,
		           DescrM  = @DescrM,
		           Guidelines = @Guidelines
		WHERE VesselCode=@VesselCode AND ComponentId = @ComponentId AND CompJobId = @CompjobId
END


' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_Update_Vessel_Specifications]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_Update_Vessel_Specifications]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
					  
CREATE PROCEDURE [dbo].[sp_Update_Vessel_Specifications]
	@VesselCode CHAR(3),
	@ComponentCode CHAR(12),
	@Maker VARCHAR(50),
	@MakerType VARCHAR(50),
	@ClassEquipCode VARCHAR(30),
	@Descr VARCHAR(1000),
	@CLASSEQUIP BIT,
	@ACCOUNTCODES VARCHAR(50)
AS
BEGIN

    UPDATE ComponentMasterForVessel SET Maker = @Maker,MakerType=@MakerType,ClassEquipCode =@ClassEquipCode ,Descr=@Descr, CLASSEQUIP=@CLASSEQUIP, ACCOUNTCODES=@ACCOUNTCODES
    WHERE VesselCode= @VesselCode 
    AND ComponentId IN (SELECT CMV.ComponentId FROM ComponentMaster CM  INNER JOIN ComponentMasterForVessel CMV ON CM.ComponentId = CMV.ComponentId AND CMV.VesselCode = @VesselCode WHERE LEFT(CM.ComponentCode, LEN(@ComponentCode))= @ComponentCode)
   
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_UpdatePlannedJob]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_UpdatePlannedJob]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


				  	
CREATE Proc [dbo].[sp_UpdatePlannedJob]
(
@VesselCode CHAR(3),
@HistoryId BIGINT ,	
@ComponentId INT,
@CompjobId INT,
@ComponentCode CHAR(20),
@DoneDate smalldatetime,
@DoneHour INT,
@DoneBy INT,
@EmployeeNo varchar(10),
@EmployeeName varchar(50),
@UpdateRemarks int,
@RemarkSpecify varchar(50),
@ServiceReport varchar(5000),
@ConditionBefore varchar(50),
@ConditionAfter varchar(50),
@FileName varchar(50),
@DocumentFile image,
@Coating SMALLINT,
@Corrosion SMALLINT,
@Deformation SMALLINT,
@Cracks SMALLINT,
@OverallRating SMALLINT,
@NextDueDate SMALLDATETIME,
@NextDueHours INT,
@UpdatedBy int,
@CompStatus CHAR(1)

)
AS
BEGIN
	   DECLARE @PlanDate_bkp smalldatetime
	   DECLARE @AssignedTo_bkp int

	   SELECT @AssignedTo_bkp=AssignedTo,@PlanDate_bkp=PlanDate from VSL_PlanMaster WHERE VesselCode=@VesselCode AND ComponentId=@ComponentId AND CompjobId=@CompjobId 
		
       UPDATE VSL_PlanMaster
	   SET 
	   LastDueDate=NextDueDate,
	   LastDueHours=NextDueHours
	   WHERE VesselCode=@VesselCode AND ComponentId=@ComponentId AND CompjobId=@CompjobId 
	   
	   DECLARE @_LASTDONEDATE SMALLDATETIME
	   DECLARE @_LASTDONEHR INT
	   SELECT @_LASTDONEDATE=LastDone,@_LASTDONEHR=LastHour FROM VSL_VesselComponentJobMaster_Updates WHERE VesselCode=@VesselCode AND ComponentId=@ComponentId AND CompJobId=@CompjobId    
	   
	   UPDATE VSL_PlanMaster
	   SET
	   _ComponentCode = @ComponentCode, 
	   DoneDate = @DoneDate,
	   DoneHour = @DoneHour,
	   DoneBy = @DoneBy,
	   DoneBy_Code = @EmployeeNo,
	   DoneBy_Name = @EmployeeName,
	   UpdateRemarks = @UpdateRemarks,
	   Specify = @RemarkSpecify,
	   ServiceReport = @ServiceReport,
	   ConditionBefore = @ConditionBefore,
	   ConditionAfter = @ConditionAfter,
	   [FileName] = @FileName,
	   FileImage = @DocumentFile,
	   Coating = @Coating,
	   Corrosion = @Corrosion,
	   Deformation = @Deformation,
	   Cracks = @Cracks,
	   OverallRating = @OverallRating,
	   NextDueDate = @NextDueDate,
	   NextDueHours = @NextDueHours,
	   ModifiedBy = @UpdatedBy,
	   ModifiedOn = getdate(),
	   Status = 0,
	   AssignedTo=0,
	   Plandate=null,
	   Updated = 1,
	   UpdatedOn = getdate()	   		   
	   WHERE VesselCode=@VesselCode AND ComponentId=@ComponentId AND CompjobId=@CompjobId 
	   
	   UPDATE VSL_VesselComponentJobMaster_Updates
	   SET LastDone = @DoneDate,
	       LastHour = @DoneHour,
	       NextDueDate = @NextDueDate,
	       NextHour = @NextDueHours,
	       Updated = 1,
		   UpdatedOn = getdate()
	   WHERE VesselCode=@VesselCode AND ComponentId=@ComponentId AND CompJobId=@CompjobId    
	   
	   IF(@HistoryId <=0)
	   BEGIN
			SELECT @HistoryId = ISNULL(MAX(HistoryId),0)+1 FROM VSL_VesselJobUpdateHistory  WHERE VesselCode=@VesselCode   
			INSERT INTO VSL_VesselJobUpdateHistory (HistoryId,VesselCode,CompJobId,ComponentId,_ComponentCode,jobId,Status,AssignedTo,PlanDate,LastDueDate,LastDueHours,NextDueDate,NextDueHours,LastRunningHourDate,LastRunningHour,DoneBy,DoneBy_Code,DoneBy_Name,DoneDate,DoneHour,ServiceReport,ConditionBefore,ConditionAfter,UpdateRemarks,Specify,[FileName],FileImage,Coating,Corrosion,Deformation,Cracks,OverallRating,ModifiedBy,ModifiedOn,PostPoneReason,PostPoneRemarks,P_DoneBy,P_DoneBy_Code,P_DoneBy_Name,PostPoneDate,CancellationReason,CancellationDate,C_DoneBy,C_DoneBy_Code,C_DoneBy_Name,Action,CompStatus,Updated,UpdatedOn)
			SELECT @HistoryId,VesselCode,CompJobId,ComponentId,@ComponentCode,jobId,Status,@AssignedTo_bkp,@PlanDate_bkp,LastDueDate,LastDueHours,NextDueDate,NextDueHours,@_LASTDONEDATE,@_LASTDONEHR,DoneBy,DoneBy_Code,DoneBy_Name,DoneDate,DoneHour,ServiceReport,ConditionBefore,ConditionAfter,UpdateRemarks,Specify,[FileName],FileImage,@Coating,@Corrosion,@Deformation,@Cracks,@OverallRating,ModifiedBy,ModifiedOn,PostPoneReason,PostPoneRemarks,P_DoneBy,P_DoneBy_Code,P_DoneBy_Name,PostPoneDate,CancellationReason,CancellationDate,C_DoneBy,C_DoneBy_Code,C_DoneBy_Name,''R'',@CompStatus,1,getdate() FROM VSL_PlanMaster WHERE VesselCode=@VesselCode AND ComponentId=@ComponentId AND CompjobId=@CompjobId

       END
	   ELSE
	   BEGIN
		   UPDATE VSL_VesselJobUpdateHistory
		   SET 

		   DoneDate = @DoneDate,
		   DoneHour = @DoneHour,
		   DoneBy = @DoneBy,
		   DoneBy_Code = @EmployeeNo,
		   DoneBy_Name = @EmployeeName,
		   UpdateRemarks = @UpdateRemarks,
		   Specify = @RemarkSpecify,
		   ServiceReport = @ServiceReport,
		   ConditionBefore = @ConditionBefore,
		   ConditionAfter = @ConditionAfter,
		   FileImage = @DocumentFile,
		   Coating = @Coating,
		   Corrosion = @Corrosion,
		   Deformation = @Deformation,
		   Cracks = @Cracks,
		   OverallRating = @OverallRating,
		   NextDueDate = @NextDueDate,
		   NextDueHours = @NextDueHours,
		   ModifiedBy = @UpdatedBy

		   WHERE VESSELCODE=@VesselCode AND HISTORYID=@HistoryId
	   END
       SELECT @HistoryId As HistoryId
END









' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_UpdateServiceReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_UpdateServiceReport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

-- EXEC sp_UpdateServiceReport ''LIG'',4,''qwerty 321''
				  	
CREATE Proc [dbo].[sp_UpdateServiceReport]
(
@VesselCode CHAR(3),
@HistoryId BIGINT ,
@DoneDate smalldatetime,
@DoneHour INT,
@DoneBy INT,
@EmployeeNo varchar(10),
@EmployeeName varchar(50),
@UpdateRemarks int,
@RemarkSpecify varchar(50),
@ServiceReport varchar(5000),
@ConditionBefore varchar(50),
@ConditionAfter varchar(50),
@NextDueDate SMALLDATETIME,
@NextDueHours INT,
@UpdatedBy int
)
AS
BEGIN

    DECLARE @MaxHistoryId BIGINT
    DECLARE @ComponentId BIGINT
    DECLARE @CompJobId BIGINT
    
  	   	   
	 UPDATE VSL_VesselJobUpdateHistory
	   SET
	       DoneDate = @DoneDate,
		   DoneHour = @DoneHour,
		   DoneBy = @DoneBy,
		   DoneBy_Code = @EmployeeNo,
		   DoneBy_Name = @EmployeeName,
		   UpdateRemarks = @UpdateRemarks,
		   Specify = @RemarkSpecify,
		   ServiceReport = @ServiceReport,
		   ConditionBefore = @ConditionBefore,
		   ConditionAfter = @ConditionAfter,
		   NextDueDate = @NextDueDate,
		   NextDueHours = @NextDueHours,
		   ModifiedBy = @UpdatedBy,
		   ModifiedOn = getdate(),
		   Updated = 1,
		   UpdatedOn = getdate()
		 WHERE VESSELCODE=@VesselCode AND HISTORYID=@HistoryId
		 
	SELECT 	@ComponentId=ComponentId, @CompJobId=CompJobId FROM VSL_VesselJobUpdateHistory 
	WHERE VESSELCODE=@VesselCode AND HISTORYID=@HistoryId
	
	SELECT @MaxHistoryId = MAX(HISTORYID) FROM VSL_VesselJobUpdateHistory 
	WHERE VESSELCODE=@VesselCode AND ComponentId=@ComponentId AND CompJobId=@CompJobId
	
	IF(@MaxHistoryId = @HistoryId)
	BEGIN
	    
	    UPDATE VSL_PlanMaster
	   SET
	   DoneDate = @DoneDate,
	   DoneHour = @DoneHour,
	   DoneBy = @DoneBy,
	   DoneBy_Code = @EmployeeNo,
	   DoneBy_Name = @EmployeeName,
	   UpdateRemarks = @UpdateRemarks,
	   Specify = @RemarkSpecify,
	   ServiceReport = @ServiceReport,
	   ConditionBefore = @ConditionBefore,
	   ConditionAfter = @ConditionAfter,	   
	   NextDueDate = @NextDueDate,
	   NextDueHours = @NextDueHours,
	   ModifiedBy = @UpdatedBy,
	   ModifiedOn = getdate(),	   
	   Updated = 1,
	   UpdatedOn = getdate()	   		   
	   WHERE VesselCode=@VesselCode AND ComponentId=@ComponentId AND CompjobId=@CompJobId 
	   
	   UPDATE VSL_VesselComponentJobMaster_Updates
	   SET LastDone = @DoneDate,
	       LastHour = @DoneHour,
	       NextDueDate = @NextDueDate,
	       NextHour = @NextDueHours,
	       Updated = 1,
		   UpdatedOn = getdate()
	   WHERE VesselCode=@VesselCode AND ComponentId=@ComponentId AND CompJobId=@CompjobId    
	   
	
	END
	 	   
	   
END









' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_UpdateUnPlannedJob]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_UpdateUnPlannedJob]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[sp_UpdateUnPlannedJob]
(
	@VesselCode char(3),
	@UPId bigint,
	@ComponentId Bigint,
	@ShortDescr varchar(500),
	@LongDescr varchar(2000),
	@DeptId Int,
	@AssignedTo Int,
	@DueDate smalldatetime,	
	@UpdatedBy int,
	@DoneBy_Code varchar(15),
	@DoneBy_Name varchar(50),
	@DoneDate smalldatetime,
	@ServiceReport varchar(5000),
	@ConditionBefore varchar(50),
	@ConditionAfter varchar(50),
	@RQNNo varchar(50),
	@RQNDate smalldatetime
)
AS
BEGIN
	UPDATE VSL_UnPlannedJobs
	SET SHORTDESCR=@ShortDescr,
		LONGDESCR=@LongDescr,
		DEPTID=@DEPTID,
		ASSIGNEDTO=@ASSIGNEDTO,
		DUEDATE=@DUEDATE,
		DoneBy_Code=@DoneBy_Code,
		DoneBy_Name=@DoneBy_Name,
		DoneDate=@DoneDate,
		ServiceReport=@ServiceReport,
		ConditionBefore=@ConditionBefore,
		ConditionAfter=@ConditionAfter,
		RQNNo=@RQNNo,
		RQNDate=@RQNDate, 
		UpdatedBy=@UpdatedBy,
		UpdatedOn=getdate()
	WHERE VESSELCODE=@VESSELCODE AND UPID=@UPID
END




' 
END
GO
/****** Object:  StoredProcedure [dbo].[sp_VesselDataScript]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_VesselDataScript]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE procedure [dbo].[sp_VesselDataScript]
( 
	@VSL CHAR(3),
	@ExportedBy INT
)
as
begin
	select * from dbo.DeptMaster
	select * from dbo.Rank
	select * from dbo.Settings where shipcode=@VSL
	select * from dbo.ShipUserMaster
	
	select * from dbo.JobMaster
	select * from dbo.JobIntervalMaster

	select * from dbo.ComponentMaster
	select * from dbo.ComponentsJobMapping
	select * from dbo.ComponentsJobMapping_Attachments
	
	select * from dbo.VSL_ComponentMasterForVessel  where VESSELCODE=@VSL
	select * from dbo.VSL_VesselComponentJobMaster where VESSELCODE=@VSL
	select * from dbo.VSL_VesselComponentJobMaster_Updates where VESSELCODE=@VSL
	select * from dbo.VSL_VesselComponentJobMaster_Attachments where VESSELCODE=@VSL

	select * from dbo.VSL_VesselRunningHourMaster where VESSELCODE=@VSL
	select * from dbo.VSL_VesselSpareMaster where VESSELCODE=@VSL
	select * from dbo.VSL_PlanMaster where VESSELCODE=@VSL

	select * from dbo.VSL_VesselJobUpdateHistory where VESSELCODE=@VSL
	select * from dbo.VSL_DefectDetailsMaster where VesselCode = @VSL
	select * from dbo.VSL_DefectSpareDetails where VesselCode = @VSL

	SELECT * FROM dbo.VSL_VesselJobUpdateHistoryAttachments WHERE VesselCode = @VSL
	SELECT * FROM dbo.VSL_VesselJobUpdateHistorySpareDetails WHERE VesselCode = @VSL

	SELECT * FROM dbo.VSL_StockInventory WHERE VesselCode = @VSL

	select * from dbo.VSL_UnPlannedJobs where VESSELCODE=@VSL
	select * from dbo.VSL_UnPlannedJobs_Attachments where VESSELCODE=@VSL
	select * from dbo.VSL_UnPlannedJobs_SpareDetails where VESSELCODE=@VSL
	
	select * from dbo.VSL_CriticalEquipShutdownRequest where VESSELCODE=@VSL
	select * from dbo.VSL_CriticalShutdownExtensions where VESSELCODE=@VSL
	select * from dbo.VSL_CriticalShutdownApproval where VESSELCODE=@VSL
	select * from dbo.VSL_CriticalShutdownExtensionApproval where VESSELCODE=@VSL
	select * from dbo.VSL_DefectRemarks where VESSELCODE=@VSL
	select * from dbo.VSL_Defects_Attachments where VESSELCODE=@VSL
	
	SELECT TOP 1 VesselCode,CAST( SUBSTRING(PacketName,15,5) AS INT) AS RowId,PacketNAme,PacketDate FROM dbo.IE_PacketReceived WHERE VesselCode =@VSL ORDER BY CAST( SUBSTRING(PacketName,15,5) AS INT) DESC
	
	------ SMS MODULE DATA --------------------
	
	--DECLARE @VESSELID INT

	--SELECT @VESSELID=VesselId FROM dbo.Vessel WHERE VesselCode = @VSL
	

	--select * from dbo.SMS_Forms
	--select * from dbo.SMS_APP_ManualMaster MM WHERE MM.MANUALID IN (select VT.MANUALID from dbo.SMS_ManualVesselType VT WHERE VESSELTYPEID=@VESSELID)
	--select * from dbo.SMS_APP_ManualDetails MD WHERE MD.MANUALID IN (select VT.MANUALID from dbo.SMS_ManualVesselType VT WHERE VESSELTYPEID=@VESSELID)
	--select * from dbo.SMS_APP_ManualDetailsForms MDF WHERE MDF.MANUALID IN (select VT.MANUALID from dbo.SMS_ManualVesselType VT WHERE VESSELTYPEID=@VESSELID)
	--select * from dbo.SMS_APP_COM_ManualDetails SACM WHERE SACM.MANUALID IN (select VT.MANUALID from dbo.SMS_ManualVesselType VT WHERE VESSELTYPEID=@VESSELID)
	
	select TOP 1 VesselCode,PACKETID AS TableId,PacketName,RECDON AS CreatedOn from dbo.SMS_Packetrecd WHERE VESSELCODE=@VSL ORDER BY PACKETID DESC
	
	
	
END







' 
END
GO
/****** Object:  StoredProcedure [dbo].[TRANSFTER_TO_POS]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TRANSFTER_TO_POS]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

-- exec DBO.TRANSFTER_TO_POS ''AGE'',4

CREATE PROCEDURE [dbo].[TRANSFTER_TO_POS]
(
	@VesselCode CHAR(3),
	@PROVISIONID BIGINT,
	@TransferedBy INT
)
AS
BEGIN

--IF NOT EXISTS (SELECT Poid FROM [MTMPOS].[dbo].Add_tblSMDPOMaster WHERE ShipProvisonID = @PROVISIONID)
IF NOT EXISTS (SELECT REQNO FROM MTMPOS.DBO.Add_tblSMDPOMaster WHERE REQNO IN (SELECT REQUISITIONNO FROM MP_VSL_PROVISIONMASTER WHERE VesselCode=@VesselCode AND PROVISIONID=@PROVISIONID))
BEGIN


	DECLARE @NWCSHIPID CHAR(3)
	--SELECT @NWCSHIPID=@NWCSHIPID FROM MTMM2000SQL.DBO.sql_tblSMDPRVESSELS WHERE SHIPID=@VesselCode
	--IF(ISNULL(@NWCSHIPID,'''')='''')
	SET @NWCSHIPID=@VesselCode 
	-- ========== ++++++++++ COPY MASTER DATA +++++++++++++++++++ ======================
	declare @AccountID INT
    SELECT @AccountID=AccountID FROM MTMM2000SQL.DBO.sql_tblSMDPRAccounts WHERE ACCOUNTNUMBER in (SELECT ACCTCODE FROM MP_VSL_PROVISIONMASTER WHERE VesselCode=@VesselCode AND PROVISIONID=@PROVISIONID)

	DECLARE @PRNum int
	SELECT @PRNum = isnull(max(PRNum),5000)+1 from [MTMM2000SQL].[dbo].[tblSMDPOMaster] where shipid=@NWCSHIPID

	INSERT INTO [MTMM2000SQL].[dbo].[tblSMDPOMaster]
			   (
			   PODate, 
			   POCreator,
			   ShipID, 
			   InvoiceReceived,
			   InvoicePosted, 
			   LocalMasterID, 
			   Locked, 
			   DateCreated,
			   PoComments, 
			   POCommentsVen,
			   StatusID, 
			   StatusDate, 
			   HighPriority,
			   OrigPOID,
			   CopyEquip, 
			   Dept, 
			   PRType,
			   PRNum, 
			   VerNo, 
			   AccountID, 
			   LandedRepairs, 
			   LandedStorage, 
			   isClosed,
			   MultiVess
	)
	SELECT GETDATE(),UPDATEDBY,@NWCSHIPID,0,0,0,0,GETDATE(),REMARKS,'''',0,GETDATE(),0,0,0,''P'',1,@PRNum,0,@AccountID,0,0,0,0 FROM MP_VSL_PROVISIONMASTER WHERE VesselCode=@VesselCode AND PROVISIONID=@PROVISIONID
	
	---------- =============== ++++++++++++++++++++++++++++++++ Insert data in MTMPOS database for added fields

	DECLARE @POID as int
	SELECT @POID=SCOPE_IDENTITY()
	INSERT INTO [MTMPOS].[dbo].Add_tblSMDPOMaster
	(
	Poid,
	ReqNo,
	ReceivedFrom,
	RemarksSMD,
	Port ,
    ETA ,
    ReceivedDate,
	ShipProvisonID
	)
	SELECT @POID,REQUISITIONNO,0,REMARKS,PORTOFSUPPLY,ETA,GETDATE(),@PROVISIONID FROM MP_VSL_PROVISIONMASTER WHERE VesselCode=@VesselCode AND PROVISIONID=@PROVISIONID
	
	---------- =============== ++++++++++++++++++++++++++++++++

	declare @EventID as bigint
	SELECT @EventID=isnull(max(ActionId),0)+1 from [MTMPOS].[dbo].tblEventHistory
	insert into [MTMPOS].[dbo].tblEventHistory
	(
	ActionId,
	RefKey,
	Status,
	Descr,
	EventDate
	)
	SELECT @EventID,@POID,0,REMARKS,GETDATE() FROM MP_VSL_PROVISIONMASTER WHERE VesselCode=@VesselCode AND PROVISIONID=@PROVISIONID
	-------------
	SELECT @POID

	
	-- ========== ++++++++++ COPY DETAILS DATA +++++++++++++++++++ ======================

	DECLARE @REQQTY FLOAT
	DECLARE @PRODUCTID INT
	DECLARE @SUPPLYUNITID INT
	DECLARE @IMPACODE VARCHAR(50)
	DECLARE @ROBQTY FLOAT
	DECLARE @UNITNAME VARCHAR(50)
	DECLARE @RecID INT
	DECLARE @PackagingName VARCHAR(50)

	SET @REQQTY =0
	SET @PRODUCTID =0
	SET @SUPPLYUNITID =0
	SET @IMPACODE =''''
	SET @ROBQTY =0
	

	-- ========== ++++++++++ COPY PRODUCTS DATA +++++++++++++++++++ ======================

	DECLARE CS_ITEMS CURSOR FOR SELECT REQQTY,PRODUCTID,ROBQTY,PackagingName FROM MP_VSL_PROVISIONDETAILS WHERE VesselCode=@VesselCode AND PROVISIONID=@PROVISIONID
	OPEN CS_ITEMS
	FETCH NEXT FROM CS_ITEMS INTO @REQQTY,@PRODUCTID,@ROBQTY,@PackagingName
	WHILE(@@FETCH_STATUS=0)
	BEGIN
		SET @RecID=0
		SET @UNITNAME=''''
		DECLARE @CATID INT
		DECLARE @PRODUCTNAME VARCHAR(50)

		SELECT @CATID=CATEGORYID,@PRODUCTNAME=PRODUCTNAME,@SUPPLYUNITID=SUPPLYUNITID,@IMPACODE=IMPACODE FROM MP_PRODUCTS WHERE PRODUCTID=@PRODUCTID
		SELECT @UNITNAME=UNITNAME FROM MP_UnitMaster WHERE UNITID IN  (CASE WHEN @SUPPLYUNITID > 0 THEN @SUPPLYUNITID ELSE (SELECT ORDERUNITID FROM MP_MAINCATEGORY MC WHERE MC.CATEGORYID=@CATID) END)

		IF(LTRIM(RTRIM(@PackagingName))<>'''')
			SET @PRODUCTNAME=@PRODUCTNAME +  '' , Packaging : ('' +  @PackagingName + '')''

		INSERT INTO [MTMM2000SQL].[dbo].[tblSMDPODetail]
		(       
			[POID]
			,[Qty]
			,[Description]
			,[AccountID]
			,[UOM]
			,[PartNo]
			,[HasEquip]
			,[PRID]
			,[QtyOB]
		)
		VALUES
		(
			@POID,
			@REQQTY,
			@PRODUCTNAME,
			@AccountID,
			@UNITNAME,
			@IMPACODE,
			0,
			0,
			@ROBQTY
		)

		---- Insert data in MTMPOS database for added fields

		
		SELECT @RecID=SCOPE_IDENTITY()
		insert into [MTMPOS].[dbo].Add_tblSMDPODetail(Recid,POID,ProvisionProductId) values(@Recid,@POID,@PRODUCTID)

		FETCH NEXT FROM CS_ITEMS INTO @REQQTY,@PRODUCTID,@ROBQTY,@PackagingName
	END
	CLOSE CS_ITEMS
	DEALLOCATE CS_ITEMS

	-------------------------------------------------------------------------------					
	SET @REQQTY =0
	SET @PRODUCTID =0
	SET @SUPPLYUNITID =0
	SET @IMPACODE =''''
	SET @ROBQTY =0

	-- ========== ++++++++++ COPY OTHER ITEMS DATA +++++++++++++++++++ ======================
	
	DECLARE CS_ITEMS1 CURSOR FOR SELECT REQQTY,ROBQTY,PRODUCTNAME,UNITID,PACKAGING FROM MP_VSL_PROVISIONOTHERITEMS WHERE VesselCode=@VesselCode AND PROVISIONID=@PROVISIONID
	OPEN CS_ITEMS1
	FETCH NEXT FROM CS_ITEMS1 INTO @REQQTY,@ROBQTY,@PRODUCTNAME,@SUPPLYUNITID,@PackagingName
	WHILE(@@FETCH_STATUS=0)
	BEGIN
		SET @RecID=0
		SET @UNITNAME=''''
		SELECT @UNITNAME=UNITNAME FROM MP_UnitMaster WHERE UNITID=@SUPPLYUNITID


		IF(LTRIM(RTRIM(@PackagingName))<>'''')
			SET @PRODUCTNAME=@PRODUCTNAME +  '' , Packaging : ('' +  @PackagingName + '')''


		INSERT INTO [MTMM2000SQL].[dbo].[tblSMDPODetail]
		(       
			[POID]
			,[Qty]
			,[Description]
			,[AccountID]
			,[UOM]
			,[PartNo]
			,[HasEquip]
			,[PRID]
			,[QtyOB]
		)
		VALUES
		(
			@POID,
			@REQQTY,
			@PRODUCTNAME,
			@AccountID,
			@UNITNAME,
			'''',
			0,
			0,
			@ROBQTY
		)

		---- Insert data in MTMPOS database for added fields
		SELECT @RecID=SCOPE_IDENTITY()
		insert into [MTMPOS].[dbo].Add_tblSMDPODetail(Recid,POID,ProvisionProductId) values(@Recid,@POID,@PRODUCTID)

		FETCH NEXT FROM CS_ITEMS1 INTO @REQQTY,@ROBQTY,@PRODUCTNAME,@SUPPLYUNITID,@PackagingName
	END
	CLOSE CS_ITEMS1
	DEALLOCATE CS_ITEMS1

	UPDATE [dbo].[MP_VSL_ProvisionMaster] SET [Status] = ''T'', [TransferedBy]=@TransferedBy,[TransferedOn]=GetDate() WHERE [VesselCode] = @VesselCode  AND [ProvisionId]=@PROVISIONID

END


END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[TRANSFTER_TO_POS_SpareReq]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TRANSFTER_TO_POS_SpareReq]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
-- exec DBO.TRANSFTER_TO_POS ''AGE'',4
CREATE PROCEDURE [dbo].[TRANSFTER_TO_POS_SpareReq]
(
	@VesselCode CHAR(3),
	@SpareReqId BIGINT,
	@TransferedBy INT
)
AS
BEGIN

--IF NOT EXISTS (SELECT Poid FROM [MTMPOS].[dbo].Add_tblSMDPOMaster WHERE ShipSpareReqId = @SpareReqId)
IF NOT EXISTS (SELECT REQNO FROM MTMPOS.DBO.Add_tblSMDPOMaster WHERE REQNO IN (SELECT ReqnNo FROM MP_VSL_SparesReqMaster WHERE VesselCode=@VesselCode AND ShipSpareReqId = @SpareReqId))
BEGIN

	DECLARE @NWCSHIPID CHAR(3)	
	SET @NWCSHIPID=@VesselCode 
	-- ========== ++++++++++ COPY MASTER DATA +++++++++++++++++++ ======================
	declare @AccountID INT
    SELECT @AccountID=AccountID FROM MTMM2000SQL.DBO.sql_tblSMDPRAccounts WHERE ACCOUNTNUMBER in (SELECT AccountCode FROM MP_VSL_SparesReqMaster WHERE VesselCode=@VesselCode AND SpareReqId=@SpareReqId)
	DECLARE @Dept Varchar(2)
	SELECT TOP 1 @Dept=Dept FROM MTMPOS.dbo.tblSMDDeptAccounts WHERE AccountID = @AccountID AND PRType = 2
	DECLARE @PRNum int
	SELECT @PRNum = isnull(max(PRNum),5000)+1 from [MTMM2000SQL].[dbo].[tblSMDPOMaster] where shipid=@NWCSHIPID
	
	DECLARE @EquipName VARCHAR(255)
	DECLARE @EquipModel NVARCHAR(255)
	DECLARE @Equipmfg NVARCHAR(255)

	--SELECT @EquipName=MAKER,@EquipModel=MAKERTYPE,@Equipmfg=DESCR from vsl_componentmasterforvessel WHERE VESSELCODE=@VesselCode AND COMPONENTID IN (SELECT TOP 1 ComponentId FROM MP_VSL_SparesReqDetails WHERE VesselCode=@VesselCode AND SpareReqId=@SpareReqId)
	
	SELECT TOP 1 @EquipName=COMPONENTNAME FROM COMPONENTMASTER WHERE COMPONENTID IN (SELECT TOP 1 ComponentId FROM DBO.MP_VSL_SparesReqDetails WHERE VesselCode=@VESSELCODE AND SpareReqId=@SPAREREQID)
	SELECT @EquipModel=MAKER + '', '' + MAKERTYPE,@Equipmfg=SPECIFICATION from DBO.VSL_VesselSpareMaster where VESSELCODE=@VESSELCODE AND COMPONENTID IN (SELECT TOP 1 ComponentId FROM DBO.MP_VSL_SparesReqDetails WHERE VesselCode=@VESSELCODE AND SpareReqId=@SPAREREQID)


	INSERT INTO [MTMM2000SQL].[dbo].[tblSMDPOMaster]
			   (
			   PODate, 
			   POCreator,
			   ShipID, 
			   InvoiceReceived,
			   InvoicePosted, 
			   LocalMasterID, 
			   Locked, 
			   DateCreated,
			   PoComments, 
			   POCommentsVen,
			   StatusID, 
			   StatusDate, 
			   HighPriority,
			   OrigPOID,

			   CopyEquip, 

			   Dept, 

			   PRType,

			   PRNum, 

			   VerNo, 

			   AccountID, 

			   LandedRepairs, 

			   LandedStorage, 

			   isClosed,

			   MultiVess,
			   EquipName,
			   EquipModel,
			   Equipmfg

	)

	SELECT GETDATE(),UPDATEDBY,@NWCSHIPID,0,0,0,0,GETDATE(),REMARKS,'''',0,GETDATE(),0,0,0,@Dept,2,@PRNum,0,@AccountID,0,0,0,0, @EquipName,@EquipModel,@Equipmfg FROM MP_VSL_SparesReqMaster WHERE VesselCode=@VesselCode AND SpareReqId=@SpareReqId

	

	---------- =============== ++++++++++++++++++++++++++++++++ Insert data in MTMPOS database for added fields



	DECLARE @POID as int

	SELECT @POID=SCOPE_IDENTITY()

	INSERT INTO [MTMPOS].[dbo].Add_tblSMDPOMaster

	(

	Poid,

	ReqNo,

	ReceivedFrom,

	RemarksSMD,

	Port ,

    ETA ,

    ReceivedDate,

	ShipSpareReqId

	)

	SELECT @POID,ReqnNo,0,REMARKS,Port,ETA,GETDATE(),@SpareReqId FROM MP_VSL_SparesReqMaster WHERE VesselCode=@VesselCode AND SpareReqId=@SpareReqId

	

	---------- =============== ++++++++++++++++++++++++++++++++



	declare @EventID as bigint

	SELECT @EventID=isnull(max(ActionId),0)+1 from [MTMPOS].[dbo].tblEventHistory

	insert into [MTMPOS].[dbo].tblEventHistory

	(

	ActionId,

	RefKey,

	Status,

	Descr,

	EventDate

	)

	SELECT @EventID,@POID,0,REMARKS,GETDATE() FROM MP_VSL_SparesReqMaster WHERE VesselCode=@VesselCode AND SpareReqId=@SpareReqId

	-------------

	SELECT @POID



	

	-- ========== ++++++++++ COPY DETAILS DATA +++++++++++++++++++ ======================



	DECLARE @REQQTY FLOAT

	DECLARE @SpareId INT

	DECLARE @SPARENAME VARCHAR(50)	

	DECLARE @ROBQTY FLOAT

	DECLARE @UNITNAME VARCHAR(50)

	DECLARE @PartNo VARCHAR(50)

	DECLARE @RecID INT

	DECLARE @ComponentId INT

	DECLARE @Office_Ship CHAR(1)

	DECLARE @Maker VARCHAR(50)
	DECLARE @MakerType VARCHAR(50)
	DECLARE @Specification VARCHAR(500)
	DECLARE @DrawingNo VARCHAR(50)

	



	SET @REQQTY =0

	SET @SpareId =0	

	SET @ROBQTY =0

	



	-- ========== ++++++++++ COPY PRODUCTS DATA +++++++++++++++++++ ======================



	DECLARE CS_ITEMS CURSOR FOR SELECT QTY,SRD.SPAREID,ROB,UOM,SpareName,PartNo,SRD.ComponentId,SRD.Office_Ship,[Maker],[MakerType],[Specification],[DrawingNo] FROM MP_VSL_SparesReqDetails SRD 

								INNER JOIN VSL_VesselSpareMaster VSM ON SRD.VesselCode = VSM.VesselCode AND  SRD.[ComponentId] = VSM.[ComponentId] AND SRD.[Office_Ship]= VSM.[Office_Ship] AND SRD.[SpareId]=VSM.[SpareId]

								WHERE SRD.VesselCode=@VesselCode AND SRD.SpareReqId=@SpareReqId

	OPEN CS_ITEMS

	FETCH NEXT FROM CS_ITEMS INTO @REQQTY,@SpareId,@ROBQTY,@UNITNAME,@SPARENAME,@PartNo,@ComponentId,@Office_Ship,@Maker,@MakerType,@Specification,@DrawingNo

	WHILE(@@FETCH_STATUS=0)

	BEGIN

		SET @RecID=0		



		INSERT INTO [MTMM2000SQL].[dbo].[tblSMDPODetail]

		(       

			[POID]

			,[Qty]

			,[Description]

			,[AccountID]

			,[UOM]

			,[PartNo]

			,[HasEquip]

			,[PRID]

			,[QtyOB]			
			
			,EquipItemName

			,EquipItemMfg

			,EquipItemModel

			,EquipItemDesc

			,EquipItemDrawing
			

		)

		VALUES

		(

			@POID,

			@REQQTY,

			@SPARENAME,

			@AccountID,

			@UNITNAME,

			@PartNo,

			0,

			0,

			@ROBQTY,
			@SPARENAME,
			@Maker,
			@MakerType,
			@Specification,
			@DrawingNo

		)



		---- Insert data in MTMPOS database for added fields

		

		SELECT @RecID=SCOPE_IDENTITY()

		insert into [MTMPOS].[dbo].Add_tblSMDPODetail(Recid,POID,ComponentId,Office_Ship,SpareId) values(@Recid,@POID,@ComponentId,@Office_Ship,@SpareId)



		FETCH NEXT FROM CS_ITEMS INTO @REQQTY,@SpareId,@ROBQTY,@UNITNAME,@SPARENAME,@PartNo,@ComponentId,@Office_Ship,@Maker,@MakerType,@Specification,@DrawingNo

	END

	CLOSE CS_ITEMS

	DEALLOCATE CS_ITEMS



	-------------------------------------------------------------------------------					

	

	UPDATE [dbo].[MP_VSL_SparesReqMaster] SET [Status] = ''T'', [TransferedBy]=@TransferedBy,[TransferedOn]=GetDate() WHERE [VesselCode] = @VesselCode  AND SpareReqId=@SpareReqId



END

END





' 
END
GO
/****** Object:  StoredProcedure [dbo].[TRANSFTER_TO_POS_StoreReq]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TRANSFTER_TO_POS_StoreReq]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

-- exec DBO.TRANSFTER_TO_POS ''AGE'',4
CREATE PROCEDURE [dbo].[TRANSFTER_TO_POS_StoreReq]
(
	@VesselCode CHAR(3),
	@StoreReqId INT,
	@TransferedBy INT
)
AS
BEGIN

--IF NOT EXISTS (SELECT Poid FROM [MTMPOS].[dbo].Add_tblSMDPOMaster WHERE ShipStoreReqId = @StoreReqId)
IF NOT EXISTS (SELECT REQNO FROM MTMPOS.DBO.Add_tblSMDPOMaster WHERE REQNO IN (SELECT ReqnNo FROM MP_VSL_StoreReqMaster WHERE VesselCode=@VesselCode AND ShipStoreReqId=@StoreReqId))
BEGIN

	DECLARE @NWCSHIPID CHAR(3)	
	SET @NWCSHIPID=@VesselCode 
	-- ========== ++++++++++ COPY MASTER DATA +++++++++++++++++++ ======================
	declare @AccountID INT
    SELECT @AccountID=AccountID FROM MTMM2000SQL.DBO.sql_tblSMDPRAccounts WHERE ACCOUNTNUMBER in (SELECT [AccountCode] FROM MP_VSL_StoreReqMaster WHERE VesselCode=@VesselCode AND StoreReqId=@StoreReqId)

	DECLARE @Dept Varchar(2)
	SELECT TOP 1 @Dept=Dept FROM MTMPOS.dbo.tblSMDDeptAccounts WHERE AccountID = @AccountID AND PRType = 1


	DECLARE @PRNum int
	SELECT @PRNum = isnull(max(PRNum),5000)+1 from [MTMM2000SQL].[dbo].[tblSMDPOMaster] where shipid=@NWCSHIPID

	INSERT INTO [MTMM2000SQL].[dbo].[tblSMDPOMaster]
			   (
			   PODate, 
			   POCreator,
			   ShipID, 
			   InvoiceReceived,
			   InvoicePosted, 
			   LocalMasterID, 
			   Locked, 
			   DateCreated,
			   PoComments, 
			   POCommentsVen,
			   StatusID, 
			   StatusDate, 
			   HighPriority,
			   OrigPOID,
			   CopyEquip, 
			   Dept, 
			   PRType,
			   PRNum, 
			   VerNo, 
			   AccountID, 
			   LandedRepairs, 
			   LandedStorage, 
			   isClosed,
			   MultiVess
	)

	SELECT GETDATE(),UPDATEDBY,@NWCSHIPID,0,0,0,0,GETDATE(),REMARKS,'''',0,GETDATE(),0,0,0,@Dept,1,@PRNum,0,@AccountID,0,0,0,0 FROM 
	MP_VSL_StoreReqMaster WHERE VesselCode=@VesselCode AND StoreReqId=@StoreReqId

	---------- =============== ++++++++++++++++++++++++++++++++ Insert data in MTMPOS database for added fields

	DECLARE @POID as int
	SELECT @POID=SCOPE_IDENTITY()
	INSERT INTO [MTMPOS].[dbo].Add_tblSMDPOMaster
	(
	Poid,
	ReqNo,
	ReceivedFrom,
	RemarksSMD,
	Port ,
    ETA ,
    ReceivedDate,
	ShipStoreReqId
	)
	SELECT @POID,ReqnNo,0,REMARKS,Port,ETA,GETDATE(),@StoreReqId FROM MP_VSL_StoreReqMaster WHERE VesselCode=@VesselCode AND StoreReqId=@StoreReqId

	---------- =============== ++++++++++++++++++++++++++++++++

	declare @EventID as bigint
	SELECT @EventID=isnull(max(ActionId),0)+1 from [MTMPOS].[dbo].tblEventHistory
	insert into [MTMPOS].[dbo].tblEventHistory
	(
	ActionId,
	RefKey,
	Status,
	Descr,
	EventDate
	)

	SELECT @EventID,@POID,0,REMARKS,GETDATE() FROM MP_VSL_StoreReqMaster WHERE VesselCode=@VesselCode AND StoreReqId=@StoreReqId
	-------------
	SELECT @POID

	-- ========== ++++++++++ COPY DETAILS DATA +++++++++++++++++++ ======================

	DECLARE @QTY FLOAT
	DECLARE @ITEMID BIGINT	
	DECLARE @ROB FLOAT
	DECLARE @RecID BIGINT	
	DECLARE @SUPPLYUNITID INT
	DECLARE @IMPACODE VARCHAR(50)	
	DECLARE @UNITNAME VARCHAR(50)
	DECLARE @ITEMNAME VARCHAR(50)
	DECLARE @Description VARCHAR(1000)		
	SET @QTY =0
	SET @ITEMID =0
	SET @ROB =0
	SET @SUPPLYUNITID =0
	SET @IMPACODE =''''

	-- ========== ++++++++++ COPY PRODUCTS DATA +++++++++++++++++++ ======================

	DECLARE CS_ITEMS CURSOR FOR SELECT QTY,SRD.ItemId,ROB,ItemName,[Description],[ISSA_IMPA],[UOM] FROM MP_VSL_StoreReqDetails SRD 
	INNER JOIN MP_VSL_StoreItemMaster SIM ON SRD.VesselCode=SIM.VesselCode AND SRD.ItemId = SIM.ItemId
	WHERE SRD.VesselCode=@VesselCode AND SRD.StoreReqId=@StoreReqId

	OPEN CS_ITEMS
	FETCH NEXT FROM CS_ITEMS INTO @QTY,@ITEMID,@ROB,@ITEMNAME,@Description,@IMPACODE,@UNITNAME
	WHILE(@@FETCH_STATUS=0)
	BEGIN
		SET @RecID=0	
		INSERT INTO [MTMM2000SQL].[dbo].[tblSMDPODetail]
		(       
			[POID]
			,[Qty]
			,[Description]
			,[AccountID]
			,[UOM]
			,[PartNo]
			,[HasEquip]
			,[PRID]
			,[QtyOB]
		)
		VALUES
		(
			@POID,
			@QTY,
			@ITEMNAME + '' '' + @Description,
			@AccountID,
			@UNITNAME,
			@IMPACODE,
			0,
			0,
			@ROB
		)

		---- Insert data in MTMPOS database for added fields

		SELECT @RecID=SCOPE_IDENTITY()
		insert into [MTMPOS].[dbo].Add_tblSMDPODetail(Recid,POID,StoreItemId) values(@Recid,@POID,@ITEMID)
		FETCH NEXT FROM CS_ITEMS INTO @QTY,@ITEMID,@ROB,@ITEMNAME,@Description,@IMPACODE,@UNITNAME
	END
	CLOSE CS_ITEMS
	DEALLOCATE CS_ITEMS

	-------------------------------------------------------------------------------	
	UPDATE [dbo].MP_VSL_StoreReqMaster SET [Status] = ''T'', [TransferedBy]=@TransferedBy,[TransferedOn]=GetDate() WHERE [VesselCode] = @VesselCode  AND StoreReqId=@StoreReqId

END

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[UPDATE_NEXTDUE_BYCOMPONENTID]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UPDATE_NEXTDUE_BYCOMPONENTID]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROC [dbo].[UPDATE_NEXTDUE_BYCOMPONENTID]
(
@VesselCode CHAR(3),
@ComponentId INT,	
@StartupHour INT,
@AvgRunningHrPerDay INT,
@StartDate SMALLDATETIME,
@UpdatedBy INT
)
AS
BEGIN
	---------------------------------
	IF (DBO.GETDATEPART(@StartDate)=DBO.GETDATEPART(GETDATE()))
	BEGIN
		DECLARE CS CURSOR FOR 
		SELECT * FROM 
		(
			SELECT COMPJOBID,NEXTDUEDATE,( VCJU.LASTHOUR + dbo.getInterval(VCJU.VesselCode,VCJU.ComponentId,VCJU.COMPJOBID)) AS NEXTHOUR,LASTDONE 
			FROM dbo.VSL_VesselComponentJobMaster_Updates VCJU
			WHERE 
			VCJU.VesselCode=@VesselCode 
			AND VCJU.ComponentId=@ComponentId
			AND VCJU.COMPJOBID IN (SELECT VCJM.compjobid FROM dbo.VSL_VesselComponentJobMaster VCJM WHERE VCJM.VesselCode=@VesselCode AND VCJM.Intervalid=1)
			-- AND VCJU.NEXTHOUR > @StartupHour
		) DUMMY -- WHERE NEXTHOUR > @StartupHour
	END
	ELSE
	BEGIN
		DECLARE CS CURSOR FOR 
		SELECT * FROM 
		(
			SELECT COMPJOBID,NEXTDUEDATE,( VCJU.LASTHOUR + dbo.getInterval(VCJU.VesselCode,VCJU.ComponentId,VCJU.COMPJOBID)) AS NEXTHOUR,LASTDONE 
			FROM dbo.VSL_VesselComponentJobMaster_Updates VCJU
			WHERE 
			VCJU.VesselCode=@VesselCode 
			AND VCJU.ComponentId=@ComponentId
			AND VCJU.COMPJOBID IN (SELECT VCJM.compjobid FROM dbo.VSL_VesselComponentJobMaster VCJM WHERE VCJM.VesselCode=@VesselCode AND VCJM.Intervalid=1)
			-- AND VCJU.NEXTHOUR > @StartupHour
		) DUMMY WHERE NEXTHOUR > @StartupHour
	END
	
	----------------------------------
	DECLARE @NEWDUEDATE SMALLDATETIME
	DECLARE @NEWDUEDATE_CALC SMALLDATETIME
	DECLARE @NEWDUEDATE_CALC_H SMALLDATETIME

	DECLARE @COMPJOBID INT
	DECLARE @NEXTDUEDATE SMALLDATETIME
	DECLARE @DONEDATE SMALLDATETIME
	DECLARE @NEXTDUEHOURS INT
	
	DECLARE @AVGHRPDAY FLOAT
	DECLARE @INTERVAL FLOAT
	
	DECLARE @H_INTTYPE INT
	DECLARE @H_INTERVAL FLOAT

	OPEN CS
	FETCH NEXT FROM CS INTO @COMPJOBID,@NEXTDUEDATE,@NEXTDUEHOURS,@DONEDATE
	WHILE(@@FETCH_STATUS=0)
	BEGIN
		-- IF THERE IS NOT ANY HISTORY AFTER FILLING RUNNING HOURS THEN UPDATE NEXT DUE FOR THAT COMPJOB
		IF NOT EXISTS(SELECT HISTORYID FROM VSL_VesselJobUpdateHistory WHERE VESSELCODE=@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID AND [ACTION]=''R'' AND DBO.GETDATEPART(DONEDATE) > @StartDate)
		BEGIN
			SET @NEWDUEDATE = NULL
			SET @NEWDUEDATE_CALC = NULL
			SET @NEWDUEDATE_CALC_H = NULL

			SET @AVGHRPDAY=0
			SET @INTERVAL=0
			SET @H_INTTYPE=0
			SET @H_INTERVAL=0

			SELECT TOP 1 @AVGHRPDAY=AvgRunningHrPerDay FROM VSL_VesselRunningHourMaster WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId ORDER BY UpdatedOn Desc
			IF @AVGHRPDAY>0
			BEGIN
				SELECT @INTERVAL=INTERVAL,@H_INTERVAL=INTERVAL_H,@H_INTTYPE=INTERVALID_H FROM VSL_VesselComponentJobMaster WHERE VESSELCODE=@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
				IF @H_INTTYPE=0 -- IF OR CONDITION IS NOT ENTERED
				BEGIN
					SET @NEWDUEDATE_CALC=DATEADD(day,CEILING((@NEXTDUEHOURS-@StartupHour)/@AVGHRPDAY),@StartDate)
					UPDATE dbo.VSL_PlanMaster SET NEXTDUEHOURS=@NEXTDUEHOURS,NEXTDUEDATE=@NEWDUEDATE_CALC,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
					UPDATE dbo.VSL_VesselComponentJobMaster_Updates SET NEXTHOUR=@NEXTDUEHOURS,NEXTDUEDATE=@NEWDUEDATE_CALC,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
				END
				ELSE
				BEGIN
					SET @NEWDUEDATE_CALC=DATEADD(day,CEILING((@NEXTDUEHOURS-@StartupHour)/@AVGHRPDAY),@StartDate)
					SET @NEWDUEDATE_CALC_H=
						CASE WHEN @H_INTTYPE=2 THEN DATEADD(day,@H_INTERVAL,@DONEDATE)
							 WHEN @H_INTTYPE=3 THEN DATEADD(day,@H_INTERVAL * 7,@DONEDATE)
							 WHEN @H_INTTYPE=4 THEN DATEADD(month,@H_INTERVAL,@DONEDATE)
							 WHEN @H_INTTYPE=5 THEN DATEADD(year,@H_INTERVAL,@DONEDATE)
						ELSE @NEXTDUEDATE END
					IF @NEWDUEDATE_CALC < @NEWDUEDATE_CALC_H
					BEGIN
						UPDATE dbo.VSL_PlanMaster SET NEXTDUEHOURS=@NEXTDUEHOURS,NEXTDUEDATE=@NEWDUEDATE_CALC,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
						UPDATE dbo.VSL_VesselComponentJobMaster_Updates SET NEXTHOUR=@NEXTDUEHOURS,NEXTDUEDATE=@NEWDUEDATE_CALC,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
					END
					ELSE
					BEGIN
						UPDATE dbo.VSL_PlanMaster SET NEXTDUEHOURS=@NEXTDUEHOURS,NEXTDUEDATE=@NEWDUEDATE_CALC_H,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
						UPDATE dbo.VSL_VesselComponentJobMaster_Updates SET NEXTHOUR=@NEXTDUEHOURS,NEXTDUEDATE=@NEWDUEDATE_CALC_H,Updated=1,UpdatedOn=getdate() WHERE VesselCode =@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID
					END
				END
			END 
		END
	FETCH NEXT FROM CS INTO @COMPJOBID,@NEXTDUEDATE,@NEXTDUEHOURS,@DONEDATE
	END
	CLOSE CS
	DEALLOCATE CS
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[UpdateRunningHrs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdateRunningHrs]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'  
  
  
CREATE PROC [dbo].[UpdateRunningHrs]  
(  
@VSLID CHAR(3),  
@COMPCODE VARCHAR(12),  
@OLDHRS int,  
@HRS int,  
@UpdatedBy int  
)  
AS  
BEGIN  
 DECLARE @ComponentId BIGINT  
 DECLARE @AvgRunningHrPerDay BIGINT  
 DECLARE @StartDate SMALLDATETIME  
 DECLARE @UPDATEDON SMALLDATETIME  
 ----------------------------  
 DECLARE CS_PARENT CURSOR FOR   
 SELECT CM.ComponentId FROM COMPONENTMASTER CM   
 INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''  
 INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1  
 ----------------------------  
 SELECT TOP 1 @UPDATEDON=dbo.getDatePart(UpdatedOn) FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE=@VSLID   
 AND ComponentId IN   
 (   
  SELECT CM.ComponentId FROM COMPONENTMASTER CM   
  INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''  
  INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1  
 )  
 ----------------------------  
 ORDER BY STARTDATE DESC,STARTUPHOUR DESC  
 OPEN CS_PARENT  
 FETCH NEXT FROM CS_PARENT INTO @ComponentId  
 WHILE(@@FETCH_STATUS=0)  
 BEGIN  
    
  ----------------------------  
  SELECT TOP 1 @AvgRunningHrPerDay=AvgRunningHrPerDay,@StartDate=StartDate FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE=@VSLID   
  AND ComponentId=@ComponentId  
  ORDER BY STARTDATE DESC,STARTUPHOUR DESC  
  ----------------------------  
  UPDATE dbo.VSL_VesselRunningHourMaster  
  SET STARTUPHOUR=@HRS  
  WHERE   
  VESSELCODE=@VSLID   
  AND ComponentId=@ComponentId  
  AND STARTUPHOUR=@OLDHRS AND dbo.getDatePart(UPDATEDON)=@UPDATEDON  
  --------------------   
  EXEC DBO.UPDATE_NEXTDUE_BYCOMPONENTID @VSLID,@ComponentId,@HRS,@AvgRunningHrPerDay,@StartDate,@UpdatedBy  
  --------------------    
 FETCH NEXT FROM CS_PARENT INTO @ComponentId    
 END  
 CLOSE CS_PARENT  
 DEALLOCATE CS_PARENT  
   
END  
  
  
  ' 
END
GO
/****** Object:  StoredProcedure [dbo].[VerifyJobHistory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VerifyJobHistory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[VerifyJobHistory]
	@VesselCode char(3),
	@HistoryId Int,
	@VerifiedBy varchar(50)
AS
BEGIN
	UPDATE	dbo.VSL_VesselJobUpdateHistory
	SET 
	VERIFIED=1,
	VERIFIEDBY=@VerifiedBy,
	VERIFIEDON=GETDATE(),
	Updated=1,
	UpdatedOn=GETDATE()
	WHERE VESSELCODE=@VesselCode AND HistoryId=@HistoryId
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[VIQ_OFFICE_IMPORT_VIQDetailsRanks]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_OFFICE_IMPORT_VIQDetailsRanks]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[VIQ_OFFICE_IMPORT_VIQDetailsRanks]
(
@VESSELCODE char(3),
@VIQID bigint,
@QUESTIONID int,
@RANKID int,
@NAMEDONEBY varchar(50),
@DONEDATE smalldatetime,
@SHIPCOMMENTS varchar(7000),
@MODIFIEDON smalldatetime,
@SHIPCLOSURESTATUS smallint,
@OfficeCommentBy varchar(100),
@OFFICECOMMENT varchar(7000),
@OFFICECOMMENTDATE smalldatetime,
@OFFICECLOSURESTATUS smallint
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM VIQ_VIQDetailsRanks WHERE VESSELCODE=@VESSELCODE AND VIQID=@VIQID AND QUESTIONID=@QUESTIONID AND RANKID=@RANKID)
	BEGIN
		INSERT INTO VIQ_VIQDetailsRanks
		(
		VESSELCODE ,
		VIQID ,
		QUESTIONID ,
		RANKID ,
		NAMEDONEBY ,
		DONEDATE ,
		SHIPCOMMENTS ,
		MODIFIEDON ,
		SHIPCLOSURESTATUS ,
		OfficeCommentBy ,
		OFFICECOMMENT ,
		OFFICECOMMENTDATE ,
		OFFICECLOSURESTATUS 
		)
		Values
		(
		@VESSELCODE,
		@VIQID,
		@QUESTIONID,
		@RANKID,
		@NAMEDONEBY,
		@DONEDATE,
		@SHIPCOMMENTS,
		@MODIFIEDON,
		@SHIPCLOSURESTATUS,
		@OfficeCommentBy ,
		@OFFICECOMMENT,
		@OFFICECOMMENTDATE,
		@OFFICECLOSURESTATUS
		)
	END
	ELSE
	BEGIN
		UPDATE VIQ_VIQDetailsRanks
		SET 
		NAMEDONEBY=@NAMEDONEBY,
		DONEDATE=@DONEDATE,
		SHIPCOMMENTS=@SHIPCOMMENTS,
		MODIFIEDON=@MODIFIEDON,
		SHIPCLOSURESTATUS=@SHIPCLOSURESTATUS
		WHERE VESSELCODE=@VESSELCODE AND VIQID=@VIQID AND QUESTIONID=@QUESTIONID AND RANKID=@RANKID
	END
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[VIQ_OFFICE_IMPORT_VIQDetailsRanksAttachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_OFFICE_IMPORT_VIQDetailsRanksAttachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROC [dbo].[VIQ_OFFICE_IMPORT_VIQDetailsRanksAttachments]
(
@VESSELCODE CHAR(3),
@VIQID BIGINT,
@QUESTIONID INT,
@RANKID INT,
@ATTACHMENTID INT,
@DESCRIPTION VARCHAR(7000),
@FILENAME VARCHAR(100),
@MODIFIEDON SMALLDATETIME
)
as
begin
	INSERT INTO VIQ_VIQDetailsRanksAttachments
	(VesselCode,VIQId,QuestionId,RankId,AttachmentId,Description,FileName,ModifiedOn) 
	VALUES(@VESSELCODE,@VIQID,@QUESTIONID,@RANKID,@ATTACHMENTID,@DESCRIPTION,@FILENAME,@MODIFIEDON)
end' 
END
GO
/****** Object:  StoredProcedure [dbo].[VIQ_OFFICE_IMPORT_VIQMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_OFFICE_IMPORT_VIQMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[VIQ_OFFICE_IMPORT_VIQMaster]
(
@VESSELCODE varchar(3),
@VIQID bigint,
@PVIQId bigint,
@VIQNO varchar(50),
@INSPGROUPID int,
@TARGETDATE smalldatetime,
@VIQSTATUS smallint,
@CREATEDON smalldatetime,
@SHIPRECDDATE smalldatetime,
@MailSent smallint,
@MailSentOn smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM VIQ_VIQMaster WHERE VESSELCODE=@VESSELCODE AND VIQID=@VIQID)
	BEGIN
		INSERT INTO VIQ_VIQMaster
		(
		VESSELCODE ,
		VIQID ,
		PVIQId ,
		VIQNO ,
		INSPGROUPID ,
		TARGETDATE ,
		VIQSTATUS ,
		CREATEDON ,
		SHIPRECDDATE ,
		MailSent ,
		MailSentOn
		)
		Values
		(
		@VESSELCODE,
		@VIQID,
		@PVIQId,
		@VIQNO,
		@INSPGROUPID,
		@TARGETDATE,
		@VIQSTATUS,
		@CREATEDON,
		@SHIPRECDDATE,
		@MailSent ,
		@MailSentOn
		)
	END
	ELSE
	BEGIN
		UPDATE VIQ_VIQMaster
		SET 
		SHIPRECDDATE=@SHIPRECDDATE
		WHERE VESSELCODE=@VESSELCODE AND VIQID=@VIQID
	END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[VIQ_OFFICE_InsertUpdateOffficeComments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_OFFICE_InsertUpdateOffficeComments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE proc [dbo].[VIQ_OFFICE_InsertUpdateOffficeComments]
(
	@VESSELCODE CHAR(3),
	@VIQId BIGINT,
	@QUESTIONID BIGINT,
	@RANKID INT,
	@USERNAME VARCHAR(50),
	@DONEDATE SMALLDATETIME,
	@OFFICECOMMENTS VARCHAR(7000),
	@OfficeClosureStatus INT
)
AS
BEGIN

DECLARE @PVIQID BIGINT
SELECT @PVIQID=ISNULL(PVIQID,0) FROM VIQ_VIQMASTER WHERE VIQID=@VIQId

IF (@PVIQID<=0)
BEGIN
	UPDATE VIQ_VIQDetailsRanks SET OFFICECOMMENTBY=@USERNAME,OFFICECOMMENTDATE=@DONEDATE,OFFICECOMMENT=@OFFICECOMMENTS,OfficeClosureStatus=@OfficeClosureStatus
	WHERE VESSELCODE=@VESSELCODE AND QUESTIONID=@QUESTIONID AND RANKID=@RANKID AND ( VIQId=@VIQId OR ( VIQID IN (SELECT M.VIQId FROM VIQ_VIQMASTER M WHERE M.VESSELCODE=@VESSELCODE AND M.PVIQID=@VIQId) AND OFFICECOMMENTDATE IS NULL )) 
END
ELSE
BEGIN
	UPDATE VIQ_VIQDetailsRanks SET OFFICECOMMENTBY=@USERNAME,OFFICECOMMENTDATE=@DONEDATE,OFFICECOMMENT=@OFFICECOMMENTS,OfficeClosureStatus=@OfficeClosureStatus
	WHERE VESSELCODE=@VESSELCODE AND QUESTIONID=@QUESTIONID AND RANKID=@RANKID AND ( VIQID=@VIQId OR (( VIQId=@PVIQID OR VIQID IN (SELECT M.VIQId FROM VIQ_VIQMASTER M WHERE M.VESSELCODE=@VESSELCODE AND M.PVIQID=@PVIQID)) AND OFFICECOMMENTDATE IS NULL ) ) 
END

END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[VIQ_VSL_IMPORT_VIQDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VSL_IMPORT_VIQDetails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[VIQ_VSL_IMPORT_VIQDetails]
(
@VESSELCODE char(3),
@VIQID bigint,
@QUESTIONID int,
@SORTORDER int,
@RiskScore VARCHAR(50),
@ObsCount Int,
@CHAPTERID int,
@CHAPTERNO varchar(50),
@CHAPTERNAME varchar(100),
@VERSIONNAME varchar(50),
@QUESTIONNO varchar(50),
@QUESTION varchar(7000),
@GUIDANCE varchar(7000),
@PREVETTING smallint,
@OFFICEREMARKS varchar(7000)
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM VIQ_VIQDetails WHERE VESSELCODE=@VESSELCODE AND VIQID=@VIQID AND QUESTIONID=@QUESTIONID)
	BEGIN
		INSERT INTO VIQ_VIQDetails
		(
		VESSELCODE ,
		VIQID ,
		QUESTIONID ,
		SORTORDER ,
		RiskScore ,
		ObsCount ,
		CHAPTERID ,
		CHAPTERNO ,
		CHAPTERNAME ,
		VERSIONNAME ,
		QUESTIONNO ,
		QUESTION ,
		GUIDANCE ,
		PREVETTING ,
		OFFICEREMARKS 
		)
		Values
		(
		@VESSELCODE,
		@VIQID,
		@QUESTIONID,
		@SORTORDER,
		@RiskScore,
		@ObsCount ,
		@CHAPTERID,
		@CHAPTERNO,
		@CHAPTERNAME,
		@VERSIONNAME,
		@QUESTIONNO,
		@QUESTION,
		@GUIDANCE,
		@PREVETTING,
		@OFFICEREMARKS
		)
	END
	ELSE
	BEGIN
		UPDATE VIQ_VIQDetails
		SET 
		SORTORDER=@SORTORDER,
		RiskScore=@RiskScore,
		ObsCount=@ObsCount,
		CHAPTERID=@CHAPTERID,
		CHAPTERNO=@CHAPTERNO,
		CHAPTERNAME=@CHAPTERNAME,
		VERSIONNAME=@VERSIONNAME,
		QUESTIONNO=@QUESTIONNO,
		QUESTION=@QUESTION,
		GUIDANCE=@GUIDANCE,
		PREVETTING=@PREVETTING,
		OFFICEREMARKS=@OFFICEREMARKS
		WHERE VESSELCODE=@VESSELCODE AND VIQID=@VIQID AND QUESTIONID=@QUESTIONID
	END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[VIQ_VSL_IMPORT_VIQDetailsRanks]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VSL_IMPORT_VIQDetailsRanks]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[VIQ_VSL_IMPORT_VIQDetailsRanks]
(
@VESSELCODE char(3),
@VIQID bigint,
@QUESTIONID int,
@RANKID int,
@NAMEDONEBY varchar(50),
@DONEDATE smalldatetime,
@SHIPCOMMENTS varchar(7000),
@MODIFIEDON smalldatetime,
@SHIPCLOSURESTATUS smallint,
@OfficeCommentBy varchar(100),
@OFFICECOMMENT varchar(7000),
@OFFICECOMMENTDATE smalldatetime,
@OFFICECLOSURESTATUS smallint
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM VIQ_VIQDetailsRanks WHERE VESSELCODE=@VESSELCODE AND VIQID=@VIQID AND QUESTIONID=@QUESTIONID AND RANKID=@RANKID)
	BEGIN
		INSERT INTO VIQ_VIQDetailsRanks
		(
		VESSELCODE ,
		VIQID ,
		QUESTIONID ,
		RANKID ,
		NAMEDONEBY ,
		DONEDATE ,
		SHIPCOMMENTS ,
		MODIFIEDON ,
		SHIPCLOSURESTATUS ,
		OfficeCommentBy ,
		OFFICECOMMENT ,
		OFFICECOMMENTDATE ,
		OFFICECLOSURESTATUS 
		)
		Values
		(
		@VESSELCODE,
		@VIQID,
		@QUESTIONID,
		@RANKID,
		@NAMEDONEBY,
		@DONEDATE,
		@SHIPCOMMENTS,
		@MODIFIEDON,
		@SHIPCLOSURESTATUS,
		@OfficeCommentBy ,
		@OFFICECOMMENT,
		@OFFICECOMMENTDATE,
		@OFFICECLOSURESTATUS
		)
	END
	ELSE
	BEGIN
		UPDATE VIQ_VIQDetailsRanks
		SET 
		OfficeCommentBy=@OfficeCommentBy,
		OFFICECOMMENT=@OFFICECOMMENT,
		OFFICECOMMENTDATE=@OFFICECOMMENTDATE,
		OFFICECLOSURESTATUS=@OFFICECLOSURESTATUS
		WHERE VESSELCODE=@VESSELCODE AND VIQID=@VIQID AND QUESTIONID=@QUESTIONID AND RANKID=@RANKID
	END
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[VIQ_VSL_IMPORT_VIQDetailsRanks_Inv]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VSL_IMPORT_VIQDetailsRanks_Inv]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[VIQ_VSL_IMPORT_VIQDetailsRanks_Inv]
(
@VESSELCODE char(3),
@VIQID bigint,
@QUESTIONID int,
@RANKID int
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM VIQ_VIQDetailsRanks_Inv WHERE VESSELCODE=@VESSELCODE AND VIQID=@VIQID AND QUESTIONID=@QUESTIONID AND RANKID=@RANKID)
	BEGIN
		INSERT INTO VIQ_VIQDetailsRanks_Inv
		(
		VESSELCODE ,
		VIQID ,
		QUESTIONID ,
		RANKID 
		)
		Values
		(
		@VESSELCODE,
		@VIQID,
		@QUESTIONID,
		@RANKID
		)
	END
	ELSE
	BEGIN
		UPDATE VIQ_VIQDetailsRanks_Inv
		SET RANKID=@RANKID
		WHERE VESSELCODE=@VESSELCODE AND VIQID=@VIQID AND QUESTIONID=@QUESTIONID AND RANKID=@RANKID
	END
END
' 
END
GO
/****** Object:  StoredProcedure [dbo].[VIQ_VSL_IMPORT_VIQDetailsRanksAttachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VSL_IMPORT_VIQDetailsRanksAttachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROC [dbo].[VIQ_VSL_IMPORT_VIQDetailsRanksAttachments]
(
@VSLCODE CHAR(3),
@VIQID BIGINT,
@QUESTIONID INT,
@RANKID INT,
@DESCR VARCHAR(7000),
@FILENAME VARCHAR(100)
)
as
begin
	DECLARE @ATTID BIGINT
	SELECT @ATTID=ISNULL(MAX(AttachmentId),0)+1 FROM VIQ_VIQDetailsRanksAttachments WHERE VESSELCODE=@VSLCODE AND VIQID=@VIQID AND QUESTIONID=@QUESTIONID AND RANKID=@RANKID
	INSERT INTO VIQ_VIQDetailsRanksAttachments(VesselCode,VIQId,QuestionId,RankId,AttachmentId,Description,FileName,ModifiedOn) 
	VALUES(@VSLCODE,@VIQID,@QUESTIONID,@RANKID,@ATTID,@DESCR,@FILENAME,GETDATE())
end' 
END
GO
/****** Object:  StoredProcedure [dbo].[VIQ_VSL_IMPORT_VIQMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VSL_IMPORT_VIQMaster]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[VIQ_VSL_IMPORT_VIQMaster]
(
@VESSELCODE varchar(3),
@VIQID bigint,
@PVIQId bigint,
@VIQNO varchar(50),
@VIQType INT,
@INSPGROUPID int,
@TARGETDATE smalldatetime,
@VIQSTATUS smallint,
@CREATEDON smalldatetime,
@SHIPRECDDATE smalldatetime,
@MailSent smallint,
@MailSentOn smalldatetime
)
AS
BEGIN
SET NOCOUNT ON
	IF NOT EXISTS(SELECT * FROM VIQ_VIQMaster WHERE VESSELCODE=@VESSELCODE AND VIQID=@VIQID)
	BEGIN
		INSERT INTO VIQ_VIQMaster
		(
		VESSELCODE ,
		VIQID ,
		PVIQId ,
		VIQNO ,
		VIQType,
		INSPGROUPID ,
		TARGETDATE ,
		VIQSTATUS ,
		CREATEDON ,
		SHIPRECDDATE ,
		MailSent,
		MailSentOn
		)
		Values
		(
		@VESSELCODE,
		@VIQID,
		@PVIQId,
		@VIQNO,
		@VIQType,
		@INSPGROUPID,
		@TARGETDATE,
		@VIQSTATUS,
		@CREATEDON,
		GETDATE(),
		@MailSent ,
		@MailSentOn
		)
	END
	ELSE
	BEGIN
		UPDATE VIQ_VIQMaster
		SET 
		VIQNO=@VIQNO,
		VIQType=@VIQType,
		INSPGROUPID=@INSPGROUPID,
		TARGETDATE=@TARGETDATE,
		VIQSTATUS=@VIQSTATUS,
		MailSent=@MailSent,
		MailSentOn=@MailSentOn
		WHERE VESSELCODE=@VESSELCODE AND VIQID=@VIQID
	END
END

' 
END
GO
/****** Object:  StoredProcedure [dbo].[VIQ_VSL_InsertUpdateShipComments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VSL_InsertUpdateShipComments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE proc [dbo].[VIQ_VSL_InsertUpdateShipComments]
(
	@VESSELCODE CHAR(3),
	@VIQId BIGINT,
	@QUESTIONID BIGINT,
	@RANKID INT,
	@USERNAME VARCHAR(50),
	@DONEDATE SMALLDATETIME,
	@SHIPCOMMENTS VARCHAR(7000),
	@ShipClosureStatus INT
)
AS
BEGIN

DECLARE @PVIQID BIGINT
SELECT @PVIQID=ISNULL(PVIQID,0) FROM VIQ_VIQMASTER WHERE VIQID=@VIQId

IF (@PVIQID<=0)
BEGIN
	UPDATE VIQ_VIQDetailsRanks SET NAMEDONEBY=@USERNAME,DONEDATE=@DONEDATE,SHIPCOMMENTS=@SHIPCOMMENTS,ModifiedOn=getdate(),ShipClosureStatus=@ShipClosureStatus
	WHERE VESSELCODE=@VESSELCODE AND QUESTIONID=@QUESTIONID AND RANKID=@RANKID AND ( VIQId=@VIQId OR ( VIQID IN (SELECT M.VIQId FROM VIQ_VIQMASTER M WHERE M.VESSELCODE=@VESSELCODE AND M.PVIQID=@VIQId) AND DONEDATE IS NULL )) 
END
ELSE
BEGIN
	UPDATE VIQ_VIQDetailsRanks 	SET NAMEDONEBY=@USERNAME,DONEDATE=@DONEDATE,SHIPCOMMENTS=@SHIPCOMMENTS,ModifiedOn=getdate(),ShipClosureStatus=@ShipClosureStatus
	WHERE VESSELCODE=@VESSELCODE AND QUESTIONID=@QUESTIONID AND RANKID=@RANKID AND ( VIQID=@VIQId OR (( VIQId=@PVIQID OR VIQID IN (SELECT M.VIQId FROM VIQ_VIQMASTER M WHERE M.VESSELCODE=@VESSELCODE AND M.PVIQID=@PVIQID)) AND DONEDATE IS NULL ) ) 
END
END' 
END
GO
/****** Object:  StoredProcedure [dbo].[VSL_VPR_GET_FUEL_ROB]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPR_GET_FUEL_ROB]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



CREATE PROC [dbo].[VSL_VPR_GET_FUEL_ROB]
(
	@VESSELID VARCHAR(3),
	@BEF_ReportsPK BIGINT
)
AS
BEGIN
IF(@BEF_ReportsPK=0)
BEGIN
	SET @BEF_ReportsPK=99999999999999
END

SELECT TOP 1 
ROBIFO45,
ROBIFO1,
ROBMGO5,
ROBMGO1,
ROBMDO,
ROBMECC,
ROBMECYL,
ROBAECC,
ROBHYD,
ROBFesshWater FROM VW_VSL_VPR_ALLREPORTS WHERE VESSELID=@VESSELID AND ReportsPK<@BEF_ReportsPK  ORDER BY ReportsPK DESC

END



' 
END
GO
/****** Object:  UserDefinedFunction [dbo].[CSVtoTable]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CSVtoTable]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'-- =============================================
-- Author:		<Pankaj K. Verma>
-- Create date: <05-Apr-2011>
-- Description:	<Convert CSV to Table>
-- =============================================
create FUNCTION [dbo].[CSVtoTable]
(
	@LIST varchar(7000),
	@Delimeter varchar(10)
)
RETURNS @RET1 TABLE (RESULT BIGINT)
AS
BEGIN
	DECLARE @RET TABLE(RESULT BIGINT)
	
	IF LTRIM(RTRIM(@LIST))='''' RETURN  

	DECLARE @START BIGINT
	DECLARE @LASTSTART BIGINT
	SET @LASTSTART=0
	SET @START=CHARINDEX(@Delimeter,@LIST,0)

	IF @START=0
	INSERT INTO @RET VALUES(SUBSTRING(@LIST,0,LEN(@LIST)+1))

	WHILE(@START >0)
	BEGIN
		INSERT INTO @RET VALUES(SUBSTRING(@LIST,@LASTSTART,@START-@LASTSTART))
		SET @LASTSTART=@START+1
		SET @START=CHARINDEX(@Delimeter,@LIST,@START+1)
		IF(@START=0)
		INSERT INTO @RET VALUES(SUBSTRING(@LIST,@LASTSTART,LEN(@LIST)+1))
	END
	
	INSERT INTO @RET1 SELECT * FROM @RET
	RETURN 
END








' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[CSVtoTable2]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CSVtoTable2]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
-- =============================================
-- Author:		<Pankaj K. Verma>
-- Create date: <05-Apr-2011>
-- Description:	<Convert CSV to Table>
-- =============================================
CREATE FUNCTION [dbo].[CSVtoTable2]
(
	@LIST varchar(7000),
	@LIST1 varchar(7000),
	@Delimeter varchar(10)
)
RETURNS @RET1 TABLE (RESULT BIGINT,RESULT1 BIGINT)
AS
BEGIN
	DECLARE @RET TABLE(RESULT BIGINT,RESULT1 BIGINT)
	
	IF LTRIM(RTRIM(@LIST))='''' RETURN  

	DECLARE @START BIGINT
	DECLARE @LASTSTART BIGINT
	SET @LASTSTART=0

	DECLARE @START1 BIGINT
	DECLARE @LASTSTART1 BIGINT
	SET @LASTSTART1=0

	SET @START=CHARINDEX(@Delimeter,@LIST,0)
	SET @START1=CHARINDEX(@Delimeter,@LIST1,0)

	IF @START=0
	INSERT INTO @RET VALUES(SUBSTRING(@LIST,0,LEN(@LIST)+1),SUBSTRING(@LIST1,0,LEN(@LIST1)+1))

	WHILE(@START >0)
	BEGIN
		INSERT INTO @RET VALUES(SUBSTRING(@LIST,@LASTSTART,@START-@LASTSTART),SUBSTRING(@LIST1,@LASTSTART1,@START1-@LASTSTART1))
		SET @LASTSTART=@START+1
		SET @LASTSTART1=@START1+1

		SET @START=CHARINDEX(@Delimeter,@LIST,@START+1)
		SET @START1=CHARINDEX(@Delimeter,@LIST1,@START1+1)

		IF(@START=0)
		INSERT INTO @RET VALUES(SUBSTRING(@LIST,@LASTSTART,LEN(@LIST)+1),SUBSTRING(@LIST1,@LASTSTART1,LEN(@LIST1)+1))
	END
	
	INSERT INTO @RET1 SELECT * FROM @RET
	RETURN 
END





' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[CSVtoTableDate]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CSVtoTableDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'

-- =============================================
-- Author:		<Pankaj K. Verma>
-- Create date: <05-Apr-2011>
-- Description:	<Convert CSV to Table>
-- =============================================
CREATE FUNCTION [dbo].[CSVtoTableDate]
(
	@LIST varchar(max),
	@Delimeter varchar(10)
)
RETURNS @RET1 TABLE (RESULT DATETIME)
AS
BEGIN
	DECLARE @TMP VARCHAR(1000)
	DECLARE @RET TABLE(RESULT DATETIME)
	
	IF LTRIM(RTRIM(@LIST))='''' RETURN  

	DECLARE @START BIGINT
	DECLARE @LASTSTART BIGINT
	SET @LASTSTART=0
	SET @START=CHARINDEX(@Delimeter,@LIST,0)

	IF @START=0
	BEGIN
		SET @TMP=SUBSTRING(@LIST,0,LEN(@LIST)+1)
		IF LTRIM(RTRIM(@TMP))<>''''
			INSERT INTO @RET VALUES(@TMP)
	END

	WHILE(@START >0)
	BEGIN
		SET @TMP=SUBSTRING(@LIST,@LASTSTART,@START-@LASTSTART)
		IF LTRIM(RTRIM(@TMP))<>'''' 
			INSERT INTO @RET VALUES(@TMP)

		SET @LASTSTART=@START+1
		SET @START=CHARINDEX(@Delimeter,@LIST,@START+1)
		IF(@START=0)
		BEGIN
			SET @TMP=SUBSTRING(@LIST,@LASTSTART,LEN(@LIST)+1)
			IF LTRIM(RTRIM(@TMP))<>'''' 
				INSERT INTO @RET VALUES(@TMP)
		END
	END
	
	INSERT INTO @RET1 SELECT * FROM @RET  
	RETURN 
END










' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[CSVtoTableString]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CSVtoTableString]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'-- =============================================
-- Author:		<Pankaj K. Verma>
-- Create date: <05-Apr-2011>
-- Description:	<Convert CSV to Table>
-- =============================================
CREATE FUNCTION [dbo].[CSVtoTableString]
(
	@LIST varchar(7000),
	@Delimeter varchar(10)
)
RETURNS @RET1 TABLE (RESULT VARCHAR(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL)
AS
BEGIN
	DECLARE @RET TABLE(RESULT VARCHAR(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL)
	
	IF LTRIM(RTRIM(@LIST))='''' RETURN  

	DECLARE @START BIGINT
	DECLARE @LASTSTART BIGINT
	SET @LASTSTART=0
	SET @START=CHARINDEX(@Delimeter,@LIST,0)

	IF @START=0
	INSERT INTO @RET VALUES(SUBSTRING(@LIST,0,LEN(@LIST)+1))

	WHILE(@START >0)
	BEGIN
		INSERT INTO @RET VALUES(SUBSTRING(@LIST,@LASTSTART,@START-@LASTSTART))
		SET @LASTSTART=@START+1
		SET @START=CHARINDEX(@Delimeter,@LIST,@START+1)
		IF(@START=0)
		INSERT INTO @RET VALUES(SUBSTRING(@LIST,@LASTSTART,LEN(@LIST)+1))
	END
	
	INSERT INTO @RET1 SELECT * FROM @RET
	RETURN 
END










' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[ER_S115_getOptionTextCSV]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_getOptionTextCSV]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [dbo].[ER_S115_getOptionTextCSV]
(
@FormNo Varchar(50),
@RegisterId INT,
@OptionIds Varchar(500),
@Delimiter char(1)
)
RETURNS Varchar(MAX)
AS
BEGIN
	DECLARE @OptionText Varchar(MAX)	
	 
	SELECT @OptionText= COALESCE(@OptionText + '', '', '''') + RO.OptionText  FROM [DBO].[ER_RegisterOptions] RO 
	INNER JOIN [DBO].[ER_Registers] R ON R.[RegisterId] = RO.[RegisterId] 
	WHERE R.[FormNo]=@FormNo AND R.[RegisterId] = @RegisterId AND
	[OptionId] IN (SELECT result from dbo.CSVtoTable(@OptionIds,@Delimiter) )
	
	RETURN @OptionText
END



' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[fn_getInventoryROB]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[fn_getInventoryROB]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'create function [dbo].[fn_getInventoryROB]
(
	@VesselCode char(3),
	@ComponentId bigint,
	@Office_Ship char,
	@SpareId bigint,
	@OnDate smalldatetime
)
returns float
as
begin
	declare @rec float
	declare @cons float

	declare @rob float

	select @cons=isnull(sum(QtyCons),0) from dbo.VSL_VesselJobUpdateHistorySpareDetails Where VesselCode=@VesselCode And ComponentId=@ComponentId And Office_Ship=@Office_Ship And SpareId=@SpareId And Status=''A'' And HistoryId in(SELECT HISTORYID FROM dbo.VSL_VesselJobUpdateHistory WHERE VESSELCODE=@VesselCode AND DONEDATE<=@OnDate)
	select @cons=@cons+isnull(sum(QtyCons),0) from dbo.VSL_DefectSpareDetails Where VesselCode=@VesselCode And ComponentId=@ComponentId And Office_Ship=@Office_Ship And SpareId=@SpareId And Status=''A'' And DefectNo in(SELECT DefectNo FROM dbo.VSL_DefectDetailsMaster WHERE VESSELCODE=@VesselCode AND ReportDt<=@OnDate)
	select @cons=@cons+isnull(sum(QtyCons),0) from dbo.VSL_UnPlannedJobs_SpareDetails Where VesselCode=@VesselCode And ComponentId=@ComponentId And Office_Ship=@Office_Ship And SpareId=@SpareId And Status=''A'' And UPId in(SELECT UPId FROM dbo.VSL_UnPlannedJobs WHERE VESSELCODE=@VesselCode AND DONEDATE<=@OnDate)

	select @rec=isnull(sum(QtyRecd),0) from dbo.VSL_StockInventory WHERE  VESSELCODE=@VesselCode And ComponentId=@ComponentId And Office_Ship=@Office_Ship And SpareId=@SpareId And Status=''A'' AND RecdDate <=@OnDate
	
	set @rob=@rec-@cons

	return @rob
end
' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[Get_CircularNo]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Get_CircularNo]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [dbo].[Get_CircularNo]
(
 @CId bigint	
)
RETURNS varchar(250)
AS
BEGIN
	Declare @CircularNumber varchar(250)		
	
	IF EXISTS(SELECT CircularNumber FROM Cir_Circular WHERE CId=@CId AND ISNULL(CircularNumber,'''')<>'''')
		select @CircularNumber=CircularNumber FROM Cir_Circular WHERE CId=@CId
	ELSE
		select @CircularNumber=''CIRCULAR-'' + CONVERT(VARCHAR,YEAR(GETDATE())) + ''-'' + REPLACE(STR(ISNULL(MAX(CAST( right(CircularNumber,3) AS INT)),0)+1,3),'' '',''0'') from Cir_Circular WHERE CAST( LEFT(right(CircularNumber,8),4) AS INT)=YEAR(GETDATE())

	return @CircularNumber
END
' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getCirCategories]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getCirCategories]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'

-- SELECT dbo.getCirCategories(4)

CREATE FUNCTION [dbo].[getCirCategories] 
(
	@CirId int
)
RETURNS Varchar(MAX)
AS
BEGIN
	DECLARE @CSV VARCHAR(MAX)

	SELECT @CSV = COALESCE(@CSV + '', '', '''') + [CirCatName] from [Cir_Category] C
	INNER JOIN [Cir_Categories] CC ON CC.[CirCatId] = C.[CirCatId]
	WHERE CC.[CirId] = @CirId 
	
	RETURN @CSV

END

' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getDatePart]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getDatePart]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'create function [dbo].[getDatePart]
(
@InParam Smalldatetime
) returns smalldatetime
as
begin
	return CONVERT(SMALLDATETIME,REPLACE(CONVERT(VARCHAR(15),@InParam,106),'' '',''-''))
end' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getDueJobsForMonth]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getDueJobsForMonth]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [dbo].[getDueJobsForMonth]
(
@VESSELCODE CHAR(3),
@MNTH INT,
@YR INT
)
RETURNS INT
AS
BEGIN
DECLARE @RET INT 
--SELECT DBO.getDueJobsForMonth(6,2012)
--DECLARE @MNTH INT
--DECLARE @YR INT
--SET @MNTH=6
--SET @YR=2012
DECLARE @STDT SMALLDATETIME
SET @STDT=CONVERT(VARCHAR,@YR)+''-''+CONVERT(VARCHAR,@MNTH)+''-01''

SELECT @RET=
SUM(	CASE WHEN FREQ=0 THEN 
		CASE WHEN MONTH(NextDueDate)=@MNTH AND YEAR(@MNTH)=@YR THEN 1 ELSE 0 END
	ELSE 
		FREQ 
	END
)
FROM
(
SELECT 
VCJU.VESSELCODE,VCJU.COMPJOBID,CJM.INTERVALID,
(CASE 
WHEN CJM.INTERVALID=1 THEN 
CAST((
30/(INTERVAL / (SELECT TOP 1 CASE WHEN AVGRUNNINGHRPERDAY=0 THEN 1 ELSE AVGRUNNINGHRPERDAY END FROM VSL_VesselRunningHourMaster RH WHERE UPDATEDON<=@STDT AND RH.VESSELCODE=VCJU.VESSELCODE AND VCJU.COMPONENTID=RH.COMPONENTID ORDER BY UPDATEDON DESC))
) AS INT)
WHEN CJM.INTERVALID=2 THEN CAST((30/INTERVAL) AS INT)
WHEN CJM.INTERVALID=3 THEN CAST((30/(INTERVAL*7)) AS INT)
WHEN CJM.INTERVALID=4 THEN CAST((30/(INTERVAL*30)) AS INT)
WHEN CJM.INTERVALID=5 THEN 0
END ) AS FREQ,NextDueDate
FROM dbo.VSL_VesselComponentJobMaster_Updates VCJU
INNER JOIN VSL_VesselComponentJobMaster CJM ON VCJU.VESSELCODE=CJM.VESSELCODE AND VCJU.COMPJOBID=CJM.COMPJOBID AND CJM.STATUS=''A''
INNER JOIN VSL_ComponentMasterForVessel CMV ON VCJU.VESSELCODE=CMV.VESSELCODE AND VCJU.COMPONENTID=CMV.COMPONENTID
WHERE VCJU.VESSELCODE=@VESSELCODE
) A

RETURN @RET
END







' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getFocusCampCategories]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getFocusCampCategories]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
-- SELECT dbo.getFocusCampCategories(4)

CREATE FUNCTION [dbo].[getFocusCampCategories] 
(
	@FocusCampId int
)
RETURNS Varchar(MAX)
AS
BEGIN
	DECLARE @CSV VARCHAR(MAX)

	SELECT @CSV = COALESCE(@CSV + '', '', '''') + [FocusCampCatName] from [FocusCampCategory] LF
	INNER JOIN [FocusCamp_Categories] LC ON LC.[FocusCampCatId] = LF.[FocusCampCatId]
	WHERE LC.[FocusCampId] = @FocusCampId 
	-- SELECT @CSV AS Result
	
	-- Return the result of the function
	RETURN @CSV

END
' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getInterval]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getInterval]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'  
CREATE FUNCTION [dbo].[getInterval]  
(  
@VesselCode CHAR(3),  
@ComponentId INT,  
@COMPJOBID INT  
)  
RETURNS float  
AS  
BEGIN  
 DECLARE @INTERVAL FLOAT  
 SELECT @INTERVAL=INTERVAL FROM VSL_VesselComponentJobMaster WHERE VESSELCODE=@VesselCode AND ComponentId=@ComponentId AND COMPJOBID=@COMPJOBID  
 RETURN @INTERVAL  
END  
  ' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getInvolvedRanks]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getInvolvedRanks]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [dbo].[getInvolvedRanks] 
(
	@VesselCode char(3),
	@Qid bigint,
	@VIQId int
)
RETURNS Varchar(MAX)
AS
BEGIN
	DECLARE @CSV VARCHAR(MAX)

	SELECT @CSV = COALESCE(@CSV + '', '', '''') + RANKCODE FROM MP_ALLRANK WHERE RANKID IN (SELECT RANKID FROM [dbo].[VIQ_VIQDetailsRanks_Inv] WHERE VESSELCODE=@VesselCode AND QuestionId=@Qid AND VIQID=@VIQId)
	
	RETURN @CSV

	

END
' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[GetJobAttachmentCount]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetJobAttachmentCount]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'CREATE function [dbo].[GetJobAttachmentCount]

(
	@CompJobID bigint	
	,@VesselCode varchar(3)
	,@Mode char(1)
)
returns int
as
begin
	declare @Count int
	declare @Count1 int
	SET @Count =0;
	SET @Count1 =0;
	select @Count =count(*) from ComponentsJobMapping_attachments where CompJobID=@CompJobID and Status=''A'' 

IF (@Mode=''V'')
	select @Count1=COUNT(*) from  VesselComponentJobMaster_Attachments  WHERE VesselCode=@VesselCode and CompJobID=@CompJobID 
ELSE IF (@Mode=''S'')
	select @Count1=COUNT(*) from  VSL_VesselComponentJobMaster_Attachments  WHERE VesselCode=@VesselCode and CompJobID=@CompJobID 

return @Count + @Count1 ;

--ELSE
--BEGIN
--END

	
end



------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------




' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getLFICategories]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getLFICategories]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
-- SELECT dbo.getLFICategories(4)

CREATE FUNCTION [dbo].[getLFICategories] 
(
	@LFIId int
)
RETURNS Varchar(MAX)
AS
BEGIN
	DECLARE @CSV VARCHAR(MAX)

	SELECT @CSV = COALESCE(@CSV + '', '', '''') + [LFICatName] from [LFICategory] LF
	INNER JOIN [LFI_Categories] LC ON LC.[LFICatId] = LF.[LFICatId]
	WHERE LC.[LFIId] = @LFIId 
	-- SELECT @CSV AS Result
	
	-- Return the result of the function
	RETURN @CSV

END
' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getREGCategories]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getREGCategories]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'CREATE FUNCTION [dbo].[getREGCategories] 
(
	@RegId int
)
RETURNS Varchar(MAX)
AS
BEGIN
	DECLARE @CSV VARCHAR(MAX)

	SELECT @CSV = COALESCE(@CSV + '', '', '''', '''') + [RegCatName] from [Reg_Category] R
	INNER JOIN [Reg_Categories] RC ON RC.[RegCatId] = R.[RegCatId]
	WHERE RC.[RegId] = @RegId 
	
	RETURN @CSV

END' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getRHAsOnDate]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRHAsOnDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [dbo].[getRHAsOnDate]
(
@VSLID CHAR(3),
@COMPCODE VARCHAR(12),
@ONDATE SMALLDATETIME
)
returns SMALLDATETIME
BEGIN

DECLARE @ASONDATE SMALLDATETIME


IF(@ONDATE IS NULL)
BEGIN
	SELECT TOP 1 @ASONDATE= StartDate FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE=@VSLID 
	AND ComponentId IN 
	(	
		SELECT CM.ComponentId FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
		INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1
	)
	ORDER BY STARTDATE DESC,STARTUPHOUR DESC
END
ELSE  
BEGIN
	SELECT TOP 1 @ASONDATE= StartDate FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE=@VSLID 
	AND ComponentId IN 
	(	
		SELECT CM.ComponentId FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
		INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1
	)
	AND STARTDATE<@ONDATE ORDER BY STARTDATE DESC,STARTUPHOUR DESC
END

RETURN @ASONDATE

END

' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getROB]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getROB]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'CREATE function [dbo].[getROB]
(
	@VesselCode char(3),
	@ComponentId bigint,
	@Office_Ship char,
	@SpareId bigint,
	@OnDate smalldatetime
)
returns float
as
begin
	declare @rec float
	declare @cons float
	declare @rob float

	select @cons=isnull(sum(QtyCons),0) from dbo.VSL_VesselJobUpdateHistorySpareDetails Where VesselCode=@VesselCode And ComponentId=@ComponentId And Office_Ship=@Office_Ship And SpareId=@SpareId And Status=''A'' And HistoryId in(SELECT HISTORYID FROM dbo.VSL_VesselJobUpdateHistory WHERE VESSELCODE=@VesselCode AND DONEDATE<=@OnDate)
	select @cons=@cons+isnull(sum(QtyCons),0) from dbo.VSL_DefectSpareDetails Where VesselCode=@VesselCode And ComponentId=@ComponentId And Office_Ship=@Office_Ship And SpareId=@SpareId And Status=''A'' And DefectNo in(SELECT DefectNo FROM dbo.VSL_DefectDetailsMaster WHERE VESSELCODE=@VesselCode AND ReportDt<=@OnDate)
	select @cons=@cons+isnull(sum(QtyCons),0) from dbo.VSL_UnPlannedJobs_SpareDetails Where VesselCode=@VesselCode And ComponentId=@ComponentId And Office_Ship=@Office_Ship And SpareId=@SpareId And Status=''A'' And UPId in(SELECT UPId FROM dbo.VSL_UnPlannedJobs WHERE VESSELCODE=@VesselCode AND DONEDATE<=@OnDate)

	select @rec=isnull(sum(QtyRecd),0) from dbo.VSL_StockInventory WHERE  VESSELCODE=@VesselCode And ComponentId=@ComponentId And Office_Ship=@Office_Ship And SpareId=@SpareId And Status=''A'' AND RecdDate <=@OnDate
	
	set @rob=@rec-@cons

	if @rob<0
		set @rob=0

	return @rob 
end







' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getRootPath]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRootPath]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'--SELECT CM.*,
--(SELECT  ComponentName FROM ComponentMaster CMP WHERE CMP.ComponentCode = LEFT(CM.COMPONENTCODE,LEN(CM.COMPONENTCODE)-3) ) as Parent 
--FROM VSL_ComponentMasterForVessel CMV INNER JOIN ComponentMaster CM ON CM.ComponentId = CMV.ComponentId WHERE 1=1 AND CMV.VesselCode = ''LIG''  AND CM.componentcode like ''%601%''
CREATE function [dbo].[getRootPath]
(
	@Code varchar(12)
)
returns varchar(500)
as
begin
	declare @ret varchar(500)
	declare @part1 varchar(50)
	declare @part2 varchar(50)
	declare @part3 varchar(50)
	select @part1=ComponentName FROM ComponentMaster CMP WHERE CMP.ComponentCode = LEFT(@Code,3)
	select @part2=ComponentName FROM ComponentMaster CMP WHERE CMP.ComponentCode = LEFT(@Code,6)
	select @part3=ComponentName FROM ComponentMaster CMP WHERE CMP.ComponentCode = LEFT(@Code,9)

	if(len(ltrim(rtrim(@Code)))=3)
	set @ret= ''Root''
	else if(len(ltrim(rtrim(@Code)))=6)
	set @ret= @part1 
	else if(len(ltrim(rtrim(@Code)))=9)
	set @ret= @part1 + '' > '' + @part2 
	else if(len(ltrim(rtrim(@Code)))=12)
	set @ret= @part1 + '' > '' + @part2 + '' > '' + @part3

	return @ret
end



--select * from ComponentMaster

' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getRunningHrsOnDate]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRunningHrsOnDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [dbo].[getRunningHrsOnDate]
(
@VSLID CHAR(3),
@COMPCODE VARCHAR(12),
@ONDATE SMALLDATETIME
)
returns int
BEGIN
--SELECT dbo.getRunningHrsOnDate(''LIG'',''376'',GETDATE())
--DECLARE @VSLID CHAR(3)
--DECLARE @COMPCODE VARCHAR(12)
--DECLARE @COMPID BIGINT
--DECLARE @ONDATE SMALLDATETIME

DECLARE @HRS BIGINT

--SET @VSLID=''LIG''
--SET @COMPCODE=''376''
--SET @ONDATE=GETDATE()

--SELECT @COMPID=COMPONENTID FROM dbo.ComponentMaster WHERE LTRIM(RTRIM(ComponentCode))=LTRIM(RTRIM(@COMPCODE))

IF(@ONDATE IS NULL)
BEGIN
	SELECT TOP 1 @HRS=STARTUPHOUR FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE=@VSLID 
	AND ComponentId IN 
	(	
		SELECT CM.ComponentId FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
		INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1
	)
	ORDER BY STARTDATE DESC,STARTUPHOUR DESC
END
ELSE  
BEGIN
	SELECT TOP 1 @HRS=STARTUPHOUR FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE=@VSLID 
	AND ComponentId IN 
	(	
		SELECT CM.ComponentId FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
		INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1
	)
  AND STARTDATE<@ONDATE ORDER BY STARTDATE DESC,STARTUPHOUR DESC
END

RETURN @HRS

END

' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getRunningHrsOnDate_ExcludeLast]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRunningHrsOnDate_ExcludeLast]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [dbo].[getRunningHrsOnDate_ExcludeLast]
(
@VSLID CHAR(3),
@COMPCODE VARCHAR(12),
@ONDATE SMALLDATETIME,
@HRSEXCLUDE BIGINT
)
returns int
BEGIN
--SELECT dbo.getRunningHrsOnDate(''LIG'',''376'',GETDATE())
--DECLARE @VSLID CHAR(3)
--DECLARE @COMPCODE VARCHAR(12)
--DECLARE @COMPID BIGINT
--DECLARE @ONDATE SMALLDATETIME

DECLARE @HRS BIGINT

--SET @VSLID=''LIG''
--SET @COMPCODE=''376''
--SET @ONDATE=GETDATE()

--SELECT @COMPID=COMPONENTID FROM dbo.ComponentMaster WHERE LTRIM(RTRIM(ComponentCode))=LTRIM(RTRIM(@COMPCODE))

IF(@ONDATE IS NULL)
BEGIN
	SELECT TOP 1 @HRS=STARTUPHOUR FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE=@VSLID 
	AND ComponentId IN 
	(	
		SELECT CM.ComponentId FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
		INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1
	)
	ORDER BY STARTDATE DESC,STARTUPHOUR DESC
END
ELSE  
BEGIN
	SELECT TOP 1 @HRS=STARTUPHOUR FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE=@VSLID 
	AND ComponentId IN 
	(	
		SELECT CM.ComponentId FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
		INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1
	)
AND STARTUPHOUR<>@HRSEXCLUDE
AND STARTDATE<@ONDATE ORDER BY STARTDATE DESC,STARTUPHOUR DESC
END

RETURN @HRS

END

' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getRunningHrsOnDate_SingleCompCode]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRunningHrsOnDate_SingleCompCode]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'					  
CREATE FUNCTION [dbo].[getRunningHrsOnDate_SingleCompCode]
(
@VSLID CHAR(3),
@COMPCODE VARCHAR(12),
@ONDATE SMALLDATETIME
)
returns int
BEGIN

DECLARE @HRS BIGINT

IF(@ONDATE IS NULL)
BEGIN
	SELECT TOP 1 @HRS=STARTUPHOUR FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE=@VSLID 
	AND ComponentId IN 
	(	
		SELECT ComponentId FROM COMPONENTMASTER WHERE COMPONENTCODE=@COMPCODE
		
	)
	ORDER BY STARTDATE DESC,STARTUPHOUR DESC
END
ELSE  
BEGIN
	SELECT TOP 1 @HRS=STARTUPHOUR FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE=@VSLID 
	AND ComponentId IN 
	(	
		SELECT ComponentId FROM COMPONENTMASTER WHERE COMPONENTCODE=@COMPCODE
	)
  AND STARTDATE<@ONDATE ORDER BY STARTDATE DESC,STARTUPHOUR DESC
END

RETURN @HRS

END

' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getRunningHrsOnDateFromHistory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRunningHrsOnDateFromHistory]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [dbo].[getRunningHrsOnDateFromHistory]
(
@VSLID CHAR(3),
@COMPCODE VARCHAR(12),
@ONDATE SMALLDATETIME
)
returns int
BEGIN

DECLARE @HRS BIGINT

IF(@ONDATE IS NULL)
BEGIN
	SELECT TOP 1 @HRS=DONEHOUR
	FROM dbo.VSL_VesselJobUpdateHistory 
	WHERE VesselCode = @VSLID 
	AND ComponentId IN 
	(
		SELECT CMV.ComponentId FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
	)
	AND [ACTION]=''R'' 
	AND COMPJOBID IN  
	(
		SELECT VCJM.COMPJOBID FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
		INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1
	)	
	ORDER BY DONEDATE DESC,HISTORYID DESC
END
ELSE  
BEGIN
	SELECT TOP 1 @HRS=DONEHOUR
	FROM dbo.VSL_VesselJobUpdateHistory 
	WHERE VesselCode = @VSLID 
	AND ComponentId IN 
	(
		SELECT CMV.ComponentId FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
	)
	AND [ACTION]=''R'' 
	AND COMPJOBID IN  
	(
		SELECT VCJM.COMPJOBID FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
		INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1
	)
	AND DBO.getDatepart(DONEDATE)<=@ONDATE -- change
	ORDER BY DONEDATE DESC,HISTORYID DESC
END

RETURN @HRS

END



' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getRunningHrsOnDateFromHistoryDate]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRunningHrsOnDateFromHistoryDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [dbo].[getRunningHrsOnDateFromHistoryDate]
(
@VSLID CHAR(3),
@COMPCODE VARCHAR(12),
@ONDATE SMALLDATETIME
)
returns SMALLDATETIME
BEGIN

DECLARE @ASONDATE SMALLDATETIME

IF(@ONDATE IS NULL)
BEGIN
	SELECT TOP 1 @ASONDATE=DONEDATE
	FROM dbo.VSL_VesselJobUpdateHistory 
	WHERE VesselCode = @VSLID 
	AND ComponentId IN 
	(
		SELECT CMV.ComponentId FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
	)
	AND [ACTION]=''R'' 
	AND COMPJOBID IN  
	(
		SELECT VCJM.COMPJOBID FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
		INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1
	)	
	ORDER BY DONEDATE DESC,HISTORYID DESC
END
ELSE  
BEGIN
	SELECT TOP 1 @ASONDATE=DONEDATE
	FROM dbo.VSL_VesselJobUpdateHistory 
	WHERE VesselCode = @VSLID 
	AND ComponentId IN 
	(
		SELECT CMV.ComponentId FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
	)
	AND [ACTION]=''R'' 
	AND COMPJOBID IN  
	(
		SELECT VCJM.COMPJOBID FROM COMPONENTMASTER CM 
		INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
		INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1
	)
	AND DONEDATE<@ONDATE 
	ORDER BY DONEDATE DESC,HISTORYID DESC
END

RETURN @ASONDATE

END


' 
END

GO
/****** Object:  UserDefinedFunction [dbo].[getRunningHrsOnFixedDate]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[getRunningHrsOnFixedDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [dbo].[getRunningHrsOnFixedDate]
(
@VSLID CHAR(3),
@COMPCODE VARCHAR(12),
@ONDATE SMALLDATETIME
)
returns int
BEGIN
--SELECT dbo.getRunningHrsOnDate(''LIG'',''376'',GETDATE())
--DECLARE @VSLID CHAR(3)
--DECLARE @COMPCODE VARCHAR(12)
--DECLARE @COMPID BIGINT
--DECLARE @ONDATE SMALLDATETIME

DECLARE @HRS BIGINT

--SET @VSLID=''LIG''
--SET @COMPCODE=''376''
--SET @ONDATE=GETDATE()

--SELECT @COMPID=COMPONENTID FROM dbo.ComponentMaster WHERE LTRIM(RTRIM(ComponentCode))=LTRIM(RTRIM(@COMPCODE))
SELECT TOP 1 @HRS=STARTUPHOUR FROM dbo.VSL_VesselRunningHourMaster WHERE VESSELCODE=@VSLID
--AND COMPONENTID=@COMPID 
AND ComponentId IN 
(	
	SELECT CM.ComponentId FROM COMPONENTMASTER CM 
	INNER JOIN VSL_COMPONENTMASTERFORVESSEL CMV ON CMV.COMPONENTID=CM.COMPONENTID AND VESSELCODE=@VSLID AND LEFT(COMPONENTCODE,LEN(@COMPCODE))=@COMPCODE AND CMV.STATUS=''A''
	INNER JOIN VSL_VesselComponentJobMaster VCJM ON CMV.VESSELCODE=VCJM.VESSELCODE AND VCJM.STATUS=''A'' AND VCJM.IntervalId = 1
)

AND dbo.getDatePart(STARTDATE)=@ONDATE ORDER BY STARTDATE DESC,STARTUPHOUR DESC

RETURN @HRS

END

' 
END

GO
/****** Object:  Table [dbo].[atest]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[atest]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[atest](
	[name] [varchar](50) NULL,
	[formid] [varchar](50) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Cir_Categories]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Cir_Categories]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Cir_Categories](
	[CirId] [int] NOT NULL,
	[CirCatId] [int] NOT NULL,
 CONSTRAINT [PK_CIR_Categories] PRIMARY KEY CLUSTERED 
(
	[CirId] ASC,
	[CirCatId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
/****** Object:  Table [dbo].[Cir_Category]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Cir_Category]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Cir_Category](
	[CirCatId] [int] NOT NULL,
	[CirCatName] [varchar](50) NULL,
 CONSTRAINT [PK_CirCategory] PRIMARY KEY CLUSTERED 
(
	[CirCatId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Cir_Circular]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Cir_Circular]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Cir_Circular](
	[CId] [bigint] NOT NULL,
	[CircularNumber] [varchar](250) NULL,
	[CircularDate] [smalldatetime] NULL,
	[Category] [int] NULL,
	[CType] [char](1) NULL,
	[Source] [varchar](1000) NULL,
	[Topic] [varchar](1000) NULL,
	[Details] [varchar](max) NULL,
	[NextReviewDate] [smalldatetime] NULL,
	[AttachmentFileName] [varchar](1000) NULL,
	[Attachment] [image] NULL,
	[CreatedBy] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
	[Status] [int] NULL,
 CONSTRAINT [PK_Circular] PRIMARY KEY CLUSTERED 
(
	[CId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Cir_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Cir_Vessel_Notifications]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Cir_Vessel_Notifications](
	[CId] [int] NOT NULL,
	[VESSELCODE] [varchar](3) NOT NULL,
	[SentOn] [smalldatetime] NULL,
	[AckOn] [smalldatetime] NULL,
	[AckMessage] [varchar](500) NULL,
	[Discussed] [bit] NULL,
	[Notice] [bit] NULL,
 CONSTRAINT [PK_CIR_Email_Notifications] PRIMARY KEY CLUSTERED 
(
	[CId] ASC,
	[VESSELCODE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ComponentJobMapping_OtherRanks]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ComponentJobMapping_OtherRanks]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ComponentJobMapping_OtherRanks](
	[CompJobId] [bigint] NULL,
	[RankId] [bigint] NULL
) ON [PRIMARY]
END
GO
/****** Object:  Table [dbo].[ComponentMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ComponentMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ComponentMaster](
	[ComponentId] [bigint] NOT NULL,
	[ComponentCode] [char](12) NULL,
	[ComponentName] [varchar](100) NULL,
	[Descr] [varchar](500) NULL,
	[ClassEquip] [bit] NULL,
	[CriticalEquip] [bit] NULL,
	[Inactive] [bit] NULL,
	[CriticalType] [char](1) NULL,
 CONSTRAINT [PK_ComponentMaster] PRIMARY KEY CLUSTERED 
(
	[ComponentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ComponentMasterForVessel]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ComponentMasterForVessel]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ComponentMasterForVessel](
	[VesselCode] [char](3) NOT NULL,
	[ComponentId] [bigint] NOT NULL,
	[Maker] [varchar](50) NULL,
	[MakerType] [varchar](50) NULL,
	[ClassEquipCode] [varchar](30) NULL,
	[Descr] [varchar](1000) NULL,
	[CLASSEQUIP] [bit] NULL,
	[ACCOUNTCODES] [varchar](50) NULL,
 CONSTRAINT [PK_ComponentMasterForVessel] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[ComponentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ComponentsJobMapping]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ComponentsJobMapping]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ComponentsJobMapping](
	[ComponentId] [bigint] NOT NULL,
	[JobId] [bigint] NOT NULL,
	[CompJobId] [bigint] NOT NULL,
	[AssignTo] [int] NULL,
	[DeptId] [int] NULL,
	[IntervalId] [int] NULL,
	[IsFixed] [smallint] NULL,
	[DescrSh] [varchar](250) NULL,
	[DescrM] [varchar](5000) NULL,
	[AttachmentForm] [varchar](50) NULL,
	[RiskAssessment] [varchar](50) NULL,
	[RatingRequired] [bit] NULL,
 CONSTRAINT [PK_ComponentsJobMapping] PRIMARY KEY CLUSTERED 
(
	[CompJobId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ComponentsJobMapping_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ComponentsJobMapping_Attachments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ComponentsJobMapping_Attachments](
	[TableId] [bigint] NOT NULL,
	[CompJobId] [bigint] NULL,
	[Descr] [varchar](500) NULL,
	[DocumentType] [varchar](5) NULL,
	[Status] [char](1) NULL,
 CONSTRAINT [PK_ComponentMaster_Attachments] PRIMARY KEY CLUSTERED 
(
	[TableId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_Docket_Publish_History]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Docket_Publish_History]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_Docket_Publish_History](
	[TableId] [bigint] NOT NULL,
	[DocketId] [bigint] NULL,
	[VersionNo] [varchar](3) NULL,
	[PublishedBy] [varchar](50) NULL,
	[PublishedOn] [smalldatetime] NULL,
	[Attachment] [image] NULL,
 CONSTRAINT [PK_DD_Docket_Publish_History] PRIMARY KEY CLUSTERED 
(
	[TableId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_Docket_RFQ_Jobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Docket_RFQ_Jobs]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_Docket_RFQ_Jobs](
	[RFQId] [bigint] NOT NULL,
	[DocketJobId] [bigint] NOT NULL,
	[DocketId] [bigint] NOT NULL,
	[CatId] [bigint] NULL,
	[CatCode] [varchar](50) NULL,
	[CatName] [varchar](500) NULL,
	[JobId] [bigint] NULL,
	[JobCode] [varchar](50) NULL,
	[JobName] [varchar](500) NULL,
	[ComponentCode] [varchar](50) NULL,
	[ComponentName] [varchar](50) NULL,
	[JobDesc] [varchar](max) NULL,
	[PlanFrom] [smalldatetime] NULL,
	[PlanTo] [smalldatetime] NULL,
	[StartFrom] [smalldatetime] NULL,
	[StartTo] [smalldatetime] NULL,
	[ExecPerDate] [smalldatetime] NULL,
	[ExecPer] [smallint] NULL,
	[ExecRemarks] [varchar](1000) NULL,
 CONSTRAINT [PK_DD_Docket_RFQ_Jobs] PRIMARY KEY CLUSTERED 
(
	[RFQId] ASC,
	[DocketJobId] ASC,
	[DocketId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_Docket_RFQ_Jobs_Planning]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Docket_RFQ_Jobs_Planning]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_Docket_RFQ_Jobs_Planning](
	[RfqId] [bigint] NOT NULL,
	[DocketJobId] [bigint] NOT NULL,
	[DocketId] [bigint] NOT NULL,
	[For_Date] [smalldatetime] NOT NULL,
	[Per] [varchar](50) NULL,
	[Remark] [varchar](1000) NULL,
	[Report] [bit] NULL,
 CONSTRAINT [PK_DD_DocketSubJobsPlanning] PRIMARY KEY CLUSTERED 
(
	[RfqId] ASC,
	[DocketJobId] ASC,
	[DocketId] ASC,
	[For_Date] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_Docket_RFQ_Jobs_Planning_History]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Docket_RFQ_Jobs_Planning_History]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_Docket_RFQ_Jobs_Planning_History](
	[HistoryId] [bigint] IDENTITY(1,1) NOT NULL,
	[RfqId] [bigint] NOT NULL,
	[DocketJobId] [bigint] NOT NULL,
	[DocketId] [bigint] NOT NULL,
	[For_Date] [smalldatetime] NOT NULL,
	[Dates] [varchar](max) NULL,
 CONSTRAINT [PK_DD_Docket_RFQ_Jobs_Planning_History] PRIMARY KEY CLUSTERED 
(
	[HistoryId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_Docket_RFQ_Master]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Docket_RFQ_Master]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_Docket_RFQ_Master](
	[RFQId] [bigint] NOT NULL,
	[DocketId] [bigint] NULL,
	[RFQNo] [varchar](50) NULL,
	[YardId] [bigint] NULL,
	[Status] [char](1) NULL,
	[ActiveInactive] [char](1) NULL,
	[GUID] [uniqueidentifier] NULL,
	[Currency] [char](3) NULL,
	[ExchRate] [numeric](18, 4) NULL,
	[CreatedBy] [varchar](50) NOT NULL,
	[CreatedOn] [smalldatetime] NULL,
	[MailSentBy] [varchar](50) NULL,
	[MailSentOn] [smalldatetime] NULL,
	[CancelledBy] [varchar](50) NULL,
	[CancelledOn] [smalldatetime] NULL,
	[CancellRemarks] [varchar](500) NULL,
	[ExecFrom] [smalldatetime] NULL,
	[ExecTo] [smalldatetime] NULL,
	[Executed] [char](1) NULL,
	[FinalDiscount] [numeric](18, 2) NULL,
	[Password] [varchar](50) NULL,
	[PasswordExpiryDate] [smalldatetime] NULL,
	[DockingArrivalDate] [smalldatetime] NULL,
 CONSTRAINT [PK_DD_Docket_RFQ_Master] PRIMARY KEY CLUSTERED 
(
	[RFQId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_Docket_RFQ_SubJobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Docket_RFQ_SubJobs]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_Docket_RFQ_SubJobs](
	[RFQId] [bigint] NOT NULL,
	[DocketSubJobId] [bigint] NOT NULL,
	[DocketJobId] [bigint] NOT NULL,
	[DocketId] [bigint] NOT NULL,
	[SubJobId] [bigint] NULL,
	[SubJobCode] [varchar](50) NULL,
	[SubJobName] [varchar](5000) NULL,
	[AttachmentName] [varchar](100) NULL,
	[Attachment] [image] NULL,
	[Unit] [varchar](50) NULL,
	[BidQty] [numeric](18, 2) NULL,
	[QuoteQty] [numeric](18, 2) NULL,
	[UnitPrice] [numeric](18, 2) NULL,
	[GrossAmount] [numeric](18, 2) NULL,
	[DiscountPer] [numeric](18, 2) NULL,
	[NetAmount] [numeric](18, 2) NULL,
	[VendorRemarks] [varchar](1000) NULL,
	[UnitPrice_USD] [numeric](18, 2) NULL,
	[GrossAmount_USD] [numeric](18, 2) NULL,
	[NetAmount_USD] [numeric](18, 2) NULL,
	[POQty] [numeric](18, 2) NULL,
	[POGrossAmount] [numeric](18, 2) NULL,
	[PODiscountPer] [numeric](18, 2) NULL,
	[PONetAmount] [numeric](18, 2) NULL,
	[POUnitPrice_USD] [numeric](18, 2) NULL,
	[POGrossAmount_USD] [numeric](18, 2) NULL,
	[PONetAmount_USD] [numeric](18, 2) NULL,
	[LongDescr] [varchar](max) NULL,
	[CostCategory] [char](1) NULL,
	[OutsideRepair] [char](1) NULL,
	[SUPQty] [numeric](18, 2) NULL,
	[SUPUnitPrice_USD] [numeric](18, 2) NULL,
	[SUPGrossAmount_USD] [numeric](18, 2) NULL,
	[SUPDiscountPer] [numeric](18, 2) NULL,
	[SUPNetAmount_USD] [numeric](18, 2) NULL,
	[SUPUpdated] [char](1) NULL,
	[SUPRemarks] [varchar](1000) NULL,
	[DefectNo] [varchar](15) NULL,
	[EstAmount_USD] [numeric](18, 2) NULL,
	[EstQty] [numeric](18, 2) NULL,
	[Remarks] [varchar](250) NULL,
	[EstUnitPrice] [numeric](18, 2) NULL,
	[ReqForJobTrack] [char](1) NULL,
	[EstDiscPer] [numeric](18, 2) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_DocketDocuments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_DocketDocuments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_DocketDocuments](
	[DocumentId] [bigint] NOT NULL,
	[DocketId] [bigint] NULL,
	[DocumentName] [varchar](500) NULL,
	[FileName] [varchar](50) NULL,
	[Attachment] [image] NULL,
 CONSTRAINT [PK_DD_DocketDocuments] PRIMARY KEY CLUSTERED 
(
	[DocumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_DocketJobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_DocketJobs]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_DocketJobs](
	[DocketJobId] [bigint] NOT NULL,
	[DocketId] [bigint] NOT NULL,
	[CatId] [bigint] NULL,
	[CatCode] [varchar](50) NULL,
	[CatName] [varchar](500) NULL,
	[JobId] [bigint] NULL,
	[JobCode] [varchar](50) NULL,
	[JobName] [varchar](500) NULL,
	[ComponentCode] [varchar](50) NULL,
	[ComponentName] [varchar](50) NULL,
	[JobDesc] [varchar](max) NULL,
 CONSTRAINT [PK_DD_DocketJobs] PRIMARY KEY CLUSTERED 
(
	[DocketJobId] ASC,
	[DocketId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_DocketMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_DocketMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_DocketMaster](
	[DocketId] [bigint] NOT NULL,
	[VesselId] [int] NULL,
	[DocketType] [varchar](50) NULL,
	[DocketNo] [varchar](50) NULL,
	[Startdate] [smalldatetime] NULL,
	[EndDate] [smalldatetime] NULL,
	[Act_Startdate] [smalldatetime] NULL,
	[Act_EndDate] [smalldatetime] NULL,
	[Status] [char](1) NULL,
	[ClosedBy] [int] NULL,
	[ClosedOn] [smalldatetime] NULL,
	[ClosingRemarks] [varchar](max) NULL,
	[NextDDDate] [smalldatetime] NULL,
	[ReportSentToShip] [char](1) NULL,
	[ReportSentDate] [smalldatetime] NULL,
	[DDType] [varchar](50) NULL,
 CONSTRAINT [PK_DD_DocketMaster] PRIMARY KEY CLUSTERED 
(
	[DocketId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_DocketReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_DocketReport]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_DocketReport](
	[DocketId] [bigint] NOT NULL,
	[CatId] [int] NOT NULL,
	[ContentText] [varchar](max) NULL,
	[CreatedBy] [int] NULL,
	[CreatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_DD_DocketReport_1] PRIMARY KEY CLUSTERED 
(
	[DocketId] ASC,
	[CatId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_DocketReportImages]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_DocketReportImages]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_DocketReportImages](
	[TableId] [bigint] IDENTITY(1,1) NOT NULL,
	[DocketId] [bigint] NULL,
	[CatId] [int] NULL,
	[FileName] [varchar](255) NULL,
	[Caption] [varchar](255) NULL,
 CONSTRAINT [PK_DD_DocketReportImages] PRIMARY KEY CLUSTERED 
(
	[TableId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_DocketSubJobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_DocketSubJobs]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_DocketSubJobs](
	[DocketSubJobId] [bigint] NOT NULL,
	[DocketJobId] [bigint] NOT NULL,
	[DocketId] [bigint] NOT NULL,
	[SubJobId] [bigint] NULL,
	[SubJobCode] [varchar](50) NULL,
	[SubJobName] [varchar](5000) NULL,
	[AttachmentName] [varchar](100) NULL,
	[Attachment] [image] NULL,
	[Unit] [varchar](50) NULL,
	[BidQty] [numeric](18, 2) NULL,
	[LongDescr] [varchar](max) NULL,
	[CostCategory] [char](1) NULL,
	[OutsideRepair] [char](1) NULL,
	[DefectNo] [varchar](15) NULL,
	[ReqForJobTrack] [char](1) NULL,
 CONSTRAINT [PK_DD_DocketSubJobs] PRIMARY KEY CLUSTERED 
(
	[DocketSubJobId] ASC,
	[DocketJobId] ASC,
	[DocketId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_JobCategory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_JobCategory]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_JobCategory](
	[CatId] [int] NOT NULL,
	[CatCode] [varchar](50) NULL,
	[CatName] [varchar](500) NULL,
 CONSTRAINT [PK_DD_JobCategory] PRIMARY KEY CLUSTERED 
(
	[CatId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_Jobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_Jobs]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_Jobs](
	[JobId] [bigint] NOT NULL,
	[CatId] [int] NULL,
	[JobCode] [varchar](50) NULL,
	[JobName] [varchar](500) NULL,
	[ComponentId] [bigint] NULL,
	[JobDesc] [varchar](max) NULL,
 CONSTRAINT [PK_DD_Jobs] PRIMARY KEY CLUSTERED 
(
	[JobId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_PRINT_RFQ_COMPARISON]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_PRINT_RFQ_COMPARISON]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_PRINT_RFQ_COMPARISON](
	[VesselName] [varchar](50) NULL,
	[DocketNo] [varchar](50) NULL,
	[YardName] [varchar](50) NULL,
	[YardName1] [varchar](50) NULL,
	[CatCode] [varchar](50) NULL,
	[CatName] [varchar](500) NULL,
	[JobCode] [varchar](50) NULL,
	[JobName] [varchar](max) NULL,
	[JonDesc] [varchar](max) NULL,
	[SubJobCode] [varchar](50) NULL,
	[SubJobName] [varchar](max) NULL,
	[LongDesc] [varchar](max) NULL,
	[QuoteQty] [numeric](18, 2) NULL,
	[UnitPrice] [numeric](18, 2) NULL,
	[Disc] [numeric](18, 2) NULL,
	[Total] [numeric](18, 2) NULL,
	[QuoteQty1] [numeric](18, 2) NULL,
	[UnitPrice1] [numeric](18, 2) NULL,
	[Disc1] [numeric](18, 2) NULL,
	[Total1] [numeric](18, 2) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_SubJobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_SubJobs]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_SubJobs](
	[SubJobId] [bigint] NOT NULL,
	[JobId] [bigint] NULL,
	[SubJobCode] [varchar](50) NULL,
	[SubJobName] [varchar](5000) NULL,
	[Unit] [varchar](50) NULL,
	[LongDescr] [varchar](max) NULL,
	[CostCategory] [char](1) NULL,
	[OutsideRepair] [char](1) NULL,
	[ReqForJobTrack] [char](1) NULL,
 CONSTRAINT [PK_DD_SubJobs] PRIMARY KEY CLUSTERED 
(
	[SubJobId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DD_YardMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DD_YardMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DD_YardMaster](
	[YardId] [bigint] NOT NULL,
	[YardName] [varchar](100) NULL,
	[Address] [varchar](500) NULL,
	[ContactNo] [varchar](100) NULL,
	[Email] [varchar](500) NULL,
	[ContactPerson] [varchar](50) NULL,
	[PortName] [varchar](50) NULL,
	[CountryId] [int] NULL,
 CONSTRAINT [PK_DD_YardMaster] PRIMARY KEY CLUSTERED 
(
	[YardId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DefaultTrace_History]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DefaultTrace_History]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DefaultTrace_History](
	[TextData] [nvarchar](max) NULL,
	[DatabaseID] [int] NULL,
	[HostName] [nvarchar](256) NULL,
	[ApplicationName] [nvarchar](256) NULL,
	[LoginName] [nvarchar](256) NULL,
	[SPID] [int] NULL,
	[StartTime] [datetime] NULL,
	[EndTime] [datetime] NULL,
	[Duration] [bigint] NULL,
	[ObjectID] [int] NULL,
	[ObjectType] [int] NULL,
	[IndexID] [int] NULL,
	[EventClass] [int] NULL,
	[FileName] [nvarchar](256) NULL,
	[RowCounts] [bigint] NULL,
	[IsSystem] [int] NULL,
	[SqlHandle] [varbinary](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DeptMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DeptMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DeptMaster](
	[DeptId] [int] NOT NULL,
	[DeptName] [varchar](50) NULL,
 CONSTRAINT [PK_DeptMaster] PRIMARY KEY CLUSTERED 
(
	[DeptId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DT_DrillMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_DrillMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DT_DrillMaster](
	[DrillId] [bigint] NOT NULL,
	[DrillName] [varchar](1000) NULL,
	[RecordType] [char](1) NULL,
	[DrillGroupId] [bigint] NULL,
	[OfficeGuideLines] [varchar](max) NULL,
	[AttachmentFileName] [varchar](150) NULL,
	[Attachment] [image] NULL,
	[Status] [char](1) NULL,
 CONSTRAINT [PK_DT_DrillMaster] PRIMARY KEY CLUSTERED 
(
	[DrillId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DT_MatrixDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_MatrixDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DT_MatrixDetails](
	[MatrixId] [bigint] NOT NULL,
	[DTId] [bigint] NOT NULL,
	[RecordType] [char](1) NOT NULL,
	[ValidityType] [char](1) NULL,
	[ValidityValue] [int] NULL,
	[Status] [char](1) NULL,
 CONSTRAINT [PK_DT_MatrixDetails] PRIMARY KEY CLUSTERED 
(
	[MatrixId] ASC,
	[DTId] ASC,
	[RecordType] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DT_MatrixDetailsAttachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_MatrixDetailsAttachments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DT_MatrixDetailsAttachments](
	[TableId] [bigint] NOT NULL,
	[MatrixId] [bigint] NULL,
	[DTId] [bigint] NULL,
	[RecordType] [char](1) NULL,
	[ImageText] [varchar](500) NULL,
 CONSTRAINT [PK_DT_MatrixDetailsAttachments] PRIMARY KEY CLUSTERED 
(
	[TableId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DT_MatrixMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_MatrixMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DT_MatrixMaster](
	[MatrixId] [bigint] NOT NULL,
	[ApplicableDate] [smalldatetime] NULL,
 CONSTRAINT [PK_DT_MatrixMaster] PRIMARY KEY CLUSTERED 
(
	[MatrixId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
/****** Object:  Table [dbo].[DT_TrainingMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_TrainingMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DT_TrainingMaster](
	[TrainingId] [bigint] NOT NULL,
	[TraininingName] [varchar](1000) NULL,
	[RecordType] [char](1) NULL,
	[TrainingGroupId] [bigint] NULL,
	[OfficeGuideLines] [varchar](max) NULL,
	[AttachmentFileName] [varchar](150) NULL,
	[Attachment] [image] NULL,
	[Status] [char](1) NULL,
 CONSTRAINT [PK_DT_TrainingMaster] PRIMARY KEY CLUSTERED 
(
	[TrainingId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DT_VSL_DrillTrainingHistoryAttachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_VSL_DrillTrainingHistoryAttachments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DT_VSL_DrillTrainingHistoryAttachments](
	[TableId] [bigint] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[DoneId] [bigint] NULL,
	[Description] [varchar](500) NULL,
	[FileName] [varchar](150) NULL,
	[Attachment] [image] NULL,
 CONSTRAINT [PK_DT_VSL_DrillTrainingHistoryAttachments] PRIMARY KEY CLUSTERED 
(
	[TableId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DT_VSL_DrillTrainingHistoryDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_VSL_DrillTrainingHistoryDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DT_VSL_DrillTrainingHistoryDetails](
	[VesselCode] [char](3) NOT NULL,
	[DoneId] [bigint] NOT NULL,
	[SrNo] [int] NOT NULL,
	[Details] [varchar](1000) NULL,
	[OnTime] [smalldatetime] NULL,
 CONSTRAINT [PK_DT_VSL_DrillTrainingHistoryDetails] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[DoneId] ASC,
	[SrNo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DT_VSL_DrillTrainingHistoryRanks]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_VSL_DrillTrainingHistoryRanks]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DT_VSL_DrillTrainingHistoryRanks](
	[VesselCode] [char](3) NOT NULL,
	[DoneId] [bigint] NOT NULL,
	[CrewNumber] [varchar](10) NOT NULL,
	[CrewName] [varchar](100) NULL,
	[RankName] [varchar](100) NULL,
	[Present] [bit] NULL,
 CONSTRAINT [PK_DT_VSL_DrillTrainingHistoryRanks_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[DoneId] ASC,
	[CrewNumber] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DT_VSL_DrillTrainings]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_VSL_DrillTrainings]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DT_VSL_DrillTrainings](
	[VesselCode] [char](3) NOT NULL,
	[DTId] [bigint] NOT NULL,
	[RecordType] [char](1) NOT NULL,
	[LastDueDate] [smalldatetime] NULL,
	[DoneDate] [smalldatetime] NULL,
	[NextDueDate] [smalldatetime] NULL,
	[PlanDate] [smalldatetime] NULL,
	[PostPoneDate] [smalldatetime] NULL,
	[PostPoneTillDate] [smalldatetime] NULL,
	[DoneId] [bigint] NULL,
	[DoneBy] [varchar](50) NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_DT_VSL_DrillTrainings] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[DTId] ASC,
	[RecordType] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DT_VSL_DrillTrainingsHistory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DT_VSL_DrillTrainingsHistory]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DT_VSL_DrillTrainingsHistory](
	[VesselCode] [char](3) NULL,
	[DTId] [bigint] NULL,
	[DTRecordType] [char](1) NULL,
	[DoneId] [bigint] NOT NULL,
	[DoneDate] [smalldatetime] NULL,
	[RecordType] [char](1) NULL,
	[MasterName] [varchar](100) NULL,
	[FromHrs] [int] NULL,
	[FromMin] [int] NULL,
	[ToHrs] [int] NULL,
	[ToMin] [int] NULL,
	[Lattitude1] [int] NULL,
	[Lattitude2] [int] NULL,
	[Lattitude3] [char](1) NULL,
	[Longitude1] [int] NULL,
	[Longitude2] [int] NULL,
	[Longitude3] [char](1) NULL,
	[PortName] [varchar](100) NULL,
	[LastDueDate] [smalldatetime] NULL,
	[NextDueDate] [smalldatetime] NULL,
	[PostPoneDate] [smalldatetime] NULL,
	[PostPoneTillDate] [smalldatetime] NULL,
	[DoneBy] [varchar](50) NULL,
	[Imp_Comment] [varchar](5000) NULL,
	[Imp_CorrectiveAction] [varchar](5000) NULL,
	[OfficeRemarksBy] [varchar](100) NULL,
	[OfficeRemarks] [varchar](max) NULL,
	[OfficeRemarksOn] [smalldatetime] NULL,
	[UpdatedBy] [varchar](50) NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[ExportedBy] [varchar](50) NULL,
	[ExportedOn] [smalldatetime] NULL,
	[OfficeRecOn] [smalldatetime] NULL,
 CONSTRAINT [PK_DT_VSL_DrillTrainingsHistory] PRIMARY KEY CLUSTERED 
(
	[DoneId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_G118_Report]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_G118_Report]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_G118_Report](
	[ReportId] [bigint] NOT NULL,
	[ReportNo] [varchar](50) NULL,
	[VesselCode] [varchar](3) NOT NULL,
	[AreaAudited] [varchar](255) NULL,
	[AreaAuditedOther] [varchar](50) NULL,
	[AuditType] [varchar](3) NULL,
	[AuditValue] [varchar](255) NULL,
	[AuditValueOther] [varchar](255) NULL,
	[NonConformanceDes] [varchar](max) NULL,
	[NCRMaker] [varchar](255) NULL,
	[NCRCreatedDate] [smalldatetime] NULL,
	[NCRMakerPos] [varchar](255) NULL,
	[PersonRecvNCR] [varchar](255) NULL,
	[RankRecvNCR] [varchar](255) NULL,
	[NameofGeneralManager] [varchar](255) NULL,
	[NCRTargetCompDate] [smalldatetime] NULL,
	[ImmediateCorrectiveAction] [varchar](max) NULL,
	[IMCName] [varchar](255) NULL,
	[IMCCompletedDate] [smalldatetime] NULL,
	[IMCRanck] [varchar](255) NULL,
	[RootCause] [varchar](500) NULL,
	[OhterRootCause] [varchar](max) NULL,
	[PreventivAction] [varchar](max) NULL,
	[PAName] [varchar](255) NULL,
	[PADate] [varchar](255) NULL,
	[PAPos] [varchar](255) NULL,
	[CreatedBy] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[ExportedBy] [varchar](50) NULL,
	[ExportedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_ER_G118_Report] PRIMARY KEY CLUSTERED 
(
	[ReportId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_G118_Report_Office]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_G118_Report_Office]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_G118_Report_Office](
	[ReportId] [bigint] NOT NULL,
	[VesselCode] [char](3) NULL,
	[OfficeComment] [varchar](max) NULL,
	[OfficeCommentVarefiedBy] [varchar](255) NULL,
	[OfficeCommentVarefiedDate] [smalldatetime] NULL,
	[VerifiedPersonPOS] [varchar](255) NULL,
	[Is_Closed] [char](1) NULL,
	[ClosureDate] [smalldatetime] NULL,
	[ClosureRemarks] [varchar](max) NULL,
	[ClosureEvidence] [varchar](255) NULL,
	[CloserFile] [image] NULL,
	[ClosedBy] [varchar](255) NULL,
	[ClosedOn] [smalldatetime] NULL,
	[Is_Closure_notified] [char](1) NULL,
	[NotifyDate] [smalldatetime] NULL,
	[CreatedBy] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[Status] [char](1) NULL,
	[Locked] [char](1) NULL,
	[ExportedBy] [varchar](50) NULL,
	[ExportedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_ER_G118_Report_Office] PRIMARY KEY CLUSTERED 
(
	[ReportId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_Master]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_Master]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_Master](
	[ReportGroupId] [bigint] NOT NULL,
	[FormNo] [varchar](50) NOT NULL,
	[FormName] [varchar](100) NULL,
	[Guidance] [image] NULL,
	[VersionNo] [varchar](50) NULL,
 CONSTRAINT [PK_ER_Master] PRIMARY KEY CLUSTERED 
(
	[ReportGroupId] ASC,
	[FormNo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_RegisterOptions]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_RegisterOptions]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_RegisterOptions](
	[RegisterId] [bigint] NOT NULL,
	[OptionId] [bigint] NOT NULL,
	[OptionText] [varchar](100) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_Registers]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_Registers]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_Registers](
	[RegisterId] [bigint] NOT NULL,
	[FormNo] [varchar](50) NULL,
	[RegisterName] [varchar](250) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_Report_Documents_Office]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_Report_Documents_Office]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_Report_Documents_Office](
	[DocId] [bigint] NULL,
	[VesselCode] [char](3) NULL,
	[FormNo] [varchar](50) NULL,
	[ReportId] [bigint] NULL,
	[Descr] [varchar](500) NULL,
	[FileName] [varchar](500) NULL,
	[UploadedBy] [varchar](50) NULL,
	[UploadedOn] [smalldatetime] NULL,
	[Status] [char](1) NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_Report_Documents_Ship]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_Report_Documents_Ship]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_Report_Documents_Ship](
	[DocId] [bigint] NULL,
	[VesselCode] [char](3) NULL,
	[FormNo] [varchar](50) NULL,
	[ReportId] [bigint] NULL,
	[Descr] [varchar](500) NULL,
	[FileName] [varchar](500) NULL,
	[UploadedBy] [varchar](50) NULL,
	[UploadedOn] [smalldatetime] NULL,
	[Status] [char](1) NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_Report_UpdationDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_Report_UpdationDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_Report_UpdationDetails](
	[FormNo] [varchar](50) NULL,
	[ReportId] [bigint] NULL,
	[UpdatedBy] [varchar](50) NULL,
	[UpdatedOn] [datetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_ReportGroupMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_ReportGroupMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_ReportGroupMaster](
	[ReportGroupId] [bigint] NOT NULL,
	[ReportGroupName] [varchar](50) NULL,
 CONSTRAINT [PK_ER_ReportGroupMaster] PRIMARY KEY CLUSTERED 
(
	[ReportGroupId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_S115_InjuryToPerson]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_InjuryToPerson]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_S115_InjuryToPerson](
	[TableId] [bigint] NOT NULL,
	[ReportId] [bigint] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[Is_Crew] [char](1) NULL,
	[IP_CrewNo] [varchar](50) NULL,
	[IP_Name] [varchar](50) NULL,
	[IP_DOB] [smalldatetime] NULL,
	[IP_Nationality_IDNo] [varchar](50) NULL,
	[IP_Rank_Rating] [int] NULL,
	[IP_SignedOnDate] [smalldatetime] NULL,
	[IP_NoOfHrOnBoard] [float] NULL,
	[IP_Is_VisitToDoctor_Necessary] [char](1) NULL,
	[IP_ACTIVITY_OD] [char](1) NULL,
	[IP_ActivityHours] [float] NULL,
	[IP_RestrictedWork] [char](1) NULL,
	[IP_MedicalTreatmentReqd] [char](1) NULL,
	[IP_AreaOfOperation] [int] NULL,
	[IP_AreaOfOperation_Other] [varchar](50) NULL,
	[IP_TypeOfInjury] [int] NULL,
	[IP_TypeOfInjury_Other] [varchar](50) NULL,
	[OCI_MI_Reporting] [int] NULL,
	[Status] [char](1) NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_ER_S115_InjuryToPerson_1] PRIMARY KEY CLUSTERED 
(
	[TableId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_S115_Report]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_Report]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_S115_Report](
	[ReportId] [bigint] NOT NULL,
	[ReportNo] [varchar](50) NULL,
	[VesselCode] [char](3) NOT NULL,
	[Latitude] [varchar](50) NULL,
	[Longitude] [varchar](50) NULL,
	[Port] [varchar](50) NULL,
	[ReportDate] [datetime] NULL,
	[IncidentDate] [datetime] NULL,
	[AccidentSeverity] [int] NULL,
	[AccidentClassification] [varchar](500) NULL,
	[EventDescription] [varchar](5000) NULL,
	[Alcohol_Drug_Testing] [char](1) NULL,
	[Is_Vessel_Delayed_GI] [char](1) NULL,
	[Is_Bad_Weather] [char](1) NULL,
	[VesselActivity] [int] NULL,
	[Is_Restricted_Visibility] [char](1) NULL,
	[Is_BreachOfCP] [char](1) NULL,
	[Cargo_Contamination_Damage] [char](1) NULL,
	[Cargo_Qty_InDispute] [char](1) NULL,
	[CCD_NameOfCharterer] [varchar](50) NULL,
	[CCD_TypeOfCargo] [varchar](50) NULL,
	[CCD_Tank_Hold_Nos] [varchar](50) NULL,
	[CCD_TankCoating] [varchar](50) NULL,
	[CCD_TankCoating_Other] [varchar](50) NULL,
	[CCD_LoadPort] [varchar](50) NULL,
	[CCD_LP_Terminal] [varchar](50) NULL,
	[CCD_LP_Date] [smalldatetime] NULL,
	[CCD_DischargePort] [varchar](50) NULL,
	[CCD_DP_Terminal] [varchar](50) NULL,
	[CCD_DP_Date] [smalldatetime] NULL,
	[CCD_STS_Operation] [char](1) NULL,
	[CQD_CargoContaminant] [varchar](500) NULL,
	[CQD_CargoQty] [int] NULL,
	[CQD_TanksInspected] [char](1) NULL,
	[CQD_WallWashTestDone] [char](1) NULL,
	[Navigation] [varchar](500) NULL,
	[Env_Pollution] [varchar](500) NULL,
	[Env_Pollution_Other] [varchar](50) NULL,
	[Is_LossToEnv] [char](1) NULL,
	[LE_SpillType] [int] NULL,
	[LE_Category] [varchar](500) NULL,
	[LE_Category_Other] [varchar](50) NULL,
	[Incident_First_Obseved_Date] [datetime] NULL,
	[Ceased_Operation_Date] [datetime] NULL,
	[Reported_To_Authority] [char](1) NULL,
	[ReportingDate] [datetime] NULL,
	[AuthorityName] [varchar](50) NULL,
	[Mooring] [varchar](500) NULL,
	[Is_Equip_Affected] [char](1) NULL,
	[Equipments] [varchar](500) NULL,
	[Is_DamageToThirdParty] [char](1) NULL,
	[DamageToThirdParty] [varchar](50) NULL,
	[DamageToThirdParty_Other] [varchar](50) NULL,
	[Is_DamageToOwnVessel] [char](1) NULL,
	[DamageToOwnVessel] [varchar](50) NULL,
	[DamageToOwnVessel_Other] [varchar](50) NULL,
	[Is_Explosion] [char](1) NULL,
	[ExplosionOn] [varchar](500) NULL,
	[ExplosionOn_Other] [varchar](50) NULL,
	[Security] [varchar](500) NULL,
	[Security_Other] [varchar](50) NULL,
	[CA_HumanActions] [varchar](500) NULL,
	[CA_HumanActions_Other] [varchar](50) NULL,
	[CA_Conditions] [varchar](500) NULL,
	[CA_Conditions_Other] [varchar](50) NULL,
	[RC_HumanFactors] [varchar](500) NULL,
	[RC_HumanFactors_Other] [varchar](50) NULL,
	[RC_JobFactors] [varchar](500) NULL,
	[RC_JobFactors_Other] [varchar](50) NULL,
	[Is_ImmadiateActionTaken] [char](1) NULL,
	[IA_Yes_Desc] [varchar](500) NULL,
	[Is_Action_Recommended] [char](1) NULL,
	[AR_Yes_Desc] [varchar](500) NULL,
	[Is_ImmediateTraining] [char](1) NULL,
	[IT_Details] [varchar](500) NULL,
	[Is_FurtherTrainingReq] [char](1) NULL,
	[FT_Details] [varchar](500) NULL,
	[Is_SafetyMeeting] [char](1) NULL,
	[SM_Date] [smalldatetime] NULL,
	[Is_SupplementaryInfo] [char](1) NULL,
	[SI_Details] [varchar](500) NULL,
	[CreatedBy] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[ExportedBy] [varchar](50) NULL,
	[ExportedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_ER_S115_Report] PRIMARY KEY CLUSTERED 
(
	[ReportId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_S115_Report_EmailBlast]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_Report_EmailBlast]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_S115_Report_EmailBlast](
	[VESSELCODE] [char](3) NOT NULL,
	[REPORTID] [bigint] NOT NULL,
	[ACCVSLCODE] [char](3) NOT NULL,
	[AccidentHappen] [bit] NULL,
	[CAPATaken] [bit] NULL,
	[Comments] [varchar](500) NULL,
	[PacketSentDate] [smalldatetime] NULL,
	[PacketRecievedDate] [smalldatetime] NULL,
 CONSTRAINT [PK_ER_S115_Report_EmailBlast] PRIMARY KEY CLUSTERED 
(
	[VESSELCODE] ASC,
	[REPORTID] ASC,
	[ACCVSLCODE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_S115_Report_Office]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S115_Report_Office]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_S115_Report_Office](
	[ReportId] [bigint] NOT NULL,
	[VesselCode] [char](3) NULL,
	[Is_Vessel_Delayed] [char](1) NULL,
	[VesselDelayed_Days] [int] NULL,
	[VesselDelayed_Hours] [int] NULL,
	[Potential_Recurrence] [int] NULL,
	[Is_InvestigationDone] [char](1) NULL,
	[InvestigationDate] [smalldatetime] NULL,
	[NameOfPerson_Org] [varchar](50) NULL,
	[O_HumanActions] [varchar](500) NULL,
	[O_HumanActions_Other] [varchar](50) NULL,
	[O_Conditions] [varchar](500) NULL,
	[O_Conditions_Other] [varchar](50) NULL,
	[O_HumanFactors] [varchar](500) NULL,
	[O_HumanFactors_Other] [varchar](50) NULL,
	[O_JobFactors] [varchar](500) NULL,
	[O_JobFactors_Other] [varchar](50) NULL,
	[ReasonDiffRCA] [varchar](500) NULL,
	[Is_FollowUPReq] [char](1) NULL,
	[TargetDate] [smalldatetime] NULL,
	[FU_Details] [varchar](500) NULL,
	[FU_PIC] [varchar](50) NULL,
	[Suggestions] [varchar](50) NULL,
	[Remarks] [varchar](500) NULL,
	[Is_Closed] [char](1) NULL,
	[CloseDate] [smalldatetime] NULL,
	[ClosedBy] [varchar](50) NULL,
	[Is_Closure_Notified] [char](1) NULL,
	[NotifyDate] [smalldatetime] NULL,
	[CreatedBy] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[Status] [char](1) NULL,
	[Locked] [char](1) NULL,
	[ExportedBy] [varchar](50) NULL,
	[ExportedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_ER_S115_Report_Office] PRIMARY KEY CLUSTERED 
(
	[ReportId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_S133_Report]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S133_Report]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_S133_Report](
	[ReportId] [bigint] NOT NULL,
	[ReportNo] [varchar](50) NULL,
	[VesselCode] [char](3) NOT NULL,
	[ReportDate] [datetime] NULL,
	[DateOfOccurence] [datetime] NULL,
	[FamilyName] [varchar](50) NULL,
	[FirstName] [varchar](50) NULL,
	[RankId] [int] NULL,
	[CrewNo] [varchar](50) NULL,
	[Category] [varchar](500) NULL,
	[EventDescr] [varchar](1000) NULL,
	[Suggestions] [varchar](1000) NULL,
	[SM_FamilyName] [varchar](50) NULL,
	[SM_FirstName] [varchar](50) NULL,
	[SM_CrewNo] [varchar](50) NULL,
	[CreatedBy] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[ExportedBy] [varchar](50) NULL,
	[ExportedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_ER_S115A_Report] PRIMARY KEY CLUSTERED 
(
	[ReportId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ER_S133_Report_Office]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ER_S133_Report_Office]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ER_S133_Report_Office](
	[ReportId] [bigint] NOT NULL,
	[VesselCode] [char](3) NULL,
	[Remarks] [varchar](500) NULL,
	[NMSeverity] [char](1) NULL,
	[CA_HumanActions] [varchar](500) NULL,
	[CA_HumanActions_Other] [varchar](50) NULL,
	[CA_Conditions] [varchar](500) NULL,
	[CA_Conditions_Other] [varchar](50) NULL,
	[RC_HumanFactors] [varchar](500) NULL,
	[RC_HumanFactors_Other] [varchar](50) NULL,
	[RC_JobFactors] [varchar](500) NULL,
	[RC_JobFactors_Other] [varchar](50) NULL,
	[Is_Closed] [char](1) NULL,
	[CloseDate] [smalldatetime] NULL,
	[ClosedBy] [varchar](50) NULL,
	[Is_Closure_Notified] [char](1) NULL,
	[NotifyDate] [smalldatetime] NULL,
	[CreatedBy] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[Status] [char](1) NULL,
	[Locked] [char](1) NULL,
	[ExportedBy] [varchar](50) NULL,
	[ExportedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_ER_S133_Report_Office] PRIMARY KEY CLUSTERED 
(
	[ReportId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[EV_EventMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_EventMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[EV_EventMaster](
	[EventId] [bigint] NOT NULL,
	[EventName] [varchar](50) NULL,
 CONSTRAINT [PK_EV_EventMaster] PRIMARY KEY CLUSTERED 
(
	[EventId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[EV_HazardMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_HazardMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[EV_HazardMaster](
	[HazardId] [bigint] NOT NULL,
	[EventId] [bigint] NULL,
	[HazardName] [varchar](1000) NULL,
	[STD_CONTROL_MEASURES] [varchar](5000) NULL,
	[ADD_CONTROL_MEASURES] [varchar](5000) NULL,
 CONSTRAINT [PK_EV_HazardMaster] PRIMARY KEY CLUSTERED 
(
	[HazardId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[EV_Off_RISKMGMT_DETAILS]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_Off_RISKMGMT_DETAILS]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[EV_Off_RISKMGMT_DETAILS](
	[TABLID] [bigint] NOT NULL,
	[RISKID] [bigint] NOT NULL,
	[OfficeId] [bigint] NOT NULL,
	[ROUTINE] [char](1) NULL,
	[HAZARDID] [bigint] NOT NULL,
	[HAZARDNAME] [varchar](1000) NULL,
	[LIKELIHOOD] [int] NULL,
	[CONSEQUENCES] [int] NULL,
	[RISKRANK] [char](1) NULL,
	[Re_LIKELIHOOD] [int] NULL,
	[Re_CONSEQUENCES] [int] NULL,
	[Re_RISKRANK] [char](1) NULL,
	[STD_CONTROL_MESASRUES] [varchar](1000) NULL,
	[ADD_CONTROL_MEASURES] [varchar](1000) NULL,
	[AGREED_TIME] [varchar](50) NULL,
	[PIC_NAME] [varchar](50) NULL,
 CONSTRAINT [PK_EV_Off_RISKMGMT_DETAILS] PRIMARY KEY CLUSTERED 
(
	[TABLID] ASC,
	[RISKID] ASC,
	[OfficeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[EV_Off_RISKMGMT_MASTER]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_Off_RISKMGMT_MASTER]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[EV_Off_RISKMGMT_MASTER](
	[RISKID] [bigint] NOT NULL,
	[OfficeId] [bigint] NOT NULL,
	[EVENTID] [bigint] NOT NULL,
	[EVENTDATE] [smalldatetime] NULL,
	[REFNO] [varchar](50) NULL,
	[RiskDescr] [varchar](max) NULL,
	[ALTERNATEMETHODS] [char](1) NULL,
	[Details] [varchar](max) NULL,
	[HOD_NAME] [varchar](50) NULL,
	[SAF_OFF_NAME] [varchar](50) NULL,
	[MASTER_NAME] [varchar](50) NULL,
	[STATUS] [char](1) NULL,
	[OFFICE_COMMENTS] [varchar](1000) NULL,
	[OFFICECOMMENTBY] [varchar](50) NULL,
	[DESIGNATION] [varchar](50) NULL,
	[COMMENTDATE] [smalldatetime] NULL,
	[CREATED_BY] [varchar](50) NULL,
	[CREATED_ON] [smalldatetime] NULL,
	[POSITION] [varchar](50) NULL,
	[ApprovalFwdTo] [int] NULL,
	[ApprovalStatus] [char](1) NULL,
 CONSTRAINT [PK_EV_Off_RISKMGMT_MASTER] PRIMARY KEY CLUSTERED 
(
	[RISKID] ASC,
	[OfficeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[EV_VSL_RISKMGMT_DETAILS]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_VSL_RISKMGMT_DETAILS]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[EV_VSL_RISKMGMT_DETAILS](
	[TABLID] [bigint] NOT NULL,
	[RISKID] [bigint] NOT NULL,
	[VESSELCODE] [char](3) NOT NULL,
	[ROUTINE] [char](1) NULL,
	[HAZARDID] [bigint] NOT NULL,
	[HAZARDNAME] [varchar](1000) NULL,
	[LIKELIHOOD] [int] NULL,
	[CONSEQUENCES] [int] NULL,
	[RISKRANK] [char](1) NULL,
	[Re_LIKELIHOOD] [int] NULL,
	[Re_CONSEQUENCES] [int] NULL,
	[Re_RISKRANK] [char](1) NULL,
	[STD_CONTROL_MESASRUES] [varchar](1000) NULL,
	[ADD_CONTROL_MEASURES] [varchar](1000) NULL,
	[AGREED_TIME] [varchar](50) NULL,
	[PIC_NAME] [varchar](50) NULL,
 CONSTRAINT [PK_EV_VSL_RISKMGMT_DETAILS] PRIMARY KEY CLUSTERED 
(
	[TABLID] ASC,
	[RISKID] ASC,
	[VESSELCODE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[EV_VSL_RISKMGMT_MASTER]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EV_VSL_RISKMGMT_MASTER]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[EV_VSL_RISKMGMT_MASTER](
	[RISKID] [bigint] NOT NULL,
	[VESSELCODE] [char](3) NOT NULL,
	[EVENTID] [bigint] NOT NULL,
	[EVENTDATE] [smalldatetime] NULL,
	[REFNO] [varchar](50) NULL,
	[RiskDescr] [varchar](max) NULL,
	[ALTERNATEMETHODS] [char](1) NULL,
	[Details] [varchar](max) NULL,
	[HOD_NAME] [varchar](50) NULL,
	[SAF_OFF_NAME] [varchar](50) NULL,
	[MASTER_NAME] [varchar](50) NULL,
	[STATUS] [char](1) NULL,
	[OFFICE_COMMENTS] [varchar](1000) NULL,
	[OFFICECOMMENTBY] [varchar](50) NULL,
	[DESIGNATION] [varchar](50) NULL,
	[COMMENTDATE] [smalldatetime] NULL,
	[CREATED_BY] [varchar](50) NULL,
	[CREATED_ON] [smalldatetime] NULL,
	[POSITION] [varchar](50) NULL,
 CONSTRAINT [PK_EV_VSL_RISKMGMT_MASTER] PRIMARY KEY CLUSTERED 
(
	[RISKID] ASC,
	[VESSELCODE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[FocusCamp]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[FocusCamp]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[FocusCamp](
	[FocusCampId] [int] NOT NULL,
	[FocusCampNumber] [varchar](50) NULL,
	[FocusCampDate] [smalldatetime] NULL,
	[Title] [varchar](500) NULL,
	[AttachmentFileName] [varchar](100) NULL,
	[Attachment] [image] NULL,
	[Status] [char](1) NULL,
	[CreatedBy] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
	[PublishedBy] [varchar](50) NULL,
	[PublishedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_FocusCamp_1] PRIMARY KEY CLUSTERED 
(
	[FocusCampId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[FocusCamp_Categories]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[FocusCamp_Categories]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[FocusCamp_Categories](
	[FocusCampId] [int] NOT NULL,
	[FocusCampCatId] [int] NOT NULL,
 CONSTRAINT [PK_FocusCamp_Categories] PRIMARY KEY CLUSTERED 
(
	[FocusCampId] ASC,
	[FocusCampCatId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
/****** Object:  Table [dbo].[FocusCamp_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[FocusCamp_Vessel_Notifications]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[FocusCamp_Vessel_Notifications](
	[FocusCampId] [int] NOT NULL,
	[VESSELCODE] [varchar](3) NOT NULL,
	[SentOn] [smalldatetime] NULL,
	[AckOn] [smalldatetime] NULL,
	[AckMessage] [varchar](500) NULL,
	[Discussed] [bit] NULL,
	[Notice] [bit] NULL,
 CONSTRAINT [PK_FocusCamp_Email_Notifications] PRIMARY KEY CLUSTERED 
(
	[FocusCampId] ASC,
	[VESSELCODE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[FocusCampCategory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[FocusCampCategory]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[FocusCampCategory](
	[FocusCampCatId] [int] NOT NULL,
	[FocusCampCatName] [varchar](50) NULL,
 CONSTRAINT [PK_FocusCampCategory] PRIMARY KEY CLUSTERED 
(
	[FocusCampCatId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[IE_PacketCreated]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[IE_PacketCreated]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[IE_PacketCreated](
	[VesselCode] [char](3) NOT NULL,
	[RowId] [bigint] NOT NULL,
	[PacketName] [varchar](50) NULL,
	[PacketDate] [smalldatetime] NULL,
 CONSTRAINT [PK_IE_PacketCreated_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[RowId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[IE_PacketCreated_MNP]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[IE_PacketCreated_MNP]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[IE_PacketCreated_MNP](
	[VesselCode] [char](3) NOT NULL,
	[RowId] [bigint] NOT NULL,
	[PacketName] [varchar](50) NULL,
	[PacketDate] [smalldatetime] NULL,
 CONSTRAINT [PK_IE_PacketCreated_MNP] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[RowId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[IE_PacketCreatedDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[IE_PacketCreatedDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[IE_PacketCreatedDetails](
	[VesselCode] [char](3) NULL,
	[RowId] [bigint] NULL,
	[TableID] [varchar](50) NULL,
	[PKString] [varchar](50) NULL,
	[UpdatedOn] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[IE_PacketCreatedDetails_MNP]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[IE_PacketCreatedDetails_MNP]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[IE_PacketCreatedDetails_MNP](
	[VesselCode] [char](3) NULL,
	[RowId] [bigint] NULL,
	[TableID] [varchar](50) NULL,
	[PKString] [varchar](50) NULL,
	[UpdatedOn] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[IE_PacketReceived]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[IE_PacketReceived]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[IE_PacketReceived](
	[PacketId] [bigint] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[PacketName] [varchar](50) NOT NULL,
	[PacketDate] [smalldatetime] NULL,
 CONSTRAINT [PK_IE_PacketReceived_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[PacketName] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[IE_PacketReceived_MNP]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[IE_PacketReceived_MNP]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[IE_PacketReceived_MNP](
	[PacketId] [bigint] NULL,
	[VesselCode] [char](3) NOT NULL,
	[PacketName] [varchar](50) NOT NULL,
	[PacketDate] [smalldatetime] NULL,
 CONSTRAINT [PK_IE_PacketReceived_MNP] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[PacketName] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[JobIntervalMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[JobIntervalMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[JobIntervalMaster](
	[IntervalId] [int] NOT NULL,
	[IntervalName] [varchar](50) NULL,
 CONSTRAINT [PK_JobIntervalMaster] PRIMARY KEY CLUSTERED 
(
	[IntervalId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[JobMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[JobMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[JobMaster](
	[JobId] [bigint] NOT NULL,
	[JobCode] [char](3) NULL,
	[JobName] [varchar](50) NULL,
 CONSTRAINT [PK_JobTypeMaster] PRIMARY KEY CLUSTERED 
(
	[JobId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[LFI]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LFI]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[LFI](
	[LFIId] [int] NOT NULL,
	[LFINumber] [varchar](50) NULL,
	[LFIDate] [smalldatetime] NULL,
	[Title] [varchar](500) NULL,
	[AttachmentFileName] [varchar](100) NULL,
	[Attachment] [image] NULL,
	[Status] [char](1) NULL,
	[CreatedBy] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
	[PublishedBy] [varchar](50) NULL,
	[PublishedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_LFI_1] PRIMARY KEY CLUSTERED 
(
	[LFIId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[LFI_Categories]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LFI_Categories]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[LFI_Categories](
	[LFIId] [int] NOT NULL,
	[LFICatId] [int] NOT NULL,
 CONSTRAINT [PK_LFI_Categories] PRIMARY KEY CLUSTERED 
(
	[LFIId] ASC,
	[LFICatId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
/****** Object:  Table [dbo].[LFI_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LFI_Vessel_Notifications]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[LFI_Vessel_Notifications](
	[LFIId] [int] NOT NULL,
	[VESSELCODE] [varchar](3) NOT NULL,
	[SentOn] [smalldatetime] NULL,
	[AckOn] [smalldatetime] NULL,
	[AckMessage] [varchar](500) NULL,
	[Discussed] [bit] NULL,
	[Notice] [bit] NULL,
 CONSTRAINT [PK_LFI_Email_Notifications] PRIMARY KEY CLUSTERED 
(
	[LFIId] ASC,
	[VESSELCODE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[LFICategory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LFICategory]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[LFICategory](
	[LFICatId] [int] NOT NULL,
	[LFICatName] [varchar](50) NULL,
 CONSTRAINT [PK_LFICategory] PRIMARY KEY CLUSTERED 
(
	[LFICatId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MailSettings]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MailSettings]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MailSettings](
	[Id] [int] NOT NULL,
	[SenderAddress] [varchar](50) NULL,
	[SenderUserName] [varchar](50) NULL,
	[senderPass] [varchar](50) NULL,
	[MailClient] [varchar](50) NULL,
	[Port] [varchar](50) NULL,
	[Mail_Encryption] [varchar](10) NULL,
	[ToAddress] [varchar](50) NULL,
	[PacketMode] [char](1) NULL,
 CONSTRAINT [PK_MailSettings] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_AllRank]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_AllRank]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_AllRank](
	[RankId] [int] NULL,
	[RankCode] [varchar](10) NULL,
	[RankName] [varchar](50) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_CrewComplementDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_CrewComplementDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_CrewComplementDetails](
	[CCId] [bigint] NULL,
	[VesselCode] [char](3) NULL,
	[RankId] [int] NULL,
	[BudgetManning] [int] NULL,
	[BudgetNationality] [int] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_CrewComplementMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_CrewComplementMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_CrewComplementMaster](
	[CCId] [bigint] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[EffectiveFrom] [datetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[AckRecd] [bit] NULL,
	[AckRecdOn] [smalldatetime] NULL,
 CONSTRAINT [PK_MP_CrewComplementMaster_1] PRIMARY KEY CLUSTERED 
(
	[CCId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_MainCategory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_MainCategory]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_MainCategory](
	[CategoryId] [bigint] NOT NULL,
	[CategoryName] [varchar](50) NULL,
	[CategoryCode] [char](5) NULL,
	[ParentCategoryId] [bigint] NULL,
	[OrderUnitId] [int] NULL,
	[ConsumptionUnitId] [int] NULL,
	[ConversionFactor] [float] NULL,
	[Level] [char](1) NULL,
	[Inactive] [bit] NULL,
 CONSTRAINT [PK_MP_MainCategory] PRIMARY KEY CLUSTERED 
(
	[CategoryId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_MealConsumptionDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_MealConsumptionDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_MealConsumptionDetails](
	[MealConsumptionDetailId] [bigint] NOT NULL,
	[MealConsumptionId] [bigint] NULL,
	[CategoryId] [bigint] NULL,
	[UnitId] [bigint] NULL,
	[StdConsumption] [float] NULL,
 CONSTRAINT [PK_MP_MealConsumptionDetails] PRIMARY KEY CLUSTERED 
(
	[MealConsumptionDetailId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
/****** Object:  Table [dbo].[MP_MealConsumptionMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_MealConsumptionMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_MealConsumptionMaster](
	[MealConsumptionId] [bigint] NOT NULL,
	[NationalityId] [bigint] NULL,
	[MealId] [bigint] NULL,
	[Version] [varchar](50) NULL,
	[EffectiveFrom] [datetime] NULL,
 CONSTRAINT [PK_MP_MealConsumptionMaster] PRIMARY KEY CLUSTERED 
(
	[MealConsumptionId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_MealsTypeMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_MealsTypeMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_MealsTypeMaster](
	[MealId] [bigint] NULL,
	[MealType] [varchar](100) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_NationalityMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_NationalityMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_NationalityMaster](
	[NationalityId] [bigint] NOT NULL,
	[NationalityName] [varchar](100) NULL,
 CONSTRAINT [PK_MP_NationalityMaster] PRIMARY KEY CLUSTERED 
(
	[NationalityId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_Products]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_Products]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_Products](
	[CategoryId] [bigint] NOT NULL,
	[ProductId] [bigint] NOT NULL,
	[ProductCode] [char](9) NULL,
	[ProductName] [varchar](50) NULL,
	[SupplyUnitId] [int] NULL,
	[IMPACode] [varchar](50) NULL,
	[Inactive] [bit] NULL,
 CONSTRAINT [PK_MP_Products] PRIMARY KEY CLUSTERED 
(
	[CategoryId] ASC,
	[ProductId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_Products_Packaging]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_Products_Packaging]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_Products_Packaging](
	[ProductId] [bigint] NULL,
	[Qty] [int] NULL,
	[UnitId] [int] NULL,
	[OrderQty] [float] NULL
) ON [PRIMARY]
END
GO
/****** Object:  Table [dbo].[MP_UnitMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_UnitMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_UnitMaster](
	[UnitId] [bigint] NOT NULL,
	[UnitName] [varchar](100) NULL,
 CONSTRAINT [PK_MP_UnitMaster] PRIMARY KEY CLUSTERED 
(
	[UnitId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VictualingMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VictualingMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VictualingMaster](
	[VID] [bigint] NOT NULL,
	[VesselCode] [char](3) NULL,
	[EffectiveDate] [smalldatetime] NULL,
	[VesselAccount] [float] NULL,
	[OwnerAccount] [float] NULL,
	[CharterAccount] [float] NULL,
 CONSTRAINT [PK_MP_VictualingMaster] PRIMARY KEY CLUSTERED 
(
	[VID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_AccountDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_AccountDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_AccountDetails](
	[AccountDetailId] [bigint] NOT NULL,
	[AccountId] [bigint] NOT NULL,
	[VesselCode] [char](3) NULL,
	[Name] [varchar](50) NULL,
	[Rank] [varchar](50) NULL,
	[Company] [varchar](50) NULL,
	[FromDay] [int] NULL,
	[ToDay] [int] NULL,
	[NoOfMealsServed] [int] NULL,
	[Remarks] [varchar](5000) NULL,
 CONSTRAINT [PK_MP_VSL_AccountDetails_1] PRIMARY KEY CLUSTERED 
(
	[AccountDetailId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_AccountMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_AccountMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_AccountMaster](
	[AccountId] [bigint] NOT NULL,
	[AccountType] [char](1) NULL,
	[VesselCode] [char](3) NULL,
	[Month] [int] NULL,
	[Year] [int] NULL,
	[UpdatedBy] [varchar](50) NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
 CONSTRAINT [PK_MP_VSL_InsertUpdateAccountMaster] PRIMARY KEY CLUSTERED 
(
	[AccountId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_InventoryDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_InventoryDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_InventoryDetails](
	[VesselCode] [char](3) NOT NULL,
	[InventoryId] [bigint] NOT NULL,
	[ProductId] [bigint] NOT NULL,
	[Quantity] [float] NULL,
	[Spoilage] [float] NULL,
 CONSTRAINT [PK_MP_VSL_InventoryDetails_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[InventoryId] ASC,
	[ProductId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_InventoryMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_InventoryMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_InventoryMaster](
	[InventoryId] [bigint] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[InventoryDate] [smalldatetime] NULL,
	[UpdatedBy] [varchar](50) NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
 CONSTRAINT [PK_MP_VSL_InventoryMaster] PRIMARY KEY CLUSTERED 
(
	[InventoryId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_MenuCalculator]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_MenuCalculator]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_MenuCalculator](
	[VesselCode] [char](3) NULL,
	[MenuDate] [smalldatetime] NULL,
	[CategoryId] [int] NULL,
	[MealId] [int] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_MenuCalculator_SHIP]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_MenuCalculator_SHIP]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_MenuCalculator_SHIP](
	[VesselCode] [char](3) NULL,
	[MenuDate] [smalldatetime] NULL,
	[CategoryId] [int] NULL,
	[MealId] [int] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_ProvisionDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_ProvisionDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_ProvisionDetails](
	[VesselCode] [char](3) NOT NULL,
	[ProvisionId] [bigint] NOT NULL,
	[ProductId] [bigint] NOT NULL,
	[ROBQty] [float] NULL,
	[ReqQty] [float] NULL,
	[ReqQty_Office] [float] NULL,
	[OrderQtyPerUnit] [float] NULL,
	[PackagingName] [varchar](50) NULL,
	[UnitName] [varchar](50) NULL,
 CONSTRAINT [PK_MP_VSL_ProvisionDetails_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[ProvisionId] ASC,
	[ProductId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_ProvisionMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_ProvisionMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_ProvisionMaster](
	[ProvisionId] [bigint] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[Department] [varchar](50) NULL,
	[AcctCode] [varchar](50) NULL,
	[RequisitionNo] [varchar](50) NULL,
	[PortOfSupply] [varchar](50) NULL,
	[ETA] [smalldatetime] NULL,
	[Remarks] [varchar](5000) NULL,
	[UpdatedBy] [varchar](50) NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[ApprovedBy] [varchar](50) NULL,
	[ApprovedOn] [smalldatetime] NULL,
	[Status] [char](1) NULL,
	[SentOn] [smalldatetime] NULL,
	[ReceivedOn] [smalldatetime] NULL,
	[ActiveInactive] [char](1) NULL,
	[OfficeRemarks] [varchar](1000) NULL,
	[OfficeRemarksBy] [varchar](50) NULL,
	[OfficeRemarksOn] [smalldatetime] NULL,
	[TransferedBy] [int] NULL,
	[TransferedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_MP_VSL_ProvisionMaster] PRIMARY KEY CLUSTERED 
(
	[ProvisionId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_ProvisionNationalityWise]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_ProvisionNationalityWise]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_ProvisionNationalityWise](
	[VesselCode] [char](3) NULL,
	[ProvisionId] [bigint] NULL,
	[NationalityId] [int] NULL,
	[NoOfCrew] [int] NULL,
	[NoOfDays] [int] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_ProvisionOtherItems]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_ProvisionOtherItems]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_ProvisionOtherItems](
	[VesselCode] [char](3) NOT NULL,
	[ProvisionId] [bigint] NOT NULL,
	[OtherItemId] [bigint] NOT NULL,
	[ProductName] [varchar](50) NULL,
	[Packaging] [varchar](50) NULL,
	[ROBQty] [float] NULL,
	[ReqQty] [float] NULL,
	[UnitId] [int] NULL,
	[ReqQty_Office] [float] NULL,
 CONSTRAINT [PK_MP_VSL_ProvisionOtherItems_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[ProvisionId] ASC,
	[OtherItemId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_ShipStaffDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_ShipStaffDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_ShipStaffDetails](
	[ShipStaffDetailId] [bigint] NOT NULL,
	[ShipStaffId] [bigint] NULL,
	[VesselCode] [char](3) NULL,
	[Name] [varchar](50) NULL,
	[Rank] [int] NULL,
	[Nationality] [int] NULL,
	[FromDay] [int] NULL,
	[ToDay] [int] NULL,
 CONSTRAINT [PK_MP_VSL_ShipStaffDetails] PRIMARY KEY CLUSTERED 
(
	[ShipStaffDetailId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_ShipStaffMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_ShipStaffMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_ShipStaffMaster](
	[ShipStaffId] [bigint] NOT NULL,
	[VesselCode] [char](3) NULL,
	[Month] [int] NULL,
	[Year] [int] NULL,
	[UpdatedBy] [varchar](50) NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
 CONSTRAINT [PK_MP_VSL_ShipStaffMaster] PRIMARY KEY CLUSTERED 
(
	[ShipStaffId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_SparesReqDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_SparesReqDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_SparesReqDetails](
	[SpareReqId] [int] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[ComponentId] [int] NOT NULL,
	[Office_Ship] [char](1) NOT NULL,
	[SpareId] [int] NOT NULL,
	[QTY] [float] NULL,
	[ROB] [float] NULL,
	[UOM] [varchar](50) NULL,
	[OfficeQty] [float] NULL,
	[OfficeUOM] [varchar](50) NULL,
 CONSTRAINT [PK_MP_VSL_SparesReqDetails] PRIMARY KEY CLUSTERED 
(
	[SpareReqId] ASC,
	[VesselCode] ASC,
	[ComponentId] ASC,
	[Office_Ship] ASC,
	[SpareId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_SparesReqMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_SparesReqMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_SparesReqMaster](
	[VesselCode] [char](3) NOT NULL,
	[SpareReqId] [int] NOT NULL,
	[ReqnNo] [varchar](50) NULL,
	[AccountCode] [int] NULL,
	[Port] [varchar](50) NULL,
	[ETA] [smalldatetime] NULL,
	[Remarks] [varchar](5000) NULL,
	[UpdatedBy] [varchar](50) NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[ApprovedBy] [varchar](50) NULL,
	[ApprovedOn] [smalldatetime] NULL,
	[Status] [char](1) NULL,
	[SentOn] [smalldatetime] NULL,
	[ReceivedOn] [smalldatetime] NULL,
	[ActiveInactive] [char](1) NULL,
	[OfficeRemarks] [varchar](1000) NULL,
	[OfficeRemarksBy] [varchar](50) NULL,
	[OfficeRemarksOn] [smalldatetime] NULL,
	[TransferedBy] [int] NULL,
	[TransferedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_MP_VSL_SparesReqMaster] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[SpareReqId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_StoreItemMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_StoreItemMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_StoreItemMaster](
	[VesselCode] [char](3) NOT NULL,
	[ItemId] [bigint] NOT NULL,
	[ItemName] [varchar](1000) NULL,
	[Description] [varchar](1000) NULL,
	[ISSA_IMPA] [varchar](100) NULL,
	[UOM] [varchar](50) NULL,
	[AccountCode] [int] NULL,
 CONSTRAINT [PK_MP_VSL_StoreItemMaster] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[ItemId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_StoreReqDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_StoreReqDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_StoreReqDetails](
	[StoreReqId] [int] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[ItemId] [bigint] NOT NULL,
	[QTY] [float] NULL,
	[ROB] [float] NULL,
	[OfficeQty] [float] NULL,
 CONSTRAINT [PK_MP_VSL_StoreReqDetails] PRIMARY KEY CLUSTERED 
(
	[StoreReqId] ASC,
	[VesselCode] ASC,
	[ItemId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_StoreReqMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_StoreReqMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_StoreReqMaster](
	[VesselCode] [char](3) NOT NULL,
	[StoreReqId] [int] NOT NULL,
	[ReqnNo] [varchar](50) NULL,
	[AccountCode] [int] NULL,
	[Port] [varchar](50) NULL,
	[ETA] [smalldatetime] NULL,
	[Remarks] [varchar](5000) NULL,
	[UpdatedBy] [varchar](50) NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[ApprovedBy] [varchar](50) NULL,
	[ApprovedOn] [smalldatetime] NULL,
	[Status] [char](1) NULL,
	[SentOn] [smalldatetime] NULL,
	[ReceivedOn] [smalldatetime] NULL,
	[ActiveInactive] [char](1) NULL,
	[OfficeRemarks] [varchar](1000) NULL,
	[OfficeRemarksBy] [varchar](50) NULL,
	[OfficeRemarksOn] [smalldatetime] NULL,
	[TransferedBy] [int] NULL,
	[TransferedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_MP_VSL_StoreReqMaster] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[StoreReqId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_SupplyDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_SupplyDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_SupplyDetails](
	[SupplyDetailId] [bigint] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[SupplyId] [bigint] NULL,
	[ProductId] [bigint] NULL,
	[Quantity] [float] NULL,
	[PackagingQty] [float] NULL,
	[PackagingUnit] [int] NULL,
	[PackagingOrderQty] [float] NULL,
 CONSTRAINT [PK_MP_VSL_SupplyDetails_1] PRIMARY KEY CLUSTERED 
(
	[SupplyDetailId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_SupplyMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_SupplyMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_SupplyMaster](
	[SupplyId] [bigint] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[Mode] [varchar](50) NULL,
	[PONumber] [varchar](50) NULL,
	[VenderName] [varchar](50) NULL,
	[Port] [varchar](50) NULL,
	[ReceivingDate] [smalldatetime] NULL,
	[UpdatedBy] [varchar](50) NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
 CONSTRAINT [PK_MP_VSL_SupplyMaster] PRIMARY KEY CLUSTERED 
(
	[SupplyId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_TMP_Provision]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_TMP_Provision]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_TMP_Provision](
	[UserId] [int] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[ProductId] [int] NOT NULL,
	[QTY] [float] NULL,
	[ROB] [float] NULL,
	[OrderQtyPerUnit] [int] NULL,
	[PackagingName] [varchar](50) NULL,
	[UnitName] [varchar](50) NULL,
 CONSTRAINT [PK_MP_VSL_TMP_Provision] PRIMARY KEY CLUSTERED 
(
	[UserId] ASC,
	[VesselCode] ASC,
	[ProductId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_TMP_Provision_OtherItems]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_TMP_Provision_OtherItems]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_TMP_Provision_OtherItems](
	[UserId] [int] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[OtherItemId] [int] NOT NULL,
	[ProductName] [varchar](50) NULL,
	[Packaging] [varchar](50) NULL,
	[QTY] [float] NULL,
	[ROB] [float] NULL,
	[UnitId] [int] NULL,
 CONSTRAINT [PK_MP_VSL_TMP_Provision_OtherItems] PRIMARY KEY CLUSTERED 
(
	[UserId] ASC,
	[VesselCode] ASC,
	[OtherItemId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_TMP_Spares]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_TMP_Spares]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_TMP_Spares](
	[UserId] [int] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[ComponentId] [int] NOT NULL,
	[Office_Ship] [char](1) NOT NULL,
	[SpareId] [int] NOT NULL,
	[QTY] [float] NULL,
	[ROB] [float] NULL,
	[UOM] [varchar](50) NULL,
	[OfficeQty] [float] NULL,
	[OfficeUOM] [varchar](50) NULL,
 CONSTRAINT [PK_Table_1] PRIMARY KEY CLUSTERED 
(
	[UserId] ASC,
	[VesselCode] ASC,
	[ComponentId] ASC,
	[Office_Ship] ASC,
	[SpareId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MP_VSL_TMP_Stores]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MP_VSL_TMP_Stores]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MP_VSL_TMP_Stores](
	[UserId] [int] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[ItemId] [bigint] NOT NULL,
	[QTY] [float] NULL,
	[ROB] [float] NULL,
 CONSTRAINT [PK_MP_VSL_TMP_Stores] PRIMARY KEY CLUSTERED 
(
	[UserId] ASC,
	[VesselCode] ASC,
	[ItemId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MWUC_CATMASTER]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_CATMASTER]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MWUC_CATMASTER](
	[VESSELCODE] [char](3) NOT NULL,
	[CATID] [int] NOT NULL,
	[CATNAME] [varchar](500) NULL,
 CONSTRAINT [PK_MWUC_CATMASTER_1] PRIMARY KEY CLUSTERED 
(
	[VESSELCODE] ASC,
	[CATID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MWUC_DETAILS]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_DETAILS]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MWUC_DETAILS](
	[VESSELCODE] [char](3) NOT NULL,
	[TABLEID] [bigint] NOT NULL,
	[CATID] [int] NOT NULL,
	[SHIPCOMMENT] [varchar](max) NULL,
	[SHIPCOMMENTON] [smalldatetime] NULL,
	[OFFICECOMMENT] [varchar](max) NULL,
	[OFFICECOMMENTBY] [varchar](50) NULL,
	[OFFICECOMMENTPOSITION] [varchar](50) NULL,
	[OFFICECOMMENTON] [smalldatetime] NULL,
 CONSTRAINT [PK_MWUC_DETAILS] PRIMARY KEY CLUSTERED 
(
	[VESSELCODE] ASC,
	[TABLEID] ASC,
	[CATID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MWUC_MASTER]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MWUC_MASTER]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[MWUC_MASTER](
	[VESSELCODE] [char](3) NOT NULL,
	[TABLEID] [bigint] NOT NULL,
	[FORDATE] [smalldatetime] NULL,
	[MASTERCREWNO] [varchar](10) NULL,
	[MASTERNAME] [varchar](50) NULL,
	[CREATEDON] [smalldatetime] NULL,
	[OFFICERECDON] [smalldatetime] NULL,
	[OFFICECLOSEDON] [smalldatetime] NULL,
 CONSTRAINT [PK_MWUC_MASTER] PRIMARY KEY CLUSTERED 
(
	[VESSELCODE] ASC,
	[TABLEID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PB_Publication_Category]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publication_Category]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[PB_Publication_Category](
	[CategoryId] [smallint] NOT NULL,
	[CategoryName] [varchar](50) NULL,
 CONSTRAINT [PK_PB_Publication_Category] PRIMARY KEY CLUSTERED 
(
	[CategoryId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PB_Publication_Location]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publication_Location]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[PB_Publication_Location](
	[LocationId] [smallint] NOT NULL,
	[LocationName] [varchar](50) NULL,
	[OfficeShip] [char](1) NULL,
 CONSTRAINT [PK_PB_Publication_Location] PRIMARY KEY CLUSTERED 
(
	[LocationId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PB_Publication_Mode]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publication_Mode]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[PB_Publication_Mode](
	[ModeId] [smallint] NOT NULL,
	[ModeName] [varchar](50) NULL,
 CONSTRAINT [PK_PB_Publication_Mode] PRIMARY KEY CLUSTERED 
(
	[ModeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PB_Publication_Type]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publication_Type]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[PB_Publication_Type](
	[TypeId] [smallint] NOT NULL,
	[TypeName] [varchar](50) NULL,
 CONSTRAINT [PK_PB_Publication_Type] PRIMARY KEY CLUSTERED 
(
	[TypeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PB_Publication_Type_Vessels]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publication_Type_Vessels]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[PB_Publication_Type_Vessels](
	[TypeId] [smallint] NULL,
	[VesselId] [smallint] NULL
) ON [PRIMARY]
END
GO
/****** Object:  Table [dbo].[PB_PublicationEditions]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_PublicationEditions]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[PB_PublicationEditions](
	[PublicationId] [bigint] NULL,
	[EditionYear] [int] NULL,
	[EditionNo] [varchar](50) NULL,
	[ValidityDate] [smalldatetime] NULL,
	[CreatedBy] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PB_Publications]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publications]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[PB_Publications](
	[PublicationId] [bigint] NOT NULL,
	[PublicationName] [varchar](100) NULL,
	[TypeId] [smallint] NULL,
	[ModeId] [smallint] NULL,
	[PublisherId] [smallint] NULL,
	[OfficeShip] [char](1) NULL,
	[OfficeLocation] [smallint] NULL,
	[ShipLocation] [smallint] NULL,
	[OfficeCustody] [smallint] NULL,
	[ShipCustody] [smallint] NULL,
	[EditionYear] [int] NULL,
	[EditionNo] [varchar](50) NULL,
	[ValidityDate] [smalldatetime] NULL,
	[CreatedBy] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_PB_Publications] PRIMARY KEY CLUSTERED 
(
	[PublicationId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PB_Publications_RequiredBy]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publications_RequiredBy]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[PB_Publications_RequiredBy](
	[PublicationId] [bigint] NOT NULL,
	[RequiredById] [bigint] NOT NULL
) ON [PRIMARY]
END
GO
/****** Object:  Table [dbo].[PB_Publisher]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_Publisher]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[PB_Publisher](
	[PublisherId] [smallint] NOT NULL,
	[PublisherName] [varchar](50) NULL,
 CONSTRAINT [PK_PB_Publisher] PRIMARY KEY CLUSTERED 
(
	[PublisherId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PB_RequiredBy]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_RequiredBy]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[PB_RequiredBy](
	[RequiredById] [smallint] NOT NULL,
	[RequiredByName] [varchar](50) NULL,
 CONSTRAINT [PK_PB_RequiredBy] PRIMARY KEY CLUSTERED 
(
	[RequiredById] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PB_VSL_Publication]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PB_VSL_Publication]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[PB_VSL_Publication](
	[VESSELCODE] [char](3) NULL,
	[PUBMONTH] [int] NULL,
	[PUBYEAR] [int] NULL,
	[PUBLICATIONID] [int] NULL,
	[PUBLICATIONNAME] [varchar](100) NULL,
	[TYPENAME] [varchar](50) NULL,
	[MODENAME] [varchar](50) NULL,
	[PUBLISHERNAME] [varchar](50) NULL,
	[OFFICESHIP] [varchar](50) NULL,
	[EDITIONYEAR] [int] NULL,
	[EDITIONNO] [varchar](50) NULL,
	[VALIDITYDATE] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Port]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Port]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Port](
	[PortId] [int] NOT NULL,
	[PortName] [varchar](50) NOT NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Rank]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Rank]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Rank](
	[RankId] [int] NOT NULL,
	[RankLevel] [smallint] NULL,
	[RankCode] [varchar](10) NULL,
	[RankName] [varchar](50) NOT NULL,
	[OffCrew] [char](1) NULL,
	[OffGroup] [char](1) NULL,
	[StatusId] [char](1) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Reg_Categories]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Reg_Categories]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Reg_Categories](
	[RegId] [int] NOT NULL,
	[RegCatId] [int] NOT NULL,
 CONSTRAINT [PK_REG_Categories] PRIMARY KEY CLUSTERED 
(
	[RegId] ASC,
	[RegCatId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
/****** Object:  Table [dbo].[Reg_Category]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Reg_Category]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Reg_Category](
	[RegCatId] [int] NOT NULL,
	[RegCatName] [varchar](50) NULL,
 CONSTRAINT [PK_RegCategory] PRIMARY KEY CLUSTERED 
(
	[RegCatId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Reg_MainSource]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Reg_MainSource]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Reg_MainSource](
	[MSId] [bigint] NOT NULL,
	[MSName] [varchar](50) NULL,
 CONSTRAINT [PK_Reg_MainSource] PRIMARY KEY CLUSTERED 
(
	[MSId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Reg_Regulation]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Reg_Regulation]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Reg_Regulation](
	[RegId] [int] NOT NULL,
	[RegNumber] [varchar](50) NULL,
	[MSId] [int] NULL,
	[SSId] [int] NULL,
	[RegDate] [smalldatetime] NULL,
	[EarAppDate] [smalldatetime] NULL,
	[Title] [varchar](500) NULL,
	[Tag] [varchar](100) NULL,
	[SMSChangeReqd] [char](1) NULL,
	[AttachmentFileName] [varchar](100) NULL,
	[Attachment] [image] NULL,
	[Status] [char](1) NULL,
	[CreatedBy] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
	[PublishedBy] [varchar](50) NULL,
	[PublishedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_REG_1] PRIMARY KEY CLUSTERED 
(
	[RegId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Reg_SubSource]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Reg_SubSource]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Reg_SubSource](
	[SSId] [bigint] NOT NULL,
	[MSId] [bigint] NOT NULL,
	[SSName] [varchar](50) NULL,
 CONSTRAINT [PK_Reg_SubSource] PRIMARY KEY CLUSTERED 
(
	[SSId] ASC,
	[MSId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Reg_Vessel_Notifications]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Reg_Vessel_Notifications]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Reg_Vessel_Notifications](
	[RegId] [int] NOT NULL,
	[VESSELCODE] [varchar](3) NOT NULL,
	[SentOn] [smalldatetime] NULL,
	[AckOn] [smalldatetime] NULL,
	[AckMessage] [varchar](500) NULL,
	[Discussed] [bit] NULL,
	[Notice] [bit] NULL,
 CONSTRAINT [PK_Reg_Email_Notifications] PRIMARY KEY CLUSTERED 
(
	[RegId] ASC,
	[VESSELCODE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SCM_MASTER]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_MASTER]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SCM_MASTER](
	[SCMId] [bigint] NULL,
	[VesselCode] [char](3) NULL,
	[SDate] [smalldatetime] NULL,
	[ShipPosFrom] [varchar](50) NULL,
	[ShipPosTo] [varchar](50) NULL,
	[CommTime] [varchar](5) NULL,
	[CompTime] [varchar](5) NULL,
	[Ocassion] [char](1) NULL,
	[ShipPosition] [char](1) NULL,
	[Str_MinOfPrevSaFeCom] [bit] NULL,
	[Str_AbsPrevSageCom] [bit] NULL,
	[NAME_OTHER] [varchar](50) NULL,
	[Str_OffCommPrevSafeCom] [bit] NULL,
	[Sef_AvailableOnBoard] [varchar](5000) NULL,
	[Sef_AccidentNarMiss] [varchar](5000) NULL,
	[Sef_ReviewOfMooring] [varchar](5000) NULL,
	[Sef_CrewNotFamilierWithAll] [varchar](5000) NULL,
	[Sef_BestPractice] [varchar](5000) NULL,
	[Hel_ReviewHelth] [varchar](5000) NULL,
	[Hel_BestPractice] [varchar](5000) NULL,
	[Sec_ReviewAnyImmediateSecurity] [varchar](5000) NULL,
	[Sec_BestPractices] [varchar](5000) NULL,
	[Qul_ReviewOfRegulatory] [varchar](5000) NULL,
	[Qul_ReviewOfQuality] [varchar](5000) NULL,
	[Qul_KPI] [varchar](5000) NULL,
	[Qul_CrewWelfare] [varchar](5000) NULL,
	[Qul_BestPractices] [varchar](5000) NULL,
	[Env_EnvironmentalKPIs] [varchar](5000) NULL,
	[Env_BestPractices] [varchar](5000) NULL,
	[AnyOtherIssues] [varchar](5000) NULL,
	[RANK_OTHER] [varchar](50) NULL,
	[OUTSTANDINGITEMS] [varchar](1000) NULL,
	[ReceviedOn] [smalldatetime] NULL,
	[OfficeComments] [varchar](5000) NULL,
	[SUPTD_CompliancewithRegulations] [varchar](5000) NULL,
	[SUPTD_DeviationsfromSafety] [varchar](5000) NULL,
	[SUPTD_DetailsofTraining] [varchar](5000) NULL,
	[SUPTD_HealthSafetyMeasures] [varchar](5000) NULL,
	[SUPTD_Suggestions] [varchar](5000) NULL,
	[SUPTD_BPI] [varchar](5000) NULL,
	[SUPTD_AnyOtherTopic] [varchar](5000) NULL,
	[UpdatedBy] [varchar](50) NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[ReportsPK] [bigint] NULL,
	[BestPractice] [varchar](5000) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SCM_NCRDETAILS]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_NCRDETAILS]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SCM_NCRDETAILS](
	[SCMId] [bigint] NULL,
	[NUMBER] [varchar](50) NULL,
	[CDATE] [smalldatetime] NULL,
	[REMARKS] [varchar](1000) NULL,
	[ReportsPK] [bigint] NULL,
	[VesselCode] [char](3) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SCM_RANKDETAILS]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SCM_RANKDETAILS]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SCM_RANKDETAILS](
	[SCMId] [bigint] NULL,
	[RankName] [varchar](50) NULL,
	[Name] [varchar](50) NULL,
	[Remarks] [varchar](50) NULL,
	[Absent] [int] NULL,
	[ReportsPK] [bigint] NULL,
	[VesselCode] [char](3) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Settings]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Settings]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Settings](
	[ShipCode] [varchar](3) NULL,
	[ShipName] [varchar](50) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Ship_MaintenanceKPI]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ship_MaintenanceKPI]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Ship_MaintenanceKPI](
	[VesselCode] [char](3) NOT NULL,
	[Year] [int] NOT NULL,
	[Month] [int] NOT NULL,
	[TotalSystemJobs] [int] NULL,
	[DueJobs] [int] NULL,
	[OverDueJobs] [int] NULL,
	[OD1Week] [int] NULL,
	[OD2Week] [int] NULL,
	[ODMorethan2week] [int] NULL,
	[OutStandingJobs] [int] NULL,
 CONSTRAINT [PK_Ship_MaintenanceKPI] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[Year] ASC,
	[Month] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ShipUserMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ShipUserMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ShipUserMaster](
	[UserId] [int] NOT NULL,
	[UserName] [varchar](20) NULL,
	[Password] [varchar](20) NULL,
 CONSTRAINT [PK_ShipUserMaster] PRIMARY KEY CLUSTERED 
(
	[UserId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_APP_COM_Forms]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_APP_COM_Forms]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_APP_COM_Forms](
	[VESSELID] [smallint] NOT NULL,
	[FORMNO] [varchar](50) NOT NULL,
	[FORMID] [bigint] NULL,
	[Scheduled] [bit] NULL,
	[ScheduledOn] [smalldatetime] NULL,
	[Ack_Recd] [bit] NULL,
	[Ack_RecdOn] [smalldatetime] NULL,
 CONSTRAINT [PK_SMS_APP_COM_Forms] PRIMARY KEY CLUSTERED 
(
	[VESSELID] ASC,
	[FORMNO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_APP_COM_ManualDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_APP_COM_ManualDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_APP_COM_ManualDetails](
	[VesselID] [smallint] NULL,
	[ManualId] [bigint] NULL,
	[SectionId] [varchar](100) NULL,
	[SNO] [bigint] NULL,
	[Scheduled] [bit] NULL,
	[SentDate] [smalldatetime] NULL,
	[SendBy] [varchar](50) NULL,
	[AckStatus] [char](1) NULL,
	[AckBy] [varchar](50) NULL,
	[AckOn] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_APP_ManualDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_APP_ManualDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_APP_ManualDetails](
	[ManualId] [bigint] NULL,
	[SectionId] [varchar](100) NULL,
	[ParentSectionId] [varchar](100) NULL,
	[Heading] [nvarchar](max) NULL,
	[SearchTags] [varchar](500) NULL,
	[FileName] [varchar](100) NULL,
	[FileContent] [image] NULL,
	[Approved] [char](1) NULL,
	[ApprovedOn] [smalldatetime] NULL,
	[Status] [char](1) NULL,
	[SVersion] [varchar](50) NULL,
	[ModifiedBy] [varchar](50) NULL,
	[ModifiedOn] [smalldatetime] NULL,
	[ReqRemarks] [varchar](1000) NULL,
	[AppRemarks] [varchar](1000) NULL,
	[RejRemarks] [varchar](1000) NULL,
	[Ship_RecdOn] [smalldatetime] NULL,
	[Ship_AckScheduled] [bit] NULL,
	[Ship_AckScheduledBy] [varchar](50) NULL,
	[Ship_AckSent] [bit] NULL,
	[Ship_AckSentOn] [smalldatetime] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_APP_ManualDetailsForms]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_APP_ManualDetailsForms]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_APP_ManualDetailsForms](
	[ManualID] [bigint] NULL,
	[SectionId] [varchar](100) NULL,
	[FormID] [bigint] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_APP_ManualMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_APP_ManualMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_APP_ManualMaster](
	[ManualId] [bigint] NULL,
	[ManualName] [varchar](100) NULL,
	[VersionNo] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
	[MApproved] [char](1) NULL,
	[MApprovedOn] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_Forms]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_Forms]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_Forms](
	[FormId] [bigint] NULL,
	[FormName] [varchar](100) NULL,
	[FormNo] [varchar](50) NULL,
	[VersionNo] [varchar](50) NULL,
	[FileName] [varchar](100) NULL,
	[FileContent] [image] NULL,
	[CreatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_FORMS_BKP_28_APR]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_FORMS_BKP_28_APR]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_FORMS_BKP_28_APR](
	[FormId] [bigint] NULL,
	[FormName] [varchar](100) NULL,
	[FormNo] [varchar](50) NULL,
	[VersionNo] [varchar](50) NULL,
	[FileName] [varchar](100) NULL,
	[FileContent] [image] NULL,
	[CreatedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_ManualCategory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualCategory]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_ManualCategory](
	[ManualCatId] [int] NULL,
	[ManualCatName] [varchar](50) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_ManualCatMappings]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualCatMappings]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_ManualCatMappings](
	[ManualCatId] [int] NULL,
	[ManualId] [int] NULL
) ON [PRIMARY]
END
GO
/****** Object:  Table [dbo].[SMS_ManualDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_ManualDetails](
	[ManualId] [bigint] NULL,
	[SectionId] [varchar](100) NULL,
	[ParentSectionId] [varchar](100) NULL,
	[Heading] [nvarchar](max) NULL,
	[SearchTags] [varchar](500) NULL,
	[FileName] [varchar](100) NULL,
	[FileContent] [image] NULL,
	[Approved] [char](1) NULL,
	[ApprovedOn] [smalldatetime] NULL,
	[Status] [char](1) NULL,
	[SVersion] [varchar](50) NULL,
	[ModifiedBy] [varchar](50) NULL,
	[ModifiedOn] [smalldatetime] NULL,
	[ReqRemarks] [varchar](1000) NULL,
	[AppRemarks] [varchar](1000) NULL,
	[RejRemarks] [varchar](1000) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_ManualDetails_Comments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualDetails_Comments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_ManualDetails_Comments](
	[CommentId] [bigint] NULL,
	[ManualId] [bigint] NULL,
	[SectionId] [varchar](100) NULL,
	[ManualVersion] [varchar](50) NULL,
	[SVersion] [varchar](50) NULL,
	[Comments] [nvarchar](max) NULL,
	[UserType] [char](1) NULL,
	[EnteredBy] [varchar](50) NULL,
	[EnteredOn] [smalldatetime] NULL,
	[Status] [char](1) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_ManualDetails_History]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualDetails_History]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_ManualDetails_History](
	[HistoryId] [bigint] NULL,
	[ManualId] [bigint] NULL,
	[SectionId] [varchar](100) NULL,
	[ParentSectionId] [varchar](100) NULL,
	[Heading] [nvarchar](max) NULL,
	[SearchTags] [varchar](500) NULL,
	[FileName] [varchar](100) NULL,
	[FileContent] [image] NULL,
	[Approved] [char](1) NULL,
	[ApprovedOn] [smalldatetime] NULL,
	[Status] [char](1) NULL,
	[SVersion] [varchar](50) NULL,
	[ModifiedBy] [varchar](50) NULL,
	[ModifiedOn] [smalldatetime] NULL,
	[ReqRemarks] [varchar](1000) NULL,
	[AppRemarks] [varchar](1000) NULL,
	[RejRemarks] [varchar](1000) NULL,
	[Ship_RecdOn] [smalldatetime] NULL,
	[Ship_AckScheduled] [bit] NULL,
	[Ship_AckScheduledBy] [varchar](50) NULL,
	[Ship_AckSent] [bit] NULL,
	[Ship_AckSentOn] [smalldatetime] NULL,
	[ManualVersion] [varchar](50) NULL,
	[HistoryOn] [smalldatetime] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_ManualDetails_Images]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualDetails_Images]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_ManualDetails_Images](
	[ImageId] [bigint] NULL,
	[ManualId] [bigint] NULL,
	[SectionId] [varchar](100) NULL,
	[ImageName] [varchar](100) NULL,
	[Description] [varchar](1000) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_ManualDetailsForms]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualDetailsForms]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_ManualDetailsForms](
	[ManualID] [bigint] NULL,
	[SectionId] [varchar](100) NULL,
	[FormID] [bigint] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_ManualDetailsForms_History]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualDetailsForms_History]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_ManualDetailsForms_History](
	[HistoryId] [bigint] NOT NULL,
	[ManualID] [bigint] NULL,
	[SectionId] [varchar](100) NULL,
	[FormID] [bigint] NULL,
	[HistoryOn] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_ManualMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_ManualMaster](
	[ManualId] [bigint] NULL,
	[ManualName] [varchar](100) NULL,
	[VersionNo] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
	[MApproved] [char](1) NULL,
	[MApprovedOn] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_ManualVesselType]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ManualVesselType]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_ManualVesselType](
	[ManualId] [int] NULL,
	[VesselTypeId] [int] NULL
) ON [PRIMARY]
END
GO
/****** Object:  Table [dbo].[SMS_OfficeComments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_OfficeComments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_OfficeComments](
	[CommentId] [bigint] NOT NULL,
	[ManualId] [bigint] NULL,
	[SectionId] [varchar](100) NULL,
	[MVersion] [varchar](50) NULL,
	[SVersion] [varchar](50) NULL,
	[CommentText] [varchar](5000) NULL,
	[CommentBy] [int] NULL,
	[CommentOn] [smalldatetime] NULL,
	[PositionId] [int] NULL,
	[OfficeId] [int] NULL,
	[ChangeRequested] [char](1) NULL,
	[Status] [char](1) NULL,
	[Stage] [char](1) NULL,
	[ReqDate] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[ClosedBy] [int] NULL,
	[ClosedOn] [smalldatetime] NULL,
	[ClosureRemarks] [varchar](1000) NULL,
 CONSTRAINT [PK_SMS_OfficeComments_1] PRIMARY KEY CLUSTERED 
(
	[CommentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_PacketRecd]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_PacketRecd]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_PacketRecd](
	[VesselCode] [char](3) NOT NULL,
	[PacketID] [int] NOT NULL,
	[PacketName] [varchar](50) NULL,
	[RecdOn] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_PacketSent]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_PacketSent]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_PacketSent](
	[VesselCode] [char](3) NOT NULL,
	[TableID] [int] NOT NULL,
	[PacketName] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_SMS_PacketSent] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[TableID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SMS_ShipComments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SMS_ShipComments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[SMS_ShipComments](
	[VesselCode] [char](3) NOT NULL,
	[CommentId] [bigint] NOT NULL,
	[ManualId] [bigint] NULL,
	[SectionId] [varchar](100) NULL,
	[MVersion] [varchar](50) NULL,
	[SVersion] [varchar](50) NULL,
	[CommentText] [varchar](5000) NULL,
	[CommentBy] [varchar](50) NULL,
	[CommentOn] [smalldatetime] NULL,
	[ReceivedInOffice] [char](1) NULL,
	[ComentByRank] [varchar](50) NULL,
	[ChangeRequested] [char](1) NULL,
	[Status] [char](1) NULL,
	[Stage] [char](1) NULL,
	[ReqDate] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[ClosedBy] [varchar](50) NULL,
	[ClosedOn] [smalldatetime] NULL,
	[ClosureRemarks] [varchar](1000) NULL,
 CONSTRAINT [PK_SMS_ShipComments] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[CommentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[tbl_Vessel_Communication]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[tbl_Vessel_Communication]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[tbl_Vessel_Communication](
	[VesselCode] [char](3) NOT NULL,
	[TableId] [bigint] NOT NULL,
	[RecordType] [varchar](50) NULL,
	[RecordId] [varchar](50) NULL,
	[RecordNo] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
	[CreatedBy] [varchar](50) NULL,
	[ExportedOn] [smalldatetime] NULL,
	[ExportedBy] [varchar](50) NULL,
	[OfficeReceivedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_tbl_Vessel_Communication] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[TableId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VesselComponentJobMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VesselComponentJobMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VesselComponentJobMaster](
	[VesselCode] [char](3) NOT NULL,
	[CompJobId] [bigint] NOT NULL,
	[ComponentId] [bigint] NOT NULL,
	[JobId] [bigint] NULL,
	[AssignTo] [int] NULL,
	[IntervalId] [int] NULL,
	[Interval] [float] NULL,
	[IsFixed] [smallint] NULL,
	[StartDate] [smalldatetime] NULL,
	[DescrM] [varchar](5000) NULL,
	[Interval_H] [float] NULL,
	[IntervalId_H] [int] NULL,
	[Guidelines] [varchar](50) NULL,
 CONSTRAINT [PK_VesselComponentJobMaster_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[CompJobId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VesselComponentJobMaster_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VesselComponentJobMaster_Attachments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VesselComponentJobMaster_Attachments](
	[VesselCode] [varchar](3) NOT NULL,
	[TableId] [bigint] NOT NULL,
	[CompJobId] [bigint] NULL,
	[Descr] [varchar](500) NULL,
	[DocumentType] [varchar](5) NULL,
 CONSTRAINT [PK_VesselComponentJobMaster_Attachments] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[TableId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VesselMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Vessel]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Vessel](
	[VesselId] [int] NOT NULL,
	[VesselCode] [char](3) NULL,
	[VesselName] [varchar](50) NULL,
	[IsExported] [bit] NULL,
	[ExportedBy] [int] NULL,
	[ExportDate] [smalldatetime] NULL,
 CONSTRAINT [PK_VesselMaster] PRIMARY KEY CLUSTERED 
(
	[VesselId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VesselRunningHourMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VesselRunningHourMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VesselRunningHourMaster](
	[VesselCode] [char](3) NOT NULL,
	[ComponentId] [bigint] NOT NULL,
	[StartupHour] [int] NULL,
	[AvgRunningHrPerDay] [int] NULL,
	[StartDate] [smalldatetime] NULL,
	[UpdatedBy] [int] NULL,
	[UpdatedOn] [datetime] NULL,
 CONSTRAINT [PK_VesselRunningHourMaster_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[ComponentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VesselSpareMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VesselSpareMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VesselSpareMaster](
	[VesselCode] [char](3) NOT NULL,
	[ComponentId] [bigint] NOT NULL,
	[Office_Ship] [char](1) NOT NULL,
	[SpareId] [bigint] NOT NULL,
	[SpareName] [varchar](50) NULL,
	[Maker] [varchar](50) NULL,
	[MakerType] [varchar](50) NULL,
	[PartNo] [varchar](50) NULL,
	[AltPartNo] [varchar](50) NULL,
	[Location] [varchar](50) NULL,
	[MinQty] [int] NULL,
	[MaxQty] [int] NULL,
	[StatutoryQty] [int] NULL,
	[Weight] [float] NULL,
	[Stock] [int] NULL,
	[Specification] [varchar](500) NULL,
	[DrawingNo] [varchar](50) NULL,
	[Attachment] [varchar](50) NULL,
 CONSTRAINT [PK_VesselSpareMaster_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[ComponentId] ASC,
	[Office_Ship] ASC,
	[SpareId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VIMS_Ins_Observations]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIMS_Ins_Observations]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VIMS_Ins_Observations](
	[InspectionNo] [varchar](50) NOT NULL,
	[QNO] [varchar](50) NOT NULL,
	[QuestionId] [varchar](50) NULL,
	[Id] [varchar](50) NULL,
	[Deficiency] [varchar](1000) NULL,
	[MasterComments] [varchar](1000) NULL,
	[CorrectiveActions] [varchar](1000) NULL,
 CONSTRAINT [PK_VIMS_Ins_Observations] PRIMARY KEY CLUSTERED 
(
	[InspectionNo] ASC,
	[QNO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VIMS_Inspections]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIMS_Inspections]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VIMS_Inspections](
	[INSPECTIONNO] [varchar](50) NULL,
	[PLANDATE] [smalldatetime] NULL,
	[PORTNAME] [varchar](50) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VIQ_VIQDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VIQDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VIQ_VIQDetails](
	[VesselCode] [char](3) NOT NULL,
	[VIQId] [bigint] NOT NULL,
	[QuestionId] [int] NOT NULL,
	[SortOrder] [int] NULL,
	[RiskScore] [varchar](50) NULL,
	[ObsCount] [int] NULL,
	[ChapterId] [int] NULL,
	[ChapterNo] [varchar](50) NULL,
	[ChapterName] [varchar](100) NULL,
	[VersionName] [varchar](50) NULL,
	[QuestionNo] [varchar](50) NULL,
	[Question] [varchar](7000) NULL,
	[Guidance] [varchar](7000) NULL,
	[PreVetting] [smallint] NULL,
	[OfficeRemarks] [varchar](7000) NULL,
 CONSTRAINT [PK_VIQ_VIQDetails_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[VIQId] ASC,
	[QuestionId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VIQ_VIQDetailsRanks]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VIQDetailsRanks]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VIQ_VIQDetailsRanks](
	[VesselCode] [char](3) NOT NULL,
	[VIQId] [bigint] NOT NULL,
	[QuestionId] [int] NOT NULL,
	[RankId] [int] NOT NULL,
	[NameDoneBy] [varchar](50) NULL,
	[DoneDate] [smalldatetime] NULL,
	[ShipComments] [varchar](7000) NULL,
	[ModifiedOn] [smalldatetime] NULL,
	[ShipClosureStatus] [smallint] NULL,
	[OfficeCommentBy] [varchar](100) NULL,
	[OfficeComment] [varchar](7000) NULL,
	[OfficeCommentDate] [smalldatetime] NULL,
	[OfficeClosureStatus] [smallint] NULL,
 CONSTRAINT [PK_VIQ_VIQDetailsRanks] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[VIQId] ASC,
	[QuestionId] ASC,
	[RankId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VIQ_VIQDetailsRanks_Inv]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VIQDetailsRanks_Inv]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VIQ_VIQDetailsRanks_Inv](
	[VesselCode] [char](3) NOT NULL,
	[VIQId] [bigint] NOT NULL,
	[QuestionId] [int] NOT NULL,
	[RankId] [int] NOT NULL,
 CONSTRAINT [PK_VIQ_VIQDetailsRanks_Inv] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[VIQId] ASC,
	[QuestionId] ASC,
	[RankId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VIQ_VIQDetailsRanksAttachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VIQDetailsRanksAttachments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VIQ_VIQDetailsRanksAttachments](
	[VesselCode] [char](3) NOT NULL,
	[VIQId] [bigint] NOT NULL,
	[QuestionId] [int] NOT NULL,
	[RankId] [int] NOT NULL,
	[AttachmentId] [int] NOT NULL,
	[Description] [varchar](7000) NULL,
	[FileName] [varchar](100) NULL,
	[ModifiedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VIQ_VIQDetailsRanksAttachments_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[VIQId] ASC,
	[QuestionId] ASC,
	[RankId] ASC,
	[AttachmentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VIQ_VIQMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VIQ_VIQMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VIQ_VIQMaster](
	[VesselCode] [varchar](3) NOT NULL,
	[VIQId] [bigint] NOT NULL,
	[PVIQId] [bigint] NULL,
	[ViqNo] [varchar](50) NULL,
	[VIQType] [int] NULL,
	[InspGroupId] [int] NULL,
	[TargetDate] [smalldatetime] NULL,
	[VIQStatus] [smallint] NULL,
	[CreatedOn] [smalldatetime] NULL,
	[ShipRecdDate] [smalldatetime] NULL,
	[MailSent] [smallint] NULL,
	[MailSentOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VIQ_VIQMaster] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[VIQId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VLI]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VLI]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VLI](
	[VLIId] [bigint] NOT NULL,
	[VLIDate] [smalldatetime] NULL,
	[VesselId] [int] NULL,
	[VisitedBy] [int] NULL,
	[VisitedBYPosition] [int] NULL,
	[Remarks] [varchar](1000) NULL,
 CONSTRAINT [PK_VLI] PRIMARY KEY CLUSTERED 
(
	[VLIId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VLI_LFI_FC]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VLI_LFI_FC]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VLI_LFI_FC](
	[VLIId] [bigint] NULL,
	[LFI_FC] [char](1) NULL,
	[LFI_FC_Id] [bigint] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VNA_Details]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VNA_Details]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VNA_Details](
	[VESSELCODE] [char](3) NULL,
	[VNAID] [bigint] NULL,
	[QID] [bigint] NULL,
	[QNO] [varchar](50) NULL,
	[QTEXT] [varchar](max) NULL,
	[GUIDANCE] [varchar](max) NULL,
	[COMPLY] [varchar](50) NULL,
	[SHIPCOMMENTS] [varchar](max) NULL,
	[SHIPCOMMENTBY] [varchar](50) NULL,
	[SHIPCOMMENTDATE] [smalldatetime] NULL,
	[OFFICECOMMENTS] [varchar](max) NULL,
	[OFFICECOMMENTBY] [varchar](50) NULL,
	[OFFICECOMMENTDATE] [smalldatetime] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VNA_Master]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VNA_Master]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VNA_Master](
	[VNAId] [bigint] NULL,
	[VesselCode] [varchar](3) NULL,
	[VNANo] [varchar](50) NULL,
	[CreatedBy] [int] NULL,
	[CreatedOn] [smalldatetime] NULL,
	[OfficeRemark] [varchar](max) NULL,
	[ClosedBy] [varchar](50) NULL,
	[ClosedOn] [smalldatetime] NULL,
	[AuditFrom] [smalldatetime] NULL,
	[AuditTo] [smalldatetime] NULL,
	[PortFrom] [varchar](50) NULL,
	[PortTo] [varchar](50) NULL,
	[MasterCrewNo] [varchar](10) NULL,
	[MasterName] [varchar](100) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_ComponentMasterForVessel]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_ComponentMasterForVessel]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_ComponentMasterForVessel](
	[VesselCode] [char](3) NOT NULL,
	[ComponentId] [bigint] NOT NULL,
	[Maker] [varchar](50) NULL,
	[MakerType] [varchar](50) NULL,
	[ClassEquipCode] [varchar](30) NULL,
	[Status] [char](1) NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[Descr] [varchar](1000) NULL,
	[CLASSEQUIP] [bit] NULL,
	[ACCOUNTCODES] [varchar](50) NULL,
 CONSTRAINT [PK_VSL_ComponentMasterForVessel] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[ComponentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_CriticalEquipShutdownRequest]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_CriticalEquipShutdownRequest]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_CriticalEquipShutdownRequest](
	[ShutdownId] [bigint] NOT NULL,
	[VesselCode] [char](3) NULL,
	[ComponentId] [bigint] NULL,
	[Occasion] [smallint] NULL,
	[DefectNo] [varchar](15) NULL,
	[FormNo] [varchar](50) NULL,
	[Version] [varchar](50) NULL,
	[RequestDate] [smalldatetime] NULL,
	[MasterCEName] [varchar](50) NULL,
	[Job_Defect] [varchar](5000) NULL,
	[Pl_ShutDownTotalHrs] [int] NULL,
	[Pl_FromDateTime] [smalldatetime] NULL,
	[Pl_ToDateTime] [smalldatetime] NULL,
	[Ma_CommencedDateTime] [smalldatetime] NULL,
	[Ma_CompletedDateTime] [smalldatetime] NULL,
	[Maintenence_Remarks] [varchar](5000) NULL,
	[IssuedBy] [int] NULL,
	[IssueDate] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[Closed] [bit] NULL,
 CONSTRAINT [PK_VSL_CriticalEquipShutdownRequest_1] PRIMARY KEY CLUSTERED 
(
	[ShutdownId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_CriticalShutdownApproval]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_CriticalShutdownApproval]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_CriticalShutdownApproval](
	[ShutdownApproveId] [bigint] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[ShutdownId] [bigint] NULL,
	[Approver_Name] [varchar](50) NULL,
	[Approver_Position] [varchar](50) NULL,
	[Approver_Remarks] [varchar](5000) NULL,
	[ApprovedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_CriticalShutdownApproval] PRIMARY KEY CLUSTERED 
(
	[ShutdownApproveId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_CriticalShutdownExtensionApproval]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_CriticalShutdownExtensionApproval]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_CriticalShutdownExtensionApproval](
	[ExtensionApproveId] [bigint] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[ExtensionId] [bigint] NULL,
	[Approver_Name] [varchar](50) NULL,
	[Approver_Position] [varchar](50) NULL,
	[Approver_Remarks] [varchar](5000) NULL,
	[ApprovedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_CriticalShutdownExtensionApproval_1] PRIMARY KEY CLUSTERED 
(
	[ExtensionApproveId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_CriticalShutdownExtensions]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_CriticalShutdownExtensions]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_CriticalShutdownExtensions](
	[ExtensionId] [bigint] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[ShutdownId] [bigint] NULL,
	[Ext_ShutDownTotalHrs] [int] NULL,
	[Ext_FromDateTime] [smalldatetime] NULL,
	[Ext_ToDateTime] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_CriticalShutdownExtensions] PRIMARY KEY CLUSTERED 
(
	[ExtensionId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_DefectDetailsMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_DefectDetailsMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_DefectDetailsMaster](
	[VesselCode] [char](3) NULL,
	[ComponentId] [bigint] NULL,
	[DefectNo] [varchar](15) NOT NULL,
	[HistoryId] [bigint] NULL,
	[ReportDt] [smalldatetime] NULL,
	[TargetDt] [smalldatetime] NULL,
	[CompletionDt] [smalldatetime] NULL,
	[Vessel] [char](1) NULL,
	[Spares] [char](1) NULL,
	[ShoreAssist] [char](1) NULL,
	[Drydock] [char](1) NULL,
	[Guarentee] [char](1) NULL,
	[DefectDetails] [varchar](1000) NULL,
	[RepairsDetails] [varchar](1000) NULL,
	[SparesOnBoard] [char](1) NULL,
	[RqnNo] [varchar](20) NULL,
	[SparesOrdered] [char](1) NULL,
	[RqnDate] [smalldatetime] NULL,
	[SparesRequired] [char](1) NULL,
	[Supdt] [varchar](50) NULL,
	[ChiefOfficer] [varchar](50) NULL,
	[ChiefEngg] [varchar](50) NULL,
	[Status] [char](1) NULL,
	[Updated] [char](1) NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[CompStatus] [char](1) NULL,
 CONSTRAINT [PK_Vsl_DefectDetails] PRIMARY KEY CLUSTERED 
(
	[DefectNo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_DefectRemarks]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_DefectRemarks]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_DefectRemarks](
	[DefectRemarkId] [bigint] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[DefectNo] [varchar](15) NOT NULL,
	[Remarks] [varchar](5000) NULL,
	[FileName] [varchar](50) NULL,
	[File] [image] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[EnteredBy] [varchar](50) NULL,
	[EnteredOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_DefectRemarks] PRIMARY KEY CLUSTERED 
(
	[DefectRemarkId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_Defects_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_Defects_Attachments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_Defects_Attachments](
	[AttachmentId] [bigint] NOT NULL,
	[VesselCode] [char](3) NOT NULL,
	[DefectNo] [varchar](15) NULL,
	[AttachmentText] [varchar](500) NULL,
	[FileName] [varchar](50) NULL,
	[Status] [char](1) NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_Defects_Attachments_1] PRIMARY KEY CLUSTERED 
(
	[AttachmentId] ASC,
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_DefectSpareDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_DefectSpareDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_DefectSpareDetails](
	[VesselCode] [char](3) NOT NULL,
	[ComponentId] [bigint] NOT NULL,
	[Office_Ship] [char](1) NOT NULL,
	[SpareId] [bigint] NOT NULL,
	[DefectNo] [varchar](15) NOT NULL,
	[QtyCons] [float] NULL,
	[QtyRob] [float] NULL,
	[Status] [char](1) NULL,
 CONSTRAINT [PK_VSL_DefectSpareDetails] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[ComponentId] ASC,
	[Office_Ship] ASC,
	[SpareId] ASC,
	[DefectNo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_MaintenanceKPI]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_MaintenanceKPI]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_MaintenanceKPI](
	[VesselCode] [char](3) NOT NULL,
	[Year] [int] NOT NULL,
	[Month] [int] NOT NULL,
	[TotalSystemJobs] [int] NULL,
	[DueJobs] [int] NULL,
	[OverDueJobs] [int] NULL,
	[OD1Week] [int] NULL,
	[OD2Week] [int] NULL,
	[ODMorethan2week] [int] NULL,
	[OutStandingJobs] [int] NULL,
	[PublishedBy] [int] NULL,
	[PublishedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_MaintenanceKPI] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[Year] ASC,
	[Month] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_MNP_PacketRecd]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_MNP_PacketRecd]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_MNP_PacketRecd](
	[VesselCode] [char](3) NOT NULL,
	[PacketID] [int] NOT NULL,
	[PacketName] [varchar](50) NULL,
	[RecdOn] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_MNP_PacketSent]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_MNP_PacketSent]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_MNP_PacketSent](
	[VesselCode] [char](3) NOT NULL,
	[TableID] [int] NOT NULL,
	[PacketName] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_MNP_PacketSent] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[TableID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_MP_MealConsumptionMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_MP_MealConsumptionMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_MP_MealConsumptionMaster](
	[VesselCode] [char](3) NOT NULL,
	[MealConsumptionId] [bigint] NOT NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[AckRecd] [bit] NULL,
	[AckRecdOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_MP_MealConsumptionMaster] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[MealConsumptionId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_MP_Products]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_MP_Products]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_MP_Products](
	[VesselCode] [char](3) NOT NULL,
	[ProductId] [bigint] NOT NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[AckRecd] [bit] NULL,
	[AckRecdOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_MP_Products_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[ProductId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_PlanMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_PlanMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_PlanMaster](
	[VesselCode] [char](3) NOT NULL,
	[CompJobId] [bigint] NOT NULL,
	[ComponentId] [bigint] NOT NULL,
	[_ComponentCode] [char](20) NULL,
	[jobId] [bigint] NOT NULL,
	[Status] [int] NULL,
	[AssignedTo] [int] NULL,
	[PlanDate] [smalldatetime] NULL,
	[LastDueDate] [smalldatetime] NULL,
	[LastDueHours] [int] NULL,
	[NextDueDate] [smalldatetime] NULL,
	[NextDueHours] [int] NULL,
	[LastRunningHourDate] [smalldatetime] NULL,
	[LastRunningHour] [int] NULL,
	[DoneBy] [int] NULL,
	[DoneBy_Code] [varchar](10) NULL,
	[DoneBy_Name] [varchar](50) NULL,
	[DoneDate] [smalldatetime] NULL,
	[DoneHour] [int] NULL,
	[ServiceReport] [varchar](5000) NULL,
	[ConditionBefore] [varchar](50) NULL,
	[ConditionAfter] [varchar](50) NULL,
	[UpdateRemarks] [int] NULL,
	[Specify] [varchar](50) NULL,
	[FileName] [varchar](50) NULL,
	[FileImage] [image] NULL,
	[Coating] [smallint] NULL,
	[Corrosion] [smallint] NULL,
	[Deformation] [smallint] NULL,
	[Cracks] [smallint] NULL,
	[OverallRating] [smallint] NULL,
	[ModifiedBy] [int] NULL,
	[ModifiedOn] [smalldatetime] NULL,
	[PostPoneReason] [int] NULL,
	[PostPoneRemarks] [varchar](500) NULL,
	[P_DoneBy] [int] NULL,
	[P_DoneBy_Code] [varchar](10) NULL,
	[P_DoneBy_Name] [varchar](50) NULL,
	[PostPoneDate] [smalldatetime] NULL,
	[CancellationReason] [varchar](500) NULL,
	[CancellationDate] [smalldatetime] NULL,
	[C_DoneBy] [int] NULL,
	[C_DoneBy_Code] [varchar](10) NULL,
	[C_DoneBy_Name] [varchar](50) NULL,
	[Verified] [bit] NULL,
	[VerifiedBy] [varchar](100) NULL,
	[VerifiedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_PlanMaster] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[CompJobId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_Settings]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_Settings]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_Settings](
	[VesselCode] [char](3) NOT NULL,
	[VesselName] [varchar](50) NULL,
	[VesselType] [varchar](100) NULL,
	[OwnerName] [varchar](100) NULL,
	[OwnerAddress] [varchar](100) NULL,
	[ManagementName] [varchar](100) NULL,
	[MangementAddress] [varchar](100) NULL,
	[FlagName] [varchar](50) NULL,
	[Build] [smalldatetime] NULL,
	[Builder] [varchar](100) NULL,
	[IMONumber] [varchar](50) NULL,
	[CallSing] [varchar](50) NULL,
	[OfficialNumber] [varchar](50) NULL,
	[MMSINumber] [varchar](50) NULL,
	[FaxInmarsatC] [varchar](50) NULL,
	[PhoneInmarsatFB] [varchar](50) NULL,
	[Class] [varchar](50) NULL,
	[ClassNKNumber] [varchar](50) NULL,
	[LengthOverAll] [numeric](11, 3) NULL,
	[LengthBetweenPP] [numeric](11, 3) NULL,
	[BreadthMoulded] [numeric](11, 3) NULL,
	[DepthMoulded] [numeric](11, 3) NULL,
	[Draught_S] [numeric](11, 3) NULL,
	[Deadweight_S] [numeric](11, 3) NULL,
	[Int_Gross_Tonnage] [numeric](11, 3) NULL,
	[Int_Net_Tonnage] [numeric](11, 3) NULL,
	[SuezCanal_Net_Register_Tonnage] [numeric](11, 3) NULL,
	[PanamaCanal_UMS_Net_Tonnage] [numeric](11, 3) NULL,
	[LightShip] [numeric](11, 3) NULL,
	[MainEngine] [varchar](100) NULL,
	[Propeller_Size] [varchar](100) NULL,
	[Propeller_Type] [varchar](100) NULL,
	[Propeller_Material] [varchar](100) NULL,
	[Tail_Shaft_Oil] [varchar](100) NULL,
	[Trial_Speed] [numeric](11, 3) NULL,
	[Main_Generator_Engine] [varchar](100) NULL,
	[Main_Generators] [varchar](100) NULL,
	[Emergency_Generator_Engine] [varchar](100) NULL,
	[Electrical_Eqp_Main_Switch_Board] [varchar](100) NULL,
	[Boiler_Maker] [varchar](100) NULL,
	[Boiler_Model] [varchar](100) NULL,
	[Boiler_Type] [varchar](100) NULL,
	[Boiler_MaxWorkPressure] [varchar](100) NULL,
	[Boiler_NorWorkPressure] [varchar](100) NULL,
	[Boiler_SteamEvap] [varchar](100) NULL,
 CONSTRAINT [PK_VSL_Settings] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_ShipSettings]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_ShipSettings]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_ShipSettings](
	[StartDate] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
/****** Object:  Table [dbo].[VSL_SMS_PacketRecd]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_SMS_PacketRecd]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_SMS_PacketRecd](
	[VesselCode] [char](3) NOT NULL,
	[PacketID] [int] NOT NULL,
	[PacketName] [varchar](50) NULL,
	[RecdOn] [smalldatetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_SMS_PacketSent]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_SMS_PacketSent]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_SMS_PacketSent](
	[VesselCode] [char](3) NOT NULL,
	[TableID] [int] NOT NULL,
	[PacketName] [varchar](50) NULL,
	[CreatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_SMS_PacketSent] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[TableID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_StockInventory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_StockInventory]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_StockInventory](
	[VesselCode] [char](3) NOT NULL,
	[ComponentId] [bigint] NOT NULL,
	[Office_Ship] [char](1) NOT NULL,
	[SpareId] [bigint] NOT NULL,
	[PkId] [bigint] NOT NULL,
	[RecdDate] [smalldatetime] NULL,
	[QtyRecd] [float] NULL,
	[StockLocation] [varchar](50) NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
	[Status] [char](1) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_UnPlannedJobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_UnPlannedJobs]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_UnPlannedJobs](
	[VesselCode] [varchar](3) NOT NULL,
	[UPId] [bigint] NOT NULL,
	[ComponentId] [bigint] NULL,
	[ShortDescr] [varchar](500) NULL,
	[LongDescr] [varchar](2000) NULL,
	[DeptId] [int] NULL,
	[AssignedTo] [int] NULL,
	[DueDate] [smalldatetime] NULL,
	[Status] [char](1) NULL,
	[DoneBy] [int] NULL,
	[DoneBy_Code] [varchar](15) NULL,
	[DoneBy_Name] [varchar](50) NULL,
	[DoneDate] [smalldatetime] NULL,
	[ServiceReport] [varchar](5000) NULL,
	[ConditionBefore] [varchar](50) NULL,
	[ConditionAfter] [varchar](50) NULL,
	[RQNNo] [varchar](50) NULL,
	[RQNDate] [smalldatetime] NULL,
	[UpdatedBy] [int] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_UnPlannedJobs] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[UPId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_UnPlannedJobs_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_UnPlannedJobs_Attachments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_UnPlannedJobs_Attachments](
	[VesselCode] [char](3) NOT NULL,
	[TableId] [bigint] NOT NULL,
	[UPId] [bigint] NULL,
	[AttachmentText] [varchar](500) NULL,
	[FileName] [varchar](50) NULL,
	[Status] [char](1) NULL,
 CONSTRAINT [PK_VSL_UnPlannedJobs_Attachments] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[TableId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_UnPlannedJobs_SpareDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_UnPlannedJobs_SpareDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_UnPlannedJobs_SpareDetails](
	[VesselCode] [char](3) NOT NULL,
	[ComponentId] [bigint] NOT NULL,
	[Office_Ship] [char](1) NOT NULL,
	[SpareId] [bigint] NOT NULL,
	[UPId] [bigint] NOT NULL,
	[QtyCons] [float] NULL,
	[QtyRob] [float] NULL,
	[Status] [char](1) NULL,
 CONSTRAINT [PK_VSL_UnPlannedJobsSpareDetails] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[ComponentId] ASC,
	[Office_Ship] ASC,
	[SpareId] ASC,
	[UPId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VesselComponentJobMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselComponentJobMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VesselComponentJobMaster](
	[VesselCode] [char](3) NOT NULL,
	[CompJobId] [bigint] NOT NULL,
	[ComponentId] [bigint] NULL,
	[JobId] [bigint] NOT NULL,
	[AssignTo] [int] NULL,
	[IntervalId] [int] NULL,
	[Interval] [float] NULL,
	[IsFixed] [smallint] NULL,
	[StartDate] [smalldatetime] NULL,
	[DescrM] [varchar](5000) NULL,
	[Interval_H] [float] NULL,
	[IntervalId_H] [int] NULL,
	[Guidelines] [varchar](50) NULL,
	[Status] [char](1) NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_VesselComponentJobMaster_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[CompJobId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VesselComponentJobMaster_Attachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselComponentJobMaster_Attachments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VesselComponentJobMaster_Attachments](
	[VesselCode] [varchar](3) NOT NULL,
	[TableId] [bigint] NOT NULL,
	[CompJobId] [bigint] NULL,
	[Descr] [varchar](500) NULL,
	[DocumentType] [varchar](5) NULL,
	[Status] [char](1) NULL,
 CONSTRAINT [PK_VSL_VesselComponentJobMaster_Attachments] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[TableId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VesselComponentJobMaster_Updates]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselComponentJobMaster_Updates]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VesselComponentJobMaster_Updates](
	[VesselCode] [char](3) NOT NULL,
	[CompJobId] [bigint] NOT NULL,
	[ComponentId] [bigint] NULL,
	[LastDone] [smalldatetime] NULL,
	[LastHour] [int] NULL,
	[NextDueDate] [smalldatetime] NULL,
	[NextHour] [int] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_VesselComponentJobMaster_Updates] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[CompJobId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VesselJobUpdateHistory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselJobUpdateHistory]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VesselJobUpdateHistory](
	[VesselCode] [char](3) NOT NULL,
	[HistoryId] [bigint] NOT NULL,
	[CompJobId] [bigint] NULL,
	[ComponentId] [bigint] NOT NULL,
	[_ComponentCode] [char](20) NULL,
	[jobId] [bigint] NOT NULL,
	[Status] [int] NULL,
	[AssignedTo] [int] NULL,
	[PlanDate] [smalldatetime] NULL,
	[LastDueDate] [smalldatetime] NULL,
	[LastDueHours] [int] NULL,
	[NextDueDate] [smalldatetime] NULL,
	[NextDueHours] [int] NULL,
	[LastRunningHourDate] [smalldatetime] NULL,
	[LastRunningHour] [int] NULL,
	[DoneBy] [int] NULL,
	[DoneBy_Code] [varchar](10) NULL,
	[DoneBy_Name] [varchar](50) NULL,
	[DoneDate] [smalldatetime] NULL,
	[DoneHour] [int] NULL,
	[ServiceReport] [varchar](5000) NULL,
	[ConditionBefore] [varchar](50) NULL,
	[ConditionAfter] [varchar](50) NULL,
	[UpdateRemarks] [int] NULL,
	[Specify] [varchar](50) NULL,
	[FileName] [varchar](50) NULL,
	[FileImage] [image] NULL,
	[Coating] [smallint] NULL,
	[Corrosion] [smallint] NULL,
	[Deformation] [smallint] NULL,
	[Cracks] [smallint] NULL,
	[OverallRating] [smallint] NULL,
	[ModifiedBy] [int] NULL,
	[ModifiedOn] [smalldatetime] NULL,
	[PostPoneReason] [int] NULL,
	[PostPoneRemarks] [varchar](500) NULL,
	[P_DoneBy] [int] NULL,
	[P_DoneBy_Code] [varchar](10) NULL,
	[P_DoneBy_Name] [varchar](50) NULL,
	[PostPoneDate] [smalldatetime] NULL,
	[CancellationReason] [varchar](500) NULL,
	[CancellationDate] [smalldatetime] NULL,
	[C_DoneBy] [int] NULL,
	[C_DoneBy_Code] [varchar](10) NULL,
	[C_DoneBy_Name] [varchar](50) NULL,
	[Action] [char](1) NULL,
	[CompStatus] [char](1) NULL,
	[Verified] [bit] NULL,
	[VerifiedBy] [varchar](100) NULL,
	[VerifiedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_VesselJobUpdateHistory_1] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[HistoryId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VesselJobUpdateHistory_OfficeComments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselJobUpdateHistory_OfficeComments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VesselJobUpdateHistory_OfficeComments](
	[VesselCode] [char](3) NOT NULL,
	[HistoryId] [bigint] NOT NULL,
	[Comments] [varchar](4000) NULL,
	[Verified] [bit] NULL,
	[VerifiedBy] [varchar](100) NULL,
	[VerifiedOn] [smalldatetime] NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_VesselJobUpdateHistory_OfficeComments] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[HistoryId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VesselJobUpdateHistoryAttachments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselJobUpdateHistoryAttachments]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VesselJobUpdateHistoryAttachments](
	[VesselCode] [char](3) NOT NULL,
	[TableId] [bigint] NOT NULL,
	[HistoryId] [bigint] NULL,
	[AttachmentText] [varchar](500) NULL,
	[FileName] [varchar](50) NULL,
	[Status] [char](1) NULL,
 CONSTRAINT [PK_VSL_VesselJobUpdateHistoryAttachments] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[TableId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VesselJobUpdateHistorySpareDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselJobUpdateHistorySpareDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VesselJobUpdateHistorySpareDetails](
	[VesselCode] [char](3) NOT NULL,
	[ComponentId] [bigint] NOT NULL,
	[Office_Ship] [char](1) NOT NULL,
	[SpareId] [bigint] NOT NULL,
	[HistoryId] [bigint] NOT NULL,
	[QtyCons] [float] NULL,
	[QtyRob] [float] NULL,
	[Status] [char](1) NULL,
 CONSTRAINT [PK_VSL_VesselJobUpdateHistorySpareDetails] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[ComponentId] ASC,
	[Office_Ship] ASC,
	[SpareId] ASC,
	[HistoryId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VesselRunningHourMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselRunningHourMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VesselRunningHourMaster](
	[VesselCode] [char](3) NOT NULL,
	[ComponentId] [bigint] NOT NULL,
	[StartupHour] [int] NULL,
	[AvgRunningHrPerDay] [int] NULL,
	[StartDate] [smalldatetime] NULL,
	[UpdatedBy] [int] NULL,
	[UpdatedOn] [datetime] NULL,
	[Updated] [bit] NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VesselSpareMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VesselSpareMaster]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VesselSpareMaster](
	[VesselCode] [char](3) NOT NULL,
	[ComponentId] [bigint] NOT NULL,
	[Office_Ship] [char](1) NOT NULL,
	[SpareId] [bigint] NOT NULL,
	[SpareName] [varchar](50) NULL,
	[Maker] [varchar](50) NULL,
	[MakerType] [varchar](50) NULL,
	[PartNo] [varchar](50) NULL,
	[AltPartNo] [varchar](50) NULL,
	[Location] [varchar](50) NULL,
	[MinQty] [int] NULL,
	[MaxQty] [int] NULL,
	[StatutoryQty] [int] NULL,
	[Weight] [float] NULL,
	[Stock] [int] NULL,
	[Specification] [varchar](500) NULL,
	[DrawingNo] [varchar](50) NULL,
	[Attachment] [varchar](50) NULL,
	[Status] [char](10) NULL,
	[Updated] [bit] NULL,
	[UpdatedOn] [smalldatetime] NULL,
 CONSTRAINT [PK_VSL_VesselSpareMaster] PRIMARY KEY CLUSTERED 
(
	[VesselCode] ASC,
	[ComponentId] ASC,
	[Office_Ship] ASC,
	[SpareId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VPRArrivalReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPRArrivalReport]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VPRArrivalReport](
	[ReportsPK] [bigint] NULL,
	[ArrivalID] [bigint] NOT NULL,
	[VesselID] [varchar](3) NOT NULL,
	[ReportDate] [smalldatetime] NULL,
	[VoyageNo] [varchar](100) NULL,
	[SteamingHrs] [int] NULL,
	[SteamingMin] [int] NULL,
	[DistanceMadeGood] [decimal](18, 2) NULL,
	[AvgSpeed] [decimal](18, 2) NULL,
	[Stoppages] [int] NULL,
	[StoppagesHH] [int] NULL,
	[StoppagesMM] [int] NULL,
	[Remarks] [varchar](max) NULL,
	[VoyCondition] [varchar](250) NULL,
	[DepPort] [varchar](50) NULL,
	[DepArrivalPort] [varchar](250) NULL,
	[EOSPDate] [smalldatetime] NULL,
	[EOSPHrs] [int] NULL,
	[EOSPMin] [int] NULL,
	[DraftFwd] [decimal](18, 2) NULL,
	[DraftAft] [decimal](18, 2) NULL,
	[ArrivalPortAgent] [varchar](250) NULL,
	[PersonalIncharge] [varchar](250) NULL,
	[AddressContactDetails] [varchar](max) NULL,
	[CourceT] [decimal](18, 2) NULL,
	[WindDirectionT] [decimal](18, 2) NULL,
	[WindForce] [int] NULL,
	[SeaDirection] [decimal](18, 2) NULL,
	[SeaState] [int] NULL,
	[CurrentDirection] [decimal](18, 2) NULL,
	[CurrentStrength] [decimal](18, 2) NULL,
	[WeatherRemarks] [varchar](max) NULL,
	[Lattitude1] [int] NULL,
	[Lattitude2] [int] NULL,
	[Lattitude3] [int] NULL,
	[Longitude1] [int] NULL,
	[Longitud2] [int] NULL,
	[Longitud3] [int] NULL,
	[LocationDescription] [varchar](max) NULL,
	[ROBIFO45Fuel] [decimal](18, 2) NULL,
	[ROBIFO1Fuel] [decimal](18, 2) NULL,
	[ROBMGO5Fuel] [decimal](18, 2) NULL,
	[ROBMGO1Fuel] [decimal](18, 2) NULL,
	[ROBMDOFuel] [decimal](18, 2) NULL,
	[ROBIFO45Lube] [decimal](18, 2) NULL,
	[ROBIFO1Lube] [decimal](18, 2) NULL,
	[ROBMGO5Lube] [decimal](18, 2) NULL,
	[ROBMGO1Lube] [decimal](18, 2) NULL,
	[ROBMDOLube] [decimal](18, 2) NULL,
	[ROBFreshWater] [decimal](18, 2) NULL,
	[MEIFO45] [decimal](18, 2) NULL,
	[MEIFO1] [decimal](18, 2) NULL,
	[MEMGO5] [decimal](18, 2) NULL,
	[MEMGO1] [decimal](18, 2) NULL,
	[MEMDO] [decimal](18, 2) NULL,
	[AEIFO45] [decimal](18, 2) NULL,
	[AEIFO1] [decimal](18, 2) NULL,
	[AEMGO5] [decimal](18, 2) NULL,
	[AEMGO1] [decimal](18, 2) NULL,
	[AEMDO] [decimal](18, 2) NULL,
	[CargoHeatingIFO45] [decimal](18, 2) NULL,
	[CargoHeatingIFO1] [decimal](18, 2) NULL,
	[CargoHeatingMGO5] [decimal](18, 2) NULL,
	[CargoHeatingMGO1] [decimal](18, 2) NULL,
	[CargoHeatingMDO] [decimal](18, 2) NULL,
	[MECCLube] [decimal](18, 2) NULL,
	[MECYLLube] [decimal](18, 2) NULL,
	[AECCLube] [decimal](18, 2) NULL,
	[HYDLube] [decimal](18, 2) NULL,
	[MDOLube] [decimal](18, 2) NULL,
	[GeneratedFreshWater] [decimal](18, 2) NULL,
	[ConsumedFreshWater] [decimal](18, 2) NULL,
	[TCW] [varchar](50) NULL,
	[BW] [varchar](50) NULL,
	[TCU20L] [varchar](50) NULL,
	[TCU40L] [varchar](50) NULL,
	[TCU45L] [varchar](50) NULL,
	[TCU20E] [varchar](50) NULL,
	[TCU40E] [varchar](50) NULL,
	[TCU45E] [varchar](50) NULL,
	[NextActivity] [char](1) NULL,
	[ETBDATE] [smalldatetime] NULL,
	[ETBHrs] [int] NULL,
	[ETBMin] [int] NULL,
	[TotalCargoWeight] [decimal](18, 2) NULL,
	[BallastWeight] [decimal](18, 2) NULL,
 CONSTRAINT [PK_VPRArrivalReport] PRIMARY KEY CLUSTERED 
(
	[ArrivalID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VPRDepartureReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPRDepartureReport]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VPRDepartureReport](
	[ReportsPK] [bigint] NULL,
	[DepartureID] [bigint] NOT NULL,
	[VesselID] [varchar](3) NOT NULL,
	[ReportDate] [smalldatetime] NULL,
	[VoyageNo] [varchar](100) NULL,
	[RestrictedArea] [int] NULL,
	[AreaName] [int] NULL,
	[ETARestrictedArea] [smalldatetime] NULL,
	[ChartererName] [varchar](250) NULL,
	[CharterPartySpeed] [decimal](18, 2) NULL,
	[VoyOrderSpeed] [decimal](18, 2) NULL,
	[VoyInstructions] [varchar](1000) NULL,
	[VoyCondition] [varchar](250) NULL,
	[DepPort] [varchar](50) NULL,
	[DepArrivalPort] [varchar](250) NULL,
	[COSPDate] [smalldatetime] NULL,
	[COSPHrs] [int] NULL,
	[COSPMin] [int] NULL,
	[ArrivalPortETA] [smalldatetime] NULL,
	[ArrivalPortETAHrs] [int] NULL,
	[ArrivalPortETAMin] [int] NULL,
	[DraftFwd] [decimal](18, 2) NULL,
	[DraftAft] [decimal](18, 2) NULL,
	[DistanceToGo] [decimal](18, 2) NULL,
	[ArrivalPortAgent] [varchar](250) NULL,
	[PersonalIncharge] [varchar](250) NULL,
	[AddressContactDetails] [varchar](max) NULL,
	[Port1] [varchar](50) NULL,
	[PortETA1] [smalldatetime] NULL,
	[Port2] [varchar](50) NULL,
	[PortETA2] [smalldatetime] NULL,
	[Port3] [varchar](50) NULL,
	[PortETA3] [smalldatetime] NULL,
	[CourceT] [decimal](18, 2) NULL,
	[WindDirectionT] [decimal](18, 2) NULL,
	[WindForce] [int] NULL,
	[SeaDirection] [decimal](18, 2) NULL,
	[SeaState] [int] NULL,
	[CurrentDirection] [decimal](18, 2) NULL,
	[CurrentStrength] [decimal](18, 2) NULL,
	[WeatherRemarks] [varchar](max) NULL,
	[Lattitude1] [int] NULL,
	[Lattitude2] [int] NULL,
	[Lattitude3] [int] NULL,
	[Longitude1] [int] NULL,
	[Longitud2] [int] NULL,
	[Longitud3] [int] NULL,
	[LocationDescription] [varchar](max) NULL,
	[ROBIFO45] [decimal](18, 2) NULL,
	[ROBIFO1] [decimal](18, 2) NULL,
	[ROBMGO5] [decimal](18, 2) NULL,
	[ROBMGO1] [decimal](18, 2) NULL,
	[ROBMDO] [decimal](18, 2) NULL,
	[ROBMECC] [decimal](18, 2) NULL,
	[ROBMECYL] [decimal](18, 2) NULL,
	[ROBAECC] [decimal](18, 2) NULL,
	[ROBHYD] [decimal](18, 2) NULL,
	[ROBMDOLube] [decimal](18, 2) NULL,
	[ROBFesshWater] [decimal](18, 2) NULL,
	[ROBIFO45Recv] [decimal](18, 2) NULL,
	[ROBIFO1Recv] [decimal](18, 2) NULL,
	[ROBMGO5Recv] [decimal](18, 2) NULL,
	[ROBMGO1Recv] [decimal](18, 2) NULL,
	[RobMDORecv] [decimal](18, 2) NULL,
	[ROBMECCRecv] [decimal](18, 2) NULL,
	[ROBMECYLRecv] [decimal](18, 2) NULL,
	[ROBAECCRecv] [decimal](18, 2) NULL,
	[ROBHYDRecv] [decimal](18, 2) NULL,
	[RobMDOLubeRecv] [decimal](18, 2) NULL,
	[RobFesshWaterRecv] [decimal](18, 2) NULL,
	[TCW] [varchar](50) NULL,
	[BW] [varchar](50) NULL,
	[TCU20L] [varchar](50) NULL,
	[TCU40L] [varchar](50) NULL,
	[TCU45L] [varchar](50) NULL,
	[TCU20E] [varchar](50) NULL,
	[TCU40E] [varchar](50) NULL,
	[TCU45E] [varchar](50) NULL,
 CONSTRAINT [PK_VPRDepartureReport] PRIMARY KEY CLUSTERED 
(
	[DepartureID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VPRNoonReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPRNoonReport]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VPRNoonReport](
	[ReportsPK] [bigint] NULL,
	[NoonID] [bigint] NOT NULL,
	[VesselID] [varchar](3) NOT NULL,
	[ReportDate] [smalldatetime] NULL,
	[Location] [int] NULL,
	[VoyageNo] [varchar](100) NULL,
	[RestrictedArea] [int] NULL,
	[AreaName] [int] NULL,
	[ETARestrictedArea] [smalldatetime] NULL,
	[ChartererName] [varchar](250) NULL,
	[CharterPartySpeed] [decimal](18, 2) NULL,
	[VoyOrderSpeed] [decimal](18, 2) NULL,
	[VoyInstructions] [varchar](1000) NULL,
	[SteamingHrs] [int] NULL,
	[SteamingMin] [int] NULL,
	[DistanceMadeGood] [decimal](18, 2) NULL,
	[AvgSpeed] [decimal](18, 2) NULL,
	[Stoppages] [int] NULL,
	[StoppagesHH] [int] NULL,
	[StoppagesMM] [int] NULL,
	[Displacement] [int] NULL,
	[Remarks] [varchar](max) NULL,
	[VoyCondition] [varchar](250) NULL,
	[DepPort] [varchar](50) NULL,
	[DepArrivalPort] [varchar](250) NULL,
	[COSPDate] [smalldatetime] NULL,
	[COSPHrs] [int] NULL,
	[COSPMin] [int] NULL,
	[TimeZone] [varchar](250) NULL,
	[ArrivalPortETA] [smalldatetime] NULL,
	[ArrivalPortETAHrs] [int] NULL,
	[ArrivalPortETAMin] [int] NULL,
	[DraftFwd] [decimal](18, 2) NULL,
	[DraftAft] [decimal](18, 2) NULL,
	[DistanceToGo] [decimal](18, 2) NULL,
	[ArrivalPortAgent] [varchar](250) NULL,
	[PersonalIncharge] [varchar](250) NULL,
	[AddressContactDetails] [varchar](max) NULL,
	[Port1] [varchar](50) NULL,
	[PortETA1] [smalldatetime] NULL,
	[Port2] [varchar](50) NULL,
	[PortETA2] [smalldatetime] NULL,
	[Port3] [varchar](50) NULL,
	[PortETA3] [smalldatetime] NULL,
	[CourceT] [decimal](18, 2) NULL,
	[WindDirectionT] [decimal](18, 2) NULL,
	[WindForce] [int] NULL,
	[SeaDirection] [decimal](18, 2) NULL,
	[SeaState] [int] NULL,
	[CurrentDirection] [decimal](18, 2) NULL,
	[CurrentStrength] [decimal](18, 2) NULL,
	[WeatherRemarks] [varchar](max) NULL,
	[Lattitude1] [int] NULL,
	[Lattitude2] [int] NULL,
	[Lattitude3] [int] NULL,
	[Longitude1] [int] NULL,
	[Longitud2] [int] NULL,
	[Longitud3] [int] NULL,
	[LocationDescription] [varchar](max) NULL,
	[ROBIFO45Fuel] [decimal](18, 2) NULL,
	[ROBIFO45Lube] [decimal](18, 2) NULL,
	[ROBIFO45FreshWater] [decimal](18, 2) NULL,
	[ROBIFO1Fuel] [decimal](18, 2) NULL,
	[ROBIFO1Lube] [decimal](18, 2) NULL,
	[ROBMGO5Fuel] [decimal](18, 2) NULL,
	[ROBMGO5Lube] [decimal](18, 2) NULL,
	[ROBMGO1Fuel] [decimal](18, 2) NULL,
	[ROBMGO1Lube] [decimal](18, 2) NULL,
	[ROBMDOFuel] [decimal](18, 2) NULL,
	[ROBMDOLube] [decimal](18, 2) NULL,
	[MEIFO45] [decimal](18, 2) NULL,
	[MEIFO1] [decimal](18, 2) NULL,
	[MEMGO5] [decimal](18, 2) NULL,
	[MEMGO1] [decimal](18, 2) NULL,
	[MEMDO] [decimal](18, 2) NULL,
	[AEIFO45] [decimal](18, 2) NULL,
	[AEIFO1] [decimal](18, 2) NULL,
	[AEMGO5] [decimal](18, 2) NULL,
	[AEMGO1] [decimal](18, 2) NULL,
	[AEMDO] [decimal](18, 2) NULL,
	[CargoHeatingIFO45] [decimal](18, 2) NULL,
	[CargoHeatingIFO1] [decimal](18, 2) NULL,
	[CargoHeatingMGO5] [decimal](18, 2) NULL,
	[CargoHeatingMGO1] [decimal](18, 2) NULL,
	[CargoHeatingMDO] [decimal](18, 2) NULL,
	[TankCleaningIFO45] [decimal](18, 2) NULL,
	[TankCleaningIFO1] [decimal](18, 2) NULL,
	[TankCleaningMGO5] [decimal](18, 2) NULL,
	[TankCleaningMGO1] [decimal](18, 2) NULL,
	[TankCleaningMDO] [decimal](18, 2) NULL,
	[GasFreeingIFO45] [decimal](18, 2) NULL,
	[GasFreeingIFO1] [decimal](18, 2) NULL,
	[GasFreeingMGO5] [decimal](18, 2) NULL,
	[GasFreeingMGO1] [decimal](18, 2) NULL,
	[GasFreeingMDO] [decimal](18, 2) NULL,
	[IGSIFO45] [decimal](18, 2) NULL,
	[IGSIFO1] [decimal](18, 2) NULL,
	[IGSMGO5] [decimal](18, 2) NULL,
	[IGSMGO1] [decimal](18, 2) NULL,
	[IGSMDO] [decimal](18, 2) NULL,
	[Total_IFO45] [decimal](18, 2) NULL,
	[Total_IFO1] [decimal](18, 2) NULL,
	[Total_MGO5] [decimal](18, 2) NULL,
	[Total_MGO1] [decimal](18, 2) NULL,
	[Total_MDO] [decimal](18, 2) NULL,
	[MECCLube] [decimal](18, 2) NULL,
	[MECYLLube] [decimal](18, 2) NULL,
	[AECCLube] [decimal](18, 2) NULL,
	[HYDLube] [decimal](18, 2) NULL,
	[MDOLube] [decimal](18, 2) NULL,
	[GeneratedFreshWater] [decimal](18, 2) NULL,
	[ConsumedFreshWater] [decimal](18, 2) NULL,
	[ExhTempMin] [decimal](18, 2) NULL,
	[ExhTempMax] [decimal](18, 2) NULL,
	[MERPM] [decimal](18, 2) NULL,
	[EngineDistance] [decimal](18, 2) NULL,
	[Slip] [decimal](18, 2) NULL,
	[MEOutput] [decimal](18, 2) NULL,
	[METhermalLoad] [decimal](18, 2) NULL,
	[MELoadIndicator] [decimal](18, 2) NULL,
	[METCNo1RPM] [decimal](18, 2) NULL,
	[METCNo2RPM] [decimal](18, 2) NULL,
	[MESCAVPressure] [decimal](18, 2) NULL,
	[SCAVTEMP] [decimal](18, 2) NULL,
	[LubeOilPressure] [decimal](18, 2) NULL,
	[SeaWaterTemp] [decimal](18, 2) NULL,
	[EngRoomTemp] [decimal](18, 2) NULL,
	[BligPump] [decimal](18, 2) NULL,
	[AUX1Load] [decimal](18, 2) NULL,
	[AUX2Load] [decimal](18, 2) NULL,
	[AUX3Load] [decimal](18, 2) NULL,
	[AUX4Load] [decimal](18, 2) NULL,
	[TotalAUXLoad] [decimal](18, 2) NULL,
	[AENo1] [decimal](18, 2) NULL,
	[AENo2] [decimal](18, 2) NULL,
	[AENo3] [decimal](18, 2) NULL,
	[AENo4] [decimal](18, 2) NULL,
	[AEFOInletTemp] [decimal](18, 2) NULL,
	[TotalCargoWeight] [decimal](18, 2) NULL,
	[BallastWeight] [decimal](18, 2) NULL,
 CONSTRAINT [PK_VPRNoonReport] PRIMARY KEY CLUSTERED 
(
	[NoonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VPRPortAnchorageReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPRPortAnchorageReport]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VPRPortAnchorageReport](
	[ReportsPK] [bigint] NULL,
	[AnchorageID] [bigint] NULL,
	[VesselID] [varchar](3) NOT NULL,
	[ReportDate] [smalldatetime] NULL,
	[VoyageNo] [varchar](100) NULL,
	[ArrivalPort] [varchar](50) NULL,
	[POB] [varchar](100) NULL,
	[LetGoAnchorage] [smalldatetime] NULL,
	[LetGoAnchorageHH] [int] NULL,
	[LetGoAnchorageMM] [int] NULL,
	[pilotAwayHH] [int] NULL,
	[pilotAwayMM] [int] NULL,
	[AnchorageReason] [varchar](255) NULL,
	[ETBDT] [smalldatetime] NULL,
	[ETBHours] [int] NULL,
	[ETBMin] [int] NULL,
	[CourceT] [decimal](18, 2) NULL,
	[WindDirectionT] [decimal](18, 2) NULL,
	[WindForce] [int] NULL,
	[SeaDirection] [decimal](18, 2) NULL,
	[SeaState] [int] NULL,
	[CurrentDirection] [decimal](18, 2) NULL,
	[CurrentStrength] [decimal](18, 2) NULL,
	[WeatherRemarks] [varchar](max) NULL,
	[Lattitude1] [int] NULL,
	[Lattitude2] [int] NULL,
	[Lattitude3] [int] NULL,
	[Longitude1] [int] NULL,
	[Longitud2] [int] NULL,
	[Longitud3] [int] NULL,
	[LocationDescription] [varchar](max) NULL,
	[MEIFO45] [decimal](18, 2) NULL,
	[MEIFO1] [decimal](18, 2) NULL,
	[MEMGO5] [decimal](18, 2) NULL,
	[MEMGO1] [decimal](18, 2) NULL,
	[MEMDO] [decimal](18, 2) NULL,
	[AEIFO45] [decimal](18, 2) NULL,
	[AEIFO1] [decimal](18, 2) NULL,
	[AEMGO5] [decimal](18, 2) NULL,
	[AEMGO1] [decimal](18, 2) NULL,
	[AEMDO] [decimal](18, 2) NULL,
	[CargoHeatingIFO45] [decimal](18, 2) NULL,
	[CargoHeatingIFO1] [decimal](18, 2) NULL,
	[CargoHeatingMGO5] [decimal](18, 2) NULL,
	[CargoHeatingMGO1] [decimal](18, 2) NULL,
	[CargoHeatingMDO] [decimal](18, 2) NULL,
	[MECCLube] [decimal](18, 2) NULL,
	[MECYLLube] [decimal](18, 2) NULL,
	[AECCLube] [decimal](18, 2) NULL,
	[HYDLube] [decimal](18, 2) NULL,
	[MDOLube] [decimal](18, 2) NULL,
	[GeneratedFreshWater] [decimal](18, 2) NULL,
	[ConsumedFreshWater] [decimal](18, 2) NULL,
	[TCW] [varchar](50) NULL,
	[BW] [varchar](50) NULL,
	[ROBIFO45] [decimal](18, 2) NULL,
	[ROBIFO1] [decimal](18, 2) NULL,
	[ROBMGO5] [decimal](18, 2) NULL,
	[ROBMGO1] [decimal](18, 2) NULL,
	[ROBMDO] [decimal](18, 2) NULL,
	[ROBMECC] [decimal](18, 2) NULL,
	[ROBMECYL] [decimal](18, 2) NULL,
	[ROBAECC] [decimal](18, 2) NULL,
	[ROBHYD] [decimal](18, 2) NULL,
	[ROBMDOLube] [decimal](18, 2) NULL,
	[ROBFesshWater] [decimal](18, 2) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VPRPortBerthingReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPRPortBerthingReport]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VPRPortBerthingReport](
	[ReportsPK] [bigint] NULL,
	[BerthingID] [bigint] NOT NULL,
	[VesselID] [varchar](3) NOT NULL,
	[ReportDate] [smalldatetime] NULL,
	[VoyageNo] [varchar](100) NULL,
	[ArrivalPort] [varchar](50) NULL,
	[BerthTerminalName] [varchar](100) NULL,
	[PlaceOfBerth] [varchar](100) NULL,
	[FirstLineDate] [smalldatetime] NULL,
	[FirstLineHH] [int] NULL,
	[FirstLineMM] [int] NULL,
	[AllFastDate] [smalldatetime] NULL,
	[AllFastHH] [int] NULL,
	[AllFastMM] [int] NULL,
	[NoOfTUGSUSED] [varchar](100) NULL,
	[ETBDT] [smalldatetime] NULL,
	[ETBHours] [int] NULL,
	[ETBMin] [int] NULL,
	[ETDDT] [smalldatetime] NULL,
	[ETDHours] [int] NULL,
	[ETDMin] [int] NULL,
	[CourceT] [decimal](18, 2) NULL,
	[WindDirectionT] [decimal](18, 2) NULL,
	[WindForce] [int] NULL,
	[SeaDirection] [decimal](18, 2) NULL,
	[SeaState] [int] NULL,
	[CurrentDirection] [decimal](18, 2) NULL,
	[CurrentStrength] [decimal](18, 2) NULL,
	[WeatherRemarks] [varchar](max) NULL,
	[Lattitude1] [int] NULL,
	[Lattitude2] [int] NULL,
	[Lattitude3] [int] NULL,
	[Longitude1] [int] NULL,
	[Longitud2] [int] NULL,
	[Longitud3] [int] NULL,
	[LocationDescription] [varchar](max) NULL,
	[MEIFO45] [decimal](18, 2) NULL,
	[MEIFO1] [decimal](18, 2) NULL,
	[MEMGO5] [decimal](18, 2) NULL,
	[MEMGO1] [decimal](18, 2) NULL,
	[MEMDO] [decimal](18, 2) NULL,
	[AEIFO45] [decimal](18, 2) NULL,
	[AEIFO1] [decimal](18, 2) NULL,
	[AEMGO5] [decimal](18, 2) NULL,
	[AEMGO1] [decimal](18, 2) NULL,
	[AEMDO] [decimal](18, 2) NULL,
	[CargoHeatingIFO45] [decimal](18, 2) NULL,
	[CargoHeatingIFO1] [decimal](18, 2) NULL,
	[CargoHeatingMGO5] [decimal](18, 2) NULL,
	[CargoHeatingMGO1] [decimal](18, 2) NULL,
	[CargoHeatingMDO] [decimal](18, 2) NULL,
	[MECCLube] [decimal](18, 2) NULL,
	[MECYLLube] [decimal](18, 2) NULL,
	[AECCLube] [decimal](18, 2) NULL,
	[HYDLube] [decimal](18, 2) NULL,
	[MDOLube] [decimal](18, 2) NULL,
	[GeneratedFreshWater] [decimal](18, 2) NULL,
	[ConsumedFreshWater] [decimal](18, 2) NULL,
	[TCW] [varchar](50) NULL,
	[BW] [varchar](50) NULL,
	[ROBIFO45] [decimal](18, 2) NULL,
	[ROBIFO1] [decimal](18, 2) NULL,
	[ROBMGO5] [decimal](18, 2) NULL,
	[ROBMGO1] [decimal](18, 2) NULL,
	[ROBMDO] [decimal](18, 2) NULL,
	[ROBMECC] [decimal](18, 2) NULL,
	[ROBMECYL] [decimal](18, 2) NULL,
	[ROBAECC] [decimal](18, 2) NULL,
	[ROBHYD] [decimal](18, 2) NULL,
	[ROBMDOLube] [decimal](18, 2) NULL,
	[ROBFesshWater] [decimal](18, 2) NULL,
 CONSTRAINT [PK_VSL_VPRPortBerthingReport] PRIMARY KEY CLUSTERED 
(
	[BerthingID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VSL_VPRPortDriftReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VSL_VPRPortDriftReport]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VSL_VPRPortDriftReport](
	[ReportsPK] [bigint] NULL,
	[PortDriftID] [int] NOT NULL,
	[VesselID] [varchar](3) NOT NULL,
	[ReportDate] [smalldatetime] NULL,
	[VoyageNo] [varchar](100) NULL,
	[ArrivalPort] [varchar](50) NULL,
	[ComDDDate] [smalldatetime] NULL,
	[DriftHour] [int] NULL,
	[DriftMin] [int] NULL,
	[DriftReason] [char](1) NULL,
	[ETBDT] [smalldatetime] NULL,
	[ETBHours] [int] NULL,
	[ETBMin] [int] NULL,
	[CourceT] [decimal](18, 2) NULL,
	[WindDirectionT] [decimal](18, 2) NULL,
	[WindForce] [int] NULL,
	[SeaDirection] [decimal](18, 2) NULL,
	[SeaState] [int] NULL,
	[CurrentDirection] [decimal](18, 2) NULL,
	[CurrentStrength] [decimal](18, 2) NULL,
	[WeatherRemarks] [varchar](max) NULL,
	[Lattitude1] [int] NULL,
	[Lattitude2] [int] NULL,
	[Lattitude3] [int] NULL,
	[Longitude1] [int] NULL,
	[Longitud2] [int] NULL,
	[Longitud3] [int] NULL,
	[LocationDescription] [varchar](max) NULL,
	[MEIFO45] [decimal](18, 2) NULL,
	[MEIFO1] [decimal](18, 2) NULL,
	[MEMGO5] [decimal](18, 2) NULL,
	[MEMGO1] [decimal](18, 2) NULL,
	[MEMDO] [decimal](18, 2) NULL,
	[AEIFO45] [decimal](18, 2) NULL,
	[AEIFO1] [decimal](18, 2) NULL,
	[AEMGO5] [decimal](18, 2) NULL,
	[AEMGO1] [decimal](18, 2) NULL,
	[AEMDO] [decimal](18, 2) NULL,
	[CargoHeatingIFO45] [decimal](18, 2) NULL,
	[CargoHeatingIFO1] [decimal](18, 2) NULL,
	[CargoHeatingMGO5] [decimal](18, 2) NULL,
	[CargoHeatingMGO1] [decimal](18, 2) NULL,
	[CargoHeatingMDO] [decimal](18, 2) NULL,
	[MECCLube] [decimal](18, 2) NULL,
	[MECYLLube] [decimal](18, 2) NULL,
	[AECCLube] [decimal](18, 2) NULL,
	[HYDLube] [decimal](18, 2) NULL,
	[MDOLube] [decimal](18, 2) NULL,
	[GeneratedFreshWater] [decimal](18, 2) NULL,
	[ConsumedFreshWater] [decimal](18, 2) NULL,
	[TCW] [varchar](50) NULL,
	[BW] [varchar](50) NULL,
	[ROBIFO45] [decimal](18, 2) NULL,
	[ROBIFO1] [decimal](18, 2) NULL,
	[ROBMGO5] [decimal](18, 2) NULL,
	[ROBMGO1] [decimal](18, 2) NULL,
	[ROBMDO] [decimal](18, 2) NULL,
	[ROBMECC] [decimal](18, 2) NULL,
	[ROBMECYL] [decimal](18, 2) NULL,
	[ROBAECC] [decimal](18, 2) NULL,
	[ROBHYD] [decimal](18, 2) NULL,
	[ROBMDOLube] [decimal](18, 2) NULL,
	[ROBFesshWater] [decimal](18, 2) NULL,
 CONSTRAINT [PK_VPRPortDriftReport] PRIMARY KEY CLUSTERED 
(
	[PortDriftID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
/****** Object:  View [dbo].[vw_ClassComponentJobStatus]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_ClassComponentJobStatus]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[vw_ClassComponentJobStatus]
AS
SELECT     VCM.VesselCode, 
VSL.ShipName, CM.ComponentCode, CM.ComponentName, VCM.ClassEquipCode,
-- CJM.DescrSh AS JobDesacription, 
(SELECT DescrSh FROM ComponentsJobMapping CJM1 WHERE CJM1.CompJobId = JH.CompJobId )AS JobDesacription,
JH1.LastDueDate, JH1.DoneDate,JH1.NextDueDate ,CM.CriticalType
FROM         
dbo.VSL_ComponentMasterForVessel AS VCM  
INNER JOIN dbo.ComponentMaster AS CM ON CM.ComponentId = VCM.ComponentId AND CM.ClassEquip = 1 AND  vcm.VesselCode=''LIG''
INNER JOIN dbo.Settings AS VSL ON VSL.ShipCode = vcm.VesselCode
LEFT JOIN 
(
( 
(SELECT VESSELCODE,COMPONENTID,COMPJOBID,MAX(HistoryId) AS HistoryId FROM VSL_VesselJobUpdateHistory WHERE VesselCode =''LIG'' GROUP BY VESSELCODE,COMPONENTID,COMPJOBID) jh
INNER JOIN dbo.ComponentsJobMapping AS CJM ON CJM.ComponentId = JH.ComponentId AND CJM.CompJobId = JH.CompJobId 
) 
 INNER JOIN       VSL_VesselJobUpdateHistory jh1 on jh.vesselcode = jh1.vesselcode AND jh.HistoryId = jh1.HistoryId
 )on jh1.ComponentId = VCM.ComponentId AND JH1.VesselCode = VCM.VesselCode
' 
GO
/****** Object:  View [dbo].[vw_Communication_Export]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_Communication_Export]'))
EXEC dbo.sp_executesql @statement = N'


CREATE View [dbo].[vw_Communication_Export]
As

SELECT [TableId],[RecordType],[VesselCode],[RecordId],[CreatedOn],[RecordNo] FROM [dbo].[tbl_Vessel_Communication] WHERE [ExportedOn] IS Null

--SELECT ''Drill'' AS [Type],[VesselCode],[DoneId],DoneDate AS CreateDate, '''' AS [Number] 

--FROM [dbo].[DT_VSL_DrillTrainingsHistory] WHERE OfficeRecOn IS NULL

--UNION 

--SELECT ''Provision'' AS [Type],[VesselCode],[ProvisionId] AS DoneId ,ApprovedOn AS CreateDate,[RequisitionNo] AS [Number] 
--FROM [MP_VSL_ProvisionMaster] WHERE LTRIM(RTRIM(ISNULL(RequisitionNo,'''')))<>'''' AND ISNULL(ACTIVEINACTIVE,''A'')=''A'' AND RECEIVEDON IS NULL

--UNION

--SELECT ''Spare'' AS [Type],[VesselCode], [SpareReqId] AS DoneId, [ApprovedOn] AS CreateDate,[ReqnNo] AS [Number] 
--FROM [MP_VSL_SparesReqMaster] WHERE LTRIM(RTRIM(ISNULL(ReqnNo,'''')))<>'''' AND ISNULL(ACTIVEINACTIVE,''A'')=''A'' AND RECEIVEDON IS NULL

--UNION

--SELECT ''Store'' AS [Type],[VesselCode],[StoreReqId] AS DoneId,[ApprovedOn] AS CreateDate,[ReqnNo] AS [Number]  
--FROM [MP_VSL_StoreReqMaster] WHERE LTRIM(RTRIM(ISNULL(ReqnNo,'''')))<>'''' AND ISNULL(ACTIVEINACTIVE,''A'')=''A'' AND RECEIVEDON IS NULL

--UNION

--SELECT ''LFI'' AS [Type], (SELECT TOP 1 [ShipCode] FROM [dbo].[Settings]) AS [VesselCode], LFIID AS [DoneId], [LFIDate] AS CreateDate, [LFINumber] AS [Number]
--FROM DBO.lfi WHERE (SELECT AckOn from LFI_Vessel_Notifications WHERE LFIID=lfi.LFIID AND VESSELCODE=(SELECT TOP 1 [ShipCode] FROM [dbo].[Settings])) <> '''' OR (SELECT AckOn from LFI_Vessel_Notifications WHERE LFIID=lfi.LFIID AND VESSELCODE=(SELECT TOP 1 [ShipCode] FROM [dbo].[Settings])) IS NOT NULL

--UNION

--SELECT ''Focus Campaign'' AS [Type], (SELECT TOP 1 [ShipCode] FROM [dbo].[Settings]) AS [VesselCode], FocusCampID AS [DoneId], [FocusCampDATE] AS CreateDate, [FocusCampNUMBER] AS [Number]
--FROM DBO.FocusCamp WHERE (SELECT AckOn from FocusCamp_Vessel_Notifications WHERE FocusCampID=FocusCamp.FocusCampID AND VESSELCODE=(SELECT TOP 1 [ShipCode] FROM [dbo].[Settings])) <> '''' OR (SELECT AckOn from FocusCamp_Vessel_Notifications WHERE FocusCampID=FocusCamp.FocusCampID AND VESSELCODE=(SELECT TOP 1 [ShipCode] FROM [dbo].[Settings])) IS NOT NULL

--UNION

--SELECT ''Regulation'' AS [Type], (SELECT TOP 1 [ShipCode] FROM [dbo].[Settings]) AS [VesselCode], RegID AS [DoneId], [RegDATE] AS CreateDate, [REGNUMBER] AS [Number]
--FROM DBO.Reg_Regulation WHERE (SELECT AckOn from Reg_Vessel_Notifications WHERE RegID=Reg_Regulation.RegID AND VESSELCODE=(SELECT TOP 1 [ShipCode] FROM [dbo].[Settings])) <> '''' OR (SELECT AckOn from Reg_Vessel_Notifications WHERE RegID=Reg_Regulation.RegID AND VESSELCODE=(SELECT TOP 1 [ShipCode] FROM [dbo].[Settings])) IS NOT NULL

--UNION

--SELECT ''Circular'' AS [Type], (SELECT TOP 1 [ShipCode] FROM [dbo].[Settings]) AS [VesselCode], [CId] AS [DoneId], [CircularDate] AS CreateDate, [CircularNumber] AS [Number]
--FROM dbo.Cir_Circular C 
--INNER JOIN dbo.Cir_Category CC ON CC.[CirCatId] = C.[Category]
--WHERE (SELECT AckOn from Cir_Vessel_Notifications WHERE CId=C.CId AND VESSELCODE=(SELECT TOP 1 [ShipCode] FROM [dbo].[Settings])) <> '''' OR (SELECT AckOn from Cir_Vessel_Notifications WHERE CId=C.CId AND VESSELCODE=(SELECT TOP 1 [ShipCode] FROM [dbo].[Settings])) IS NOT NULL

--UNION

--SELECT ''SCM'' AS [Type], [VesselCode], [ReportsPK] AS [DoneId], [SDate] AS CreateDate, '''' AS [Number]
--FROM SCM_Master WHERE  [UpdatedBy] IS NULL

--UNION

--SELECT ''MWUC'' AS [Type], [VesselCode], [TABLEID] AS [DoneId], [FORDATE] AS CreateDate, [MASTERCREWNO] AS [Number]
--FROM MWUC_MASTER WHERE [OFFICERECDON] IS NULL OR [OFFICERECDON] = ''''


' 
GO
/****** Object:  View [dbo].[vw_ComponentDetailsListReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_ComponentDetailsListReport]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[vw_ComponentDetailsListReport]
AS
SELECT        MAIN.ComponentId, MAIN.ComponentCode, MAIN.ComponentName, MAIN.CriticalEquip, MAIN.CriticalType, CMV2.ClassEquipCode AS Descr, CMV2.Maker, 
                         CMV2.MakerType, CMV2.Descr AS Descr1
FROM            (SELECT DISTINCT ComponentId, ComponentCode, ComponentName, CriticalEquip, CriticalType
                          FROM            (SELECT        CM2.ComponentId, CM2.ComponentCode, CM2.ComponentName, CM2.CriticalEquip, CM2.CriticalType
                                                    FROM            dbo.ComponentMaster AS CM INNER JOIN
                                                                              dbo.ComponentMasterForVessel AS CMV ON CM.ComponentId = CMV.ComponentId INNER JOIN
                                                                              dbo.ComponentMaster AS CM2 ON LEN(LTRIM(RTRIM(CM2.ComponentCode))) <= LEN(LTRIM(RTRIM(CM.ComponentCode))) AND 
                                                                              LTRIM(RTRIM(CM.ComponentCode)) LIKE LTRIM(RTRIM(CM2.ComponentCode)) + ''%'') AS AA) AS MAIN INNER JOIN
                         dbo.ComponentMasterForVessel AS CMV2 ON MAIN.ComponentId = CMV2.ComponentId
' 
GO
/****** Object:  View [dbo].[Vw_ComponentJobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[Vw_ComponentJobs]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[Vw_ComponentJobs]
AS
SELECT     TOP (100) PERCENT dbo.ComponentMaster.ComponentCode, dbo.ComponentMaster.ComponentName, dbo.JobMaster.JobCode, 
                      dbo.ComponentsJobMapping.DescrSh, dbo.Rank.RankCode, dbo.DeptMaster.DeptName, dbo.JobIntervalMaster.IntervalName, '''' AS Interval, 
                      dbo.ComponentMaster.CriticalEquip,dbo.ComponentMaster.CriticalType, GETDATE() AS LastdoneDate, '''' AS LastDoneHour
FROM         dbo.ComponentMaster LEFT OUTER JOIN
                      dbo.ComponentsJobMapping INNER JOIN
                      dbo.JobMaster ON dbo.ComponentsJobMapping.JobId = dbo.JobMaster.JobId INNER JOIN
                      dbo.DeptMaster ON dbo.ComponentsJobMapping.DeptId = dbo.DeptMaster.DeptId INNER JOIN
                      dbo.Rank ON dbo.ComponentsJobMapping.AssignTo = dbo.Rank.RankId INNER JOIN
                      dbo.JobIntervalMaster ON dbo.JobIntervalMaster.IntervalId = dbo.ComponentsJobMapping.IntervalId ON 
                      dbo.ComponentMaster.ComponentId = dbo.ComponentsJobMapping.ComponentId
ORDER BY dbo.ComponentMaster.ComponentCode
' 
GO
/****** Object:  View [dbo].[vw_CriticalShutdownExtensionDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_CriticalShutdownExtensionDetails]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[vw_CriticalShutdownExtensionDetails]
AS
SELECT     SDE.ShutdownId, SDE.Ext_ShutDownTotalHrs, SDE.Ext_FromDateTime, SDE.Ext_ToDateTime, SDEA.Approver_Name AS E_Approver_Name, 
                      SDEA.Approver_Position AS E_Approver_Position, SDEA.Approver_Remarks AS E_Approver_Remarks, SDEA.ApprovedOn AS E_ApprovedOn
FROM         dbo.VSL_CriticalShutdownExtensions AS SDE LEFT OUTER JOIN
                      dbo.VSL_CriticalShutdownExtensionApproval AS SDEA ON SDEA.VesselCode = SDE.VesselCode AND SDEA.ExtensionId = SDE.ExtensionId

' 
GO
/****** Object:  View [dbo].[vw_CriticalShutdownRequestData]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_CriticalShutdownRequestData]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[vw_CriticalShutdownRequestData]
AS
SELECT     SDR.ShutdownId, SDR.VesselCode, CM.ComponentCode, CM.ComponentName, 
                      CASE WHEN Occasion = 1 THEN ''Routine'' WHEN Occasion = 2 THEN ''Break down'' ELSE '''' END AS Occasion, SDR.DefectNo, SDR.RequestDate, SDR.MasterCEName, 
                      SDR.Job_Defect, SDR.Pl_ShutDownTotalHrs, SDR.Pl_FromDateTime, SDR.Pl_ToDateTime, SDR.Ma_CommencedDateTime, SDR.Ma_CompletedDateTime, 
                      SDR.Maintenence_Remarks, SDR.IssuedBy, SDR.IssueDate, SDR.Closed, SDA.Approver_Name, SDA.Approver_Position, SDA.Approver_Remarks, 
                      SDA.ApprovedOn
FROM         dbo.VSL_CriticalEquipShutdownRequest AS SDR LEFT OUTER JOIN
                      dbo.VSL_CriticalShutdownApproval AS SDA ON SDA.ShutdownId = SDR.ShutdownId AND SDA.VesselCode = SDR.VesselCode INNER JOIN
                      dbo.ComponentMaster AS CM ON CM.ComponentId = SDR.ComponentId

' 
GO
/****** Object:  View [dbo].[VW_DD_DOCKET_PRINT]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_DD_DOCKET_PRINT]'))
EXEC dbo.sp_executesql @statement = N'


CREATE VIEW [dbo].[VW_DD_DOCKET_PRINT]
AS 
SELECT DOCKETNO,DocketSubJobId,DSJ.[DocketJobId],DSJ.[DocketId],DJ.CatCode,CatName,DJ.JOBCODE,JOBNAME,JobDesc,[SubJobCode],[SubJobName],AttachmentName,[Unit],[BidQty],[LongDescr],CASE WHEN [CostCategory] = ''Y'' THEN ''Shipyard Supply Costs'' WHEN [CostCategory] = ''N'' THEN ''Owners Supply Shipyard Costs'' ELSE '''' END AS [CostCategory] , CASE WHEN [OutsideRepair] = ''Y'' THEN ''Yes''  WHEN [OutsideRepair] = ''N'' THEN ''No'' ELSE '''' END AS [OutsideRepair] 
FROM [dbo].[DD_DocketSubJobs] DSJ 
INNER JOIN DD_DOCKETJOBS DJ ON DJ.DOCKETID=DSJ.DOCKETID AND DJ.DocketJobId=DSJ.DocketJobId 
INNER JOIN DD_DocketMaster DM ON DM.DOCKETID=DSJ.DOCKETID


' 
GO
/****** Object:  View [dbo].[VW_DD_RFQ_PRINT]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_DD_RFQ_PRINT]'))
EXEC dbo.sp_executesql @statement = N'


CREATE VIEW [dbo].[VW_DD_RFQ_PRINT]
AS
SELECT R.*,(SELECT VESSELNAME FROM DBO.VESSEL V WHERE V.VESSELID=D.VESSELID) AS VESSELNAME ,C.CATCODE,C.CATNAME,DJ.JOBCODE,DJ.JOBNAME,DJ.JOBDESC,
SJ.[SubJobCode],SJ.[SubJobName],SJ.AttachmentName,SJ.[Unit],SJ.[BidQty],SJ.[LongDescr],
CASE WHEN SJ.[CostCategory] = ''Y'' THEN ''Shipyard Supply Costs'' WHEN SJ.[CostCategory] = ''N'' THEN ''Owners Supply Shipyard Costs'' ELSE '''' END AS [CostCategory] , 
CASE WHEN SJ.[OutsideRepair] = ''Y'' THEN ''Yes''  WHEN SJ.[OutsideRepair] = ''N'' THEN ''No'' ELSE '''' END AS [OutsideRepair],
SJ.QuoteQty,SJ.UnitPrice,SJ.DiscountPer,SJ.NetAmount,SJ.vendorremarks

FROM DD_Docket_RFQ_Master R INNER JOIN DD_DocketMaster D ON D.DocketId = R.DocketId
INNER JOIN DD_JobCategory C ON C.CATCODE<>'''' 
INNER JOIN DD_Docket_RFQ_Jobs DJ ON DJ.RFQId=R.RFQId AND DJ.DocketId=R.DocketId AND C.CATID=DJ.CATID
INNER JOIN DD_Docket_RFQ_SubJobs SJ ON SJ.RFQId=R.RFQId AND SJ.DocketId=R.DocketId AND SJ.DOCKETJOBID=DJ.DOCKETJOBID




' 
GO
/****** Object:  View [dbo].[VW_DD_RFQ_SUP_PRINT]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_DD_RFQ_SUP_PRINT]'))
EXEC dbo.sp_executesql @statement = N'

CREATE VIEW [dbo].[VW_DD_RFQ_SUP_PRINT]
AS
SELECT R.*,(SELECT VESSELNAME FROM DBO.VESSEL V WHERE V.VESSELID=D.VESSELID) AS VESSELNAME ,C.CATCODE,C.CATNAME,DJ.JOBCODE,DJ.JOBNAME,DJ.JOBDESC,
SJ.[SubJobCode],SJ.[SubJobName],SJ.AttachmentName,SJ.[Unit],SJ.[BidQty],SJ.[LongDescr],
CASE WHEN SJ.[CostCategory] = ''Y'' THEN ''Shipyard Supply Costs'' WHEN SJ.[CostCategory] = ''N'' THEN ''Owners Supply Shipyard Costs'' ELSE '''' END AS [CostCategory] , 
CASE WHEN SJ.[OutsideRepair] = ''Y'' THEN ''Yes''  WHEN SJ.[OutsideRepair] = ''N'' THEN ''No'' ELSE '''' END AS [OutsideRepair],
SJ.[SupQty] as QuoteQty,SJ.SUPUnitPrice_USD as UnitPrice,SJ.SUPDiscountPer as DiscountPer,SJ.SUPNetAmount_USD as NetAmount,SJ.vendorremarks,SJ.SUPRemarks 

FROM DD_Docket_RFQ_Master R INNER JOIN DD_DocketMaster D ON D.DocketId = R.DocketId
INNER JOIN DD_JobCategory C ON C.CATCODE<>''''
INNER JOIN DD_Docket_RFQ_Jobs DJ ON DJ.RFQId=R.RFQId AND DJ.DocketId=R.DocketId  AND C.CATID=DJ.CATID
INNER JOIN DD_Docket_RFQ_SubJobs SJ ON SJ.RFQId=R.RFQId AND SJ.DocketId=R.DocketId AND SJ.DOCKETJOBID=DJ.DOCKETJOBID


' 
GO
/****** Object:  View [dbo].[vw_DefectJobs]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_DefectJobs]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[vw_DefectJobs]
as 
SELECT VESSELCODE,COMPONENTCODE,COMPONENTNAME,TARGETDT,DEFECTDETAILS,COMPLETIONDT,REPAIRSDETAILS,VCJM.COMPONENTID from 
dbo.VSL_DefectDetailsMaster VCJM INNER JOIN COMPONENTMASTER CM ON CM.COMPONENTID= VCJM.COMPONENTID
WHERE COMPLETIONDT IS NULL 

' 
GO
/****** Object:  View [dbo].[Vw_DefectReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[Vw_DefectReport]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[Vw_DefectReport]
AS
SELECT     dbo.Vsl_DefectDetailsMaster.VesselCode, dbo.Vsl_DefectDetailsMaster.ComponentId, dbo.ComponentMaster.ComponentCode, 
                      dbo.ComponentMaster.ComponentName, dbo.ComponentMaster.ClassEquip, dbo.ComponentMaster.CriticalEquip, dbo.Vsl_DefectDetailsMaster.DefectNo, 
                      dbo.Vsl_DefectDetailsMaster.ReportDt, dbo.Vsl_DefectDetailsMaster.TargetDt, dbo.Vsl_DefectDetailsMaster.CompletionDt, dbo.Vsl_DefectDetailsMaster.Vessel, 
                      dbo.Vsl_DefectDetailsMaster.Spares, dbo.Vsl_DefectDetailsMaster.ShoreAssist, dbo.Vsl_DefectDetailsMaster.Drydock, dbo.Vsl_DefectDetailsMaster.Guarentee, 
                      dbo.Vsl_DefectDetailsMaster.DefectDetails, dbo.Vsl_DefectDetailsMaster.RepairsDetails, dbo.Vsl_DefectDetailsMaster.SparesOnBoard, 
                      dbo.Vsl_DefectDetailsMaster.RqnNo, dbo.Vsl_DefectDetailsMaster.SparesOrdered, dbo.Vsl_DefectDetailsMaster.RqnDate, 
                      dbo.Vsl_DefectDetailsMaster.SparesRequired, dbo.Vsl_DefectDetailsMaster.Supdt, dbo.Vsl_DefectDetailsMaster.ChiefOfficer, dbo.Vsl_DefectDetailsMaster.ChiefEngg, 
                      dbo.Vsl_DefectDetailsMaster.Status, dbo.Vsl_DefectDetailsMaster.Updated, dbo.Vsl_DefectDetailsMaster.UpdatedOn
FROM         dbo.Vsl_DefectDetailsMaster INNER JOIN
                      dbo.ComponentMaster ON dbo.Vsl_DefectDetailsMaster.ComponentId = dbo.ComponentMaster.ComponentId

' 
GO
/****** Object:  View [dbo].[VW_DefectReport_OfficeData]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_DefectReport_OfficeData]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[VW_DefectReport_OfficeData]
AS
SELECT     ROW_NUMBER() OVER (ORDER BY DD.VesselCode, CM.ComponentCode) AS SrNo, DD.VesselCode, CM.ComponentId, CM.ComponentCode, CM.ComponentName, 
DD.DefectNo, REPLACE(CONVERT(varchar, DD.ReportDt, 106), '' '', ''-'') AS ReportDt, REPLACE(CONVERT(varchar, DD.TargetDt, 106), '' '', ''-'') AS TargetDt, 
CASE DD.CompStatus WHEN ''W'' THEN ''Working'' WHEN ''N'' THEN ''Not Working'' ELSE '' '' END AS CompStatus, DD.RqnNo, REPLACE(CONVERT(varchar, DD.RqnDate, 106), '' '', 
''-'') AS RqnDate, CM.CriticalType, (CASE WHEN CompletionDt IS NULL THEN ''Open'' ELSE ''Closed'' END) AS DefectStatus, REPLACE(CONVERT(varchar, DD.CompletionDt, 106), '' '', 
''-'') AS CompletionDt, CASE WHEN (DD.TargetDt < getdate() AND CompletionDt IS NULL) THEN ''OD'' ELSE '''' END AS Status, '' '' AS Remarks, DefectDetails, 
((CASE WHEN Vessel = ''Y'' THEN '',Vessel'' ELSE '''' END) +
 (CASE WHEN Spares = ''Y'' THEN '',Spares'' ELSE '''' END) +
 (CASE WHEN ShoreAssist = ''Y'' THEN '',ShoreAssist'' ELSE '''' END) + 
 (CASE WHEN Drydock = ''Y'' THEN '',Drydock'' ELSE '''' END) + 
 (CASE WHEN Guarentee = ''Y'' THEN '',Guarentee'' ELSE '''' END)
 ) as Responsibility, (RTRIM(CM.ComponentCode) + '' : '' + CM.ComponentName) AS Component, FM.FleetName
FROM         dbo.VSL_DefectDetailsMaster AS DD INNER JOIN
                      dbo.VSL_ComponentMasterForVessel AS CMV ON CMV.VesselCode = DD.VesselCode AND CMV.ComponentId = DD.ComponentId AND CMV.Status = ''A'' AND 
                      DD.Status = ''A'' INNER JOIN
                      dbo.ComponentMaster AS CM ON CM.ComponentId = CMV.ComponentId INNER JOIN
                      dbo.Vessel V ON CMV.VesselCode = V.VesselCode INNER JOIN
                      dbo.FleetMaster FM ON FM.FleetId = V.FleetId
' 
GO
/****** Object:  View [dbo].[VW_DefectReport_ShipData]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_DefectReport_ShipData]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[VW_DefectReport_ShipData]
AS
SELECT     ROW_NUMBER() OVER (ORDER BY DD.VesselCode, CM.ComponentCode) AS SrNo, DD.VesselCode, CM.ComponentId, CM.ComponentCode, CM.ComponentName, 
DD.DefectNo, REPLACE(CONVERT(varchar, DD.ReportDt, 106), '' '', ''-'') AS ReportDt, REPLACE(CONVERT(varchar, DD.TargetDt, 106), '' '', ''-'') AS TargetDt, 
CASE DD.CompStatus WHEN ''W'' THEN ''Working'' WHEN ''N'' THEN ''Not Working'' ELSE '' '' END AS CompStatus, DD.RqnNo, REPLACE(CONVERT(varchar, DD.RqnDate, 106), '' '', 
''-'') AS RqnDate, CM.CriticalType, (CASE WHEN CompletionDt IS NULL THEN ''Open'' ELSE ''Closed'' END) AS DefectStatus, REPLACE(CONVERT(varchar, DD.CompletionDt, 106), '' '', 
''-'') AS CompletionDt, CASE WHEN (DD.TargetDt < getdate() AND CompletionDt IS NULL) THEN ''OD'' ELSE '''' END AS Status, '' '' AS Remarks, DefectDetails, 
((CASE WHEN Vessel = ''Y'' THEN '',Vessel'' ELSE '''' END) + (CASE WHEN Spares = ''Y'' THEN '',Spares'' ELSE '''' END) 
+ (CASE WHEN ShoreAssist = ''Y'' THEN '',ShoreAssist'' ELSE '''' END) + (CASE WHEN Drydock = ''Y'' THEN '',Drydock'' ELSE '''' END) 
+ (CASE WHEN Guarentee = ''Y'' THEN '',Guarentee'' ELSE '''' END)) AS Responsibility, (RTRIM(CM.ComponentCode) + '' : '' + CM.ComponentName) AS Component

FROM         dbo.VSL_DefectDetailsMaster AS DD INNER JOIN
                      dbo.VSL_ComponentMasterForVessel AS CMV ON CMV.VesselCode = DD.VesselCode AND CMV.ComponentId = DD.ComponentId AND CMV.Status = ''A'' AND 
                      DD.Status = ''A'' INNER JOIN
                      dbo.ComponentMaster AS CM ON CM.ComponentId = CMV.ComponentId 
' 
GO
/****** Object:  View [dbo].[vw_DrillTrainings]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_DrillTrainings]'))
EXEC dbo.sp_executesql @statement = N'




CREATE view [dbo].[vw_DrillTrainings]
as

SELECT *,ODSTATUS=CASE WHEN DUEINDAYS IS NULL OR DUEINDAYS<0 THEN ''OD'' ELSE ''D'' END FROM
(

SELECT VesselCode,DTId,DT.RecordType,LastDueDate,DoneDate,NextDueDate, datediff(day,getdate(),nextduedate) as DueInDays,PlanDate,PostPoneTillDate,DoneId,DoneBy,TM.TraininingName,TrainingGroupId  AS ParentId, (SELECT TraininingName FROM [dbo].[DT_TrainingMaster] WHERE RECORDTYPE = ''G'' AND TrainingId = TM.TrainingGroupId) As GroupName, OfficeGuideLines, AttachmentFileName,
(SELECT [ValidityType] FROM [dbo].[DT_MatrixDetails] WHERE DTId = DT.DTID AND RECORDTYPE=''T'' AND MATRIXID = ( SELECT TOP 1 MatrixId FROM DBO.DT_MatrixMaster WHERE ApplicableDate<= getdate() ORDER BY ApplicableDate Desc )) AS ValidityType,
 (SELECT [ValidityValue] FROM [dbo].[DT_MatrixDetails] WHERE DTId = DT.DTID AND RECORDTYPE=''T'' AND MATRIXID = ( SELECT TOP 1 MatrixId FROM DBO.DT_MatrixMaster WHERE ApplicableDate<= getdate() ORDER BY ApplicableDate Desc )) AS ValidityValue,
 (SELECT STATUS FROM [dbo].[DT_MatrixDetails] WHERE DTId = DT.DTID AND RECORDTYPE=''T'' AND MATRIXID = ( SELECT TOP 1 MatrixId FROM DBO.DT_MatrixMaster WHERE ApplicableDate<= getdate() ORDER BY ApplicableDate Desc )) AS MatrixStatus
FROM 
[dbo].[DT_VSL_DrillTrainings] DT INNER JOIN [dbo].[DT_TrainingMaster] TM ON DT.DTID=TM.TRAININGID AND DT.RECORDTYPE=''T'' AND TM.RECORDTYPE=''T'' AND ISNULL(TM.[Status], ''A'') = ''A''
union
SELECT VesselCode,DTId,DT.RecordType,LastDueDate,DoneDate,NextDueDate, datediff(day,getdate(),nextduedate) as DueInDays,PlanDate,PostPoneTillDate,DoneId,DoneBy,DM.DrillName,DrillGroupId AS ParentId, (SELECT DrillName FROM [dbo].[DT_DrillMaster] WHERE RECORDTYPE = ''S'' AND DRILLID = DM.DrillGroupId) As GroupName, OfficeGuideLines, AttachmentFileName,
(SELECT [ValidityType] FROM [dbo].[DT_MatrixDetails] WHERE DTId = DT.DTID AND RECORDTYPE=''D'' AND MATRIXID = ( SELECT TOP 1 MatrixId FROM DBO.DT_MatrixMaster WHERE ApplicableDate<= getdate() ORDER BY ApplicableDate Desc )) AS ValidityType,
 (SELECT [ValidityValue] FROM [dbo].[DT_MatrixDetails] WHERE DTId = DT.DTID AND RECORDTYPE=''D'' AND MATRIXID = ( SELECT TOP 1 MatrixId FROM DBO.DT_MatrixMaster WHERE ApplicableDate<= getdate() ORDER BY ApplicableDate Desc )) AS ValidityValue,
 (SELECT STATUS FROM [dbo].[DT_MatrixDetails] WHERE DTId = DT.DTID AND RECORDTYPE=''D'' AND MATRIXID = ( SELECT TOP 1 MatrixId FROM DBO.DT_MatrixMaster WHERE ApplicableDate<= getdate() ORDER BY ApplicableDate Desc )) AS MatrixStatus
FROM 
[dbo].[DT_VSL_DrillTrainings] DT INNER JOIN [dbo].[DT_DrillMaster] DM ON DT.DTID=DM.DRILLID AND DT.RECORDTYPE=''D'' AND DM.RECORDTYPE=''D'' AND ISNULL(DM.[Status], ''A'') = ''A''

) A WHERE MATRIXSTATUS=''A''



' 
GO
/****** Object:  View [dbo].[vw_Accident_PrintReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_Accident_PrintReport]'))
EXEC dbo.sp_executesql @statement = N'

CREATE VIEW [dbo].[vw_Accident_PrintReport]
AS
SELECT       (Select [VersionNo] From [dbo].[ER_Master] WHERE [FormNo] = ''G118'') As VersionNo, R.ReportId, R.ReportNo, R.VesselCode,(SELECT [ShipName] FROM [dbo].[Settings] WHERE [ShipCode] = R.VesselCode) AS VesselName,  
               dbo.ER_S115_getOptionTextCSV(''G118'', 21, R.[AreaAudited], '','') AS [AreaAudited], R.[AreaAuditedOther], CASE WHEN R.[AuditType] = ''EXT'' THEN ''External'' WHEN R.[AuditType] = ''INT'' THEN ''Internal'' ELSE '''' END AS [AuditType],
			   CASE WHEN R.[AuditType] = ''EXT'' THEN dbo.ER_S115_getOptionTextCSV(''G118'', 22, R.[AuditValue], '','') WHEN R.[AuditType] = ''INT'' THEN dbo.ER_S115_getOptionTextCSV(''G118'', 23, R.[AuditValue], '','') ELSE '''' END AS [AuditValue],
			   
			   R.[AuditValueOther], R.[NonConformanceDes], R.[NCRMaker],R.[NCRCreatedDate],
			   
			   R.[NCRMakerPos], R.[PersonRecvNCR],R.[RankRecvNCR],R.[NameofGeneralManager],R.[NCRTargetCompDate],R.[ImmediateCorrectiveAction],R.[IMCName],R.[IMCCompletedDate],
			   R.[IMCRanck],
			   dbo.ER_S115_getOptionTextCSV(''G118'', 24, R.[RootCause], '','') AS [RootCause],
			   
			   R.[OhterRootCause],R.[PreventivAction],R.[PAName],R.[PADate],R.[PAPos],    
                         
                         R.CreatedBy, R.CreatedOn, R.ExportedBy, R.ExportedOn,
                         O.[OfficeComment],O.[OfficeCommentVarefiedBy],O.[OfficeCommentVarefiedDate],[VerifiedPersonPOS],
                         CASE WHEN O.Is_Closed = ''N'' THEN ''No'' WHEN O.Is_Closed = ''Y'' THEN ''Yes'' ELSE '''' END AS O_Is_Closed, O.[ClosureDate], O.ClosedBy, O.[ClosureRemarks], O.[ClosureEvidence],
                         CASE WHEN O.Is_Closure_Notified = ''N'' THEN ''No'' WHEN O.Is_Closure_Notified = ''Y'' THEN ''Yes'' ELSE '''' END AS O_Is_Closure_Notified, O.NotifyDate, O.Locked, 
                         O.Status
FROM            dbo.ER_G118_Report AS R LEFT OUTER JOIN dbo.[ER_G118_Report_Office] AS O ON R.ReportId = O.ReportId AND  R.VESSELCODE = O.VESSELCODE


' 
GO
/****** Object:  View [dbo].[vw_ER_S115_PrintReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_ER_S115_PrintReport]'))
EXEC dbo.sp_executesql @statement = N'


CREATE VIEW [dbo].[vw_ER_S115_PrintReport]
AS
SELECT       (Select [VersionNo] From [dbo].[ER_Master] WHERE [FormNo] = ''S115'') As VersionNo, R.ReportId, R.ReportNo, R.VesselCode,(SELECT [ShipName] FROM [dbo].[Settings] WHERE [ShipCode] = R.VesselCode) AS VesselName, R.Latitude, R.Longitude, R.Port, R.ReportDate, R.IncidentDate, 
                         CASE WHEN R.AccidentSeverity = 1 THEN ''Minor'' WHEN R.AccidentSeverity = 2 THEN ''Major'' WHEN R.AccidentSeverity = 3 THEN ''Severe'' ELSE '''' END AS AccidentSeverity,
                          dbo.ER_S115_getOptionTextCSV(''S115'', 1, R.AccidentClassification, '','') AS AccidentClassification, R.EventDescription, 
                         CASE WHEN R.Alcohol_Drug_Testing = ''N'' THEN ''No'' WHEN R.Alcohol_Drug_Testing = ''Y'' THEN ''Yes'' ELSE '''' END AS Alcohol_Drug_Testing, 
                         CASE WHEN R.Is_Vessel_Delayed_GI = ''N'' THEN ''No'' WHEN R.Is_Vessel_Delayed_GI = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_Vessel_Delayed_GI, 
                         CASE WHEN R.Is_Bad_Weather = ''N'' THEN ''No'' WHEN R.Is_Bad_Weather = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_Bad_Weather, 
                         dbo.ER_S115_getOptionTextCSV(''S115'', 2, R.VesselActivity, '','') AS VesselActivity, 
                         CASE WHEN R.Is_Restricted_Visibility = ''N'' THEN ''No'' WHEN R.Is_Restricted_Visibility = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_Restricted_Visibility, 
                         CASE WHEN R.Is_BreachOfCP = ''N'' THEN ''No'' WHEN R.Is_BreachOfCP = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_BreachOfCP, 
                         CASE WHEN R.Cargo_Contamination_Damage = ''N'' THEN ''No'' WHEN R.Cargo_Contamination_Damage = ''Y'' THEN ''Yes'' ELSE '''' END AS Cargo_Contamination_Damage,
                          CASE WHEN R.Cargo_Qty_InDispute = ''N'' THEN ''No'' WHEN R.Cargo_Qty_InDispute = ''Y'' THEN ''Yes'' ELSE '''' END AS Cargo_Qty_InDispute, 
                         R.CCD_NameOfCharterer, R.CCD_TypeOfCargo, R.CCD_Tank_Hold_Nos, 
                         CASE WHEN R.CCD_TankCoating = 1 THEN ''Stainless Steel'' WHEN R.CCD_TankCoating = 2 THEN ''Zinc'' WHEN R.CCD_TankCoating = 3 THEN ''Epoxy'' ELSE '''' END AS
                          CCD_TankCoating, R.CCD_TankCoating_Other, R.CCD_LoadPort, R.CCD_LP_Terminal, R.CCD_LP_Date, R.CCD_DischargePort, R.CCD_DP_Terminal, 
                         R.CCD_DP_Date, CASE WHEN R.CCD_STS_Operation = ''N'' THEN ''No'' WHEN R.CCD_STS_Operation = ''Y'' THEN ''Yes'' ELSE '''' END AS CCD_STS_Operation, 
                         dbo.ER_S115_getOptionTextCSV(''S115'', 5, R.CQD_CargoContaminant, '','') AS CQD_CargoContaminant, 
                         CASE WHEN R.CQD_CargoQty = 1 THEN ''Short loaded'' WHEN R.CQD_CargoQty = 2 THEN ''Excess loaded'' WHEN R.CQD_CargoQty = 3 THEN ''Short discharged'' WHEN
                          R.CQD_CargoQty = 4 THEN ''Excess discharged'' ELSE '''' END AS CQD_CargoQty, 
                         CASE WHEN R.CQD_TanksInspected = ''N'' THEN ''No'' WHEN R.CQD_TanksInspected = ''Y'' THEN ''Yes'' ELSE '''' END AS CQD_TanksInspected, 
                         CASE WHEN R.CQD_WallWashTestDone = ''N'' THEN ''No'' WHEN R.CQD_WallWashTestDone = ''Y'' THEN ''Yes'' ELSE '''' END AS CQD_WallWashTestDone, 
                         dbo.ER_S115_getOptionTextCSV(''S115'', 6, R.Navigation, '','') AS Navigation, dbo.ER_S115_getOptionTextCSV(''S115'', 7, R.Env_Pollution, '','') AS Env_Pollution, 
                         R.Env_Pollution_Other, CASE WHEN R.Is_LossToEnv = ''N'' THEN ''No'' WHEN R.Is_LossToEnv = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_LossToEnv, 
                         CASE WHEN R.LE_SpillType = 1 THEN ''Minor Spill (<25 Ltr.)'' WHEN R.LE_SpillType = 2 THEN ''Medium Spill (<1000 Ltr.)'' WHEN R.LE_SpillType = 3 THEN ''Major Spill (>1000 Ltr.)''
                          ELSE '''' END AS LE_SpillType, dbo.ER_S115_getOptionTextCSV(''S115'', 8, R.LE_Category, '','') AS LE_Category, R.LE_Category_Other, 
                         R.Incident_First_Obseved_Date, R.Ceased_Operation_Date, 
                         CASE WHEN R.Reported_To_Authority = ''N'' THEN ''No'' WHEN R.Reported_To_Authority = ''Y'' THEN ''Yes'' ELSE '''' END AS Reported_To_Authority, R.ReportingDate, 
                         R.AuthorityName, dbo.ER_S115_getOptionTextCSV(''S115'', 9, R.Mooring, '','') AS Mooring, 
                         CASE WHEN R.Is_Equip_Affected = ''N'' THEN ''No'' WHEN R.Is_Equip_Affected = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_Equip_Affected, 
                         dbo.ER_S115_getOptionTextCSV(''S115'', 10, R.Equipments, '','') AS Equipments, 
                         CASE WHEN R.Is_DamageToThirdParty = ''N'' THEN ''No'' WHEN R.Is_DamageToThirdParty = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_DamageToThirdParty, 
                         dbo.ER_S115_getOptionTextCSV(''S115'', 18, R.DamageToThirdParty, '','') AS DamageToThirdParty, R.DamageToThirdParty_Other, 
                         CASE WHEN R.Is_DamageToOwnVessel = ''N'' THEN ''No'' WHEN R.Is_DamageToOwnVessel = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_DamageToOwnVessel, 
                         dbo.ER_S115_getOptionTextCSV(''S115'', 19, R.DamageToOwnVessel, '','') AS DamageToOwnVessel, R.DamageToOwnVessel_Other, 
                         CASE WHEN R.Is_Explosion = ''N'' THEN ''No'' WHEN R.Is_Explosion = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_Explosion, dbo.ER_S115_getOptionTextCSV(''S115'', 11, 
                         R.ExplosionOn, '','') AS ExplosionOn, R.ExplosionOn_Other, dbo.ER_S115_getOptionTextCSV(''S115'', 12, R.Security, '','') AS Security, R.Security_Other, 
                         dbo.ER_S115_getOptionTextCSV(''S115'', 13, R.CA_HumanActions, '','') AS CA_HumanActions, R.CA_HumanActions_Other, dbo.ER_S115_getOptionTextCSV(''S115'', 14, 
                         R.CA_Conditions, '','') AS CA_Conditions, R.CA_Conditions_Other, dbo.ER_S115_getOptionTextCSV(''S115'', 15, R.RC_HumanFactors, '','') AS RC_HumanFactors, 
                         R.RC_HumanFactors_Other, dbo.ER_S115_getOptionTextCSV(''S115'', 16, R.RC_JobFactors, '','') AS RC_JobFactors, R.RC_JobFactors_Other, 
                         CASE WHEN R.Is_ImmadiateActionTaken = ''N'' THEN ''No'' WHEN R.Is_ImmadiateActionTaken = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_ImmadiateActionTaken, 
                         R.IA_Yes_Desc, 
                         CASE WHEN R.Is_Action_Recommended = ''N'' THEN ''No'' WHEN R.Is_Action_Recommended = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_Action_Recommended, 
                         R.AR_Yes_Desc, CASE WHEN R.Is_ImmediateTraining = ''N'' THEN ''No'' WHEN R.Is_ImmediateTraining = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_ImmediateTraining, 
                         R.IT_Details, CASE WHEN R.Is_FurtherTrainingReq = ''N'' THEN ''No'' WHEN R.Is_FurtherTrainingReq = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_FurtherTrainingReq, 
                         R.FT_Details, CASE WHEN R.Is_SafetyMeeting = ''N'' THEN ''No'' WHEN R.Is_SafetyMeeting = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_SafetyMeeting, R.SM_Date, 
                         CASE WHEN R.Is_SupplementaryInfo = ''N'' THEN ''No'' WHEN R.Is_SupplementaryInfo = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_SupplementaryInfo, R.SI_Details, 
                         R.CreatedBy, R.CreatedOn, R.ExportedBy, R.ExportedOn, 
                         CASE WHEN O.Is_Vessel_Delayed = ''N'' THEN ''No'' WHEN O.Is_Vessel_Delayed = ''Y'' THEN ''Yes'' ELSE '''' END AS O_Is_Vessel_Delayed, O.VesselDelayed_Days, 
                         O.VesselDelayed_Hours, 
                         CASE WHEN O.Potential_Recurrence = 1 THEN ''Very High/ Daily'' WHEN O.Potential_Recurrence = 2 THEN ''High/ Once per Month'' WHEN O.Potential_Recurrence
                          = 3 THEN ''Medium/ Twice per Year'' WHEN O.Potential_Recurrence = 4 THEN ''Low/ Once per Year'' WHEN O.Potential_Recurrence = 5 THEN
                          ''None/ No past reports'' ELSE '''' END AS O_Potential_Recurrence, 
                         CASE WHEN O.Is_InvestigationDone = ''N'' THEN ''No'' WHEN O.Is_InvestigationDone = ''Y'' THEN ''Yes'' ELSE '''' END AS O_Is_InvestigationDone, O.InvestigationDate, 
                         O.NameOfPerson_Org, dbo.ER_S115_getOptionTextCSV(''S115'', 13, O.O_HumanActions, '','') AS O_HumanActions, O.O_HumanActions_Other, 
                         dbo.ER_S115_getOptionTextCSV(''S115'', 14, O.O_Conditions, '','') AS O_Conditions, O.O_Conditions_Other, dbo.ER_S115_getOptionTextCSV(''S115'', 15, 
                         O.O_HumanFactors, '','') AS O_HumanFactors, O.O_HumanFactors_Other, dbo.ER_S115_getOptionTextCSV(''S115'', 16, O.O_JobFactors, '','') AS O_JobFactors, 
                         O.O_JobFactors_Other, CASE WHEN O.Is_FollowUPReq = ''N'' THEN ''No'' WHEN O.Is_FollowUPReq = ''Y'' THEN ''Yes'' ELSE '''' END AS O_Is_FollowUPReq, 
                         O.TargetDate, O.FU_Details, O.FU_PIC, 
                         CASE WHEN O.Suggestions = ''1'' THEN ''People'' WHEN O.Suggestions = ''2'' THEN ''Process'' WHEN O.Suggestions = ''3'' THEN ''Equipment'' WHEN O.Suggestions = ''1,2''
                          THEN ''People, Process'' WHEN O.Suggestions = ''1,3'' THEN ''People, Equipment'' WHEN O.Suggestions = ''2,3'' THEN ''Process, Equipment'' WHEN O.Suggestions = ''1,2,3''
                          THEN ''People, Process, Equipment'' ELSE '''' END AS O_Suggestions, O.Remarks, 
                         CASE WHEN O.Is_Closed = ''N'' THEN ''No'' WHEN O.Is_Closed = ''Y'' THEN ''Yes'' ELSE '''' END AS O_Is_Closed, O.CloseDate, O.ClosedBy, 
                         CASE WHEN O.Is_Closure_Notified = ''N'' THEN ''No'' WHEN O.Is_Closure_Notified = ''Y'' THEN ''Yes'' ELSE '''' END AS O_Is_Closure_Notified, O.NotifyDate, O.Locked, 
                         O.Status
FROM            dbo.ER_S115_Report AS R LEFT OUTER JOIN dbo.ER_S115_Report_Office AS O ON R.ReportId = O.ReportId AND  R.VESSELCODE = O.VESSELCODE



' 
GO
/****** Object:  View [dbo].[vw_ER_S115_PrintReport_InjuryToPerson]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_ER_S115_PrintReport_InjuryToPerson]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[vw_ER_S115_PrintReport_InjuryToPerson]
AS
SELECT  ReportId, VesselCode, CASE WHEN Is_Crew = ''Y'' THEN ''Crew'' WHEN Is_Crew = ''N'' THEN ''Contractor'' ELSE '''' END AS Is_Crew, IP_CrewNo, IP_Name, IP_DOB, 
                         IP_Nationality_IDNo,
                             (SELECT        RankCode
                               FROM            dbo.MP_AllRank AS AR
                               WHERE        (RankId = dbo.ER_S115_InjuryToPerson.IP_Rank_Rating)) AS [Rank], IP_SignedOnDate, IP_NoOfHrOnBoard, 
                         CASE WHEN IP_Is_VisitToDoctor_Necessary = ''N'' THEN ''No'' WHEN IP_Is_VisitToDoctor_Necessary = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_VisitToDoctor_Necessary, 
                         CASE WHEN IP_ACTIVITY_OD = ''N'' THEN ''Off Duty'' WHEN IP_ACTIVITY_OD = ''Y'' THEN ''On Duty'' ELSE '''' END AS Is_OD, IP_ActivityHours, 
                         CASE WHEN IP_RestrictedWork = ''N'' THEN ''No'' WHEN IP_RestrictedWork = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_RestrictedWork, 
                         CASE WHEN IP_MedicalTreatmentReqd = ''N'' THEN ''No'' WHEN IP_MedicalTreatmentReqd = ''Y'' THEN ''Yes'' ELSE '''' END AS Is_MedicalTreatmentReqd, 
                         dbo.ER_S115_getOptionTextCSV(''S115'', 3, IP_AreaOfOperation, '','') AS AreaOfOperation, IP_AreaOfOperation_Other, dbo.ER_S115_getOptionTextCSV(''S115'', 17, 
                         IP_TypeOfInjury, '','') AS AccidentType, IP_TypeOfInjury_Other, dbo.ER_S115_getOptionTextCSV(''S115'', 4, OCI_MI_Reporting, '','') AS InjuryType, Status
FROM            dbo.ER_S115_InjuryToPerson

' 
GO
/****** Object:  View [dbo].[vw_ER_S133_PrintReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_ER_S133_PrintReport]'))
EXEC dbo.sp_executesql @statement = N'


CREATE VIEW [dbo].[vw_ER_S133_PrintReport]
AS
SELECT        (SELECT        VersionNo
                          FROM            dbo.ER_Master
                          WHERE        (FormNo = ''S133'')) AS VersionNo,
                             (SELECT        ShipName
                               FROM            dbo.Settings
                               WHERE        (ShipCode = R.VesselCode)) AS VesselName, R.ReportId, R.ReportNo, R.VesselCode, R.ReportDate, R.DateOfOccurence, R.FamilyName, R.FirstName,
                             (SELECT        RankCode
                               FROM            dbo.MP_AllRank
                               WHERE        (RankId = R.RankId)) AS Rank, R.CrewNo, dbo.ER_S115_getOptionTextCSV(''S133'', 20, R.Category, '','') AS Category, R.EventDescr, R.Suggestions, 
                         R.SM_FamilyName, R.SM_FirstName, R.SM_CrewNo, O.CreatedBy, O.CreatedOn, R.ExportedBy, R.ExportedOn, R.Updated, R.UpdatedOn, O.Remarks, O.Is_Closed, 
                         O.CloseDate, O.ClosedBy, O.Is_Closure_Notified, O.NotifyDate, O.Status, O.Locked , (CASE WHEN O.NMSeverity=''S'' THEN ''Significant'' ELSE '''' END) AS NMSeverity ,
						 dbo.ER_S115_getOptionTextCSV(''S115'', 13, O.CA_HumanActions, '','') AS CA_HumanActions,
						 CA_HumanActions_Other,
						 dbo.ER_S115_getOptionTextCSV(''S115'', 14, O.CA_Conditions, '','') AS CA_Conditions,
						 CA_Conditions_Other,
						 dbo.ER_S115_getOptionTextCSV(''S115'', 15, O.RC_HumanFactors, '','') AS RC_HumanFactors,
						 RC_HumanFactors_Other,
						 dbo.ER_S115_getOptionTextCSV(''S115'', 16, O.RC_JobFactors, '','') AS RC_JobFactors,
						 RC_JobFactors_Other

FROM            dbo.ER_S133_Report AS R LEFT OUTER JOIN
                         dbo.ER_S133_Report_Office AS O ON R.ReportId = O.ReportId AND R.VesselCode = O.VesselCode



' 
GO
/****** Object:  View [dbo].[vw_GetCostCategoryReportData]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetCostCategoryReportData]'))
EXEC dbo.sp_executesql @statement = N'



CREATE VIEW [dbo].[vw_GetCostCategoryReportData]
as 

SELECT D.[DocketNo],('' [ '' + V.VesselCode + '' ] '' + V.VesselName) AS Vessel,YM.YardName,YM.PortName,J.[CatCode],J.[CatName],J.[JobCode], J.[JobName], SJ.[RFQId],SJ.[DocketSubJobId],SJ.[DocketJobId],SJ.[DocketId],[SubJobCode],[SubJobName],[EstQty],[EstDiscPer],[EstUnitPrice],[EstAmount_USD],[Remarks], CostCategory
FROM [dbo].[DD_Docket_RFQ_SubJobs] SJ
INNER JOIN  [dbo].[DD_Docket_RFQ_Jobs] J On SJ.[RFQId]= J.[RFQId] AND SJ.[DocketJobId]=J.[DocketJobId] AND SJ.[DocketId]=J.[DocketId]
INNER JOIN [dbo].[DD_DocketMaster] D ON J.[DocketId]= D.[DocketId]
INNER JOIN [dbo].[DD_Docket_RFQ_Master] RM ON SJ.[RFQId]= RM.[RFQId] AND SJ.[DocketId]=RM.[DocketId]
INNER JOIN [dbo].[DD_YardMaster] YM ON RM.YardId = YM.YardId
INNER JOIN dbo.Vessel V ON D.VesselId = V.VesselId


' 
GO
/****** Object:  View [dbo].[vw_GetJobComplitationReport]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetJobComplitationReport]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[vw_GetJobComplitationReport]
AS
SELECT VCJM.VesselCode,(SELECT ShipName FROM Settings WHERE ShipCode = VCJM.VesselCode) AS VesselName,CM.ComponentId,CM.ComponentCode,CM.ComponentName ,JM.JobCode,
JM.JobName AS JobType,CJM.DescrSh AS JobName,VCJM.CompJobId,JIM.IntervalName ,RM.RankCode,
VCJM.Interval,replace(convert(varchar(15),VCJMU.NextDueDate,106),'' '',''-'') As NextDueDate,CASE WHEN VCJMU.NextDueDate > getdate() THEN ''DUE'' ELSE ''OVER DUE'' END AS DueStatus ,'''' AS WorkOrderStatus,VCJMU.NextHour,REPLACE(CONVERT(VARCHAR(15),VCJMU.LastDone,106),'' '',''-'') AS LastDone,VCJMU.LastHour,'''' AS Difference,'''' AS DiffHour,0 AS PlannedRank,'''' AS PlanDate,RM.RankCode AS Rank,Row_Number() OVER(ORDER BY CM.ComponentCode) AS RowNumber, CASE CM.ClassEquip WHEN ''true'' THEN ''Class Equipment - '' + VCM.ClassEquipCode ELSE '''' END AS ClassEquip,CASE CM.CriticalEquip WHEN ''true'' THEN ''Critical Equipment'' ELSE '''' END AS CriticalEquip 
,VJH.DoneDate,VJH.DoneHour,VJH.DoneBy_Code + '' - '' + VJH.DoneBy_Name AS DoneBy,VJH.ServiceReport

FROM VSL_VesselComponentJobMaster VCJM  INNER JOIN Rank RM ON RM.RankId = VCJM.AssignTo INNER JOIN VSL_VesselComponentJobMaster_Updates VCJMU ON VCJM.VesselCode = VCJMU.VesselCode AND VCJM.ComponentId = VCJMU.ComponentId AND VCJM.CompJobId = VCJMU.CompJobId INNER JOIN  (  ComponentsJobMapping CJM  INNER JOIN JobMaster JM  ON JM.JobId = CJM.JobId  INNER JOIN ComponentMaster CM ON CM.ComponentId = CJM.ComponentId  INNER JOIN VSL_ComponentMasterForVessel VCM ON VCM.ComponentId = CM.ComponentId AND VCM.Status = ''A'' )ON  VCJM.ComponentId = CJM.ComponentId AND VCJM.CompJobId = CJM.CompJobId AND VCJM.Status = ''A'' AND VCM.VesselCode = VCJM.VesselCode  INNER JOIN JobIntervalMaster JIM ON JIM.IntervalId = VCJM.IntervalId  INNER JOIN VSL_VesselJobUpdateHistory VJH ON VJH.VesselCode = VCJM.VesselCode AND VJH.ComponentId = VCJM.ComponentId AND VJH.CompJobId = VCJM.CompJobId  

WHERE VJH.[Action] = ''R'' AND (VJH.DoneDate BETWEEN DATEADD(dd,-30,getdate()) AND getdate())        
' 
GO
/****** Object:  View [dbo].[vw_GetJobPlanningForRPT]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetJobPlanningForRPT]'))
EXEC dbo.sp_executesql @statement = N'
/*-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
CREATE VIEW [dbo].[vw_GetJobPlanningForRPT]
AS
SELECT     VCJM.VesselCode,
                          (SELECT     ShipName
                            FROM          dbo.Settings
                            WHERE      (ShipCode = VCJM.VesselCode)) AS VesselName, CM.ComponentId, CM.ComponentCode, CM.ComponentName,CM.CriticalType,JM.JobName AS JobType, 
                      CASE WHEN LEN(CJM.DescrSh) > 15 THEN Substring(CJM.DescrSh, 0, 15) + ''...'' ELSE CJM.DescrSh END AS JobName, VCJM.CompJobId, JIM.IntervalName, 
                      RM.RankCode, VCJM.Interval, VCJMU.NextDueDate AS NextDueDate, CASE WHEN VCJMU.NextDueDate > getdate() 
                      THEN ''DUE'' ELSE ''OVER DUE'' END AS DueStatus, 
                      CASE PM.Status WHEN 1 THEN ''Issued'' WHEN 2 THEN ''Completed'' WHEN 3 THEN ''Postponed'' WHEN 4 THEN ''Cancelled'' ELSE '''' END AS WorkOrderStatus, 
                      VCJMU.NextHour, VCJMU.LastDone AS LastDone, VCJMU.LastHour, CASE REPLACE(CONVERT(VARCHAR(11), 
                      ISNULL(PM.LastDueDate, ''''), 106), '' '', ''-'') WHEN ''01-Jan-1900'' THEN '''' ELSE DATEDiff(dd, PM.DoneDate, PM.LastDueDate) END AS Difference, 
                      CASE PM.Status WHEN 4 THEN 0 ELSE ISNULL(PM.AssignedTo, 0) END AS PlannedRank, CASE PM.Status WHEN 1 THEN CASE REPLACE(CONVERT(VARCHAR(11), 
                      ISNULL(PM.PlanDate, ''''), 106), '' '', ''-'') WHEN ''01-Jan-1900'' THEN '''' ELSE REPLACE(CONVERT(VARCHAR(11), ISNULL(PM.PlanDate, ''''), 106), '' '', ''-'') 
                      END WHEN 2 THEN CASE REPLACE(CONVERT(VARCHAR(11), ISNULL(PM.DoneDate, ''''), 106), '' '', ''-'') 
                      WHEN ''01-Jan-1900'' THEN '''' ELSE REPLACE(CONVERT(VARCHAR(11), ISNULL(PM.DoneDate, ''''), 106), '' '', ''-'') 
                      END WHEN 3 THEN CASE REPLACE(CONVERT(VARCHAR(11), ISNULL(PM.PostPoneDate, ''''), 106), '' '', ''-'') 
                      WHEN ''01-Jan-1900'' THEN '''' ELSE REPLACE(CONVERT(VARCHAR(11), ISNULL(PM.PostPoneDate, ''''), 106), '' '', ''-'') END ELSE '''' END AS PlanDate, 
                      CASE ISNULL(PM.Status, 0) WHEN 4 THEN '''' WHEN 0 THEN '''' ELSE ISNULL(RM.RankCode, '''') END AS Rank, CM.ClassEquip, CM.CriticalEquip
						
FROM         dbo.VSL_VesselComponentJobMaster AS VCJM INNER JOIN
                      dbo.VSL_VesselComponentJobMaster_Updates AS VCJMU ON VCJM.VesselCode = VCJMU.VesselCode AND VCJM.ComponentId = VCJMU.ComponentId AND 
                      VCJM.CompJobId = VCJMU.CompJobId INNER JOIN
                      dbo.Rank AS RM ON RM.RankId = VCJM.AssignTo INNER JOIN
                      dbo.ComponentsJobMapping AS CJM INNER JOIN
                      dbo.JobMaster AS JM ON JM.JobId = CJM.JobId INNER JOIN
                      dbo.ComponentMaster AS CM ON CM.ComponentId = CJM.ComponentId INNER JOIN
                      dbo.VSL_ComponentMasterForVessel AS VCM ON VCM.ComponentId = CM.ComponentId AND VCM.Status = ''A'' ON VCJM.ComponentId = CJM.ComponentId AND 
                      VCJM.CompJobId = CJM.CompJobId AND VCJM.Status = ''A'' AND VCM.VesselCode = VCJM.VesselCode INNER JOIN
                      dbo.JobIntervalMaster AS JIM ON JIM.IntervalId = VCJM.IntervalId LEFT OUTER JOIN
                      dbo.VSL_PlanMaster AS PM ON PM.VesselCode = VCJM.VesselCode AND PM.ComponentId = VCJM.ComponentId AND PM.CompJobId = VCJM.CompJobId
' 
GO
/****** Object:  View [dbo].[vw_GetJobPlanningHomerpt]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetJobPlanningHomerpt]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[vw_GetJobPlanningHomerpt]
AS
SELECT     VesselCode, CompJobId, ComponentId, jobId, Status, AssignedTo, PlanDate, LastDueDate, LastDueHours, NextDueDate, NextDueHours, LastRunningHourDate, 
                      LastRunningHour, DoneBy, DoneBy_Code, DoneBy_Name, DoneDate, DoneHour, ServiceReport, ConditionBefore, ConditionAfter, UpdateRemarks, Specify, FileName, 
                      FileImage, ModifiedBy, ModifiedOn, PostPoneReason, PostPoneRemarks, P_DoneBy, P_DoneBy_Code, P_DoneBy_Name, PostPoneDate, CancellationReason, 
                      CancellationDate, C_DoneBy, C_DoneBy_Code, C_DoneBy_Name, Updated, UpdatedOn
FROM         dbo.VSL_PlanMaster
' 
GO
/****** Object:  View [dbo].[vw_GetJobUpdateDataByPeriod]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetJobUpdateDataByPeriod]'))
EXEC dbo.sp_executesql @statement = N'


/* SELECT * FROM [vw_GetJobUpdateDataByPeriod]
SELECT * FROM VSL_VesselComponentJobMaster*/
CREATE VIEW [dbo].[vw_GetJobUpdateDataByPeriod]
AS
SELECT     dbo.VSL_VesselJobUpdateHistory.VesselCode, dbo.VSL_VesselJobUpdateHistory.HistoryId, dbo.VSL_VesselJobUpdateHistory.PlanDate, 
          dbo.VSL_VesselJobUpdateHistory.DoneDate, dbo.VSL_VesselJobUpdateHistory.DoneHour, dbo.ComponentMaster.ComponentCode, 
          dbo.ComponentMaster.ComponentName, dbo.JobMaster.JobCode, dbo.Rank.RankCode, dbo.ComponentsJobMapping.DescrSh, 
          dbo.JobIntervalMaster.IntervalName, dbo.VSL_VesselComponentJobMaster.Interval, dbo.VSL_VesselJobUpdateHistory.DoneBy_Code, 
          dbo.VSL_VesselJobUpdateHistory.DoneBy_Name,
          CASE dbo.VSL_VesselJobUpdateHistory.Action WHEN ''P'' THEN ''Postponed'' WHEN ''R'' THEN ''Report'' ELSE '''' END AS [Action], 
          CASE WHEN dbo.VSL_VesselJobUpdateHistory.[ACTION] = ''P'' THEN ''Job Postponed '' ELSE CASE WHEN updateremarks = 1 THEN ''Planned Job'' WHEN updateremarks
           = 2 THEN Specify WHEN updateremarks = 2 THEN ''Break Down'' ELSE '''' END END AS MaintainanceReason, 
          CASE WHEN dbo.VSL_VesselJobUpdateHistory.[ACTION] = ''P'' THEN POSTPONEREMARKS ELSE dbo.VSL_VesselJobUpdateHistory.ServiceReport END AS ServiceReport,
           dbo.VSL_VesselJobUpdateHistory.ConditionBefore, dbo.VSL_VesselJobUpdateHistory.ConditionAfter, dbo.VSL_VesselJobUpdateHistory.VerifiedBy, 
          dbo.VSL_VesselJobUpdateHistory.VerifiedOn, ISNULL(dbo.VSL_VesselJobUpdateHistory.Verified, 0) AS Verified, dbo.VSL_ComponentMasterForVessel.ClassEquip, 
          dbo.ComponentMaster.CriticalEquip,dbo.VSL_VesselJobUpdateHistory.PostPoneDate,ComponentMaster.CriticalType,dbo.VSL_VesselJobUpdateHistory.LastDueDate,isnull(VJUHOC.VERIFIED,0) AS VERIFIED_OFF,VJUHOC.VERIFIEDBY AS VERIFIEDBY_OFF,VJUHOC.VERIFIEDON AS VERIFIEDON_OFF,VJUHOC.COMMENTS,ClassEquipCode
			 
		FROM  dbo.VSL_VesselJobUpdateHistory 
		LEFT OUTER JOIN dbo.VSL_VesselJobUpdateHistory_OfficeComments AS VJUHOC ON VJUHOC.VesselCode = dbo.VSL_VesselJobUpdateHistory.VesselCode AND 
		VJUHOC.HistoryId = dbo.VSL_VesselJobUpdateHistory.HistoryId 
		INNER JOIN dbo.ComponentMaster ON dbo.VSL_VesselJobUpdateHistory.ComponentId = dbo.ComponentMaster.ComponentId 
		INNER JOIN dbo.JobMaster ON dbo.VSL_VesselJobUpdateHistory.jobId = dbo.JobMaster.JobId 
		LEFT OUTER JOIN dbo.Rank ON dbo.Rank.RankId = dbo.VSL_VesselJobUpdateHistory.AssignedTo 
		INNER JOIN dbo.ComponentsJobMapping ON dbo.VSL_VesselJobUpdateHistory.CompJobId = dbo.ComponentsJobMapping.CompJobId 
		INNER JOIN dbo.VSL_VesselComponentJobMaster ON dbo.VSL_VesselJobUpdateHistory.VesselCode = dbo.VSL_VesselComponentJobMaster.VesselCode AND 
		dbo.VSL_VesselComponentJobMaster.CompJobId = dbo.ComponentsJobMapping.CompJobId AND VSL_VesselComponentJobMaster.Status = ''A'' 
		INNER JOIN dbo.JobIntervalMaster ON dbo.VSL_VesselComponentJobMaster.IntervalId = dbo.JobIntervalMaster.IntervalId 
		INNER JOIN dbo.VSL_ComponentMasterForVessel ON dbo.VSL_ComponentMasterForVessel.VesselCode = dbo.VSL_VesselJobUpdateHistory.VesselCode AND 
		dbo.VSL_ComponentMasterForVessel.ComponentId = dbo.VSL_VesselJobUpdateHistory.ComponentId AND VSL_ComponentMasterForVessel.Status = ''A''


' 
GO
/****** Object:  View [dbo].[vw_GetRanningHourRPT]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetRanningHourRPT]'))
EXEC dbo.sp_executesql @statement = N'
/*-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
CREATE VIEW [dbo].[vw_GetRanningHourRPT]
AS
SELECT     ''ALC'' AS VesselName, ComponentId, ComponentCode, ComponentName,
                          (SELECT     TOP (1) REPLACE(CONVERT(varchar(15), ISNULL(StartDate, ''''), 106), '' '', ''-'') AS StartDate
                            FROM          dbo.VSL_VesselRunningHourMaster AS VRH
                            WHERE      (VesselCode = ''ALC'')
                            ORDER BY UpdatedOn DESC) AS StartDate,
                          (SELECT     TOP (1) StartupHour
                            FROM          dbo.VSL_VesselRunningHourMaster AS VRH
                            WHERE      (VesselCode = ''ALC'')
                            ORDER BY UpdatedOn DESC) AS StartupHour,
                          (SELECT     TOP (1) AvgRunningHrPerDay
                            FROM          dbo.VSL_VesselRunningHourMaster AS VRH
                            WHERE      (VesselCode = ''ALC'')
                            ORDER BY UpdatedOn DESC) AS AvgRunningHrPerDay,
                          (SELECT     UserName
                            FROM          dbo.ShipUserMaster
                            WHERE      (UserId IN
                                                       (SELECT     TOP (1) UpdatedBy
                                                         FROM          dbo.VSL_VesselRunningHourMaster AS VRH
                                                         WHERE      (VesselCode = ''ALC'')
                                                         ORDER BY UpdatedOn DESC))) AS UpdatedBy,
                          (SELECT     TOP (1) REPLACE(CONVERT(varchar(15), ISNULL(UpdatedOn, ''''), 106), '' '', ''-'') AS Expr1
                            FROM          dbo.VSL_VesselRunningHourMaster AS VRH
                            WHERE      (VesselCode = ''ALC'')
                            ORDER BY UpdatedOn DESC) AS UpdatedOn
FROM         dbo.ComponentMaster AS CM
WHERE     (ComponentId IN
                          (SELECT DISTINCT ComponentId
                            FROM          dbo.VSL_VesselComponentJobMaster
                            WHERE      (IntervalId = 1) AND (VesselCode = ''ALC'')))

' 
GO
/****** Object:  View [dbo].[vw_GetRFQEditReportData]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetRFQEditReportData]'))
EXEC dbo.sp_executesql @statement = N'


CREATE VIEW [dbo].[vw_GetRFQEditReportData]
as 

SELECT D.[DocketNo],('' [ '' + V.VesselCode + '' ] '' + V.VesselName) AS Vessel,YM.YardName,YM.PortName,J.[CatCode],J.[CatName],J.[JobCode], J.[JobName],J.JobDesc, SJ.[RFQId],SJ.[DocketSubJobId],SJ.[DocketJobId],SJ.[DocketId],[SubJobCode],[SubJobName],Unit,BidQty,[QuoteQty],[UnitPrice],[DiscountPer],[NetAmount],VendorRemarks, CostCategory 
FROM [dbo].[DD_Docket_RFQ_SubJobs] SJ
INNER JOIN DD_Docket_RFQ_Jobs J  On SJ.[RFQId]= J.[RFQId] AND SJ.[DocketJobId]=J.[DocketJobId] AND SJ.[DocketId]=J.[DocketId]
INNER JOIN [dbo].[DD_DocketMaster] D ON J.[DocketId]= D.[DocketId]
INNER JOIN [dbo].[DD_Docket_RFQ_Master] RM ON SJ.[RFQId]= RM.[RFQId] AND SJ.[DocketId]=RM.[DocketId]
INNER JOIN [dbo].[DD_YardMaster] YM ON RM.YardId = YM.YardId
INNER JOIN dbo.Vessel V ON D.VesselId = V.VesselId

' 
GO
/****** Object:  View [dbo].[vw_GetSCM_Master]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetSCM_Master]'))
EXEC dbo.sp_executesql @statement = N'


CREATE View [dbo].[vw_GetSCM_Master]
as
SELECT SCMId
      ,VesselCode
	  ,upper(VesselCode +''-''+right( Replace(convert(varchar,SDate ,106),'' '',''-''),8))SCMNo
	  ,(Select ShipName from dbo.Settings V Where V.ShipCode=SM.VesselCode)VesselName
      ,'' : ''+replace(convert(varchar,SDate,106),'' '',''-'')SDate
      ,ShipPosFrom
      ,ShipPosTo
      ,'' : ''+Convert(varchar,CommTime)CommTime
      ,'' : ''+Convert(varchar,CompTime)CompTime
      ,(Case Ocassion When ''M'' Then '' : Monthly'' When ''N'' Then '' : Non-Routine'' else '' : SUPTD Visit'' end )Ocassion
      ,(Case ShipPosition When ''S'' Then '' : Sea'' else '' : In Port'' end)ShipPosition 
	  ,(Case ShipPosition When ''S'' Then ''Voy From/To '' else ''Port/Anchorage '' end)ShipPositionLable 
	  ,(Case ShipPosition When ''S'' Then '' : ''+ShipPosFrom+'' To ''+ShipPosTo Else '' : ''+ShipPosFrom  end )ShipFromTo
      ,(Case Str_MinOfPrevSaFeCom when 1 then ''Yes'' else ''No'' end) Str_MinOfPrevSaFeCom
      ,(Case Str_AbsPrevSageCom when 1 then ''Yes'' else ''No'' end) Str_AbsPrevSageCom

      ,NAME_OTHER
      ,(Case Str_OffCommPrevSafeCom when 1 then ''Yes'' else ''No'' end) Str_OffCommPrevSafeCom
	  ,	(Case Rtrim(ltrim(OUTSTANDINGITEMS)) when '''' then ''No'' else ''Yes'' end) OUTSTANDINGITEMSYesNo
	  ,OUTSTANDINGITEMS
	
	  ,( Convert(varchar,Year(SDate),106)+ '' List Of Circulars And Alerts '')Sef_Heading

	  ,(Case Rtrim(ltrim(Sef_AvailableOnBoard)) when '''' then ''Yes'' else ''No'' end)Sef_AvailableOnBoardYesNo
      ,Sef_AvailableOnBoard
      ,Sef_AccidentNarMiss
      ,Sef_ReviewOfMooring
	  ,(Case Rtrim(ltrim(Sef_CrewNotFamilierWithAll)) when '''' then ''Yes'' else ''No'' end)Sef_CrewNotFamilierWithAllYesNo
      ,Sef_CrewNotFamilierWithAll
      ,Sef_BestPractice
      ,Hel_ReviewHelth
      ,Hel_BestPractice
      ,Sec_ReviewAnyImmediateSecurity
      ,Sec_BestPractices
      ,Qul_ReviewOfRegulatory
      ,Qul_ReviewOfQuality
      ,Qul_KPI
      ,Qul_CrewWelfare
      ,Qul_BestPractices
      ,Env_EnvironmentalKPIs
      ,Env_BestPractices
      ,AnyOtherIssues
      ,RANK_OTHER      
      ,ReceviedOn
      ,OfficeComments
      ,UpdatedBy
      ,Replace(convert(varchar,UpdatedOn,106),'' '',''-'')UpdatedOn
	  --,(Select Top 1 SafetyNumber from SCM_SAFETY S Where S.SCMID=SM.SCMID and Left(Safetynumber,2)=''SA'' order by Safetynumber Desc)SafetyNumber
	  , '''' AS SafetyNumber
	  --,(Select Top 1 CircularNumber from CreateCircular CC inner Join SCM_Safety SS on CC.CircularNumber=SS.SafetyNumber where Left(Right(CircularNumber,8),4)=Year(SDate) order by CID desc)CircularNumber
	  ,'''' AS CircularNumber
	  ,SUPTD_CompliancewithRegulations
	  ,SUPTD_DeviationsfromSafety
	  ,SUPTD_DetailsofTraining
	  ,SUPTD_HealthSafetyMeasures
	  ,SUPTD_Suggestions
	  ,SUPTD_AnyOtherTopic
	  ,ReportsPK 
	  ,BestPractice

  FROM dbo.SCM_MASTER SM


' 
GO
/****** Object:  View [dbo].[vw_GetShipMasterJobsRPT]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetShipMasterJobsRPT]'))
EXEC dbo.sp_executesql @statement = N'
/*ORDER BY JobCode,CompCode
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
CREATE VIEW [dbo].[vw_GetShipMasterJobsRPT]
AS
SELECT     LTRIM(RTRIM(CM.ComponentCode)) AS CompCode, CM.ComponentName, CM.CriticalEquip AS IsCritical, DM.DeptName, RM.RankCode, JM.JobName AS JobCode, 
                      CJM.DescrSh AS JobName, CASE VCJM.IntervalId WHEN 1 THEN CASE VCJM.IntervalId_H WHEN 0 THEN JIM.IntervalName + ''-'' + CAST(VCJM.Interval AS VARCHAR) 
                      ELSE JIM.IntervalName + ''-'' + CAST(VCJM.Interval AS Varchar) + ''  OR  '' +
                          (SELECT     IntervalName
                            FROM          JobIntervalMaster
                            WHERE      IntervalId = VCJM.IntervalId_H) + ''-'' + CAST(VCJM.Interval_H AS VARCHAR) END ELSE JIM.IntervalName + ''-'' + CAST(VCJM.Interval AS VARCHAR) 
                      END AS Interval, JM.JobId, VCJM.ComponentId
FROM         dbo.VSL_VesselComponentJobMaster AS VCJM INNER JOIN
                      dbo.ComponentMaster AS CM ON CM.ComponentId = VCJM.ComponentId INNER JOIN
                      dbo.ComponentsJobMapping AS CJM ON CJM.ComponentId = VCJM.ComponentId AND CJM.CompJobId = VCJM.CompJobId INNER JOIN
                      dbo.JobMaster AS JM ON JM.JobId = CJM.JobId INNER JOIN
                      dbo.Rank AS RM ON RM.RankId = VCJM.AssignTo INNER JOIN
                      dbo.DeptMaster AS DM ON DM.DeptId = CJM.DeptId INNER JOIN
                      dbo.JobIntervalMaster AS JIM ON VCJM.IntervalId = JIM.IntervalId
WHERE     (VCJM.VesselCode = ''AME'') AND (CM.ComponentCode = ''102.06'')

' 
GO
/****** Object:  View [dbo].[vw_GetSJobDescOfficeRPT]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetSJobDescOfficeRPT]'))
EXEC dbo.sp_executesql @statement = N'Create view [dbo].[vw_GetSJobDescOfficeRPT]
as
SELECT jm.JobId, jm.JobName,cjm.CompJobId,cjm.DescrSh,isnull(cm.CriticalEquip,0) as IsCritical, jm.JobCode,JIM.IntervalName,DM.DeptName ,RM.RankCode  FROM ComponentsJobMapping cjm INNER Join  JobMaster jm ON jm.JobId = cjm.JobId INNER JOIN  ComponentMaster cm ON cm.ComponentId = cjm.ComponentId INNER JOIN  JobIntervalMaster JIM ON JIM.IntervalId = cjm.IntervalId INNER JOIN DeptMaster DM ON cjm.DeptId = DM.DeptId INNER JOIN Rank RM ON cjm.AssignTo  = RM.RankId  WHERE cm.ComponentCode =''102.06'' 


---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


' 
GO
/****** Object:  View [dbo].[vw_GetSpareDataRPT]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_GetSpareDataRPT]'))
EXEC dbo.sp_executesql @statement = N'
CREATE view [dbo].[vw_GetSpareDataRPT]
as
SELECT CM.ComponentCode,'''' as VesselName,CM.ComponentName,VSM.*,(Select LTRIM(RTRIM(ComponentCode)) + '' - '' + ComponentName from ComponentMaster WHERE LEN(ComponentCode)= (LEN(''102.06'')-3) AND  LEFT(ComponentCode,(LEN(''102.06'')-3)) = LEFT(''102.06'',(LEN(''102.06'')-3)))As LinkedTo,0 as ROB,'''' as CriticalType FROM VSL_VesselSpareMaster VSM INNER JOIN ComponentMaster CM ON VSM.ComponentId = CM.ComponentId 

' 
GO
/****** Object:  View [dbo].[vw_HullMonitoring]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_HullMonitoring]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[vw_HullMonitoring]
as
SELECT * FROM (
SELECT VCJM.VESSELCODE,VJUH.HISTORYID,CM.COMPONENTCODE,COMPONENTNAME,VCM.ClassEquipCode,CJM.DESCRSH,VJUH.DONEDATE,
CONVERT(VARCHAR,VCJM.INTERVAL) + '' '' + JIM.INTERVALNAME AS INTERVAL,
CASE VJUH.OVERALLRATING WHEN 1 THEN ''Good'' WHEN 2 THEN ''Fair'' WHEN 3 THEN ''Poor'' ELSE '''' END AS OVERALLRATING,
CASE VJUH.COATING WHEN 1 THEN ''Good'' WHEN 2 THEN ''Fair'' WHEN 3 THEN ''Poor'' ELSE '''' END AS COATING,
CASE VJUH.CORROSION WHEN 1 THEN ''None'' WHEN 2 THEN ''Light'' WHEN 3 THEN ''Medium'' WHEN 4 THEN ''Heavy'' ELSE '''' END AS CORROSION,
CASE VJUH.DEFORMATION WHEN 1 THEN ''None'' WHEN 2 THEN ''Minor'' WHEN 3 THEN ''Major'' ELSE '''' END AS DEFORMATION,
CASE VJUH.CRACKS WHEN 1 THEN ''None'' WHEN 2 THEN ''Visible'' ELSE '''' END AS CRACKS, 
(SELECT COUNT(*) FROM dbo.VSL_DefectDetailsMaster DDM WHERE DDM.VESSELCODE=VCJM.VESSELCODE AND DDM.HISTORYID=VJUH.HISTORYID) AS TOTAL_DEFECTS,
(SELECT COUNT(*) FROM dbo.VSL_DefectDetailsMaster DDM WHERE DDM.VESSELCODE=VCJM.VESSELCODE AND DDM.HISTORYID=VJUH.HISTORYID AND COMPLETIONDT IS NULL OR COMPLETIONDT=''01/01/1900'') AS OPEN_DEFECTS,
VJUH.SERVICEREPORT,RANK() OVER (PARTITION BY COMPONENTCODE ORDER BY HISTORYID desc ) AS RANK,CM.CriticalType
FROM
VSL_VesselComponentJobMaster VCJM
INNER JOIN dbo.ComponentsJobMapping CJM ON CJM.COMPJOBID=VCJM.COMPJOBID AND ISNULL(RATINGREQUIRED,0)=1
INNER JOIN dbo.VSL_ComponentMasterForVessel VCM ON VCJM.COMPONENTID = VCM.COMPONENTID AND VCJM.VESSELCODE = VCM.VESSELCODE
LEFT JOIN COMPONENTMASTER CM ON CM.COMPONENTID=VCJM.COMPONENTID
LEFT JOIN dbo.VSL_VesselJobUpdateHistory VJUH ON VJUH.VESSELCODE=VCJM.VESSELCODE AND VCJM.COMPONENTID=VJUH.COMPONENTID AND VCJM.COMPJOBID=VJUH.COMPJOBID
LEFT JOIN dbo.JobIntervalMaster JIM ON JIM.INTERVALID=VCJM.INTERVALID
) a WHERE RANK = 1
' 
GO
/****** Object:  View [dbo].[VW_MP_VSL_ProvisionDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_MP_VSL_ProvisionDetails]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[VW_MP_VSL_ProvisionDetails]
AS
SELECT        (SELECT        ParentCategoryId
                          FROM            dbo.MP_MainCategory
                          WHERE        (CategoryId =
                                                        (SELECT        CategoryId
                                                          FROM            dbo.MP_Products
                                                          WHERE        (ProductId = PD.ProductId)))) AS CategoryId,
                             (SELECT        CategoryName
                               FROM            dbo.MP_MainCategory AS MP_MainCategory_2
                               WHERE        (CategoryId =
                                                             (SELECT        ParentCategoryId
                                                               FROM            dbo.MP_MainCategory AS MP_MainCategory_1
                                                               WHERE        (CategoryId =
                                                                                             (SELECT        CategoryId
                                                                                               FROM            dbo.MP_Products AS MP_Products_1
                                                                                               WHERE        (ProductId = PD.ProductId)))))) AS CategoryName, PD.ProductId, P.ProductCode, P.ProductName, P.IMPACode, 
                         PD.ROBQty, PD.ReqQty AS ReqdQty, PD.ReqQty_Office, PD.OrderQtyPerUnit, PD.PackagingName, PD.UnitName, PD.VesselCode, PD.ProvisionId
FROM            dbo.MP_VSL_ProvisionDetails AS PD INNER JOIN
                         dbo.MP_Products AS P ON PD.ProductId = P.ProductId
' 
GO
/****** Object:  View [dbo].[VW_MP_VSL_ProvisionMaster]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_MP_VSL_ProvisionMaster]'))
EXEC dbo.sp_executesql @statement = N'
CREATE VIEW [dbo].[VW_MP_VSL_ProvisionMaster] AS
   
      SELECT [ProvisionId],[VesselCode],[Department],[AcctCode],[RequisitionNo],[PortOfSupply],[ETA],[Remarks],[UpdatedBy],[UpdatedOn],[Updated],[Status],[SentOn],[ReceivedOn]
	  FROM [dbo].[MP_VSL_ProvisionMaster]' 
GO
/****** Object:  View [dbo].[VW_MP_VSL_ProvisionNationalityWise]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_MP_VSL_ProvisionNationalityWise]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[VW_MP_VSL_ProvisionNationalityWise]
AS
SELECT        PN.NationalityId, N.NationalityName, PN.NoOfCrew, PN.NoOfDays, PN.VesselCode, PN.ProvisionId
FROM            dbo.MP_VSL_ProvisionNationalityWise AS PN INNER JOIN
                         dbo.MP_NationalityMaster AS N ON PN.NationalityId = N.NationalityId
' 
GO
/****** Object:  View [dbo].[VW_MP_VSL_ProvisionOtherItems]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_MP_VSL_ProvisionOtherItems]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[VW_MP_VSL_ProvisionOtherItems]
AS
SELECT        OI.OtherItemId, OI.ProductName, OI.Packaging, OI.ROBQty, OI.ReqQty, OI.UnitId, OI.ReqQty_Office, UM.UnitName, OI.VesselCode, OI.ProvisionId
FROM            dbo.MP_VSL_ProvisionOtherItems AS OI INNER JOIN
                         dbo.MP_UnitMaster AS UM ON OI.UnitId = UM.UnitId
' 
GO
/****** Object:  View [dbo].[VW_PRINT_RFQ]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_PRINT_RFQ]'))
EXEC dbo.sp_executesql @statement = N'

CREATE VIEW [dbo].[VW_PRINT_RFQ]
AS
SELECT MST.RFQID,YARDNAME,VESSELNAME,RFQNO,DocketSubJobId,JOBS.DocketJobId,CATID,CATCODE,CATNAME,JOBS.JOBCODE,JOBS.JOBNAME,JOBDESC,SUBJOBCODE,SUBJOBNAME,ATTACHMENTNAME,ISNULL(CostCategory,''N'') as CostCategory, CASE WHEN [OutsideRepair] = ''Y'' THEN ''Yes''  WHEN [OutsideRepair] = ''N'' THEN ''No'' ELSE '''' END AS OutsideRepair,UNIT,BIDQTY,QUOTEQTY,UnitPrice_USD,DISCOUNTPER,NetAmount_USD 
FROM [dbo].[DD_Docket_RFQ_Master] MST 
INNER JOIN [dbo].[DD_Docket_RFQ_Jobs] JOBS ON MST.RFQID=JOBS.RFQID
INNER JOIN [dbo].[DD_Docket_RFQ_SubJobs] SUBJOBS ON JOBS.RFQID=SUBJOBS.RFQID AND JOBS.DocketJobId=SUBJOBS.DocketJobId
INNER JOIN [dbo].[DD_DocketMaster] DOCKET ON DOCKET.DOCKETID=MST.DOCKETID
INNER JOIN [dbo].[DD_YardMaster] YM ON MST.YARDID=YM.YARDID
INNER JOIN DBO.VESSEL V ON V.VESSELID=DOCKET.VESSELID

' 
GO
/****** Object:  View [dbo].[VW_PRINT_RFQ_SUP]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_PRINT_RFQ_SUP]'))
EXEC dbo.sp_executesql @statement = N'

create VIEW [dbo].[VW_PRINT_RFQ_SUP]
AS
SELECT MST.RFQID,YARDNAME,VESSELNAME,RFQNO,DocketSubJobId,JOBS.DocketJobId,CATID,CATCODE,CATNAME,JOBS.JOBCODE,JOBS.JOBNAME,JOBDESC,SUBJOBCODE,SUBJOBNAME,ATTACHMENTNAME,
ISNULL(CostCategory,''N'') as CostCategory, CASE WHEN [OutsideRepair] = ''Y'' THEN ''Yes''  WHEN [OutsideRepair] = ''N'' THEN ''No'' ELSE '''' END AS OutsideRepair,
UNIT,BIDQTY,
SUPQty AS QUOTEQTY,SUPUnitPrice_USD AS UnitPrice_USD,SUPDiscountPer AS DISCOUNTPER,SUPNetAmount_USD AS NetAmount_USD 

FROM [dbo].[DD_Docket_RFQ_Master] MST 
INNER JOIN [dbo].[DD_Docket_RFQ_Jobs] JOBS ON MST.RFQID=JOBS.RFQID
INNER JOIN [dbo].[DD_Docket_RFQ_SubJobs] SUBJOBS ON JOBS.RFQID=SUBJOBS.RFQID AND JOBS.DocketJobId=SUBJOBS.DocketJobId
INNER JOIN [dbo].[DD_DocketMaster] DOCKET ON DOCKET.DOCKETID=MST.DOCKETID
INNER JOIN [dbo].[DD_YardMaster] YM ON MST.YARDID=YM.YARDID
INNER JOIN DBO.VESSEL V ON V.VESSELID=DOCKET.VESSELID


' 
GO
/****** Object:  View [dbo].[vw_PrintRunningHourHistory]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_PrintRunningHourHistory]'))
EXEC dbo.sp_executesql @statement = N'CREATE VIEW [dbo].[vw_PrintRunningHourHistory]
AS
SELECT     VRH.VesselCode, CM.ComponentCode, CM.ComponentName, VRH.StartupHour, VRH.AvgRunningHrPerDay, VRH.StartDate, SM.UserName, VRH.UpdatedOn
FROM         dbo.VSL_VesselRunningHourMaster AS VRH INNER JOIN
                      dbo.ComponentMaster AS CM ON CM.ComponentId = VRH.ComponentId INNER JOIN
                      dbo.ShipUserMaster AS SM ON SM.UserId = VRH.UpdatedBy

' 
GO
/****** Object:  View [dbo].[vw_SCM_RankDetails]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_SCM_RankDetails]'))
EXEC dbo.sp_executesql @statement = N'

CREATE View [dbo].[vw_SCM_RankDetails]  
as
Select * from SCM_RankDetails

' 
GO
/****** Object:  View [dbo].[vw_SMS_GetComments]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_SMS_GetComments]'))
EXEC dbo.sp_executesql @statement = N'








CREATE View [dbo].[vw_SMS_GetComments] as

	SELECT MODE,[Location],ManualId,[CommentId],[MVersion],[SVersion],SectionId,CommentBy,ManualName,Heading,[CommentText],[CommentOn], [PositionName], [PositionId], [OfficeName], [OfficeId], [StatusText], [Status], [StageText], [Stage], [ReqDate], [ChangeRequested], ClosureBy, ClosedOn, ClosureRemarks FROM 
( 
	SELECT ''O'' AS MODE,
	isnull(OfficeName,''Office'') as Location, s.ManualId,
	[CommentId],
	ManualName,S.[MVersion],MD.Heading,S.SECTIONID,S.[SVersion],
	[CommentText],
    U.firstname + '' '' + U.lastname as CommentBy, 
	[CommentOn],
	PositionName, S.PositionId,
	OfficeName, S.OfficeId,
	 CASE WHEN ISNULL(S.[Status],''O'') = ''O'' THEN ''Open'' WHEN ISNULL(S.[Status],''O'') = ''C'' THEN ''Closed'' ELSE '''' END AS [StatusText],ISNULL(S.[Status],''O'') AS Status,
	 CASE WHEN ISNULL([ChangeRequested],''N'') =''Y'' THEN 
		CASE WHEN ISNULL(S.[Stage],''P'') = ''A'' THEN ''Approved'' WHEN ISNULL(S.[Stage],''P'') = ''N'' THEN ''UnApproved'' WHEN ISNULL(S.[Stage],''P'') = ''P'' THEN ''Pending'' WHEN S.[Stage] = ''H'' THEN ''On Hold'' ELSE '''' END
	 ELSE ''NA'' END 	AS [StageText],ISNULL(S.[Stage],''P'') AS  [Stage],
	 [ReqDate], 
	 [ChangeRequested] 
	 ,U1.firstname + '' '' + U1.lastname as ClosureBy,ClosedOn,	ClosureRemarks
	FROM [dbo].[SMS_OfficeComments] S
	LEFT JOIN DBO.OFFICE O ON O.OFFICEID=S.OFFICEID 
    LEFT JOIN DBO.POSITION P ON P.POSITIONID=S.POSITIONID 
	LEFT JOIN DBO.USERLOGIN U ON U.LOGINID=S.COMMENTBY 
	LEFT JOIN DBO.USERLOGIN U1 ON U1.LOGINID=S.ClosedBy

    INNER JOIN [dbo].SMS_APP_ManualMaster MM ON MM.MANUALID=S.MANUALID   
	INNER JOIN [dbo].SMS_APP_ManualDetails MD ON MD.MANUALID=S.MANUALID AND MD.SectionId=S.SectionId

	UNION 

	SELECT ''S'' AS MODE,[VesselCode] AS [Location],s.ManualId,
	  [CommentId],
	  ManualName,S.[MVersion],MD.Heading,S.SECTIONID,S.[SVersion],
	  [CommentText],
	  [CommentBy] AS [CommentByName], 
	  [CommentOn], 
	  [ComentByRank] AS [Position], 0 AS [PositionId],
	  ''''  AS [Office], 0 AS [OfficeId],
	 CASE WHEN ISNULL(S.[Status],''O'') = ''O'' THEN ''Open'' WHEN ISNULL(S.[Status],''O'') = ''C'' THEN ''Closed'' ELSE '''' END AS [StatusText],ISNULL(S.[Status],''O'') AS Status,
	 CASE WHEN ISNULL([ChangeRequested],''N'') =''Y'' THEN 
		CASE WHEN ISNULL(S.[Stage],''P'') = ''A'' THEN ''Approved'' WHEN ISNULL(S.[Stage],''P'') = ''N'' THEN ''UnApproved'' WHEN ISNULL(S.[Stage],''P'') = ''P'' THEN ''Pending'' WHEN S.[Stage] = ''H'' THEN ''On Hold'' ELSE '''' END
	 ELSE ''NA'' END 	AS [StageText],
	ISNULL(S.[Stage],''P'') AS  [Stage],
	[ReqDate], 
	[ChangeRequested] ,
	ClosedBy,ClosedOn,ClosureRemarks
	FROM [dbo].[SMS_ShipComments] S
	INNER JOIN [dbo].SMS_APP_ManualMaster MM ON MM.MANUALID=S.MANUALID   
	INNER JOIN [dbo].SMS_APP_ManualDetails MD ON MD.MANUALID=S.MANUALID AND MD.SectionId=S.SectionId

	
 ) a 














' 
GO
/****** Object:  View [dbo].[vw_SMS_GetSendManuals]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_SMS_GetSendManuals]'))
EXEC dbo.sp_executesql @statement = N'

CREATE View [dbo].[vw_SMS_GetSendManuals] as
SELECT V.VesselID ,V.VesselName ,MM.ManualID,MM.ManualName,CMD.SectionID,MD.Heading,CMD.Scheduled
,(Case CMD.AckStatus When ''P'' then ''''  When ''S'' then ''Packet Sent'' else ''Ack. Recd'' end)AckStatus,Replace(Convert(Varchar,CMD.AckOn,106),'' '',''-'')AckOn,CMD.AckBy
,(case when CMD.Scheduled=1 then ''sel_row'' else '''' end)RowClass 
,cast(dbo.getdatepart(CMD.SentDate) as datetime) as SentDate,
CMD.SendBy 
,(select Count(*) from SMS_APP_COM_ManualDetails Where ManualID=MM.ManualID And SectionID=CMD.SectionID And SentDate is not null)SentCount
FROM [dbo].[SMS_APP_COM_ManualDetails] CMD 
Inner Join SMS_ManualDetails MD on MD.ManualID=CMD.ManualID And MD.SectionID=CMD.SectionID
left join dbo.Vessel V on V.VesselID=CMD.VesselID
Left Join SMS_ManualMaster MM On MM.ManualID=CMD.ManualID



--Where CMD.VesselID=49 And CMD.ManualID=10 And CMD.SectionID=''1'' 
-- Select * from vw_SMS_GetSendManuals VW Where VW.VesselID=49 And VW.ManualID=10 And VW.SectionID=''1'' 
--select * from SMS_ManualDetails

' 
GO
/****** Object:  View [dbo].[vw_VIQQuestionRanks]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vw_VIQQuestionRanks]'))
EXEC dbo.sp_executesql @statement = N'




CREATE view [dbo].[vw_VIQQuestionRanks]
as 
select 
Q.VESSELCODE,Q.VIQID,Q.QUESTIONID,SORTORDER,RiskScore,ObsCount,CHAPTERID,CHAPTERNO,CHAPTERNAME,VERSIONNAME,QUESTIONNO,QUESTION,GUIDANCE,PREVETTING,OFFICEREMARKS,
NAMEDONEBY,DONEDATE,SHIPCOMMENTS,MODIFIEDON,SHIPCLOSURESTATUS,OFFICECOMMENTBY,OFFICECOMMENT,OFFICECOMMENTDATE,OFFICECLOSURESTATUS,R.RANKID,RANKCODE
from [dbo].[VIQ_VIQDetails] Q 
INNER JOIN DBO.VIQ_VIQDetailsRanks R ON Q.QUESTIONID=R.QUESTIONID AND Q.VIQID=R.VIQID AND Q.VESSELCODE=R.VESSELCODE
INNER JOIN DBO.MP_ALLRANK AR ON AR.RANKID=R.RANKID

--select * from VIQ_VIQDetailsRanks




' 
GO
/****** Object:  View [dbo].[VW_VSL_VPR_ALLREPORTS]    Script Date: 12-Jun-2015 09:18:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_VSL_VPR_ALLREPORTS]'))
EXEC dbo.sp_executesql @statement = N'

-- SELECT * FROM  [dbo].[VW_VSL_VPR_ALLREPORTS]

CREATE VIEW [dbo].[VW_VSL_VPR_ALLREPORTS]
AS
	SELECT 
	VESSELID,
	ReportsPK,
	NoonId as ReportId,
	''N'' as ReportTypeCode,
	''Noon'' as ReportType,
	ReportDate,
	CASE 
	WHEN [VoyCondition]=1 THEN ''Laden''
	WHEN [VoyCondition]=2 THEN ''Ballast''
	ELSE '''' END AS [VoyCondition] 
	
	,VoyCondition AS VoyConditionId
	,VoyInstructions
	,DepPort as DeparturePort
	,DepArrivalPort as ArrivalPort
	,ArrivalPortAgent
	,PersonalIncharge
	,AddressContactDetails


	,NULL AS COSPDATE
	,NULL AS EOSPDATE
	,NULL AS ALLFASTDATE
	,[VoyageNo],[CharterPartySpeed],[VoyOrderSpeed],Convert(Numeric(9,2),Round((([SteamingHrs] + ([SteamingMin]/60.0))),2)) AS [SteamingTime],[DistanceMadeGood] AS [DistanceMadeGood],
	Case When Round((([SteamingHrs] + ([SteamingMin]/60.0))),2)=0 then 0
	else
	Convert(Numeric(9,2),Round(
	(( [DistanceMadeGood] / Round((([SteamingHrs] + ([SteamingMin]/60.0))),2)) ),2)) End AS [AvgSpeed],
	[Stoppages] AS [Stoppages],[DepPort],[DepArrivalPort], [DepPort] AS PortName,[ArrivalPortETA], [ArrivalPortETAHrs],[ArrivalPortETAMin],
	[DraftFwd],[DraftAft],
	Convert(Numeric(9,2),Round((([DraftFwd]+[DraftAft])/2) ,2))
	AS [MeanDraft],[WindForce],[SeaState],Lattitude1,Lattitude2,Lattitude3,Longitude1,Longitud2,Longitud3
	,CourceT,WindDirectionT,SeaDirection,CurrentDirection,CurrentStrength
	,[MEIFO45],[MEIFO1],[MEMGO5],[MEMGO1],[MEMDO],[AEIFO45],[AEIFO1],[AEMGO5],[AEMGO1],[AEMDO],[CargoHeatingIFO45],[CargoHeatingIFO1],[CargoHeatingMGO5],[CargoHeatingMGO1],[CargoHeatingMDO],[MECCLube],[MECYLLube],[AECCLube],[HYDLube],[GeneratedFreshWater],[ConsumedFreshWater] -- 21
	,[ExhTempMin],[ExhTempMax],[MERPM],[EngineDistance],[Slip],[MEOutPut],[METhermalLoad],[MELoadIndicator],[METCNo1RPM],[METCNo2RPM],[MESCAVPressure],[SCAVTEMP],[LubeOilPressure],[SeaWaterTemp],[EngRoomTemp],[BligPump],[AEFOInletTemp], TotalAUXLoad --18
	,[AUX1Load],[AUX2Load],[AUX3Load],[AUX4Load],[AENo1],[AENo2],[AENo3],[AENo4],[TotalCargoWeight],[BallastWeight] --9
	,0 AS TCU20L,0 AS TCU40L,0 AS TCU20E,0 AS TCU40E
	,ROBIFO45Fuel as ROBIFO45,ROBIFO1Fuel as ROBIFO1,ROBMGO5Fuel as ROBMGO5,ROBMGO1Fuel as ROBMGO1,ROBMDOFuel as ROBMDO,ROBIFO45Lube as ROBMECC,ROBIFO1Lube as ROBMECYL,ROBMGO5Lube as ROBAECC,ROBMGO1Lube as ROBHYD,ROBMDOLube as ROBMDOLube,ROBIFO45FreshWater as ROBFesshWater
	,0 AS ROBIFO45Recv, 0 AS ROBMGO1Recv, 0 AS RobMDORecv
	,0 AS ROBMECCRecv, 0 AS ROBMECYLRecv, 0 AS ROBAECCRecv,0 AS ROBHYDRecv
	,0 AS RobFesshWaterRecv
	from VSL_VPRNoonReport
UNION
	SELECT 
	VESSELID,
	ReportsPK,
	DepartureId as ReportId,
	''D'' as ReportTypeCode,
	''Departure'' as ReportType,
	ReportDate,
	CASE 
	WHEN [VoyCondition]=1 THEN ''Laden''
	WHEN [VoyCondition]=2 THEN ''Ballast''
	ELSE '''' END AS [VoyCondition] 

	,VoyCondition AS VoyConditionId
	,VoyInstructions
	,DepPort as DeparturePort
	,DepArrivalPort as ArrivalPort
	,ArrivalPortAgent
	,PersonalIncharge
	,AddressContactDetails


	,CONVERT(SMALLDATETIME,CONVERT(VARCHAR,COSPDATE,106) + '' '' + CONVERT(VARCHAR,COSPHRS) + '':'' + CONVERT(VARCHAR,COSPMIN)) AS COSPDATE
	,NULL AS EOSPDATE
	,NULL AS ALLFASTDATE
	,[VoyageNo],[CharterPartySpeed],[VoyOrderSpeed],0 AS [SteamingTime],0 AS [DistanceMadeGood],0 AS [AvgSpeed],0 AS [Stoppages],[DepPort],[DepArrivalPort], [DepPort] AS PortName, [ArrivalPortETA], [ArrivalPortETAHrs],[ArrivalPortETAMin]
	,[DraftFwd],[DraftAft],Convert(Numeric(9,2),Round((([DraftFwd]+[DraftAft])/2) ,2)) AS [MeanDraft],[WindForce],[SeaState],Lattitude1,Lattitude2,Lattitude3,Longitude1,Longitud2,Longitud3
	,CourceT,WindDirectionT,SeaDirection,CurrentDirection,CurrentStrength
	,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 -- 21
	,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 --18
	,0,0,0,0,0,0,0,0,cAst([TCW] aS numeric(9,2)) as TCW,[BW] --9
	,TCU20L,TCU40L,TCU20E,TCU40E
	,ROBIFO45,ROBIFO1,ROBMGO5,ROBMGO1,ROBMDO,ROBMECC,ROBMECYL,ROBAECC,ROBHYD,ROBMDOLube,ROBFesshWater
	,ROBIFO45Recv, ROBMGO1Recv, RobMDORecv
	,ROBMECCRecv, ROBMECYLRecv, ROBAECCRecv,ROBHYDRecv
	,RobFesshWaterRecv
	FROM VSL_VPRDepartureReport
UNION
	SELECT 
	VESSELID,
	ReportsPK,
	ArrivalId as ReportId,
	''A'' as ReportTypeCode,
	''Arrival'' as ReportType,
	ReportDate,
	CASE 
	WHEN [VoyCondition]=1 THEN ''Laden''
	WHEN [VoyCondition]=2 THEN ''Ballast''
	ELSE '''' END AS [VoyCondition] 

	,0 VoyConditionId
	,'''' as VoyInstructions
	,'''' as DeparturePort
	,'''' as ArrivalPort
	,'''' as ArrivalPortAgent
	,'''' as PersonalIncharge
	,'''' as AddressContactDetails

	,NULL AS COSPDATE
	,CONVERT(SMALLDATETIME,CONVERT(VARCHAR,EOSPDATE,106) + '' '' + CONVERT(VARCHAR,EOSPHRS) + '':'' + CONVERT(VARCHAR,EOSPMIN)) AS EOSPDATE
	,NULL AS ALLFASTDATE
	,[VoyageNo],0,0,0 AS [SteamingTime],0 AS [DistanceMadeGood],0 AS [AvgSpeed],0 AS [Stoppages],[DepPort],[DepArrivalPort],  [DepArrivalPort] AS PortName, null AS [ArrivalPortETA], 0 AS [ArrivalPortETAHrs], 0 AS [ArrivalPortETAMin],
	[DraftFwd],[DraftAft],
	Convert(Numeric(9,2),Round((([DraftFwd]+[DraftAft])/2) ,2)) AS [MeanDraft],[WindForce],[SeaState],Lattitude1,Lattitude2,Lattitude3,Longitude1,Longitud2,Longitud3
	,CourceT,WindDirectionT,SeaDirection,CurrentDirection,CurrentStrength
	,[MEIFO45],[MEIFO1],[MEMGO5],[MEMGO1],[MEMDO],[AEIFO45],[AEIFO1],[AEMGO5],[AEMGO1],[AEMDO],[CargoHeatingIFO45],[CargoHeatingIFO1],[CargoHeatingMGO5],[CargoHeatingMGO1],[CargoHeatingMDO],[MECCLube],[MECYLLube],[AECCLube],[HYDLube],[GeneratedFreshWater],[ConsumedFreshWater] -- 21
	,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 --- 18
	,0,0,0,0,0,0,0,0,cAst([TCW] aS numeric(9,2)) as TCW,[BallastWeight]
	,0 AS TCU20L,0 AS TCU40L,0 AS TCU20E,0 AS TCU40E
	,ROBIFO45Fuel,ROBIFO1Fuel,ROBMGO5Fuel,ROBMGO1Fuel,ROBMDOFuel,ROBIFO45Lube,ROBIFO1Lube,ROBMGO5Lube,ROBMGO1Lube,ROBMDOLube,ROBFreshWater
	,0 AS ROBIFO45Recv, 0 AS ROBMGO1Recv, 0 AS RobMDORecv
	,0 AS ROBMECCRecv, 0 AS ROBMECYLRecv, 0 AS ROBAECCRecv,0 AS ROBHYDRecv
	,0 AS RobFesshWaterRecv
	FROM VSL_VPRArrivalReport
UNION
	SELECT 
	VESSELID,
	ReportsPK,
	AnchorageID as ReportId,
	''PA'' as ReportTypeCode,
	''Port-Anchorage'' as ReportType,
	ReportDate,'''' As [VoyCondition]
	
	,0 VoyConditionId
	,'''' as VoyInstructions
	,'''' as DeparturePort
	,'''' as ArrivalPort
	,'''' as ArrivalPortAgent
	,'''' as PersonalIncharge
	,'''' as AddressContactDetails

	,NULL AS COSPDATE,NULL AS EOSPDATE,NULL AS ALLFASTDATE,[VoyageNo],0,0,0 AS [SteamingTime],0 AS [DistanceMadeGood],0 AS [AvgSpeed],0 AS [Stoppages],'''' as [DepPort],'''' as [DepArrivalPort], [ArrivalPort] AS PortName, null AS [ArrivalPortETA], 0 AS [ArrivalPortETAHrs], 0 AS [ArrivalPortETAMin],
	0 as [DraftFwd],0 as [DraftAft],0 AS [MeanDraft],[WindForce],[SeaState],Lattitude1,Lattitude2,Lattitude3,Longitude1,Longitud2,Longitud3
	,CourceT,WindDirectionT,SeaDirection,CurrentDirection,CurrentStrength
	,[MEIFO45],[MEIFO1],[MEMGO5],[MEMGO1],[MEMDO],[AEIFO45],[AEIFO1],[AEMGO5],[AEMGO1],[AEMDO],[CargoHeatingIFO45],[CargoHeatingIFO1],[CargoHeatingMGO5],[CargoHeatingMGO1],[CargoHeatingMDO],[MECCLube],[MECYLLube],[AECCLube],[HYDLube],[GeneratedFreshWater],[ConsumedFreshWater] -- 21
	,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 --- 18
	,0,0,0,0,0,0,0,0,cAst([TCW] aS numeric(9,2)) as TCW,[BW]
	,0 AS TCU20L,0 AS TCU40L,0 AS TCU20E,0 AS TCU40E,

	ROBIFO45,
	ROBIFO1,
	ROBMGO5,
	ROBMGO1,
	ROBMDO,
	ROBMECC,
	ROBMECYL,
	ROBAECC,
	ROBHYD,
	ROBMDOLube,
	ROBFesshWater

	,0 AS ROBIFO45Recv, 0 AS ROBMGO1Recv, 0 AS RobMDORecv
	,0 AS ROBMECCRecv, 0 AS ROBMECYLRecv, 0 AS ROBAECCRecv,0 AS ROBHYDRecv
	,0 AS RobFesshWaterRecv
	FROM VSL_VPRPortAnchorageReport
UNION
	SELECT 
	VESSELID,
	ReportsPK,
	BerthingID as ReportId,
	''PB'' as ReportTypeCode,
	''Port-Berthing'' as ReportType,
	ReportDate,'''' As [VoyCondition]
	
	,0 VoyConditionId
	,'''' as VoyInstructions
	,'''' as DeparturePort
	,'''' as ArrivalPort
	,'''' as ArrivalPortAgent
	,'''' as PersonalIncharge
	,'''' as AddressContactDetails

	,NULL AS COSPDATE,NULL AS EOSPDATE,
	CONVERT(SMALLDATETIME,CONVERT(VARCHAR,ALLFASTDATE,106) + '' '' + CONVERT(VARCHAR,ALLFASTHH) + '':'' + CONVERT(VARCHAR,ALLFASTMM)) AS ALLFASTDATE
	,[VoyageNo],0,0,0 AS [SteamingTime],0 AS [DistanceMadeGood],0 AS [AvgSpeed],0 AS [Stoppages],'''' as [DepPort],'''' as [DepArrivalPort], [ArrivalPort] AS PortName, null AS [ArrivalPortETA], 0 AS [ArrivalPortETAHrs], 0 AS [ArrivalPortETAMin],
	0 as [DraftFwd],0 as [DraftAft],0 AS [MeanDraft],[WindForce],[SeaState],Lattitude1,Lattitude2,Lattitude3,Longitude1,Longitud2,Longitud3
	,CourceT,WindDirectionT,SeaDirection,CurrentDirection,CurrentStrength
	,[MEIFO45],[MEIFO1],[MEMGO5],[MEMGO1],[MEMDO],[AEIFO45],[AEIFO1],[AEMGO5],[AEMGO1],[AEMDO],[CargoHeatingIFO45],[CargoHeatingIFO1],[CargoHeatingMGO5],[CargoHeatingMGO1],[CargoHeatingMDO],[MECCLube],[MECYLLube],[AECCLube],[HYDLube],[GeneratedFreshWater],[ConsumedFreshWater]
	,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 --- 18
	,0,0,0,0,0,0,0,0,cAst([TCW] aS numeric(9,2)) as TCW,[BW]
	,0 AS TCU20L,0 AS TCU40L,0 AS TCU20E,0 AS TCU40E,
	
	ROBIFO45,
	ROBIFO1,
	ROBMGO5,
	ROBMGO1,
	ROBMDO,
	ROBMECC,
	ROBMECYL,
	ROBAECC,
	ROBHYD,
	ROBMDOLube,
	ROBFesshWater

	,0 AS ROBIFO45Recv, 0 AS ROBMGO1Recv, 0 AS RobMDORecv
	,0 AS ROBMECCRecv, 0 AS ROBMECYLRecv, 0 AS ROBAECCRecv,0 AS ROBHYDRecv
	,0 AS RobFesshWaterRecv
	FROM VSL_VPRPortBerthingReport
UNION
	SELECT 
	VESSELID,
	ReportsPK,
	PortDriftID as ReportId,
	''PD'' as ReportTypeCode,
	''Port-Drift'' as ReportType,
	ReportDate,'''' As [VoyCondition]
	
	,0 VoyConditionId
	,'''' as VoyInstructions
	,'''' as DeparturePort
	,'''' as ArrivalPort
	,'''' as ArrivalPortAgent
	,'''' as PersonalIncharge
	,'''' as AddressContactDetails
	
	,NULL AS COSPDATE,NULL AS EOSPDATE,NULL AS ALLFASTDATE,[VoyageNo],0,0,0 AS [SteamingTime],0 AS [DistanceMadeGood],0 AS [AvgSpeed],0 AS [Stoppages],'''' as [DepPort],'''' as [DepArrivalPort], [ArrivalPort] AS PortName, null AS [ArrivalPortETA], 0 AS [ArrivalPortETAHrs], 0 AS [ArrivalPortETAMin],
	0 as [DraftFwd],0 as [DraftAft],0 AS [MeanDraft],[WindForce],[SeaState],Lattitude1,Lattitude2,Lattitude3,Longitude1,Longitud2,Longitud3
	,CourceT,WindDirectionT,SeaDirection,CurrentDirection,CurrentStrength
	,[MEIFO45],[MEIFO1],[MEMGO5],[MEMGO1],[MEMDO],[AEIFO45],[AEIFO1],[AEMGO5],[AEMGO1],[AEMDO],[CargoHeatingIFO45],[CargoHeatingIFO1],[CargoHeatingMGO5],[CargoHeatingMGO1],[CargoHeatingMDO],[MECCLube],[MECYLLube],[AECCLube],[HYDLube],[GeneratedFreshWater],[ConsumedFreshWater]
	,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 --- 18 
	,0,0,0,0,0,0,0,0,cAst([TCW] aS numeric(9,2)) as TCW,[BW]
	,0 AS TCU20L,0 AS TCU40L,0 AS TCU20E,0 AS TCU40E,
	
	ROBIFO45,
	ROBIFO1,
	ROBMGO5,
	ROBMGO1,
	ROBMDO,
	ROBMECC,
	ROBMECYL,
	ROBAECC,
	ROBHYD,
	ROBMDOLube,
	ROBFesshWater

	,0 AS ROBIFO45Recv, 0 AS ROBMGO1Recv, 0 AS RobMDORecv
	,0 AS ROBMECCRecv, 0 AS ROBMECYLRecv, 0 AS ROBAECCRecv,0 AS ROBHYDRecv
	,0 AS RobFesshWaterRecv
	FROM VSL_VPRPortDriftReport










' 
GO
/****** Object:  Index [IX_StartTime]    Script Date: 12-Jun-2015 09:18:55 ******/
IF NOT EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[DefaultTrace_History]') AND name = N'IX_StartTime')
CREATE CLUSTERED INDEX [IX_StartTime] ON [dbo].[DefaultTrace_History]
(
	[StartTime] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DD_Docket_RFQ_Master', N'COLUMN',N'Status'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C - RFQ Created , W - Awaiting Quotes , Q - Quotes Received , I - Cancelled , P - Order Placed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DD_Docket_RFQ_Master', @level2type=N'COLUMN',@level2name=N'Status'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DD_Docket_RFQ_Master', N'COLUMN',N'ActiveInactive'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'A - Active , I - Inactive ( Cancelled )' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DD_Docket_RFQ_Master', @level2type=N'COLUMN',@level2name=N'ActiveInactive'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DD_DocketMaster', N'COLUMN',N'Status'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'P - Plan , E - Executed , C - Closed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DD_DocketMaster', @level2type=N'COLUMN',@level2name=N'Status'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_MatrixDetails', N'COLUMN',N'MatrixId'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Foreign Key' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_MatrixDetails', @level2type=N'COLUMN',@level2name=N'MatrixId'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_MatrixDetails', N'COLUMN',N'DTId'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'TrainingId / DrillId' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_MatrixDetails', @level2type=N'COLUMN',@level2name=N'DTId'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_MatrixDetails', N'COLUMN',N'RecordType'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'D - Drill , T - Training' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_MatrixDetails', @level2type=N'COLUMN',@level2name=N'RecordType'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_MatrixDetails', N'COLUMN',N'ValidityType'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'D- Days , W- Weeks , M - Months , Y - Years' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_MatrixDetails', @level2type=N'COLUMN',@level2name=N'ValidityType'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_TrainingMaster', N'COLUMN',N'RecordType'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'G - Training Group ,  T - Training' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_TrainingMaster', @level2type=N'COLUMN',@level2name=N'RecordType'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_VSL_DrillTrainings', N'COLUMN',N'NextDueDate'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'P- Planned , D- Due , ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_VSL_DrillTrainings', @level2type=N'COLUMN',@level2name=N'NextDueDate'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'DT_VSL_DrillTrainingsHistory', N'COLUMN',N'RecordType'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'D - Done , P- Postpone' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DT_VSL_DrillTrainingsHistory', @level2type=N'COLUMN',@level2name=N'RecordType'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'MailSettings', N'COLUMN',N'PacketMode'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N' A- Auto , M- Manual' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'MailSettings', @level2type=N'COLUMN',@level2name=N'PacketMode'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'SMS_OfficeComments', N'COLUMN',N'Status'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'O - Open,  C - Closed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'SMS_OfficeComments', @level2type=N'COLUMN',@level2name=N'Status'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'SMS_OfficeComments', N'COLUMN',N'Stage'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'P - Pending, A - Approved, N - Not Approved, H - On Hold' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'SMS_OfficeComments', @level2type=N'COLUMN',@level2name=N'Stage'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'SMS_ShipComments', N'COLUMN',N'Status'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'O - Open,  C - Closed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'SMS_ShipComments', @level2type=N'COLUMN',@level2name=N'Status'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'SMS_ShipComments', N'COLUMN',N'Stage'))
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'P - Pending, A - Approved, N - Not Approved, H - On Hold' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'SMS_ShipComments', @level2type=N'COLUMN',@level2name=N'Stage'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ClassComponentJobStatus', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[41] 4[20] 2[28] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "JH"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 125
               Right = 232
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "CM"
            Begin Extent = 
               Top = 6
               Left = 270
               Bottom = 125
               Right = 441
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "VCM"
            Begin Extent = 
               Top = 6
               Left = 479
               Bottom = 125
               Right = 644
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "CJM"
            Begin Extent = 
               Top = 126
               Left = 38
               Bottom = 245
               Right = 207
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "VSL"
            Begin Extent = 
               Top = 126
               Left = 245
               Bottom = 215
               Right = 405
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
En' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ClassComponentJobStatus'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane2' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ClassComponentJobStatus', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'd
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ClassComponentJobStatus'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ClassComponentJobStatus', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ClassComponentJobStatus'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ComponentDetailsListReport', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "MAIN"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 223
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "CMV2"
            Begin Extent = 
               Top = 6
               Left = 261
               Bottom = 135
               Right = 435
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ComponentDetailsListReport'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ComponentDetailsListReport', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ComponentDetailsListReport'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'Vw_ComponentJobs', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[41] 4[12] 2[29] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "ComponentMaster"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 125
               Right = 213
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "ComponentsJobMapping"
            Begin Extent = 
               Top = 6
               Left = 251
               Bottom = 125
               Right = 411
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "JobMaster"
            Begin Extent = 
               Top = 6
               Left = 449
               Bottom = 110
               Right = 609
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "DeptMaster"
            Begin Extent = 
               Top = 114
               Left = 449
               Bottom = 203
               Right = 609
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "Rank"
            Begin Extent = 
               Top = 126
               Left = 38
               Bottom = 245
               Right = 198
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "JobIntervalMaster"
            Begin Extent = 
               Top = 126
               Left = 236
               Bottom = 215
               Right = 396
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
 ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Vw_ComponentJobs'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane2' , N'SCHEMA',N'dbo', N'VIEW',N'Vw_ComponentJobs', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'        Column = 4035
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Vw_ComponentJobs'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'Vw_ComponentJobs', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Vw_ComponentJobs'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'VW_DefectReport_OfficeData', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[41] 4[8] 2[33] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_DefectReport_OfficeData'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'VW_DefectReport_OfficeData', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_DefectReport_OfficeData'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'VW_DefectReport_ShipData', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_DefectReport_ShipData'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'VW_DefectReport_ShipData', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_DefectReport_ShipData'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ER_S115_PrintReport', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[6] 4[4] 2[72] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "R"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 191
               Right = 308
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "O"
            Begin Extent = 
               Top = 6
               Left = 331
               Bottom = 172
               Right = 577
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ER_S115_PrintReport'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ER_S115_PrintReport', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ER_S115_PrintReport'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ER_S115_PrintReport_InjuryToPerson', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "ER_S115_InjuryToPerson"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 285
            End
            DisplayFlags = 280
            TopColumn = 20
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ER_S115_PrintReport_InjuryToPerson'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ER_S115_PrintReport_InjuryToPerson', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ER_S115_PrintReport_InjuryToPerson'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ER_S133_PrintReport', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[41] 4[6] 2[35] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = -96
         Left = 0
      End
      Begin Tables = 
         Begin Table = "R"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 221
            End
            DisplayFlags = 280
            TopColumn = 17
         End
         Begin Table = "O"
            Begin Extent = 
               Top = 6
               Left = 259
               Bottom = 135
               Right = 449
            End
            DisplayFlags = 280
            TopColumn = 8
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ER_S133_PrintReport'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_ER_S133_PrintReport', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_ER_S133_PrintReport'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobComplitationReport', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobComplitationReport'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobComplitationReport', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobComplitationReport'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobPlanningForRPT', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = -192
         Left = 0
      End
      Begin Tables = 
         Begin Table = "VCJM"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 125
               Right = 198
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "VCJMU"
            Begin Extent = 
               Top = 6
               Left = 236
               Bottom = 125
               Right = 396
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "RM"
            Begin Extent = 
               Top = 126
               Left = 38
               Bottom = 245
               Right = 198
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "CJM"
            Begin Extent = 
               Top = 126
               Left = 236
               Bottom = 245
               Right = 396
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "JM"
            Begin Extent = 
               Top = 246
               Left = 38
               Bottom = 350
               Right = 198
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "CM"
            Begin Extent = 
               Top = 246
               Left = 236
               Bottom = 365
               Right = 407
            End
            DisplayFlags = 280
            TopColumn = 3
         End
         Begin Table = "VCM"
            Begin Extent = 
               Top = 354
               Left = 38
               Bottom = 473
               Right = 203
            End
            DisplayFlags = 280
            TopColumn = 3' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobPlanningForRPT'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane2' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobPlanningForRPT', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'
         End
         Begin Table = "JIM"
            Begin Extent = 
               Top = 366
               Left = 241
               Bottom = 455
               Right = 401
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "PM"
            Begin Extent = 
               Top = 456
               Left = 241
               Bottom = 575
               Right = 435
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobPlanningForRPT'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobPlanningForRPT', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobPlanningForRPT'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobPlanningHomerpt', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "VSL_PlanMaster"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 125
               Right = 232
            End
            DisplayFlags = 280
            TopColumn = 36
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobPlanningHomerpt'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobPlanningHomerpt', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobPlanningHomerpt'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobUpdateDataByPeriod', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[35] 4[11] 2[38] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "VSL_VesselJobUpdateHistory"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 125
               Right = 232
            End
            DisplayFlags = 280
            TopColumn = 47
         End
         Begin Table = "ComponentMaster"
            Begin Extent = 
               Top = 6
               Left = 270
               Bottom = 125
               Right = 441
            End
            DisplayFlags = 280
            TopColumn = 3
         End
         Begin Table = "JobMaster"
            Begin Extent = 
               Top = 6
               Left = 677
               Bottom = 105
               Right = 837
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "Rank"
            Begin Extent = 
               Top = 114
               Left = 677
               Bottom = 233
               Right = 837
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "ComponentsJobMapping"
            Begin Extent = 
               Top = 6
               Left = 479
               Bottom = 125
               Right = 639
            End
            DisplayFlags = 280
            TopColumn = 5
         End
         Begin Table = "VSL_VesselComponentJobMaster"
            Begin Extent = 
               Top = 126
               Left = 236
               Bottom = 245
               Right = 396
            End
            DisplayFlags = 280
            TopColumn = 4
         End
         Begin Table = "JobIntervalMaster"
            Begin Extent = 
               Top = 126
               Left = 38
               Bottom = 215
  ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobUpdateDataByPeriod'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane2' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobUpdateDataByPeriod', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'             Right = 198
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobUpdateDataByPeriod'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'vw_GetJobUpdateDataByPeriod', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vw_GetJobUpdateDataByPeriod'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'VW_MP_VSL_ProvisionDetails', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[41] 4[5] 2[44] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "PD"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 215
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "P"
            Begin Extent = 
               Top = 6
               Left = 253
               Bottom = 135
               Right = 423
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_MP_VSL_ProvisionDetails'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'VW_MP_VSL_ProvisionDetails', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_MP_VSL_ProvisionDetails'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'VW_MP_VSL_ProvisionNationalityWise', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "PN"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 208
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "N"
            Begin Extent = 
               Top = 6
               Left = 246
               Bottom = 101
               Right = 425
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_MP_VSL_ProvisionNationalityWise'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'VW_MP_VSL_ProvisionNationalityWise', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_MP_VSL_ProvisionNationalityWise'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPane1' , N'SCHEMA',N'dbo', N'VIEW',N'VW_MP_VSL_ProvisionOtherItems', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "OI"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 208
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "UM"
            Begin Extent = 
               Top = 6
               Left = 246
               Bottom = 101
               Right = 416
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_MP_VSL_ProvisionOtherItems'
GO
IF NOT EXISTS (SELECT * FROM ::fn_listextendedproperty(N'MS_DiagramPaneCount' , N'SCHEMA',N'dbo', N'VIEW',N'VW_MP_VSL_ProvisionOtherItems', NULL,NULL))
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'VW_MP_VSL_ProvisionOtherItems'
GO
ALTER DATABASE [eMANAGER] SET  READ_WRITE 
GO
